function Ug(n,i){for(var l=0;l<i.length;l++){const p=i[l];if(typeof p!="string"&&!Array.isArray(p)){for(const _ in p)if(_!=="default"&&!(_ in n)){const w=Object.getOwnPropertyDescriptor(p,_);w&&Object.defineProperty(n,_,w.get?w:{enumerable:!0,get:()=>p[_]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))p(_);new MutationObserver(_=>{for(const w of _)if(w.type==="childList")for(const v of w.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&p(v)}).observe(document,{childList:!0,subtree:!0});function l(_){const w={};return _.integrity&&(w.integrity=_.integrity),_.referrerPolicy&&(w.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?w.credentials="include":_.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function p(_){if(_.ep)return;_.ep=!0;const w=l(_);fetch(_.href,w)}})();var U2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $g(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gx={exports:{}},Bp={},yx={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh=Symbol.for("react.element"),$2=Symbol.for("react.portal"),Z2=Symbol.for("react.fragment"),q2=Symbol.for("react.strict_mode"),H2=Symbol.for("react.profiler"),G2=Symbol.for("react.provider"),W2=Symbol.for("react.context"),X2=Symbol.for("react.forward_ref"),K2=Symbol.for("react.suspense"),J2=Symbol.for("react.memo"),Y2=Symbol.for("react.lazy"),kv=Symbol.iterator;function Q2(n){return n===null||typeof n!="object"?null:(n=kv&&n[kv]||n["@@iterator"],typeof n=="function"?n:null)}var _x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vx=Object.assign,xx={};function xu(n,i,l){this.props=n,this.context=i,this.refs=xx,this.updater=l||_x}xu.prototype.isReactComponent={};xu.prototype.setState=function(n,i){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,i,"setState")};xu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function wx(){}wx.prototype=xu.prototype;function Zg(n,i,l){this.props=n,this.context=i,this.refs=xx,this.updater=l||_x}var qg=Zg.prototype=new wx;qg.constructor=Zg;vx(qg,xu.prototype);qg.isPureReactComponent=!0;var Iv=Array.isArray,bx=Object.prototype.hasOwnProperty,Hg={current:null},Sx={key:!0,ref:!0,__self:!0,__source:!0};function Tx(n,i,l){var p,_={},w=null,v=null;if(i!=null)for(p in i.ref!==void 0&&(v=i.ref),i.key!==void 0&&(w=""+i.key),i)bx.call(i,p)&&!Sx.hasOwnProperty(p)&&(_[p]=i[p]);var c=arguments.length-2;if(c===1)_.children=l;else if(1<c){for(var A=Array(c),V=0;V<c;V++)A[V]=arguments[V+2];_.children=A}if(n&&n.defaultProps)for(p in c=n.defaultProps,c)_[p]===void 0&&(_[p]=c[p]);return{$$typeof:Sh,type:n,key:w,ref:v,props:_,_owner:Hg.current}}function eS(n,i){return{$$typeof:Sh,type:n.type,key:i,ref:n.ref,props:n.props,_owner:n._owner}}function Gg(n){return typeof n=="object"&&n!==null&&n.$$typeof===Sh}function tS(n){var i={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(l){return i[l]})}var Pv=/\/+/g;function gm(n,i){return typeof n=="object"&&n!==null&&n.key!=null?tS(""+n.key):i.toString(36)}function Jd(n,i,l,p,_){var w=typeof n;(w==="undefined"||w==="boolean")&&(n=null);var v=!1;if(n===null)v=!0;else switch(w){case"string":case"number":v=!0;break;case"object":switch(n.$$typeof){case Sh:case $2:v=!0}}if(v)return v=n,_=_(v),n=p===""?"."+gm(v,0):p,Iv(_)?(l="",n!=null&&(l=n.replace(Pv,"$&/")+"/"),Jd(_,i,l,"",function(V){return V})):_!=null&&(Gg(_)&&(_=eS(_,l+(!_.key||v&&v.key===_.key?"":(""+_.key).replace(Pv,"$&/")+"/")+n)),i.push(_)),1;if(v=0,p=p===""?".":p+":",Iv(n))for(var c=0;c<n.length;c++){w=n[c];var A=p+gm(w,c);v+=Jd(w,i,l,A,_)}else if(A=Q2(n),typeof A=="function")for(n=A.call(n),c=0;!(w=n.next()).done;)w=w.value,A=p+gm(w,c++),v+=Jd(w,i,l,A,_);else if(w==="object")throw i=String(n),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return v}function Ld(n,i,l){if(n==null)return n;var p=[],_=0;return Jd(n,p,"","",function(w){return i.call(l,w,_++)}),p}function nS(n){if(n._status===-1){var i=n._result;i=i(),i.then(function(l){(n._status===0||n._status===-1)&&(n._status=1,n._result=l)},function(l){(n._status===0||n._status===-1)&&(n._status=2,n._result=l)}),n._status===-1&&(n._status=0,n._result=i)}if(n._status===1)return n._result.default;throw n._result}var Xr={current:null},Yd={transition:null},rS={ReactCurrentDispatcher:Xr,ReactCurrentBatchConfig:Yd,ReactCurrentOwner:Hg};function Ex(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:Ld,forEach:function(n,i,l){Ld(n,function(){i.apply(this,arguments)},l)},count:function(n){var i=0;return Ld(n,function(){i++}),i},toArray:function(n){return Ld(n,function(i){return i})||[]},only:function(n){if(!Gg(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Zt.Component=xu;Zt.Fragment=Z2;Zt.Profiler=H2;Zt.PureComponent=Zg;Zt.StrictMode=q2;Zt.Suspense=K2;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rS;Zt.act=Ex;Zt.cloneElement=function(n,i,l){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var p=vx({},n.props),_=n.key,w=n.ref,v=n._owner;if(i!=null){if(i.ref!==void 0&&(w=i.ref,v=Hg.current),i.key!==void 0&&(_=""+i.key),n.type&&n.type.defaultProps)var c=n.type.defaultProps;for(A in i)bx.call(i,A)&&!Sx.hasOwnProperty(A)&&(p[A]=i[A]===void 0&&c!==void 0?c[A]:i[A])}var A=arguments.length-2;if(A===1)p.children=l;else if(1<A){c=Array(A);for(var V=0;V<A;V++)c[V]=arguments[V+2];p.children=c}return{$$typeof:Sh,type:n.type,key:_,ref:w,props:p,_owner:v}};Zt.createContext=function(n){return n={$$typeof:W2,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:G2,_context:n},n.Consumer=n};Zt.createElement=Tx;Zt.createFactory=function(n){var i=Tx.bind(null,n);return i.type=n,i};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(n){return{$$typeof:X2,render:n}};Zt.isValidElement=Gg;Zt.lazy=function(n){return{$$typeof:Y2,_payload:{_status:-1,_result:n},_init:nS}};Zt.memo=function(n,i){return{$$typeof:J2,type:n,compare:i===void 0?null:i}};Zt.startTransition=function(n){var i=Yd.transition;Yd.transition={};try{n()}finally{Yd.transition=i}};Zt.unstable_act=Ex;Zt.useCallback=function(n,i){return Xr.current.useCallback(n,i)};Zt.useContext=function(n){return Xr.current.useContext(n)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(n){return Xr.current.useDeferredValue(n)};Zt.useEffect=function(n,i){return Xr.current.useEffect(n,i)};Zt.useId=function(){return Xr.current.useId()};Zt.useImperativeHandle=function(n,i,l){return Xr.current.useImperativeHandle(n,i,l)};Zt.useInsertionEffect=function(n,i){return Xr.current.useInsertionEffect(n,i)};Zt.useLayoutEffect=function(n,i){return Xr.current.useLayoutEffect(n,i)};Zt.useMemo=function(n,i){return Xr.current.useMemo(n,i)};Zt.useReducer=function(n,i,l){return Xr.current.useReducer(n,i,l)};Zt.useRef=function(n){return Xr.current.useRef(n)};Zt.useState=function(n){return Xr.current.useState(n)};Zt.useSyncExternalStore=function(n,i,l){return Xr.current.useSyncExternalStore(n,i,l)};Zt.useTransition=function(){return Xr.current.useTransition()};Zt.version="18.3.1";yx.exports=Zt;var Ie=yx.exports;const Cx=$g(Ie),iS=Ug({__proto__:null,default:Cx},[Ie]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS=Ie,aS=Symbol.for("react.element"),sS=Symbol.for("react.fragment"),lS=Object.prototype.hasOwnProperty,uS=oS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cS={key:!0,ref:!0,__self:!0,__source:!0};function kx(n,i,l){var p,_={},w=null,v=null;l!==void 0&&(w=""+l),i.key!==void 0&&(w=""+i.key),i.ref!==void 0&&(v=i.ref);for(p in i)lS.call(i,p)&&!cS.hasOwnProperty(p)&&(_[p]=i[p]);if(n&&n.defaultProps)for(p in i=n.defaultProps,i)_[p]===void 0&&(_[p]=i[p]);return{$$typeof:aS,type:n,key:w,ref:v,props:_,_owner:uS.current}}Bp.Fragment=sS;Bp.jsx=kx;Bp.jsxs=kx;gx.exports=Bp;var vt=gx.exports,Gm={},Ix={exports:{}},Ai={},Px={exports:{}},Mx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function i(rt,ut){var wt=rt.length;rt.push(ut);e:for(;0<wt;){var Dt=wt-1>>>1,Nt=rt[Dt];if(0<_(Nt,ut))rt[Dt]=ut,rt[wt]=Nt,wt=Dt;else break e}}function l(rt){return rt.length===0?null:rt[0]}function p(rt){if(rt.length===0)return null;var ut=rt[0],wt=rt.pop();if(wt!==ut){rt[0]=wt;e:for(var Dt=0,Nt=rt.length,kn=Nt>>>1;Dt<kn;){var yn=2*(Dt+1)-1,Fn=rt[yn],dn=yn+1,on=rt[dn];if(0>_(Fn,wt))dn<Nt&&0>_(on,Fn)?(rt[Dt]=on,rt[dn]=wt,Dt=dn):(rt[Dt]=Fn,rt[yn]=wt,Dt=yn);else if(dn<Nt&&0>_(on,wt))rt[Dt]=on,rt[dn]=wt,Dt=dn;else break e}}return ut}function _(rt,ut){var wt=rt.sortIndex-ut.sortIndex;return wt!==0?wt:rt.id-ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var w=performance;n.unstable_now=function(){return w.now()}}else{var v=Date,c=v.now();n.unstable_now=function(){return v.now()-c}}var A=[],V=[],W=1,j=null,N=3,ke=!1,Se=!1,be=!1,Ze=typeof setTimeout=="function"?setTimeout:null,oe=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ue(rt){for(var ut=l(V);ut!==null;){if(ut.callback===null)p(V);else if(ut.startTime<=rt)p(V),ut.sortIndex=ut.expirationTime,i(A,ut);else break;ut=l(V)}}function Ce(rt){if(be=!1,ue(rt),!Se)if(l(A)!==null)Se=!0,Hn(Le);else{var ut=l(V);ut!==null&&Un(Ce,ut.startTime-rt)}}function Le(rt,ut){Se=!1,be&&(be=!1,oe(pe),pe=-1),ke=!0;var wt=N;try{for(ue(ut),j=l(A);j!==null&&(!(j.expirationTime>ut)||rt&&!ot());){var Dt=j.callback;if(typeof Dt=="function"){j.callback=null,N=j.priorityLevel;var Nt=Dt(j.expirationTime<=ut);ut=n.unstable_now(),typeof Nt=="function"?j.callback=Nt:j===l(A)&&p(A),ue(ut)}else p(A);j=l(A)}if(j!==null)var kn=!0;else{var yn=l(V);yn!==null&&Un(Ce,yn.startTime-ut),kn=!1}return kn}finally{j=null,N=wt,ke=!1}}var Xe=!1,Qe=null,pe=-1,dt=5,lt=-1;function ot(){return!(n.unstable_now()-lt<dt)}function Xt(){if(Qe!==null){var rt=n.unstable_now();lt=rt;var ut=!0;try{ut=Qe(!0,rt)}finally{ut?Ot():(Xe=!1,Qe=null)}}else Xe=!1}var Ot;if(typeof re=="function")Ot=function(){re(Xt)};else if(typeof MessageChannel<"u"){var Ft=new MessageChannel,Rn=Ft.port2;Ft.port1.onmessage=Xt,Ot=function(){Rn.postMessage(null)}}else Ot=function(){Ze(Xt,0)};function Hn(rt){Qe=rt,Xe||(Xe=!0,Ot())}function Un(rt,ut){pe=Ze(function(){rt(n.unstable_now())},ut)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(rt){rt.callback=null},n.unstable_continueExecution=function(){Se||ke||(Se=!0,Hn(Le))},n.unstable_forceFrameRate=function(rt){0>rt||125<rt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):dt=0<rt?Math.floor(1e3/rt):5},n.unstable_getCurrentPriorityLevel=function(){return N},n.unstable_getFirstCallbackNode=function(){return l(A)},n.unstable_next=function(rt){switch(N){case 1:case 2:case 3:var ut=3;break;default:ut=N}var wt=N;N=ut;try{return rt()}finally{N=wt}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(rt,ut){switch(rt){case 1:case 2:case 3:case 4:case 5:break;default:rt=3}var wt=N;N=rt;try{return ut()}finally{N=wt}},n.unstable_scheduleCallback=function(rt,ut,wt){var Dt=n.unstable_now();switch(typeof wt=="object"&&wt!==null?(wt=wt.delay,wt=typeof wt=="number"&&0<wt?Dt+wt:Dt):wt=Dt,rt){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=wt+Nt,rt={id:W++,callback:ut,priorityLevel:rt,startTime:wt,expirationTime:Nt,sortIndex:-1},wt>Dt?(rt.sortIndex=wt,i(V,rt),l(A)===null&&rt===l(V)&&(be?(oe(pe),pe=-1):be=!0,Un(Ce,wt-Dt))):(rt.sortIndex=Nt,i(A,rt),Se||ke||(Se=!0,Hn(Le))),rt},n.unstable_shouldYield=ot,n.unstable_wrapCallback=function(rt){var ut=N;return function(){var wt=N;N=ut;try{return rt.apply(this,arguments)}finally{N=wt}}}})(Mx);Px.exports=Mx;var hS=Px.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dS=Ie,zi=hS;function $e(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zx=new Set,rh={};function Xs(n,i){du(n,i),du(n+"Capture",i)}function du(n,i){for(rh[n]=i,n=0;n<i.length;n++)zx.add(i[n])}var ra=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wm=Object.prototype.hasOwnProperty,pS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mv={},zv={};function fS(n){return Wm.call(zv,n)?!0:Wm.call(Mv,n)?!1:pS.test(n)?zv[n]=!0:(Mv[n]=!0,!1)}function mS(n,i,l,p){if(l!==null&&l.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return p?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function gS(n,i,l,p){if(i===null||typeof i>"u"||mS(n,i,l,p))return!0;if(p)return!1;if(l!==null)switch(l.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Kr(n,i,l,p,_,w,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=l,this.propertyName=n,this.type=i,this.sanitizeURL=w,this.removeEmptyString=v}var xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){xr[n]=new Kr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];xr[i]=new Kr(i,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){xr[n]=new Kr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){xr[n]=new Kr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){xr[n]=new Kr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){xr[n]=new Kr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){xr[n]=new Kr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){xr[n]=new Kr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){xr[n]=new Kr(n,5,!1,n.toLowerCase(),null,!1,!1)});var Wg=/[\-:]([a-z])/g;function Xg(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(Wg,Xg);xr[i]=new Kr(i,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(Wg,Xg);xr[i]=new Kr(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(Wg,Xg);xr[i]=new Kr(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){xr[n]=new Kr(n,1,!1,n.toLowerCase(),null,!1,!1)});xr.xlinkHref=new Kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){xr[n]=new Kr(n,1,!1,n.toLowerCase(),null,!0,!0)});function Kg(n,i,l,p){var _=xr.hasOwnProperty(i)?xr[i]:null;(_!==null?_.type!==0:p||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(gS(i,l,_,p)&&(l=null),p||_===null?fS(i)&&(l===null?n.removeAttribute(i):n.setAttribute(i,""+l)):_.mustUseProperty?n[_.propertyName]=l===null?_.type===3?!1:"":l:(i=_.attributeName,p=_.attributeNamespace,l===null?n.removeAttribute(i):(_=_.type,l=_===3||_===4&&l===!0?"":""+l,p?n.setAttributeNS(p,i,l):n.setAttribute(i,l))))}var sa=dS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rd=Symbol.for("react.element"),Gl=Symbol.for("react.portal"),Wl=Symbol.for("react.fragment"),Jg=Symbol.for("react.strict_mode"),Xm=Symbol.for("react.profiler"),Ax=Symbol.for("react.provider"),Dx=Symbol.for("react.context"),Yg=Symbol.for("react.forward_ref"),Km=Symbol.for("react.suspense"),Jm=Symbol.for("react.suspense_list"),Qg=Symbol.for("react.memo"),Aa=Symbol.for("react.lazy"),Lx=Symbol.for("react.offscreen"),Av=Symbol.iterator;function zc(n){return n===null||typeof n!="object"?null:(n=Av&&n[Av]||n["@@iterator"],typeof n=="function"?n:null)}var Ln=Object.assign,ym;function $c(n){if(ym===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);ym=i&&i[1]||""}return`
`+ym+n}var _m=!1;function vm(n,i){if(!n||_m)return"";_m=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(V){var p=V}Reflect.construct(n,[],i)}else{try{i.call()}catch(V){p=V}n.call(i.prototype)}else{try{throw Error()}catch(V){p=V}n()}}catch(V){if(V&&p&&typeof V.stack=="string"){for(var _=V.stack.split(`
`),w=p.stack.split(`
`),v=_.length-1,c=w.length-1;1<=v&&0<=c&&_[v]!==w[c];)c--;for(;1<=v&&0<=c;v--,c--)if(_[v]!==w[c]){if(v!==1||c!==1)do if(v--,c--,0>c||_[v]!==w[c]){var A=`
`+_[v].replace(" at new "," at ");return n.displayName&&A.includes("<anonymous>")&&(A=A.replace("<anonymous>",n.displayName)),A}while(1<=v&&0<=c);break}}}finally{_m=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?$c(n):""}function yS(n){switch(n.tag){case 5:return $c(n.type);case 16:return $c("Lazy");case 13:return $c("Suspense");case 19:return $c("SuspenseList");case 0:case 2:case 15:return n=vm(n.type,!1),n;case 11:return n=vm(n.type.render,!1),n;case 1:return n=vm(n.type,!0),n;default:return""}}function Ym(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Wl:return"Fragment";case Gl:return"Portal";case Xm:return"Profiler";case Jg:return"StrictMode";case Km:return"Suspense";case Jm:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Dx:return(n.displayName||"Context")+".Consumer";case Ax:return(n._context.displayName||"Context")+".Provider";case Yg:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Qg:return i=n.displayName||null,i!==null?i:Ym(n.type)||"Memo";case Aa:i=n._payload,n=n._init;try{return Ym(n(i))}catch{}}return null}function _S(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ym(i);case 8:return i===Jg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ha(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Rx(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function vS(n){var i=Rx(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),p=""+n[i];if(!n.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var _=l.get,w=l.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return _.call(this)},set:function(v){p=""+v,w.call(this,v)}}),Object.defineProperty(n,i,{enumerable:l.enumerable}),{getValue:function(){return p},setValue:function(v){p=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Fd(n){n._valueTracker||(n._valueTracker=vS(n))}function Fx(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var l=i.getValue(),p="";return n&&(p=Rx(n)?n.checked?"true":"false":n.value),n=p,n!==l?(i.setValue(n),!0):!1}function cp(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Qm(n,i){var l=i.checked;return Ln({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function Dv(n,i){var l=i.defaultValue==null?"":i.defaultValue,p=i.checked!=null?i.checked:i.defaultChecked;l=Ha(i.value!=null?i.value:l),n._wrapperState={initialChecked:p,initialValue:l,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Bx(n,i){i=i.checked,i!=null&&Kg(n,"checked",i,!1)}function eg(n,i){Bx(n,i);var l=Ha(i.value),p=i.type;if(l!=null)p==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(p==="submit"||p==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?tg(n,i.type,l):i.hasOwnProperty("defaultValue")&&tg(n,i.type,Ha(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function Lv(n,i,l){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var p=i.type;if(!(p!=="submit"&&p!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,l||i===n.value||(n.value=i),n.defaultValue=i}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function tg(n,i,l){(i!=="number"||cp(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Zc=Array.isArray;function au(n,i,l,p){if(n=n.options,i){i={};for(var _=0;_<l.length;_++)i["$"+l[_]]=!0;for(l=0;l<n.length;l++)_=i.hasOwnProperty("$"+n[l].value),n[l].selected!==_&&(n[l].selected=_),_&&p&&(n[l].defaultSelected=!0)}else{for(l=""+Ha(l),i=null,_=0;_<n.length;_++){if(n[_].value===l){n[_].selected=!0,p&&(n[_].defaultSelected=!0);return}i!==null||n[_].disabled||(i=n[_])}i!==null&&(i.selected=!0)}}function ng(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error($e(91));return Ln({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Rv(n,i){var l=i.value;if(l==null){if(l=i.children,i=i.defaultValue,l!=null){if(i!=null)throw Error($e(92));if(Zc(l)){if(1<l.length)throw Error($e(93));l=l[0]}i=l}i==null&&(i=""),l=i}n._wrapperState={initialValue:Ha(l)}}function Ox(n,i){var l=Ha(i.value),p=Ha(i.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),i.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),p!=null&&(n.defaultValue=""+p)}function Fv(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Nx(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rg(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Nx(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Bd,jx=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,l,p,_){MSApp.execUnsafeLocalFunction(function(){return n(i,l,p,_)})}:n}(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(Bd=Bd||document.createElement("div"),Bd.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Bd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function ih(n,i){if(i){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=i;return}}n.textContent=i}var Wc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xS=["Webkit","ms","Moz","O"];Object.keys(Wc).forEach(function(n){xS.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Wc[i]=Wc[n]})});function Vx(n,i,l){return i==null||typeof i=="boolean"||i===""?"":l||typeof i!="number"||i===0||Wc.hasOwnProperty(n)&&Wc[n]?(""+i).trim():i+"px"}function Ux(n,i){n=n.style;for(var l in i)if(i.hasOwnProperty(l)){var p=l.indexOf("--")===0,_=Vx(l,i[l],p);l==="float"&&(l="cssFloat"),p?n.setProperty(l,_):n[l]=_}}var wS=Ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ig(n,i){if(i){if(wS[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error($e(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error($e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error($e(61))}if(i.style!=null&&typeof i.style!="object")throw Error($e(62))}}function og(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ag=null;function ey(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var sg=null,su=null,lu=null;function Bv(n){if(n=Ch(n)){if(typeof sg!="function")throw Error($e(280));var i=n.stateNode;i&&(i=Up(i),sg(n.stateNode,n.type,i))}}function $x(n){su?lu?lu.push(n):lu=[n]:su=n}function Zx(){if(su){var n=su,i=lu;if(lu=su=null,Bv(n),i)for(n=0;n<i.length;n++)Bv(i[n])}}function qx(n,i){return n(i)}function Hx(){}var xm=!1;function Gx(n,i,l){if(xm)return n(i,l);xm=!0;try{return qx(n,i,l)}finally{xm=!1,(su!==null||lu!==null)&&(Hx(),Zx())}}function oh(n,i){var l=n.stateNode;if(l===null)return null;var p=Up(l);if(p===null)return null;l=p[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error($e(231,i,typeof l));return l}var lg=!1;if(ra)try{var Ac={};Object.defineProperty(Ac,"passive",{get:function(){lg=!0}}),window.addEventListener("test",Ac,Ac),window.removeEventListener("test",Ac,Ac)}catch{lg=!1}function bS(n,i,l,p,_,w,v,c,A){var V=Array.prototype.slice.call(arguments,3);try{i.apply(l,V)}catch(W){this.onError(W)}}var Xc=!1,hp=null,dp=!1,ug=null,SS={onError:function(n){Xc=!0,hp=n}};function TS(n,i,l,p,_,w,v,c,A){Xc=!1,hp=null,bS.apply(SS,arguments)}function ES(n,i,l,p,_,w,v,c,A){if(TS.apply(this,arguments),Xc){if(Xc){var V=hp;Xc=!1,hp=null}else throw Error($e(198));dp||(dp=!0,ug=V)}}function Ks(n){var i=n,l=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,i.flags&4098&&(l=i.return),n=i.return;while(n)}return i.tag===3?l:null}function Wx(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Ov(n){if(Ks(n)!==n)throw Error($e(188))}function CS(n){var i=n.alternate;if(!i){if(i=Ks(n),i===null)throw Error($e(188));return i!==n?null:n}for(var l=n,p=i;;){var _=l.return;if(_===null)break;var w=_.alternate;if(w===null){if(p=_.return,p!==null){l=p;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===l)return Ov(_),n;if(w===p)return Ov(_),i;w=w.sibling}throw Error($e(188))}if(l.return!==p.return)l=_,p=w;else{for(var v=!1,c=_.child;c;){if(c===l){v=!0,l=_,p=w;break}if(c===p){v=!0,p=_,l=w;break}c=c.sibling}if(!v){for(c=w.child;c;){if(c===l){v=!0,l=w,p=_;break}if(c===p){v=!0,p=w,l=_;break}c=c.sibling}if(!v)throw Error($e(189))}}if(l.alternate!==p)throw Error($e(190))}if(l.tag!==3)throw Error($e(188));return l.stateNode.current===l?n:i}function Xx(n){return n=CS(n),n!==null?Kx(n):null}function Kx(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=Kx(n);if(i!==null)return i;n=n.sibling}return null}var Jx=zi.unstable_scheduleCallback,Nv=zi.unstable_cancelCallback,kS=zi.unstable_shouldYield,IS=zi.unstable_requestPaint,qn=zi.unstable_now,PS=zi.unstable_getCurrentPriorityLevel,ty=zi.unstable_ImmediatePriority,Yx=zi.unstable_UserBlockingPriority,pp=zi.unstable_NormalPriority,MS=zi.unstable_LowPriority,Qx=zi.unstable_IdlePriority,Op=null,zo=null;function zS(n){if(zo&&typeof zo.onCommitFiberRoot=="function")try{zo.onCommitFiberRoot(Op,n,void 0,(n.current.flags&128)===128)}catch{}}var uo=Math.clz32?Math.clz32:LS,AS=Math.log,DS=Math.LN2;function LS(n){return n>>>=0,n===0?32:31-(AS(n)/DS|0)|0}var Od=64,Nd=4194304;function qc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function fp(n,i){var l=n.pendingLanes;if(l===0)return 0;var p=0,_=n.suspendedLanes,w=n.pingedLanes,v=l&268435455;if(v!==0){var c=v&~_;c!==0?p=qc(c):(w&=v,w!==0&&(p=qc(w)))}else v=l&~_,v!==0?p=qc(v):w!==0&&(p=qc(w));if(p===0)return 0;if(i!==0&&i!==p&&!(i&_)&&(_=p&-p,w=i&-i,_>=w||_===16&&(w&4194240)!==0))return i;if(p&4&&(p|=l&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=p;0<i;)l=31-uo(i),_=1<<l,p|=n[l],i&=~_;return p}function RS(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FS(n,i){for(var l=n.suspendedLanes,p=n.pingedLanes,_=n.expirationTimes,w=n.pendingLanes;0<w;){var v=31-uo(w),c=1<<v,A=_[v];A===-1?(!(c&l)||c&p)&&(_[v]=RS(c,i)):A<=i&&(n.expiredLanes|=c),w&=~c}}function cg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function e1(){var n=Od;return Od<<=1,!(Od&4194240)&&(Od=64),n}function wm(n){for(var i=[],l=0;31>l;l++)i.push(n);return i}function Th(n,i,l){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-uo(i),n[i]=l}function BS(n,i){var l=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var p=n.eventTimes;for(n=n.expirationTimes;0<l;){var _=31-uo(l),w=1<<_;i[_]=0,p[_]=-1,n[_]=-1,l&=~w}}function ny(n,i){var l=n.entangledLanes|=i;for(n=n.entanglements;l;){var p=31-uo(l),_=1<<p;_&i|n[p]&i&&(n[p]|=i),l&=~_}}var rn=0;function t1(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var n1,ry,r1,i1,o1,hg=!1,jd=[],Oa=null,Na=null,ja=null,ah=new Map,sh=new Map,La=[],OS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jv(n,i){switch(n){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":ah.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":sh.delete(i.pointerId)}}function Dc(n,i,l,p,_,w){return n===null||n.nativeEvent!==w?(n={blockedOn:i,domEventName:l,eventSystemFlags:p,nativeEvent:w,targetContainers:[_]},i!==null&&(i=Ch(i),i!==null&&ry(i)),n):(n.eventSystemFlags|=p,i=n.targetContainers,_!==null&&i.indexOf(_)===-1&&i.push(_),n)}function NS(n,i,l,p,_){switch(i){case"focusin":return Oa=Dc(Oa,n,i,l,p,_),!0;case"dragenter":return Na=Dc(Na,n,i,l,p,_),!0;case"mouseover":return ja=Dc(ja,n,i,l,p,_),!0;case"pointerover":var w=_.pointerId;return ah.set(w,Dc(ah.get(w)||null,n,i,l,p,_)),!0;case"gotpointercapture":return w=_.pointerId,sh.set(w,Dc(sh.get(w)||null,n,i,l,p,_)),!0}return!1}function a1(n){var i=Rs(n.target);if(i!==null){var l=Ks(i);if(l!==null){if(i=l.tag,i===13){if(i=Wx(l),i!==null){n.blockedOn=i,o1(n.priority,function(){r1(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Qd(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var l=dg(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var p=new l.constructor(l.type,l);ag=p,l.target.dispatchEvent(p),ag=null}else return i=Ch(l),i!==null&&ry(i),n.blockedOn=l,!1;i.shift()}return!0}function Vv(n,i,l){Qd(n)&&l.delete(i)}function jS(){hg=!1,Oa!==null&&Qd(Oa)&&(Oa=null),Na!==null&&Qd(Na)&&(Na=null),ja!==null&&Qd(ja)&&(ja=null),ah.forEach(Vv),sh.forEach(Vv)}function Lc(n,i){n.blockedOn===i&&(n.blockedOn=null,hg||(hg=!0,zi.unstable_scheduleCallback(zi.unstable_NormalPriority,jS)))}function lh(n){function i(_){return Lc(_,n)}if(0<jd.length){Lc(jd[0],n);for(var l=1;l<jd.length;l++){var p=jd[l];p.blockedOn===n&&(p.blockedOn=null)}}for(Oa!==null&&Lc(Oa,n),Na!==null&&Lc(Na,n),ja!==null&&Lc(ja,n),ah.forEach(i),sh.forEach(i),l=0;l<La.length;l++)p=La[l],p.blockedOn===n&&(p.blockedOn=null);for(;0<La.length&&(l=La[0],l.blockedOn===null);)a1(l),l.blockedOn===null&&La.shift()}var uu=sa.ReactCurrentBatchConfig,mp=!0;function VS(n,i,l,p){var _=rn,w=uu.transition;uu.transition=null;try{rn=1,iy(n,i,l,p)}finally{rn=_,uu.transition=w}}function US(n,i,l,p){var _=rn,w=uu.transition;uu.transition=null;try{rn=4,iy(n,i,l,p)}finally{rn=_,uu.transition=w}}function iy(n,i,l,p){if(mp){var _=dg(n,i,l,p);if(_===null)zm(n,i,p,gp,l),jv(n,p);else if(NS(_,n,i,l,p))p.stopPropagation();else if(jv(n,p),i&4&&-1<OS.indexOf(n)){for(;_!==null;){var w=Ch(_);if(w!==null&&n1(w),w=dg(n,i,l,p),w===null&&zm(n,i,p,gp,l),w===_)break;_=w}_!==null&&p.stopPropagation()}else zm(n,i,p,null,l)}}var gp=null;function dg(n,i,l,p){if(gp=null,n=ey(p),n=Rs(n),n!==null)if(i=Ks(n),i===null)n=null;else if(l=i.tag,l===13){if(n=Wx(i),n!==null)return n;n=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return gp=n,null}function s1(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PS()){case ty:return 1;case Yx:return 4;case pp:case MS:return 16;case Qx:return 536870912;default:return 16}default:return 16}}var Fa=null,oy=null,ep=null;function l1(){if(ep)return ep;var n,i=oy,l=i.length,p,_="value"in Fa?Fa.value:Fa.textContent,w=_.length;for(n=0;n<l&&i[n]===_[n];n++);var v=l-n;for(p=1;p<=v&&i[l-p]===_[w-p];p++);return ep=_.slice(n,1<p?1-p:void 0)}function tp(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Vd(){return!0}function Uv(){return!1}function Di(n){function i(l,p,_,w,v){this._reactName=l,this._targetInst=_,this.type=p,this.nativeEvent=w,this.target=v,this.currentTarget=null;for(var c in n)n.hasOwnProperty(c)&&(l=n[c],this[c]=l?l(w):w[c]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Vd:Uv,this.isPropagationStopped=Uv,this}return Ln(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Vd)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Vd)},persist:function(){},isPersistent:Vd}),i}var wu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ay=Di(wu),Eh=Ln({},wu,{view:0,detail:0}),$S=Di(Eh),bm,Sm,Rc,Np=Ln({},Eh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sy,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rc&&(Rc&&n.type==="mousemove"?(bm=n.screenX-Rc.screenX,Sm=n.screenY-Rc.screenY):Sm=bm=0,Rc=n),bm)},movementY:function(n){return"movementY"in n?n.movementY:Sm}}),$v=Di(Np),ZS=Ln({},Np,{dataTransfer:0}),qS=Di(ZS),HS=Ln({},Eh,{relatedTarget:0}),Tm=Di(HS),GS=Ln({},wu,{animationName:0,elapsedTime:0,pseudoElement:0}),WS=Di(GS),XS=Ln({},wu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),KS=Di(XS),JS=Ln({},wu,{data:0}),Zv=Di(JS),YS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tT(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=eT[n])?!!i[n]:!1}function sy(){return tT}var nT=Ln({},Eh,{key:function(n){if(n.key){var i=YS[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=tp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?QS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sy,charCode:function(n){return n.type==="keypress"?tp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?tp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),rT=Di(nT),iT=Ln({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qv=Di(iT),oT=Ln({},Eh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sy}),aT=Di(oT),sT=Ln({},wu,{propertyName:0,elapsedTime:0,pseudoElement:0}),lT=Di(sT),uT=Ln({},Np,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),cT=Di(uT),hT=[9,13,27,32],ly=ra&&"CompositionEvent"in window,Kc=null;ra&&"documentMode"in document&&(Kc=document.documentMode);var dT=ra&&"TextEvent"in window&&!Kc,u1=ra&&(!ly||Kc&&8<Kc&&11>=Kc),Hv=" ",Gv=!1;function c1(n,i){switch(n){case"keyup":return hT.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xl=!1;function pT(n,i){switch(n){case"compositionend":return h1(i);case"keypress":return i.which!==32?null:(Gv=!0,Hv);case"textInput":return n=i.data,n===Hv&&Gv?null:n;default:return null}}function fT(n,i){if(Xl)return n==="compositionend"||!ly&&c1(n,i)?(n=l1(),ep=oy=Fa=null,Xl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return u1&&i.locale!=="ko"?null:i.data;default:return null}}var mT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wv(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!mT[n.type]:i==="textarea"}function d1(n,i,l,p){$x(p),i=yp(i,"onChange"),0<i.length&&(l=new ay("onChange","change",null,l,p),n.push({event:l,listeners:i}))}var Jc=null,uh=null;function gT(n){S1(n,0)}function jp(n){var i=Yl(n);if(Fx(i))return n}function yT(n,i){if(n==="change")return i}var p1=!1;if(ra){var Em;if(ra){var Cm="oninput"in document;if(!Cm){var Xv=document.createElement("div");Xv.setAttribute("oninput","return;"),Cm=typeof Xv.oninput=="function"}Em=Cm}else Em=!1;p1=Em&&(!document.documentMode||9<document.documentMode)}function Kv(){Jc&&(Jc.detachEvent("onpropertychange",f1),uh=Jc=null)}function f1(n){if(n.propertyName==="value"&&jp(uh)){var i=[];d1(i,uh,n,ey(n)),Gx(gT,i)}}function _T(n,i,l){n==="focusin"?(Kv(),Jc=i,uh=l,Jc.attachEvent("onpropertychange",f1)):n==="focusout"&&Kv()}function vT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return jp(uh)}function xT(n,i){if(n==="click")return jp(i)}function wT(n,i){if(n==="input"||n==="change")return jp(i)}function bT(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var ho=typeof Object.is=="function"?Object.is:bT;function ch(n,i){if(ho(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var l=Object.keys(n),p=Object.keys(i);if(l.length!==p.length)return!1;for(p=0;p<l.length;p++){var _=l[p];if(!Wm.call(i,_)||!ho(n[_],i[_]))return!1}return!0}function Jv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Yv(n,i){var l=Jv(n);n=0;for(var p;l;){if(l.nodeType===3){if(p=n+l.textContent.length,n<=i&&p>=i)return{node:l,offset:i-n};n=p}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Jv(l)}}function m1(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?m1(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function g1(){for(var n=window,i=cp();i instanceof n.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)n=i.contentWindow;else break;i=cp(n.document)}return i}function uy(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function ST(n){var i=g1(),l=n.focusedElem,p=n.selectionRange;if(i!==l&&l&&l.ownerDocument&&m1(l.ownerDocument.documentElement,l)){if(p!==null&&uy(l)){if(i=p.start,n=p.end,n===void 0&&(n=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(n,l.value.length);else if(n=(i=l.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var _=l.textContent.length,w=Math.min(p.start,_);p=p.end===void 0?w:Math.min(p.end,_),!n.extend&&w>p&&(_=p,p=w,w=_),_=Yv(l,w);var v=Yv(l,p);_&&v&&(n.rangeCount!==1||n.anchorNode!==_.node||n.anchorOffset!==_.offset||n.focusNode!==v.node||n.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(_.node,_.offset),n.removeAllRanges(),w>p?(n.addRange(i),n.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),n.addRange(i)))}}for(i=[],n=l;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)n=i[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var TT=ra&&"documentMode"in document&&11>=document.documentMode,Kl=null,pg=null,Yc=null,fg=!1;function Qv(n,i,l){var p=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;fg||Kl==null||Kl!==cp(p)||(p=Kl,"selectionStart"in p&&uy(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Yc&&ch(Yc,p)||(Yc=p,p=yp(pg,"onSelect"),0<p.length&&(i=new ay("onSelect","select",null,i,l),n.push({event:i,listeners:p}),i.target=Kl)))}function Ud(n,i){var l={};return l[n.toLowerCase()]=i.toLowerCase(),l["Webkit"+n]="webkit"+i,l["Moz"+n]="moz"+i,l}var Jl={animationend:Ud("Animation","AnimationEnd"),animationiteration:Ud("Animation","AnimationIteration"),animationstart:Ud("Animation","AnimationStart"),transitionend:Ud("Transition","TransitionEnd")},km={},y1={};ra&&(y1=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function Vp(n){if(km[n])return km[n];if(!Jl[n])return n;var i=Jl[n],l;for(l in i)if(i.hasOwnProperty(l)&&l in y1)return km[n]=i[l];return n}var _1=Vp("animationend"),v1=Vp("animationiteration"),x1=Vp("animationstart"),w1=Vp("transitionend"),b1=new Map,e0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wa(n,i){b1.set(n,i),Xs(i,[n])}for(var Im=0;Im<e0.length;Im++){var Pm=e0[Im],ET=Pm.toLowerCase(),CT=Pm[0].toUpperCase()+Pm.slice(1);Wa(ET,"on"+CT)}Wa(_1,"onAnimationEnd");Wa(v1,"onAnimationIteration");Wa(x1,"onAnimationStart");Wa("dblclick","onDoubleClick");Wa("focusin","onFocus");Wa("focusout","onBlur");Wa(w1,"onTransitionEnd");du("onMouseEnter",["mouseout","mouseover"]);du("onMouseLeave",["mouseout","mouseover"]);du("onPointerEnter",["pointerout","pointerover"]);du("onPointerLeave",["pointerout","pointerover"]);Xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hc));function t0(n,i,l){var p=n.type||"unknown-event";n.currentTarget=l,ES(p,i,void 0,n),n.currentTarget=null}function S1(n,i){i=(i&4)!==0;for(var l=0;l<n.length;l++){var p=n[l],_=p.event;p=p.listeners;e:{var w=void 0;if(i)for(var v=p.length-1;0<=v;v--){var c=p[v],A=c.instance,V=c.currentTarget;if(c=c.listener,A!==w&&_.isPropagationStopped())break e;t0(_,c,V),w=A}else for(v=0;v<p.length;v++){if(c=p[v],A=c.instance,V=c.currentTarget,c=c.listener,A!==w&&_.isPropagationStopped())break e;t0(_,c,V),w=A}}}if(dp)throw n=ug,dp=!1,ug=null,n}function bn(n,i){var l=i[vg];l===void 0&&(l=i[vg]=new Set);var p=n+"__bubble";l.has(p)||(T1(i,n,2,!1),l.add(p))}function Mm(n,i,l){var p=0;i&&(p|=4),T1(l,n,p,i)}var $d="_reactListening"+Math.random().toString(36).slice(2);function hh(n){if(!n[$d]){n[$d]=!0,zx.forEach(function(l){l!=="selectionchange"&&(kT.has(l)||Mm(l,!1,n),Mm(l,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[$d]||(i[$d]=!0,Mm("selectionchange",!1,i))}}function T1(n,i,l,p){switch(s1(i)){case 1:var _=VS;break;case 4:_=US;break;default:_=iy}l=_.bind(null,i,l,n),_=void 0,!lg||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(_=!0),p?_!==void 0?n.addEventListener(i,l,{capture:!0,passive:_}):n.addEventListener(i,l,!0):_!==void 0?n.addEventListener(i,l,{passive:_}):n.addEventListener(i,l,!1)}function zm(n,i,l,p,_){var w=p;if(!(i&1)&&!(i&2)&&p!==null)e:for(;;){if(p===null)return;var v=p.tag;if(v===3||v===4){var c=p.stateNode.containerInfo;if(c===_||c.nodeType===8&&c.parentNode===_)break;if(v===4)for(v=p.return;v!==null;){var A=v.tag;if((A===3||A===4)&&(A=v.stateNode.containerInfo,A===_||A.nodeType===8&&A.parentNode===_))return;v=v.return}for(;c!==null;){if(v=Rs(c),v===null)return;if(A=v.tag,A===5||A===6){p=w=v;continue e}c=c.parentNode}}p=p.return}Gx(function(){var V=w,W=ey(l),j=[];e:{var N=b1.get(n);if(N!==void 0){var ke=ay,Se=n;switch(n){case"keypress":if(tp(l)===0)break e;case"keydown":case"keyup":ke=rT;break;case"focusin":Se="focus",ke=Tm;break;case"focusout":Se="blur",ke=Tm;break;case"beforeblur":case"afterblur":ke=Tm;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=$v;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=qS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=aT;break;case _1:case v1:case x1:ke=WS;break;case w1:ke=lT;break;case"scroll":ke=$S;break;case"wheel":ke=cT;break;case"copy":case"cut":case"paste":ke=KS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=qv}var be=(i&4)!==0,Ze=!be&&n==="scroll",oe=be?N!==null?N+"Capture":null:N;be=[];for(var re=V,ue;re!==null;){ue=re;var Ce=ue.stateNode;if(ue.tag===5&&Ce!==null&&(ue=Ce,oe!==null&&(Ce=oh(re,oe),Ce!=null&&be.push(dh(re,Ce,ue)))),Ze)break;re=re.return}0<be.length&&(N=new ke(N,Se,null,l,W),j.push({event:N,listeners:be}))}}if(!(i&7)){e:{if(N=n==="mouseover"||n==="pointerover",ke=n==="mouseout"||n==="pointerout",N&&l!==ag&&(Se=l.relatedTarget||l.fromElement)&&(Rs(Se)||Se[ia]))break e;if((ke||N)&&(N=W.window===W?W:(N=W.ownerDocument)?N.defaultView||N.parentWindow:window,ke?(Se=l.relatedTarget||l.toElement,ke=V,Se=Se?Rs(Se):null,Se!==null&&(Ze=Ks(Se),Se!==Ze||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(ke=null,Se=V),ke!==Se)){if(be=$v,Ce="onMouseLeave",oe="onMouseEnter",re="mouse",(n==="pointerout"||n==="pointerover")&&(be=qv,Ce="onPointerLeave",oe="onPointerEnter",re="pointer"),Ze=ke==null?N:Yl(ke),ue=Se==null?N:Yl(Se),N=new be(Ce,re+"leave",ke,l,W),N.target=Ze,N.relatedTarget=ue,Ce=null,Rs(W)===V&&(be=new be(oe,re+"enter",Se,l,W),be.target=ue,be.relatedTarget=Ze,Ce=be),Ze=Ce,ke&&Se)t:{for(be=ke,oe=Se,re=0,ue=be;ue;ue=Zl(ue))re++;for(ue=0,Ce=oe;Ce;Ce=Zl(Ce))ue++;for(;0<re-ue;)be=Zl(be),re--;for(;0<ue-re;)oe=Zl(oe),ue--;for(;re--;){if(be===oe||oe!==null&&be===oe.alternate)break t;be=Zl(be),oe=Zl(oe)}be=null}else be=null;ke!==null&&n0(j,N,ke,be,!1),Se!==null&&Ze!==null&&n0(j,Ze,Se,be,!0)}}e:{if(N=V?Yl(V):window,ke=N.nodeName&&N.nodeName.toLowerCase(),ke==="select"||ke==="input"&&N.type==="file")var Le=yT;else if(Wv(N))if(p1)Le=wT;else{Le=vT;var Xe=_T}else(ke=N.nodeName)&&ke.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(Le=xT);if(Le&&(Le=Le(n,V))){d1(j,Le,l,W);break e}Xe&&Xe(n,N,V),n==="focusout"&&(Xe=N._wrapperState)&&Xe.controlled&&N.type==="number"&&tg(N,"number",N.value)}switch(Xe=V?Yl(V):window,n){case"focusin":(Wv(Xe)||Xe.contentEditable==="true")&&(Kl=Xe,pg=V,Yc=null);break;case"focusout":Yc=pg=Kl=null;break;case"mousedown":fg=!0;break;case"contextmenu":case"mouseup":case"dragend":fg=!1,Qv(j,l,W);break;case"selectionchange":if(TT)break;case"keydown":case"keyup":Qv(j,l,W)}var Qe;if(ly)e:{switch(n){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else Xl?c1(n,l)&&(pe="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(pe="onCompositionStart");pe&&(u1&&l.locale!=="ko"&&(Xl||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&Xl&&(Qe=l1()):(Fa=W,oy="value"in Fa?Fa.value:Fa.textContent,Xl=!0)),Xe=yp(V,pe),0<Xe.length&&(pe=new Zv(pe,n,null,l,W),j.push({event:pe,listeners:Xe}),Qe?pe.data=Qe:(Qe=h1(l),Qe!==null&&(pe.data=Qe)))),(Qe=dT?pT(n,l):fT(n,l))&&(V=yp(V,"onBeforeInput"),0<V.length&&(W=new Zv("onBeforeInput","beforeinput",null,l,W),j.push({event:W,listeners:V}),W.data=Qe))}S1(j,i)})}function dh(n,i,l){return{instance:n,listener:i,currentTarget:l}}function yp(n,i){for(var l=i+"Capture",p=[];n!==null;){var _=n,w=_.stateNode;_.tag===5&&w!==null&&(_=w,w=oh(n,l),w!=null&&p.unshift(dh(n,w,_)),w=oh(n,i),w!=null&&p.push(dh(n,w,_))),n=n.return}return p}function Zl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function n0(n,i,l,p,_){for(var w=i._reactName,v=[];l!==null&&l!==p;){var c=l,A=c.alternate,V=c.stateNode;if(A!==null&&A===p)break;c.tag===5&&V!==null&&(c=V,_?(A=oh(l,w),A!=null&&v.unshift(dh(l,A,c))):_||(A=oh(l,w),A!=null&&v.push(dh(l,A,c)))),l=l.return}v.length!==0&&n.push({event:i,listeners:v})}var IT=/\r\n?/g,PT=/\u0000|\uFFFD/g;function r0(n){return(typeof n=="string"?n:""+n).replace(IT,`
`).replace(PT,"")}function Zd(n,i,l){if(i=r0(i),r0(n)!==i&&l)throw Error($e(425))}function _p(){}var mg=null,gg=null;function yg(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var _g=typeof setTimeout=="function"?setTimeout:void 0,MT=typeof clearTimeout=="function"?clearTimeout:void 0,i0=typeof Promise=="function"?Promise:void 0,zT=typeof queueMicrotask=="function"?queueMicrotask:typeof i0<"u"?function(n){return i0.resolve(null).then(n).catch(AT)}:_g;function AT(n){setTimeout(function(){throw n})}function Am(n,i){var l=i,p=0;do{var _=l.nextSibling;if(n.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(p===0){n.removeChild(_),lh(i);return}p--}else l!=="$"&&l!=="$?"&&l!=="$!"||p++;l=_}while(l);lh(i)}function Va(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function o0(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return n;i--}else l==="/$"&&i++}n=n.previousSibling}return null}var bu=Math.random().toString(36).slice(2),Mo="__reactFiber$"+bu,ph="__reactProps$"+bu,ia="__reactContainer$"+bu,vg="__reactEvents$"+bu,DT="__reactListeners$"+bu,LT="__reactHandles$"+bu;function Rs(n){var i=n[Mo];if(i)return i;for(var l=n.parentNode;l;){if(i=l[ia]||l[Mo]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(n=o0(n);n!==null;){if(l=n[Mo])return l;n=o0(n)}return i}n=l,l=n.parentNode}return null}function Ch(n){return n=n[Mo]||n[ia],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Yl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error($e(33))}function Up(n){return n[ph]||null}var xg=[],Ql=-1;function Xa(n){return{current:n}}function Sn(n){0>Ql||(n.current=xg[Ql],xg[Ql]=null,Ql--)}function gn(n,i){Ql++,xg[Ql]=n.current,n.current=i}var Ga={},Lr=Xa(Ga),oi=Xa(!1),Us=Ga;function pu(n,i){var l=n.type.contextTypes;if(!l)return Ga;var p=n.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===i)return p.__reactInternalMemoizedMaskedChildContext;var _={},w;for(w in l)_[w]=i[w];return p&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=_),_}function ai(n){return n=n.childContextTypes,n!=null}function vp(){Sn(oi),Sn(Lr)}function a0(n,i,l){if(Lr.current!==Ga)throw Error($e(168));gn(Lr,i),gn(oi,l)}function E1(n,i,l){var p=n.stateNode;if(i=i.childContextTypes,typeof p.getChildContext!="function")return l;p=p.getChildContext();for(var _ in p)if(!(_ in i))throw Error($e(108,_S(n)||"Unknown",_));return Ln({},l,p)}function xp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ga,Us=Lr.current,gn(Lr,n),gn(oi,oi.current),!0}function s0(n,i,l){var p=n.stateNode;if(!p)throw Error($e(169));l?(n=E1(n,i,Us),p.__reactInternalMemoizedMergedChildContext=n,Sn(oi),Sn(Lr),gn(Lr,n)):Sn(oi),gn(oi,l)}var Jo=null,$p=!1,Dm=!1;function C1(n){Jo===null?Jo=[n]:Jo.push(n)}function RT(n){$p=!0,C1(n)}function Ka(){if(!Dm&&Jo!==null){Dm=!0;var n=0,i=rn;try{var l=Jo;for(rn=1;n<l.length;n++){var p=l[n];do p=p(!0);while(p!==null)}Jo=null,$p=!1}catch(_){throw Jo!==null&&(Jo=Jo.slice(n+1)),Jx(ty,Ka),_}finally{rn=i,Dm=!1}}return null}var eu=[],tu=0,wp=null,bp=0,$i=[],Zi=0,$s=null,Qo=1,ea="";function As(n,i){eu[tu++]=bp,eu[tu++]=wp,wp=n,bp=i}function k1(n,i,l){$i[Zi++]=Qo,$i[Zi++]=ea,$i[Zi++]=$s,$s=n;var p=Qo;n=ea;var _=32-uo(p)-1;p&=~(1<<_),l+=1;var w=32-uo(i)+_;if(30<w){var v=_-_%5;w=(p&(1<<v)-1).toString(32),p>>=v,_-=v,Qo=1<<32-uo(i)+_|l<<_|p,ea=w+n}else Qo=1<<w|l<<_|p,ea=n}function cy(n){n.return!==null&&(As(n,1),k1(n,1,0))}function hy(n){for(;n===wp;)wp=eu[--tu],eu[tu]=null,bp=eu[--tu],eu[tu]=null;for(;n===$s;)$s=$i[--Zi],$i[Zi]=null,ea=$i[--Zi],$i[Zi]=null,Qo=$i[--Zi],$i[Zi]=null}var Mi=null,Pi=null,Cn=!1,lo=null;function I1(n,i){var l=qi(5,null,null,0);l.elementType="DELETED",l.stateNode=i,l.return=n,i=n.deletions,i===null?(n.deletions=[l],n.flags|=16):i.push(l)}function l0(n,i){switch(n.tag){case 5:var l=n.type;return i=i.nodeType!==1||l.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,Mi=n,Pi=Va(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,Mi=n,Pi=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(l=$s!==null?{id:Qo,overflow:ea}:null,n.memoizedState={dehydrated:i,treeContext:l,retryLane:1073741824},l=qi(18,null,null,0),l.stateNode=i,l.return=n,n.child=l,Mi=n,Pi=null,!0):!1;default:return!1}}function wg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function bg(n){if(Cn){var i=Pi;if(i){var l=i;if(!l0(n,i)){if(wg(n))throw Error($e(418));i=Va(l.nextSibling);var p=Mi;i&&l0(n,i)?I1(p,l):(n.flags=n.flags&-4097|2,Cn=!1,Mi=n)}}else{if(wg(n))throw Error($e(418));n.flags=n.flags&-4097|2,Cn=!1,Mi=n}}}function u0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Mi=n}function qd(n){if(n!==Mi)return!1;if(!Cn)return u0(n),Cn=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!yg(n.type,n.memoizedProps)),i&&(i=Pi)){if(wg(n))throw P1(),Error($e(418));for(;i;)I1(n,i),i=Va(i.nextSibling)}if(u0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error($e(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(i===0){Pi=Va(n.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++}n=n.nextSibling}Pi=null}}else Pi=Mi?Va(n.stateNode.nextSibling):null;return!0}function P1(){for(var n=Pi;n;)n=Va(n.nextSibling)}function fu(){Pi=Mi=null,Cn=!1}function dy(n){lo===null?lo=[n]:lo.push(n)}var FT=sa.ReactCurrentBatchConfig;function Fc(n,i,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error($e(309));var p=l.stateNode}if(!p)throw Error($e(147,n));var _=p,w=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===w?i.ref:(i=function(v){var c=_.refs;v===null?delete c[w]:c[w]=v},i._stringRef=w,i)}if(typeof n!="string")throw Error($e(284));if(!l._owner)throw Error($e(290,n))}return n}function Hd(n,i){throw n=Object.prototype.toString.call(i),Error($e(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function c0(n){var i=n._init;return i(n._payload)}function M1(n){function i(oe,re){if(n){var ue=oe.deletions;ue===null?(oe.deletions=[re],oe.flags|=16):ue.push(re)}}function l(oe,re){if(!n)return null;for(;re!==null;)i(oe,re),re=re.sibling;return null}function p(oe,re){for(oe=new Map;re!==null;)re.key!==null?oe.set(re.key,re):oe.set(re.index,re),re=re.sibling;return oe}function _(oe,re){return oe=qa(oe,re),oe.index=0,oe.sibling=null,oe}function w(oe,re,ue){return oe.index=ue,n?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<re?(oe.flags|=2,re):ue):(oe.flags|=2,re)):(oe.flags|=1048576,re)}function v(oe){return n&&oe.alternate===null&&(oe.flags|=2),oe}function c(oe,re,ue,Ce){return re===null||re.tag!==6?(re=jm(ue,oe.mode,Ce),re.return=oe,re):(re=_(re,ue),re.return=oe,re)}function A(oe,re,ue,Ce){var Le=ue.type;return Le===Wl?W(oe,re,ue.props.children,Ce,ue.key):re!==null&&(re.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Aa&&c0(Le)===re.type)?(Ce=_(re,ue.props),Ce.ref=Fc(oe,re,ue),Ce.return=oe,Ce):(Ce=lp(ue.type,ue.key,ue.props,null,oe.mode,Ce),Ce.ref=Fc(oe,re,ue),Ce.return=oe,Ce)}function V(oe,re,ue,Ce){return re===null||re.tag!==4||re.stateNode.containerInfo!==ue.containerInfo||re.stateNode.implementation!==ue.implementation?(re=Vm(ue,oe.mode,Ce),re.return=oe,re):(re=_(re,ue.children||[]),re.return=oe,re)}function W(oe,re,ue,Ce,Le){return re===null||re.tag!==7?(re=Vs(ue,oe.mode,Ce,Le),re.return=oe,re):(re=_(re,ue),re.return=oe,re)}function j(oe,re,ue){if(typeof re=="string"&&re!==""||typeof re=="number")return re=jm(""+re,oe.mode,ue),re.return=oe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Rd:return ue=lp(re.type,re.key,re.props,null,oe.mode,ue),ue.ref=Fc(oe,null,re),ue.return=oe,ue;case Gl:return re=Vm(re,oe.mode,ue),re.return=oe,re;case Aa:var Ce=re._init;return j(oe,Ce(re._payload),ue)}if(Zc(re)||zc(re))return re=Vs(re,oe.mode,ue,null),re.return=oe,re;Hd(oe,re)}return null}function N(oe,re,ue,Ce){var Le=re!==null?re.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Le!==null?null:c(oe,re,""+ue,Ce);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case Rd:return ue.key===Le?A(oe,re,ue,Ce):null;case Gl:return ue.key===Le?V(oe,re,ue,Ce):null;case Aa:return Le=ue._init,N(oe,re,Le(ue._payload),Ce)}if(Zc(ue)||zc(ue))return Le!==null?null:W(oe,re,ue,Ce,null);Hd(oe,ue)}return null}function ke(oe,re,ue,Ce,Le){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return oe=oe.get(ue)||null,c(re,oe,""+Ce,Le);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case Rd:return oe=oe.get(Ce.key===null?ue:Ce.key)||null,A(re,oe,Ce,Le);case Gl:return oe=oe.get(Ce.key===null?ue:Ce.key)||null,V(re,oe,Ce,Le);case Aa:var Xe=Ce._init;return ke(oe,re,ue,Xe(Ce._payload),Le)}if(Zc(Ce)||zc(Ce))return oe=oe.get(ue)||null,W(re,oe,Ce,Le,null);Hd(re,Ce)}return null}function Se(oe,re,ue,Ce){for(var Le=null,Xe=null,Qe=re,pe=re=0,dt=null;Qe!==null&&pe<ue.length;pe++){Qe.index>pe?(dt=Qe,Qe=null):dt=Qe.sibling;var lt=N(oe,Qe,ue[pe],Ce);if(lt===null){Qe===null&&(Qe=dt);break}n&&Qe&&lt.alternate===null&&i(oe,Qe),re=w(lt,re,pe),Xe===null?Le=lt:Xe.sibling=lt,Xe=lt,Qe=dt}if(pe===ue.length)return l(oe,Qe),Cn&&As(oe,pe),Le;if(Qe===null){for(;pe<ue.length;pe++)Qe=j(oe,ue[pe],Ce),Qe!==null&&(re=w(Qe,re,pe),Xe===null?Le=Qe:Xe.sibling=Qe,Xe=Qe);return Cn&&As(oe,pe),Le}for(Qe=p(oe,Qe);pe<ue.length;pe++)dt=ke(Qe,oe,pe,ue[pe],Ce),dt!==null&&(n&&dt.alternate!==null&&Qe.delete(dt.key===null?pe:dt.key),re=w(dt,re,pe),Xe===null?Le=dt:Xe.sibling=dt,Xe=dt);return n&&Qe.forEach(function(ot){return i(oe,ot)}),Cn&&As(oe,pe),Le}function be(oe,re,ue,Ce){var Le=zc(ue);if(typeof Le!="function")throw Error($e(150));if(ue=Le.call(ue),ue==null)throw Error($e(151));for(var Xe=Le=null,Qe=re,pe=re=0,dt=null,lt=ue.next();Qe!==null&&!lt.done;pe++,lt=ue.next()){Qe.index>pe?(dt=Qe,Qe=null):dt=Qe.sibling;var ot=N(oe,Qe,lt.value,Ce);if(ot===null){Qe===null&&(Qe=dt);break}n&&Qe&&ot.alternate===null&&i(oe,Qe),re=w(ot,re,pe),Xe===null?Le=ot:Xe.sibling=ot,Xe=ot,Qe=dt}if(lt.done)return l(oe,Qe),Cn&&As(oe,pe),Le;if(Qe===null){for(;!lt.done;pe++,lt=ue.next())lt=j(oe,lt.value,Ce),lt!==null&&(re=w(lt,re,pe),Xe===null?Le=lt:Xe.sibling=lt,Xe=lt);return Cn&&As(oe,pe),Le}for(Qe=p(oe,Qe);!lt.done;pe++,lt=ue.next())lt=ke(Qe,oe,pe,lt.value,Ce),lt!==null&&(n&&lt.alternate!==null&&Qe.delete(lt.key===null?pe:lt.key),re=w(lt,re,pe),Xe===null?Le=lt:Xe.sibling=lt,Xe=lt);return n&&Qe.forEach(function(Xt){return i(oe,Xt)}),Cn&&As(oe,pe),Le}function Ze(oe,re,ue,Ce){if(typeof ue=="object"&&ue!==null&&ue.type===Wl&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case Rd:e:{for(var Le=ue.key,Xe=re;Xe!==null;){if(Xe.key===Le){if(Le=ue.type,Le===Wl){if(Xe.tag===7){l(oe,Xe.sibling),re=_(Xe,ue.props.children),re.return=oe,oe=re;break e}}else if(Xe.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Aa&&c0(Le)===Xe.type){l(oe,Xe.sibling),re=_(Xe,ue.props),re.ref=Fc(oe,Xe,ue),re.return=oe,oe=re;break e}l(oe,Xe);break}else i(oe,Xe);Xe=Xe.sibling}ue.type===Wl?(re=Vs(ue.props.children,oe.mode,Ce,ue.key),re.return=oe,oe=re):(Ce=lp(ue.type,ue.key,ue.props,null,oe.mode,Ce),Ce.ref=Fc(oe,re,ue),Ce.return=oe,oe=Ce)}return v(oe);case Gl:e:{for(Xe=ue.key;re!==null;){if(re.key===Xe)if(re.tag===4&&re.stateNode.containerInfo===ue.containerInfo&&re.stateNode.implementation===ue.implementation){l(oe,re.sibling),re=_(re,ue.children||[]),re.return=oe,oe=re;break e}else{l(oe,re);break}else i(oe,re);re=re.sibling}re=Vm(ue,oe.mode,Ce),re.return=oe,oe=re}return v(oe);case Aa:return Xe=ue._init,Ze(oe,re,Xe(ue._payload),Ce)}if(Zc(ue))return Se(oe,re,ue,Ce);if(zc(ue))return be(oe,re,ue,Ce);Hd(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,re!==null&&re.tag===6?(l(oe,re.sibling),re=_(re,ue),re.return=oe,oe=re):(l(oe,re),re=jm(ue,oe.mode,Ce),re.return=oe,oe=re),v(oe)):l(oe,re)}return Ze}var mu=M1(!0),z1=M1(!1),Sp=Xa(null),Tp=null,nu=null,py=null;function fy(){py=nu=Tp=null}function my(n){var i=Sp.current;Sn(Sp),n._currentValue=i}function Sg(n,i,l){for(;n!==null;){var p=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),n===l)break;n=n.return}}function cu(n,i){Tp=n,py=nu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&i&&(ii=!0),n.firstContext=null)}function Gi(n){var i=n._currentValue;if(py!==n)if(n={context:n,memoizedValue:i,next:null},nu===null){if(Tp===null)throw Error($e(308));nu=n,Tp.dependencies={lanes:0,firstContext:n}}else nu=nu.next=n;return i}var Fs=null;function gy(n){Fs===null?Fs=[n]:Fs.push(n)}function A1(n,i,l,p){var _=i.interleaved;return _===null?(l.next=l,gy(i)):(l.next=_.next,_.next=l),i.interleaved=l,oa(n,p)}function oa(n,i){n.lanes|=i;var l=n.alternate;for(l!==null&&(l.lanes|=i),l=n,n=n.return;n!==null;)n.childLanes|=i,l=n.alternate,l!==null&&(l.childLanes|=i),l=n,n=n.return;return l.tag===3?l.stateNode:null}var Da=!1;function yy(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D1(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ta(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function Ua(n,i,l){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,Wt&2){var _=p.pending;return _===null?i.next=i:(i.next=_.next,_.next=i),p.pending=i,oa(n,l)}return _=p.interleaved,_===null?(i.next=i,gy(p)):(i.next=_.next,_.next=i),p.interleaved=i,oa(n,l)}function np(n,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194240)!==0)){var p=i.lanes;p&=n.pendingLanes,l|=p,i.lanes=l,ny(n,l)}}function h0(n,i){var l=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,l===p)){var _=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var v={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};w===null?_=w=v:w=w.next=v,l=l.next}while(l!==null);w===null?_=w=i:w=w.next=i}else _=w=i;l={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:p.shared,effects:p.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=i:n.next=i,l.lastBaseUpdate=i}function Ep(n,i,l,p){var _=n.updateQueue;Da=!1;var w=_.firstBaseUpdate,v=_.lastBaseUpdate,c=_.shared.pending;if(c!==null){_.shared.pending=null;var A=c,V=A.next;A.next=null,v===null?w=V:v.next=V,v=A;var W=n.alternate;W!==null&&(W=W.updateQueue,c=W.lastBaseUpdate,c!==v&&(c===null?W.firstBaseUpdate=V:c.next=V,W.lastBaseUpdate=A))}if(w!==null){var j=_.baseState;v=0,W=V=A=null,c=w;do{var N=c.lane,ke=c.eventTime;if((p&N)===N){W!==null&&(W=W.next={eventTime:ke,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var Se=n,be=c;switch(N=i,ke=l,be.tag){case 1:if(Se=be.payload,typeof Se=="function"){j=Se.call(ke,j,N);break e}j=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=be.payload,N=typeof Se=="function"?Se.call(ke,j,N):Se,N==null)break e;j=Ln({},j,N);break e;case 2:Da=!0}}c.callback!==null&&c.lane!==0&&(n.flags|=64,N=_.effects,N===null?_.effects=[c]:N.push(c))}else ke={eventTime:ke,lane:N,tag:c.tag,payload:c.payload,callback:c.callback,next:null},W===null?(V=W=ke,A=j):W=W.next=ke,v|=N;if(c=c.next,c===null){if(c=_.shared.pending,c===null)break;N=c,c=N.next,N.next=null,_.lastBaseUpdate=N,_.shared.pending=null}}while(!0);if(W===null&&(A=j),_.baseState=A,_.firstBaseUpdate=V,_.lastBaseUpdate=W,i=_.shared.interleaved,i!==null){_=i;do v|=_.lane,_=_.next;while(_!==i)}else w===null&&(_.shared.lanes=0);qs|=v,n.lanes=v,n.memoizedState=j}}function d0(n,i,l){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var p=n[i],_=p.callback;if(_!==null){if(p.callback=null,p=l,typeof _!="function")throw Error($e(191,_));_.call(p)}}}var kh={},Ao=Xa(kh),fh=Xa(kh),mh=Xa(kh);function Bs(n){if(n===kh)throw Error($e(174));return n}function _y(n,i){switch(gn(mh,i),gn(fh,n),gn(Ao,kh),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:rg(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=rg(i,n)}Sn(Ao),gn(Ao,i)}function gu(){Sn(Ao),Sn(fh),Sn(mh)}function L1(n){Bs(mh.current);var i=Bs(Ao.current),l=rg(i,n.type);i!==l&&(gn(fh,n),gn(Ao,l))}function vy(n){fh.current===n&&(Sn(Ao),Sn(fh))}var An=Xa(0);function Cp(n){for(var i=n;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Lm=[];function xy(){for(var n=0;n<Lm.length;n++)Lm[n]._workInProgressVersionPrimary=null;Lm.length=0}var rp=sa.ReactCurrentDispatcher,Rm=sa.ReactCurrentBatchConfig,Zs=0,Dn=null,tr=null,hr=null,kp=!1,Qc=!1,gh=0,BT=0;function zr(){throw Error($e(321))}function wy(n,i){if(i===null)return!1;for(var l=0;l<i.length&&l<n.length;l++)if(!ho(n[l],i[l]))return!1;return!0}function by(n,i,l,p,_,w){if(Zs=w,Dn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,rp.current=n===null||n.memoizedState===null?VT:UT,n=l(p,_),Qc){w=0;do{if(Qc=!1,gh=0,25<=w)throw Error($e(301));w+=1,hr=tr=null,i.updateQueue=null,rp.current=$T,n=l(p,_)}while(Qc)}if(rp.current=Ip,i=tr!==null&&tr.next!==null,Zs=0,hr=tr=Dn=null,kp=!1,i)throw Error($e(300));return n}function Sy(){var n=gh!==0;return gh=0,n}function Po(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Dn.memoizedState=hr=n:hr=hr.next=n,hr}function Wi(){if(tr===null){var n=Dn.alternate;n=n!==null?n.memoizedState:null}else n=tr.next;var i=hr===null?Dn.memoizedState:hr.next;if(i!==null)hr=i,tr=n;else{if(n===null)throw Error($e(310));tr=n,n={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},hr===null?Dn.memoizedState=hr=n:hr=hr.next=n}return hr}function yh(n,i){return typeof i=="function"?i(n):i}function Fm(n){var i=Wi(),l=i.queue;if(l===null)throw Error($e(311));l.lastRenderedReducer=n;var p=tr,_=p.baseQueue,w=l.pending;if(w!==null){if(_!==null){var v=_.next;_.next=w.next,w.next=v}p.baseQueue=_=w,l.pending=null}if(_!==null){w=_.next,p=p.baseState;var c=v=null,A=null,V=w;do{var W=V.lane;if((Zs&W)===W)A!==null&&(A=A.next={lane:0,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),p=V.hasEagerState?V.eagerState:n(p,V.action);else{var j={lane:W,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null};A===null?(c=A=j,v=p):A=A.next=j,Dn.lanes|=W,qs|=W}V=V.next}while(V!==null&&V!==w);A===null?v=p:A.next=c,ho(p,i.memoizedState)||(ii=!0),i.memoizedState=p,i.baseState=v,i.baseQueue=A,l.lastRenderedState=p}if(n=l.interleaved,n!==null){_=n;do w=_.lane,Dn.lanes|=w,qs|=w,_=_.next;while(_!==n)}else _===null&&(l.lanes=0);return[i.memoizedState,l.dispatch]}function Bm(n){var i=Wi(),l=i.queue;if(l===null)throw Error($e(311));l.lastRenderedReducer=n;var p=l.dispatch,_=l.pending,w=i.memoizedState;if(_!==null){l.pending=null;var v=_=_.next;do w=n(w,v.action),v=v.next;while(v!==_);ho(w,i.memoizedState)||(ii=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),l.lastRenderedState=w}return[w,p]}function R1(){}function F1(n,i){var l=Dn,p=Wi(),_=i(),w=!ho(p.memoizedState,_);if(w&&(p.memoizedState=_,ii=!0),p=p.queue,Ty(N1.bind(null,l,p,n),[n]),p.getSnapshot!==i||w||hr!==null&&hr.memoizedState.tag&1){if(l.flags|=2048,_h(9,O1.bind(null,l,p,_,i),void 0,null),dr===null)throw Error($e(349));Zs&30||B1(l,i,_)}return _}function B1(n,i,l){n.flags|=16384,n={getSnapshot:i,value:l},i=Dn.updateQueue,i===null?(i={lastEffect:null,stores:null},Dn.updateQueue=i,i.stores=[n]):(l=i.stores,l===null?i.stores=[n]:l.push(n))}function O1(n,i,l,p){i.value=l,i.getSnapshot=p,j1(i)&&V1(n)}function N1(n,i,l){return l(function(){j1(i)&&V1(n)})}function j1(n){var i=n.getSnapshot;n=n.value;try{var l=i();return!ho(n,l)}catch{return!0}}function V1(n){var i=oa(n,1);i!==null&&co(i,n,1,-1)}function p0(n){var i=Po();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yh,lastRenderedState:n},i.queue=n,n=n.dispatch=jT.bind(null,Dn,n),[i.memoizedState,n]}function _h(n,i,l,p){return n={tag:n,create:i,destroy:l,deps:p,next:null},i=Dn.updateQueue,i===null?(i={lastEffect:null,stores:null},Dn.updateQueue=i,i.lastEffect=n.next=n):(l=i.lastEffect,l===null?i.lastEffect=n.next=n:(p=l.next,l.next=n,n.next=p,i.lastEffect=n)),n}function U1(){return Wi().memoizedState}function ip(n,i,l,p){var _=Po();Dn.flags|=n,_.memoizedState=_h(1|i,l,void 0,p===void 0?null:p)}function Zp(n,i,l,p){var _=Wi();p=p===void 0?null:p;var w=void 0;if(tr!==null){var v=tr.memoizedState;if(w=v.destroy,p!==null&&wy(p,v.deps)){_.memoizedState=_h(i,l,w,p);return}}Dn.flags|=n,_.memoizedState=_h(1|i,l,w,p)}function f0(n,i){return ip(8390656,8,n,i)}function Ty(n,i){return Zp(2048,8,n,i)}function $1(n,i){return Zp(4,2,n,i)}function Z1(n,i){return Zp(4,4,n,i)}function q1(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function H1(n,i,l){return l=l!=null?l.concat([n]):null,Zp(4,4,q1.bind(null,i,n),l)}function Ey(){}function G1(n,i){var l=Wi();i=i===void 0?null:i;var p=l.memoizedState;return p!==null&&i!==null&&wy(i,p[1])?p[0]:(l.memoizedState=[n,i],n)}function W1(n,i){var l=Wi();i=i===void 0?null:i;var p=l.memoizedState;return p!==null&&i!==null&&wy(i,p[1])?p[0]:(n=n(),l.memoizedState=[n,i],n)}function X1(n,i,l){return Zs&21?(ho(l,i)||(l=e1(),Dn.lanes|=l,qs|=l,n.baseState=!0),i):(n.baseState&&(n.baseState=!1,ii=!0),n.memoizedState=l)}function OT(n,i){var l=rn;rn=l!==0&&4>l?l:4,n(!0);var p=Rm.transition;Rm.transition={};try{n(!1),i()}finally{rn=l,Rm.transition=p}}function K1(){return Wi().memoizedState}function NT(n,i,l){var p=Za(n);if(l={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null},J1(n))Y1(i,l);else if(l=A1(n,i,l,p),l!==null){var _=Wr();co(l,n,p,_),Q1(l,i,p)}}function jT(n,i,l){var p=Za(n),_={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null};if(J1(n))Y1(i,_);else{var w=n.alternate;if(n.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var v=i.lastRenderedState,c=w(v,l);if(_.hasEagerState=!0,_.eagerState=c,ho(c,v)){var A=i.interleaved;A===null?(_.next=_,gy(i)):(_.next=A.next,A.next=_),i.interleaved=_;return}}catch{}finally{}l=A1(n,i,_,p),l!==null&&(_=Wr(),co(l,n,p,_),Q1(l,i,p))}}function J1(n){var i=n.alternate;return n===Dn||i!==null&&i===Dn}function Y1(n,i){Qc=kp=!0;var l=n.pending;l===null?i.next=i:(i.next=l.next,l.next=i),n.pending=i}function Q1(n,i,l){if(l&4194240){var p=i.lanes;p&=n.pendingLanes,l|=p,i.lanes=l,ny(n,l)}}var Ip={readContext:Gi,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},VT={readContext:Gi,useCallback:function(n,i){return Po().memoizedState=[n,i===void 0?null:i],n},useContext:Gi,useEffect:f0,useImperativeHandle:function(n,i,l){return l=l!=null?l.concat([n]):null,ip(4194308,4,q1.bind(null,i,n),l)},useLayoutEffect:function(n,i){return ip(4194308,4,n,i)},useInsertionEffect:function(n,i){return ip(4,2,n,i)},useMemo:function(n,i){var l=Po();return i=i===void 0?null:i,n=n(),l.memoizedState=[n,i],n},useReducer:function(n,i,l){var p=Po();return i=l!==void 0?l(i):i,p.memoizedState=p.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},p.queue=n,n=n.dispatch=NT.bind(null,Dn,n),[p.memoizedState,n]},useRef:function(n){var i=Po();return n={current:n},i.memoizedState=n},useState:p0,useDebugValue:Ey,useDeferredValue:function(n){return Po().memoizedState=n},useTransition:function(){var n=p0(!1),i=n[0];return n=OT.bind(null,n[1]),Po().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,l){var p=Dn,_=Po();if(Cn){if(l===void 0)throw Error($e(407));l=l()}else{if(l=i(),dr===null)throw Error($e(349));Zs&30||B1(p,i,l)}_.memoizedState=l;var w={value:l,getSnapshot:i};return _.queue=w,f0(N1.bind(null,p,w,n),[n]),p.flags|=2048,_h(9,O1.bind(null,p,w,l,i),void 0,null),l},useId:function(){var n=Po(),i=dr.identifierPrefix;if(Cn){var l=ea,p=Qo;l=(p&~(1<<32-uo(p)-1)).toString(32)+l,i=":"+i+"R"+l,l=gh++,0<l&&(i+="H"+l.toString(32)),i+=":"}else l=BT++,i=":"+i+"r"+l.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},UT={readContext:Gi,useCallback:G1,useContext:Gi,useEffect:Ty,useImperativeHandle:H1,useInsertionEffect:$1,useLayoutEffect:Z1,useMemo:W1,useReducer:Fm,useRef:U1,useState:function(){return Fm(yh)},useDebugValue:Ey,useDeferredValue:function(n){var i=Wi();return X1(i,tr.memoizedState,n)},useTransition:function(){var n=Fm(yh)[0],i=Wi().memoizedState;return[n,i]},useMutableSource:R1,useSyncExternalStore:F1,useId:K1,unstable_isNewReconciler:!1},$T={readContext:Gi,useCallback:G1,useContext:Gi,useEffect:Ty,useImperativeHandle:H1,useInsertionEffect:$1,useLayoutEffect:Z1,useMemo:W1,useReducer:Bm,useRef:U1,useState:function(){return Bm(yh)},useDebugValue:Ey,useDeferredValue:function(n){var i=Wi();return tr===null?i.memoizedState=n:X1(i,tr.memoizedState,n)},useTransition:function(){var n=Bm(yh)[0],i=Wi().memoizedState;return[n,i]},useMutableSource:R1,useSyncExternalStore:F1,useId:K1,unstable_isNewReconciler:!1};function oo(n,i){if(n&&n.defaultProps){i=Ln({},i),n=n.defaultProps;for(var l in n)i[l]===void 0&&(i[l]=n[l]);return i}return i}function Tg(n,i,l,p){i=n.memoizedState,l=l(p,i),l=l==null?i:Ln({},i,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var qp={isMounted:function(n){return(n=n._reactInternals)?Ks(n)===n:!1},enqueueSetState:function(n,i,l){n=n._reactInternals;var p=Wr(),_=Za(n),w=ta(p,_);w.payload=i,l!=null&&(w.callback=l),i=Ua(n,w,_),i!==null&&(co(i,n,_,p),np(i,n,_))},enqueueReplaceState:function(n,i,l){n=n._reactInternals;var p=Wr(),_=Za(n),w=ta(p,_);w.tag=1,w.payload=i,l!=null&&(w.callback=l),i=Ua(n,w,_),i!==null&&(co(i,n,_,p),np(i,n,_))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var l=Wr(),p=Za(n),_=ta(l,p);_.tag=2,i!=null&&(_.callback=i),i=Ua(n,_,p),i!==null&&(co(i,n,p,l),np(i,n,p))}};function m0(n,i,l,p,_,w,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,w,v):i.prototype&&i.prototype.isPureReactComponent?!ch(l,p)||!ch(_,w):!0}function ew(n,i,l){var p=!1,_=Ga,w=i.contextType;return typeof w=="object"&&w!==null?w=Gi(w):(_=ai(i)?Us:Lr.current,p=i.contextTypes,w=(p=p!=null)?pu(n,_):Ga),i=new i(l,w),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=qp,n.stateNode=i,i._reactInternals=n,p&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=_,n.__reactInternalMemoizedMaskedChildContext=w),i}function g0(n,i,l,p){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,p),i.state!==n&&qp.enqueueReplaceState(i,i.state,null)}function Eg(n,i,l,p){var _=n.stateNode;_.props=l,_.state=n.memoizedState,_.refs={},yy(n);var w=i.contextType;typeof w=="object"&&w!==null?_.context=Gi(w):(w=ai(i)?Us:Lr.current,_.context=pu(n,w)),_.state=n.memoizedState,w=i.getDerivedStateFromProps,typeof w=="function"&&(Tg(n,i,w,l),_.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(i=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),i!==_.state&&qp.enqueueReplaceState(_,_.state,null),Ep(n,l,_,p),_.state=n.memoizedState),typeof _.componentDidMount=="function"&&(n.flags|=4194308)}function yu(n,i){try{var l="",p=i;do l+=yS(p),p=p.return;while(p);var _=l}catch(w){_=`
Error generating stack: `+w.message+`
`+w.stack}return{value:n,source:i,stack:_,digest:null}}function Om(n,i,l){return{value:n,source:null,stack:l??null,digest:i??null}}function Cg(n,i){try{console.error(i.value)}catch(l){setTimeout(function(){throw l})}}var ZT=typeof WeakMap=="function"?WeakMap:Map;function tw(n,i,l){l=ta(-1,l),l.tag=3,l.payload={element:null};var p=i.value;return l.callback=function(){Mp||(Mp=!0,Fg=p),Cg(n,i)},l}function nw(n,i,l){l=ta(-1,l),l.tag=3;var p=n.type.getDerivedStateFromError;if(typeof p=="function"){var _=i.value;l.payload=function(){return p(_)},l.callback=function(){Cg(n,i)}}var w=n.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(l.callback=function(){Cg(n,i),typeof p!="function"&&($a===null?$a=new Set([this]):$a.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),l}function y0(n,i,l){var p=n.pingCache;if(p===null){p=n.pingCache=new ZT;var _=new Set;p.set(i,_)}else _=p.get(i),_===void 0&&(_=new Set,p.set(i,_));_.has(l)||(_.add(l),n=iE.bind(null,n,i,l),i.then(n,n))}function _0(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function v0(n,i,l,p,_){return n.mode&1?(n.flags|=65536,n.lanes=_,n):(n===i?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(i=ta(-1,1),i.tag=2,Ua(l,i,1))),l.lanes|=1),n)}var qT=sa.ReactCurrentOwner,ii=!1;function Gr(n,i,l,p){i.child=n===null?z1(i,null,l,p):mu(i,n.child,l,p)}function x0(n,i,l,p,_){l=l.render;var w=i.ref;return cu(i,_),p=by(n,i,l,p,w,_),l=Sy(),n!==null&&!ii?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~_,aa(n,i,_)):(Cn&&l&&cy(i),i.flags|=1,Gr(n,i,p,_),i.child)}function w0(n,i,l,p,_){if(n===null){var w=l.type;return typeof w=="function"&&!Dy(w)&&w.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(i.tag=15,i.type=w,rw(n,i,w,p,_)):(n=lp(l.type,null,p,i,i.mode,_),n.ref=i.ref,n.return=i,i.child=n)}if(w=n.child,!(n.lanes&_)){var v=w.memoizedProps;if(l=l.compare,l=l!==null?l:ch,l(v,p)&&n.ref===i.ref)return aa(n,i,_)}return i.flags|=1,n=qa(w,p),n.ref=i.ref,n.return=i,i.child=n}function rw(n,i,l,p,_){if(n!==null){var w=n.memoizedProps;if(ch(w,p)&&n.ref===i.ref)if(ii=!1,i.pendingProps=p=w,(n.lanes&_)!==0)n.flags&131072&&(ii=!0);else return i.lanes=n.lanes,aa(n,i,_)}return kg(n,i,l,p,_)}function iw(n,i,l){var p=i.pendingProps,_=p.children,w=n!==null?n.memoizedState:null;if(p.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(iu,ki),ki|=l;else{if(!(l&1073741824))return n=w!==null?w.baseLanes|l:l,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,gn(iu,ki),ki|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:l,gn(iu,ki),ki|=p}else w!==null?(p=w.baseLanes|l,i.memoizedState=null):p=l,gn(iu,ki),ki|=p;return Gr(n,i,_,l),i.child}function ow(n,i){var l=i.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(i.flags|=512,i.flags|=2097152)}function kg(n,i,l,p,_){var w=ai(l)?Us:Lr.current;return w=pu(i,w),cu(i,_),l=by(n,i,l,p,w,_),p=Sy(),n!==null&&!ii?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~_,aa(n,i,_)):(Cn&&p&&cy(i),i.flags|=1,Gr(n,i,l,_),i.child)}function b0(n,i,l,p,_){if(ai(l)){var w=!0;xp(i)}else w=!1;if(cu(i,_),i.stateNode===null)op(n,i),ew(i,l,p),Eg(i,l,p,_),p=!0;else if(n===null){var v=i.stateNode,c=i.memoizedProps;v.props=c;var A=v.context,V=l.contextType;typeof V=="object"&&V!==null?V=Gi(V):(V=ai(l)?Us:Lr.current,V=pu(i,V));var W=l.getDerivedStateFromProps,j=typeof W=="function"||typeof v.getSnapshotBeforeUpdate=="function";j||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==p||A!==V)&&g0(i,v,p,V),Da=!1;var N=i.memoizedState;v.state=N,Ep(i,p,v,_),A=i.memoizedState,c!==p||N!==A||oi.current||Da?(typeof W=="function"&&(Tg(i,l,W,p),A=i.memoizedState),(c=Da||m0(i,l,c,p,N,A,V))?(j||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=A),v.props=p,v.state=A,v.context=V,p=c):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{v=i.stateNode,D1(n,i),c=i.memoizedProps,V=i.type===i.elementType?c:oo(i.type,c),v.props=V,j=i.pendingProps,N=v.context,A=l.contextType,typeof A=="object"&&A!==null?A=Gi(A):(A=ai(l)?Us:Lr.current,A=pu(i,A));var ke=l.getDerivedStateFromProps;(W=typeof ke=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==j||N!==A)&&g0(i,v,p,A),Da=!1,N=i.memoizedState,v.state=N,Ep(i,p,v,_);var Se=i.memoizedState;c!==j||N!==Se||oi.current||Da?(typeof ke=="function"&&(Tg(i,l,ke,p),Se=i.memoizedState),(V=Da||m0(i,l,V,p,N,Se,A)||!1)?(W||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(p,Se,A),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(p,Se,A)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||c===n.memoizedProps&&N===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===n.memoizedProps&&N===n.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=Se),v.props=p,v.state=Se,v.context=A,p=V):(typeof v.componentDidUpdate!="function"||c===n.memoizedProps&&N===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===n.memoizedProps&&N===n.memoizedState||(i.flags|=1024),p=!1)}return Ig(n,i,l,p,w,_)}function Ig(n,i,l,p,_,w){ow(n,i);var v=(i.flags&128)!==0;if(!p&&!v)return _&&s0(i,l,!1),aa(n,i,w);p=i.stateNode,qT.current=i;var c=v&&typeof l.getDerivedStateFromError!="function"?null:p.render();return i.flags|=1,n!==null&&v?(i.child=mu(i,n.child,null,w),i.child=mu(i,null,c,w)):Gr(n,i,c,w),i.memoizedState=p.state,_&&s0(i,l,!0),i.child}function aw(n){var i=n.stateNode;i.pendingContext?a0(n,i.pendingContext,i.pendingContext!==i.context):i.context&&a0(n,i.context,!1),_y(n,i.containerInfo)}function S0(n,i,l,p,_){return fu(),dy(_),i.flags|=256,Gr(n,i,l,p),i.child}var Pg={dehydrated:null,treeContext:null,retryLane:0};function Mg(n){return{baseLanes:n,cachePool:null,transitions:null}}function sw(n,i,l){var p=i.pendingProps,_=An.current,w=!1,v=(i.flags&128)!==0,c;if((c=v)||(c=n!==null&&n.memoizedState===null?!1:(_&2)!==0),c?(w=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(_|=1),gn(An,_&1),n===null)return bg(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(i.mode&1?n.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(v=p.children,n=p.fallback,w?(p=i.mode,w=i.child,v={mode:"hidden",children:v},!(p&1)&&w!==null?(w.childLanes=0,w.pendingProps=v):w=Wp(v,p,0,null),n=Vs(n,p,l,null),w.return=i,n.return=i,w.sibling=n,i.child=w,i.child.memoizedState=Mg(l),i.memoizedState=Pg,n):Cy(i,v));if(_=n.memoizedState,_!==null&&(c=_.dehydrated,c!==null))return HT(n,i,v,p,c,_,l);if(w){w=p.fallback,v=i.mode,_=n.child,c=_.sibling;var A={mode:"hidden",children:p.children};return!(v&1)&&i.child!==_?(p=i.child,p.childLanes=0,p.pendingProps=A,i.deletions=null):(p=qa(_,A),p.subtreeFlags=_.subtreeFlags&14680064),c!==null?w=qa(c,w):(w=Vs(w,v,l,null),w.flags|=2),w.return=i,p.return=i,p.sibling=w,i.child=p,p=w,w=i.child,v=n.child.memoizedState,v=v===null?Mg(l):{baseLanes:v.baseLanes|l,cachePool:null,transitions:v.transitions},w.memoizedState=v,w.childLanes=n.childLanes&~l,i.memoizedState=Pg,p}return w=n.child,n=w.sibling,p=qa(w,{mode:"visible",children:p.children}),!(i.mode&1)&&(p.lanes=l),p.return=i,p.sibling=null,n!==null&&(l=i.deletions,l===null?(i.deletions=[n],i.flags|=16):l.push(n)),i.child=p,i.memoizedState=null,p}function Cy(n,i){return i=Wp({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function Gd(n,i,l,p){return p!==null&&dy(p),mu(i,n.child,null,l),n=Cy(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function HT(n,i,l,p,_,w,v){if(l)return i.flags&256?(i.flags&=-257,p=Om(Error($e(422))),Gd(n,i,v,p)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(w=p.fallback,_=i.mode,p=Wp({mode:"visible",children:p.children},_,0,null),w=Vs(w,_,v,null),w.flags|=2,p.return=i,w.return=i,p.sibling=w,i.child=p,i.mode&1&&mu(i,n.child,null,v),i.child.memoizedState=Mg(v),i.memoizedState=Pg,w);if(!(i.mode&1))return Gd(n,i,v,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var c=p.dgst;return p=c,w=Error($e(419)),p=Om(w,p,void 0),Gd(n,i,v,p)}if(c=(v&n.childLanes)!==0,ii||c){if(p=dr,p!==null){switch(v&-v){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(p.suspendedLanes|v)?0:_,_!==0&&_!==w.retryLane&&(w.retryLane=_,oa(n,_),co(p,n,_,-1))}return Ay(),p=Om(Error($e(421))),Gd(n,i,v,p)}return _.data==="$?"?(i.flags|=128,i.child=n.child,i=oE.bind(null,n),_._reactRetry=i,null):(n=w.treeContext,Pi=Va(_.nextSibling),Mi=i,Cn=!0,lo=null,n!==null&&($i[Zi++]=Qo,$i[Zi++]=ea,$i[Zi++]=$s,Qo=n.id,ea=n.overflow,$s=i),i=Cy(i,p.children),i.flags|=4096,i)}function T0(n,i,l){n.lanes|=i;var p=n.alternate;p!==null&&(p.lanes|=i),Sg(n.return,i,l)}function Nm(n,i,l,p,_){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:l,tailMode:_}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=l,w.tailMode=_)}function lw(n,i,l){var p=i.pendingProps,_=p.revealOrder,w=p.tail;if(Gr(n,i,p.children,l),p=An.current,p&2)p=p&1|2,i.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&T0(n,l,i);else if(n.tag===19)T0(n,l,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}p&=1}if(gn(An,p),!(i.mode&1))i.memoizedState=null;else switch(_){case"forwards":for(l=i.child,_=null;l!==null;)n=l.alternate,n!==null&&Cp(n)===null&&(_=l),l=l.sibling;l=_,l===null?(_=i.child,i.child=null):(_=l.sibling,l.sibling=null),Nm(i,!1,_,l,w);break;case"backwards":for(l=null,_=i.child,i.child=null;_!==null;){if(n=_.alternate,n!==null&&Cp(n)===null){i.child=_;break}n=_.sibling,_.sibling=l,l=_,_=n}Nm(i,!0,l,null,w);break;case"together":Nm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function op(n,i){!(i.mode&1)&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function aa(n,i,l){if(n!==null&&(i.dependencies=n.dependencies),qs|=i.lanes,!(l&i.childLanes))return null;if(n!==null&&i.child!==n.child)throw Error($e(153));if(i.child!==null){for(n=i.child,l=qa(n,n.pendingProps),i.child=l,l.return=i;n.sibling!==null;)n=n.sibling,l=l.sibling=qa(n,n.pendingProps),l.return=i;l.sibling=null}return i.child}function GT(n,i,l){switch(i.tag){case 3:aw(i),fu();break;case 5:L1(i);break;case 1:ai(i.type)&&xp(i);break;case 4:_y(i,i.stateNode.containerInfo);break;case 10:var p=i.type._context,_=i.memoizedProps.value;gn(Sp,p._currentValue),p._currentValue=_;break;case 13:if(p=i.memoizedState,p!==null)return p.dehydrated!==null?(gn(An,An.current&1),i.flags|=128,null):l&i.child.childLanes?sw(n,i,l):(gn(An,An.current&1),n=aa(n,i,l),n!==null?n.sibling:null);gn(An,An.current&1);break;case 19:if(p=(l&i.childLanes)!==0,n.flags&128){if(p)return lw(n,i,l);i.flags|=128}if(_=i.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),gn(An,An.current),p)break;return null;case 22:case 23:return i.lanes=0,iw(n,i,l)}return aa(n,i,l)}var uw,zg,cw,hw;uw=function(n,i){for(var l=i.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};zg=function(){};cw=function(n,i,l,p){var _=n.memoizedProps;if(_!==p){n=i.stateNode,Bs(Ao.current);var w=null;switch(l){case"input":_=Qm(n,_),p=Qm(n,p),w=[];break;case"select":_=Ln({},_,{value:void 0}),p=Ln({},p,{value:void 0}),w=[];break;case"textarea":_=ng(n,_),p=ng(n,p),w=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(n.onclick=_p)}ig(l,p);var v;l=null;for(V in _)if(!p.hasOwnProperty(V)&&_.hasOwnProperty(V)&&_[V]!=null)if(V==="style"){var c=_[V];for(v in c)c.hasOwnProperty(v)&&(l||(l={}),l[v]="")}else V!=="dangerouslySetInnerHTML"&&V!=="children"&&V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(rh.hasOwnProperty(V)?w||(w=[]):(w=w||[]).push(V,null));for(V in p){var A=p[V];if(c=_!=null?_[V]:void 0,p.hasOwnProperty(V)&&A!==c&&(A!=null||c!=null))if(V==="style")if(c){for(v in c)!c.hasOwnProperty(v)||A&&A.hasOwnProperty(v)||(l||(l={}),l[v]="");for(v in A)A.hasOwnProperty(v)&&c[v]!==A[v]&&(l||(l={}),l[v]=A[v])}else l||(w||(w=[]),w.push(V,l)),l=A;else V==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,c=c?c.__html:void 0,A!=null&&c!==A&&(w=w||[]).push(V,A)):V==="children"?typeof A!="string"&&typeof A!="number"||(w=w||[]).push(V,""+A):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&(rh.hasOwnProperty(V)?(A!=null&&V==="onScroll"&&bn("scroll",n),w||c===A||(w=[])):(w=w||[]).push(V,A))}l&&(w=w||[]).push("style",l);var V=w;(i.updateQueue=V)&&(i.flags|=4)}};hw=function(n,i,l,p){l!==p&&(i.flags|=4)};function Bc(n,i){if(!Cn)switch(n.tailMode){case"hidden":i=n.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function Ar(n){var i=n.alternate!==null&&n.alternate.child===n.child,l=0,p=0;if(i)for(var _=n.child;_!==null;)l|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=n,_=_.sibling;else for(_=n.child;_!==null;)l|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=n,_=_.sibling;return n.subtreeFlags|=p,n.childLanes=l,i}function WT(n,i,l){var p=i.pendingProps;switch(hy(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(i),null;case 1:return ai(i.type)&&vp(),Ar(i),null;case 3:return p=i.stateNode,gu(),Sn(oi),Sn(Lr),xy(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(n===null||n.child===null)&&(qd(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,lo!==null&&(Ng(lo),lo=null))),zg(n,i),Ar(i),null;case 5:vy(i);var _=Bs(mh.current);if(l=i.type,n!==null&&i.stateNode!=null)cw(n,i,l,p,_),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!p){if(i.stateNode===null)throw Error($e(166));return Ar(i),null}if(n=Bs(Ao.current),qd(i)){p=i.stateNode,l=i.type;var w=i.memoizedProps;switch(p[Mo]=i,p[ph]=w,n=(i.mode&1)!==0,l){case"dialog":bn("cancel",p),bn("close",p);break;case"iframe":case"object":case"embed":bn("load",p);break;case"video":case"audio":for(_=0;_<Hc.length;_++)bn(Hc[_],p);break;case"source":bn("error",p);break;case"img":case"image":case"link":bn("error",p),bn("load",p);break;case"details":bn("toggle",p);break;case"input":Dv(p,w),bn("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},bn("invalid",p);break;case"textarea":Rv(p,w),bn("invalid",p)}ig(l,w),_=null;for(var v in w)if(w.hasOwnProperty(v)){var c=w[v];v==="children"?typeof c=="string"?p.textContent!==c&&(w.suppressHydrationWarning!==!0&&Zd(p.textContent,c,n),_=["children",c]):typeof c=="number"&&p.textContent!==""+c&&(w.suppressHydrationWarning!==!0&&Zd(p.textContent,c,n),_=["children",""+c]):rh.hasOwnProperty(v)&&c!=null&&v==="onScroll"&&bn("scroll",p)}switch(l){case"input":Fd(p),Lv(p,w,!0);break;case"textarea":Fd(p),Fv(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=_p)}p=_,i.updateQueue=p,p!==null&&(i.flags|=4)}else{v=_.nodeType===9?_:_.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Nx(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=v.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof p.is=="string"?n=v.createElement(l,{is:p.is}):(n=v.createElement(l),l==="select"&&(v=n,p.multiple?v.multiple=!0:p.size&&(v.size=p.size))):n=v.createElementNS(n,l),n[Mo]=i,n[ph]=p,uw(n,i,!1,!1),i.stateNode=n;e:{switch(v=og(l,p),l){case"dialog":bn("cancel",n),bn("close",n),_=p;break;case"iframe":case"object":case"embed":bn("load",n),_=p;break;case"video":case"audio":for(_=0;_<Hc.length;_++)bn(Hc[_],n);_=p;break;case"source":bn("error",n),_=p;break;case"img":case"image":case"link":bn("error",n),bn("load",n),_=p;break;case"details":bn("toggle",n),_=p;break;case"input":Dv(n,p),_=Qm(n,p),bn("invalid",n);break;case"option":_=p;break;case"select":n._wrapperState={wasMultiple:!!p.multiple},_=Ln({},p,{value:void 0}),bn("invalid",n);break;case"textarea":Rv(n,p),_=ng(n,p),bn("invalid",n);break;default:_=p}ig(l,_),c=_;for(w in c)if(c.hasOwnProperty(w)){var A=c[w];w==="style"?Ux(n,A):w==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,A!=null&&jx(n,A)):w==="children"?typeof A=="string"?(l!=="textarea"||A!=="")&&ih(n,A):typeof A=="number"&&ih(n,""+A):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(rh.hasOwnProperty(w)?A!=null&&w==="onScroll"&&bn("scroll",n):A!=null&&Kg(n,w,A,v))}switch(l){case"input":Fd(n),Lv(n,p,!1);break;case"textarea":Fd(n),Fv(n);break;case"option":p.value!=null&&n.setAttribute("value",""+Ha(p.value));break;case"select":n.multiple=!!p.multiple,w=p.value,w!=null?au(n,!!p.multiple,w,!1):p.defaultValue!=null&&au(n,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(n.onclick=_p)}switch(l){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ar(i),null;case 6:if(n&&i.stateNode!=null)hw(n,i,n.memoizedProps,p);else{if(typeof p!="string"&&i.stateNode===null)throw Error($e(166));if(l=Bs(mh.current),Bs(Ao.current),qd(i)){if(p=i.stateNode,l=i.memoizedProps,p[Mo]=i,(w=p.nodeValue!==l)&&(n=Mi,n!==null))switch(n.tag){case 3:Zd(p.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zd(p.nodeValue,l,(n.mode&1)!==0)}w&&(i.flags|=4)}else p=(l.nodeType===9?l:l.ownerDocument).createTextNode(p),p[Mo]=i,i.stateNode=p}return Ar(i),null;case 13:if(Sn(An),p=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Cn&&Pi!==null&&i.mode&1&&!(i.flags&128))P1(),fu(),i.flags|=98560,w=!1;else if(w=qd(i),p!==null&&p.dehydrated!==null){if(n===null){if(!w)throw Error($e(318));if(w=i.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error($e(317));w[Mo]=i}else fu(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Ar(i),w=!1}else lo!==null&&(Ng(lo),lo=null),w=!0;if(!w)return i.flags&65536?i:null}return i.flags&128?(i.lanes=l,i):(p=p!==null,p!==(n!==null&&n.memoizedState!==null)&&p&&(i.child.flags|=8192,i.mode&1&&(n===null||An.current&1?nr===0&&(nr=3):Ay())),i.updateQueue!==null&&(i.flags|=4),Ar(i),null);case 4:return gu(),zg(n,i),n===null&&hh(i.stateNode.containerInfo),Ar(i),null;case 10:return my(i.type._context),Ar(i),null;case 17:return ai(i.type)&&vp(),Ar(i),null;case 19:if(Sn(An),w=i.memoizedState,w===null)return Ar(i),null;if(p=(i.flags&128)!==0,v=w.rendering,v===null)if(p)Bc(w,!1);else{if(nr!==0||n!==null&&n.flags&128)for(n=i.child;n!==null;){if(v=Cp(n),v!==null){for(i.flags|=128,Bc(w,!1),p=v.updateQueue,p!==null&&(i.updateQueue=p,i.flags|=4),i.subtreeFlags=0,p=l,l=i.child;l!==null;)w=l,n=p,w.flags&=14680066,v=w.alternate,v===null?(w.childLanes=0,w.lanes=n,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=v.childLanes,w.lanes=v.lanes,w.child=v.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=v.memoizedProps,w.memoizedState=v.memoizedState,w.updateQueue=v.updateQueue,w.type=v.type,n=v.dependencies,w.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return gn(An,An.current&1|2),i.child}n=n.sibling}w.tail!==null&&qn()>_u&&(i.flags|=128,p=!0,Bc(w,!1),i.lanes=4194304)}else{if(!p)if(n=Cp(v),n!==null){if(i.flags|=128,p=!0,l=n.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),Bc(w,!0),w.tail===null&&w.tailMode==="hidden"&&!v.alternate&&!Cn)return Ar(i),null}else 2*qn()-w.renderingStartTime>_u&&l!==1073741824&&(i.flags|=128,p=!0,Bc(w,!1),i.lanes=4194304);w.isBackwards?(v.sibling=i.child,i.child=v):(l=w.last,l!==null?l.sibling=v:i.child=v,w.last=v)}return w.tail!==null?(i=w.tail,w.rendering=i,w.tail=i.sibling,w.renderingStartTime=qn(),i.sibling=null,l=An.current,gn(An,p?l&1|2:l&1),i):(Ar(i),null);case 22:case 23:return zy(),p=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==p&&(i.flags|=8192),p&&i.mode&1?ki&1073741824&&(Ar(i),i.subtreeFlags&6&&(i.flags|=8192)):Ar(i),null;case 24:return null;case 25:return null}throw Error($e(156,i.tag))}function XT(n,i){switch(hy(i),i.tag){case 1:return ai(i.type)&&vp(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return gu(),Sn(oi),Sn(Lr),xy(),n=i.flags,n&65536&&!(n&128)?(i.flags=n&-65537|128,i):null;case 5:return vy(i),null;case 13:if(Sn(An),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error($e(340));fu()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Sn(An),null;case 4:return gu(),null;case 10:return my(i.type._context),null;case 22:case 23:return zy(),null;case 24:return null;default:return null}}var Wd=!1,Dr=!1,KT=typeof WeakSet=="function"?WeakSet:Set,ft=null;function ru(n,i){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(p){Vn(n,i,p)}else l.current=null}function Ag(n,i,l){try{l()}catch(p){Vn(n,i,p)}}var E0=!1;function JT(n,i){if(mg=mp,n=g1(),uy(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var p=l.getSelection&&l.getSelection();if(p&&p.rangeCount!==0){l=p.anchorNode;var _=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var v=0,c=-1,A=-1,V=0,W=0,j=n,N=null;t:for(;;){for(var ke;j!==l||_!==0&&j.nodeType!==3||(c=v+_),j!==w||p!==0&&j.nodeType!==3||(A=v+p),j.nodeType===3&&(v+=j.nodeValue.length),(ke=j.firstChild)!==null;)N=j,j=ke;for(;;){if(j===n)break t;if(N===l&&++V===_&&(c=v),N===w&&++W===p&&(A=v),(ke=j.nextSibling)!==null)break;j=N,N=j.parentNode}j=ke}l=c===-1||A===-1?null:{start:c,end:A}}else l=null}l=l||{start:0,end:0}}else l=null;for(gg={focusedElem:n,selectionRange:l},mp=!1,ft=i;ft!==null;)if(i=ft,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,ft=n;else for(;ft!==null;){i=ft;try{var Se=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var be=Se.memoizedProps,Ze=Se.memoizedState,oe=i.stateNode,re=oe.getSnapshotBeforeUpdate(i.elementType===i.type?be:oo(i.type,be),Ze);oe.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var ue=i.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($e(163))}}catch(Ce){Vn(i,i.return,Ce)}if(n=i.sibling,n!==null){n.return=i.return,ft=n;break}ft=i.return}return Se=E0,E0=!1,Se}function eh(n,i,l){var p=i.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&n)===n){var w=_.destroy;_.destroy=void 0,w!==void 0&&Ag(i,l,w)}_=_.next}while(_!==p)}}function Hp(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&n)===n){var p=l.create;l.destroy=p()}l=l.next}while(l!==i)}}function Dg(n){var i=n.ref;if(i!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof i=="function"?i(n):i.current=n}}function dw(n){var i=n.alternate;i!==null&&(n.alternate=null,dw(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[Mo],delete i[ph],delete i[vg],delete i[DT],delete i[LT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function pw(n){return n.tag===5||n.tag===3||n.tag===4}function C0(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||pw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Lg(n,i,l){var p=n.tag;if(p===5||p===6)n=n.stateNode,i?l.nodeType===8?l.parentNode.insertBefore(n,i):l.insertBefore(n,i):(l.nodeType===8?(i=l.parentNode,i.insertBefore(n,l)):(i=l,i.appendChild(n)),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=_p));else if(p!==4&&(n=n.child,n!==null))for(Lg(n,i,l),n=n.sibling;n!==null;)Lg(n,i,l),n=n.sibling}function Rg(n,i,l){var p=n.tag;if(p===5||p===6)n=n.stateNode,i?l.insertBefore(n,i):l.appendChild(n);else if(p!==4&&(n=n.child,n!==null))for(Rg(n,i,l),n=n.sibling;n!==null;)Rg(n,i,l),n=n.sibling}var _r=null,ao=!1;function Ma(n,i,l){for(l=l.child;l!==null;)fw(n,i,l),l=l.sibling}function fw(n,i,l){if(zo&&typeof zo.onCommitFiberUnmount=="function")try{zo.onCommitFiberUnmount(Op,l)}catch{}switch(l.tag){case 5:Dr||ru(l,i);case 6:var p=_r,_=ao;_r=null,Ma(n,i,l),_r=p,ao=_,_r!==null&&(ao?(n=_r,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):_r.removeChild(l.stateNode));break;case 18:_r!==null&&(ao?(n=_r,l=l.stateNode,n.nodeType===8?Am(n.parentNode,l):n.nodeType===1&&Am(n,l),lh(n)):Am(_r,l.stateNode));break;case 4:p=_r,_=ao,_r=l.stateNode.containerInfo,ao=!0,Ma(n,i,l),_r=p,ao=_;break;case 0:case 11:case 14:case 15:if(!Dr&&(p=l.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var w=_,v=w.destroy;w=w.tag,v!==void 0&&(w&2||w&4)&&Ag(l,i,v),_=_.next}while(_!==p)}Ma(n,i,l);break;case 1:if(!Dr&&(ru(l,i),p=l.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=l.memoizedProps,p.state=l.memoizedState,p.componentWillUnmount()}catch(c){Vn(l,i,c)}Ma(n,i,l);break;case 21:Ma(n,i,l);break;case 22:l.mode&1?(Dr=(p=Dr)||l.memoizedState!==null,Ma(n,i,l),Dr=p):Ma(n,i,l);break;default:Ma(n,i,l)}}function k0(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new KT),i.forEach(function(p){var _=aE.bind(null,n,p);l.has(p)||(l.add(p),p.then(_,_))})}}function io(n,i){var l=i.deletions;if(l!==null)for(var p=0;p<l.length;p++){var _=l[p];try{var w=n,v=i,c=v;e:for(;c!==null;){switch(c.tag){case 5:_r=c.stateNode,ao=!1;break e;case 3:_r=c.stateNode.containerInfo,ao=!0;break e;case 4:_r=c.stateNode.containerInfo,ao=!0;break e}c=c.return}if(_r===null)throw Error($e(160));fw(w,v,_),_r=null,ao=!1;var A=_.alternate;A!==null&&(A.return=null),_.return=null}catch(V){Vn(_,i,V)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)mw(i,n),i=i.sibling}function mw(n,i){var l=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(io(i,n),Io(n),p&4){try{eh(3,n,n.return),Hp(3,n)}catch(be){Vn(n,n.return,be)}try{eh(5,n,n.return)}catch(be){Vn(n,n.return,be)}}break;case 1:io(i,n),Io(n),p&512&&l!==null&&ru(l,l.return);break;case 5:if(io(i,n),Io(n),p&512&&l!==null&&ru(l,l.return),n.flags&32){var _=n.stateNode;try{ih(_,"")}catch(be){Vn(n,n.return,be)}}if(p&4&&(_=n.stateNode,_!=null)){var w=n.memoizedProps,v=l!==null?l.memoizedProps:w,c=n.type,A=n.updateQueue;if(n.updateQueue=null,A!==null)try{c==="input"&&w.type==="radio"&&w.name!=null&&Bx(_,w),og(c,v);var V=og(c,w);for(v=0;v<A.length;v+=2){var W=A[v],j=A[v+1];W==="style"?Ux(_,j):W==="dangerouslySetInnerHTML"?jx(_,j):W==="children"?ih(_,j):Kg(_,W,j,V)}switch(c){case"input":eg(_,w);break;case"textarea":Ox(_,w);break;case"select":var N=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!w.multiple;var ke=w.value;ke!=null?au(_,!!w.multiple,ke,!1):N!==!!w.multiple&&(w.defaultValue!=null?au(_,!!w.multiple,w.defaultValue,!0):au(_,!!w.multiple,w.multiple?[]:"",!1))}_[ph]=w}catch(be){Vn(n,n.return,be)}}break;case 6:if(io(i,n),Io(n),p&4){if(n.stateNode===null)throw Error($e(162));_=n.stateNode,w=n.memoizedProps;try{_.nodeValue=w}catch(be){Vn(n,n.return,be)}}break;case 3:if(io(i,n),Io(n),p&4&&l!==null&&l.memoizedState.isDehydrated)try{lh(i.containerInfo)}catch(be){Vn(n,n.return,be)}break;case 4:io(i,n),Io(n);break;case 13:io(i,n),Io(n),_=n.child,_.flags&8192&&(w=_.memoizedState!==null,_.stateNode.isHidden=w,!w||_.alternate!==null&&_.alternate.memoizedState!==null||(Py=qn())),p&4&&k0(n);break;case 22:if(W=l!==null&&l.memoizedState!==null,n.mode&1?(Dr=(V=Dr)||W,io(i,n),Dr=V):io(i,n),Io(n),p&8192){if(V=n.memoizedState!==null,(n.stateNode.isHidden=V)&&!W&&n.mode&1)for(ft=n,W=n.child;W!==null;){for(j=ft=W;ft!==null;){switch(N=ft,ke=N.child,N.tag){case 0:case 11:case 14:case 15:eh(4,N,N.return);break;case 1:ru(N,N.return);var Se=N.stateNode;if(typeof Se.componentWillUnmount=="function"){p=N,l=N.return;try{i=p,Se.props=i.memoizedProps,Se.state=i.memoizedState,Se.componentWillUnmount()}catch(be){Vn(p,l,be)}}break;case 5:ru(N,N.return);break;case 22:if(N.memoizedState!==null){P0(j);continue}}ke!==null?(ke.return=N,ft=ke):P0(j)}W=W.sibling}e:for(W=null,j=n;;){if(j.tag===5){if(W===null){W=j;try{_=j.stateNode,V?(w=_.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(c=j.stateNode,A=j.memoizedProps.style,v=A!=null&&A.hasOwnProperty("display")?A.display:null,c.style.display=Vx("display",v))}catch(be){Vn(n,n.return,be)}}}else if(j.tag===6){if(W===null)try{j.stateNode.nodeValue=V?"":j.memoizedProps}catch(be){Vn(n,n.return,be)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===n)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===n)break e;for(;j.sibling===null;){if(j.return===null||j.return===n)break e;W===j&&(W=null),j=j.return}W===j&&(W=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:io(i,n),Io(n),p&4&&k0(n);break;case 21:break;default:io(i,n),Io(n)}}function Io(n){var i=n.flags;if(i&2){try{e:{for(var l=n.return;l!==null;){if(pw(l)){var p=l;break e}l=l.return}throw Error($e(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(ih(_,""),p.flags&=-33);var w=C0(n);Rg(n,w,_);break;case 3:case 4:var v=p.stateNode.containerInfo,c=C0(n);Lg(n,c,v);break;default:throw Error($e(161))}}catch(A){Vn(n,n.return,A)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function YT(n,i,l){ft=n,gw(n)}function gw(n,i,l){for(var p=(n.mode&1)!==0;ft!==null;){var _=ft,w=_.child;if(_.tag===22&&p){var v=_.memoizedState!==null||Wd;if(!v){var c=_.alternate,A=c!==null&&c.memoizedState!==null||Dr;c=Wd;var V=Dr;if(Wd=v,(Dr=A)&&!V)for(ft=_;ft!==null;)v=ft,A=v.child,v.tag===22&&v.memoizedState!==null?M0(_):A!==null?(A.return=v,ft=A):M0(_);for(;w!==null;)ft=w,gw(w),w=w.sibling;ft=_,Wd=c,Dr=V}I0(n)}else _.subtreeFlags&8772&&w!==null?(w.return=_,ft=w):I0(n)}}function I0(n){for(;ft!==null;){var i=ft;if(i.flags&8772){var l=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Dr||Hp(5,i);break;case 1:var p=i.stateNode;if(i.flags&4&&!Dr)if(l===null)p.componentDidMount();else{var _=i.elementType===i.type?l.memoizedProps:oo(i.type,l.memoizedProps);p.componentDidUpdate(_,l.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=i.updateQueue;w!==null&&d0(i,w,p);break;case 3:var v=i.updateQueue;if(v!==null){if(l=null,i.child!==null)switch(i.child.tag){case 5:l=i.child.stateNode;break;case 1:l=i.child.stateNode}d0(i,v,l)}break;case 5:var c=i.stateNode;if(l===null&&i.flags&4){l=c;var A=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":A.autoFocus&&l.focus();break;case"img":A.src&&(l.src=A.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var V=i.alternate;if(V!==null){var W=V.memoizedState;if(W!==null){var j=W.dehydrated;j!==null&&lh(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($e(163))}Dr||i.flags&512&&Dg(i)}catch(N){Vn(i,i.return,N)}}if(i===n){ft=null;break}if(l=i.sibling,l!==null){l.return=i.return,ft=l;break}ft=i.return}}function P0(n){for(;ft!==null;){var i=ft;if(i===n){ft=null;break}var l=i.sibling;if(l!==null){l.return=i.return,ft=l;break}ft=i.return}}function M0(n){for(;ft!==null;){var i=ft;try{switch(i.tag){case 0:case 11:case 15:var l=i.return;try{Hp(4,i)}catch(A){Vn(i,l,A)}break;case 1:var p=i.stateNode;if(typeof p.componentDidMount=="function"){var _=i.return;try{p.componentDidMount()}catch(A){Vn(i,_,A)}}var w=i.return;try{Dg(i)}catch(A){Vn(i,w,A)}break;case 5:var v=i.return;try{Dg(i)}catch(A){Vn(i,v,A)}}}catch(A){Vn(i,i.return,A)}if(i===n){ft=null;break}var c=i.sibling;if(c!==null){c.return=i.return,ft=c;break}ft=i.return}}var QT=Math.ceil,Pp=sa.ReactCurrentDispatcher,ky=sa.ReactCurrentOwner,Hi=sa.ReactCurrentBatchConfig,Wt=0,dr=null,Jn=null,vr=0,ki=0,iu=Xa(0),nr=0,vh=null,qs=0,Gp=0,Iy=0,th=null,ri=null,Py=0,_u=1/0,Ko=null,Mp=!1,Fg=null,$a=null,Xd=!1,Ba=null,zp=0,nh=0,Bg=null,ap=-1,sp=0;function Wr(){return Wt&6?qn():ap!==-1?ap:ap=qn()}function Za(n){return n.mode&1?Wt&2&&vr!==0?vr&-vr:FT.transition!==null?(sp===0&&(sp=e1()),sp):(n=rn,n!==0||(n=window.event,n=n===void 0?16:s1(n.type)),n):1}function co(n,i,l,p){if(50<nh)throw nh=0,Bg=null,Error($e(185));Th(n,l,p),(!(Wt&2)||n!==dr)&&(n===dr&&(!(Wt&2)&&(Gp|=l),nr===4&&Ra(n,vr)),si(n,p),l===1&&Wt===0&&!(i.mode&1)&&(_u=qn()+500,$p&&Ka()))}function si(n,i){var l=n.callbackNode;FS(n,i);var p=fp(n,n===dr?vr:0);if(p===0)l!==null&&Nv(l),n.callbackNode=null,n.callbackPriority=0;else if(i=p&-p,n.callbackPriority!==i){if(l!=null&&Nv(l),i===1)n.tag===0?RT(z0.bind(null,n)):C1(z0.bind(null,n)),zT(function(){!(Wt&6)&&Ka()}),l=null;else{switch(t1(p)){case 1:l=ty;break;case 4:l=Yx;break;case 16:l=pp;break;case 536870912:l=Qx;break;default:l=pp}l=Tw(l,yw.bind(null,n))}n.callbackPriority=i,n.callbackNode=l}}function yw(n,i){if(ap=-1,sp=0,Wt&6)throw Error($e(327));var l=n.callbackNode;if(hu()&&n.callbackNode!==l)return null;var p=fp(n,n===dr?vr:0);if(p===0)return null;if(p&30||p&n.expiredLanes||i)i=Ap(n,p);else{i=p;var _=Wt;Wt|=2;var w=vw();(dr!==n||vr!==i)&&(Ko=null,_u=qn()+500,js(n,i));do try{nE();break}catch(c){_w(n,c)}while(!0);fy(),Pp.current=w,Wt=_,Jn!==null?i=0:(dr=null,vr=0,i=nr)}if(i!==0){if(i===2&&(_=cg(n),_!==0&&(p=_,i=Og(n,_))),i===1)throw l=vh,js(n,0),Ra(n,p),si(n,qn()),l;if(i===6)Ra(n,p);else{if(_=n.current.alternate,!(p&30)&&!eE(_)&&(i=Ap(n,p),i===2&&(w=cg(n),w!==0&&(p=w,i=Og(n,w))),i===1))throw l=vh,js(n,0),Ra(n,p),si(n,qn()),l;switch(n.finishedWork=_,n.finishedLanes=p,i){case 0:case 1:throw Error($e(345));case 2:Ds(n,ri,Ko);break;case 3:if(Ra(n,p),(p&130023424)===p&&(i=Py+500-qn(),10<i)){if(fp(n,0)!==0)break;if(_=n.suspendedLanes,(_&p)!==p){Wr(),n.pingedLanes|=n.suspendedLanes&_;break}n.timeoutHandle=_g(Ds.bind(null,n,ri,Ko),i);break}Ds(n,ri,Ko);break;case 4:if(Ra(n,p),(p&4194240)===p)break;for(i=n.eventTimes,_=-1;0<p;){var v=31-uo(p);w=1<<v,v=i[v],v>_&&(_=v),p&=~w}if(p=_,p=qn()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*QT(p/1960))-p,10<p){n.timeoutHandle=_g(Ds.bind(null,n,ri,Ko),p);break}Ds(n,ri,Ko);break;case 5:Ds(n,ri,Ko);break;default:throw Error($e(329))}}}return si(n,qn()),n.callbackNode===l?yw.bind(null,n):null}function Og(n,i){var l=th;return n.current.memoizedState.isDehydrated&&(js(n,i).flags|=256),n=Ap(n,i),n!==2&&(i=ri,ri=l,i!==null&&Ng(i)),n}function Ng(n){ri===null?ri=n:ri.push.apply(ri,n)}function eE(n){for(var i=n;;){if(i.flags&16384){var l=i.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var p=0;p<l.length;p++){var _=l[p],w=_.getSnapshot;_=_.value;try{if(!ho(w(),_))return!1}catch{return!1}}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ra(n,i){for(i&=~Iy,i&=~Gp,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var l=31-uo(i),p=1<<l;n[l]=-1,i&=~p}}function z0(n){if(Wt&6)throw Error($e(327));hu();var i=fp(n,0);if(!(i&1))return si(n,qn()),null;var l=Ap(n,i);if(n.tag!==0&&l===2){var p=cg(n);p!==0&&(i=p,l=Og(n,p))}if(l===1)throw l=vh,js(n,0),Ra(n,i),si(n,qn()),l;if(l===6)throw Error($e(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,Ds(n,ri,Ko),si(n,qn()),null}function My(n,i){var l=Wt;Wt|=1;try{return n(i)}finally{Wt=l,Wt===0&&(_u=qn()+500,$p&&Ka())}}function Hs(n){Ba!==null&&Ba.tag===0&&!(Wt&6)&&hu();var i=Wt;Wt|=1;var l=Hi.transition,p=rn;try{if(Hi.transition=null,rn=1,n)return n()}finally{rn=p,Hi.transition=l,Wt=i,!(Wt&6)&&Ka()}}function zy(){ki=iu.current,Sn(iu)}function js(n,i){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,MT(l)),Jn!==null)for(l=Jn.return;l!==null;){var p=l;switch(hy(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&vp();break;case 3:gu(),Sn(oi),Sn(Lr),xy();break;case 5:vy(p);break;case 4:gu();break;case 13:Sn(An);break;case 19:Sn(An);break;case 10:my(p.type._context);break;case 22:case 23:zy()}l=l.return}if(dr=n,Jn=n=qa(n.current,null),vr=ki=i,nr=0,vh=null,Iy=Gp=qs=0,ri=th=null,Fs!==null){for(i=0;i<Fs.length;i++)if(l=Fs[i],p=l.interleaved,p!==null){l.interleaved=null;var _=p.next,w=l.pending;if(w!==null){var v=w.next;w.next=_,p.next=v}l.pending=p}Fs=null}return n}function _w(n,i){do{var l=Jn;try{if(fy(),rp.current=Ip,kp){for(var p=Dn.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}kp=!1}if(Zs=0,hr=tr=Dn=null,Qc=!1,gh=0,ky.current=null,l===null||l.return===null){nr=1,vh=i,Jn=null;break}e:{var w=n,v=l.return,c=l,A=i;if(i=vr,c.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){var V=A,W=c,j=W.tag;if(!(W.mode&1)&&(j===0||j===11||j===15)){var N=W.alternate;N?(W.updateQueue=N.updateQueue,W.memoizedState=N.memoizedState,W.lanes=N.lanes):(W.updateQueue=null,W.memoizedState=null)}var ke=_0(v);if(ke!==null){ke.flags&=-257,v0(ke,v,c,w,i),ke.mode&1&&y0(w,V,i),i=ke,A=V;var Se=i.updateQueue;if(Se===null){var be=new Set;be.add(A),i.updateQueue=be}else Se.add(A);break e}else{if(!(i&1)){y0(w,V,i),Ay();break e}A=Error($e(426))}}else if(Cn&&c.mode&1){var Ze=_0(v);if(Ze!==null){!(Ze.flags&65536)&&(Ze.flags|=256),v0(Ze,v,c,w,i),dy(yu(A,c));break e}}w=A=yu(A,c),nr!==4&&(nr=2),th===null?th=[w]:th.push(w),w=v;do{switch(w.tag){case 3:w.flags|=65536,i&=-i,w.lanes|=i;var oe=tw(w,A,i);h0(w,oe);break e;case 1:c=A;var re=w.type,ue=w.stateNode;if(!(w.flags&128)&&(typeof re.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&($a===null||!$a.has(ue)))){w.flags|=65536,i&=-i,w.lanes|=i;var Ce=nw(w,c,i);h0(w,Ce);break e}}w=w.return}while(w!==null)}ww(l)}catch(Le){i=Le,Jn===l&&l!==null&&(Jn=l=l.return);continue}break}while(!0)}function vw(){var n=Pp.current;return Pp.current=Ip,n===null?Ip:n}function Ay(){(nr===0||nr===3||nr===2)&&(nr=4),dr===null||!(qs&268435455)&&!(Gp&268435455)||Ra(dr,vr)}function Ap(n,i){var l=Wt;Wt|=2;var p=vw();(dr!==n||vr!==i)&&(Ko=null,js(n,i));do try{tE();break}catch(_){_w(n,_)}while(!0);if(fy(),Wt=l,Pp.current=p,Jn!==null)throw Error($e(261));return dr=null,vr=0,nr}function tE(){for(;Jn!==null;)xw(Jn)}function nE(){for(;Jn!==null&&!kS();)xw(Jn)}function xw(n){var i=Sw(n.alternate,n,ki);n.memoizedProps=n.pendingProps,i===null?ww(n):Jn=i,ky.current=null}function ww(n){var i=n;do{var l=i.alternate;if(n=i.return,i.flags&32768){if(l=XT(l,i),l!==null){l.flags&=32767,Jn=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{nr=6,Jn=null;return}}else if(l=WT(l,i,ki),l!==null){Jn=l;return}if(i=i.sibling,i!==null){Jn=i;return}Jn=i=n}while(i!==null);nr===0&&(nr=5)}function Ds(n,i,l){var p=rn,_=Hi.transition;try{Hi.transition=null,rn=1,rE(n,i,l,p)}finally{Hi.transition=_,rn=p}return null}function rE(n,i,l,p){do hu();while(Ba!==null);if(Wt&6)throw Error($e(327));l=n.finishedWork;var _=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error($e(177));n.callbackNode=null,n.callbackPriority=0;var w=l.lanes|l.childLanes;if(BS(n,w),n===dr&&(Jn=dr=null,vr=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Xd||(Xd=!0,Tw(pp,function(){return hu(),null})),w=(l.flags&15990)!==0,l.subtreeFlags&15990||w){w=Hi.transition,Hi.transition=null;var v=rn;rn=1;var c=Wt;Wt|=4,ky.current=null,JT(n,l),mw(l,n),ST(gg),mp=!!mg,gg=mg=null,n.current=l,YT(l),IS(),Wt=c,rn=v,Hi.transition=w}else n.current=l;if(Xd&&(Xd=!1,Ba=n,zp=_),w=n.pendingLanes,w===0&&($a=null),zS(l.stateNode),si(n,qn()),i!==null)for(p=n.onRecoverableError,l=0;l<i.length;l++)_=i[l],p(_.value,{componentStack:_.stack,digest:_.digest});if(Mp)throw Mp=!1,n=Fg,Fg=null,n;return zp&1&&n.tag!==0&&hu(),w=n.pendingLanes,w&1?n===Bg?nh++:(nh=0,Bg=n):nh=0,Ka(),null}function hu(){if(Ba!==null){var n=t1(zp),i=Hi.transition,l=rn;try{if(Hi.transition=null,rn=16>n?16:n,Ba===null)var p=!1;else{if(n=Ba,Ba=null,zp=0,Wt&6)throw Error($e(331));var _=Wt;for(Wt|=4,ft=n.current;ft!==null;){var w=ft,v=w.child;if(ft.flags&16){var c=w.deletions;if(c!==null){for(var A=0;A<c.length;A++){var V=c[A];for(ft=V;ft!==null;){var W=ft;switch(W.tag){case 0:case 11:case 15:eh(8,W,w)}var j=W.child;if(j!==null)j.return=W,ft=j;else for(;ft!==null;){W=ft;var N=W.sibling,ke=W.return;if(dw(W),W===V){ft=null;break}if(N!==null){N.return=ke,ft=N;break}ft=ke}}}var Se=w.alternate;if(Se!==null){var be=Se.child;if(be!==null){Se.child=null;do{var Ze=be.sibling;be.sibling=null,be=Ze}while(be!==null)}}ft=w}}if(w.subtreeFlags&2064&&v!==null)v.return=w,ft=v;else e:for(;ft!==null;){if(w=ft,w.flags&2048)switch(w.tag){case 0:case 11:case 15:eh(9,w,w.return)}var oe=w.sibling;if(oe!==null){oe.return=w.return,ft=oe;break e}ft=w.return}}var re=n.current;for(ft=re;ft!==null;){v=ft;var ue=v.child;if(v.subtreeFlags&2064&&ue!==null)ue.return=v,ft=ue;else e:for(v=re;ft!==null;){if(c=ft,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Hp(9,c)}}catch(Le){Vn(c,c.return,Le)}if(c===v){ft=null;break e}var Ce=c.sibling;if(Ce!==null){Ce.return=c.return,ft=Ce;break e}ft=c.return}}if(Wt=_,Ka(),zo&&typeof zo.onPostCommitFiberRoot=="function")try{zo.onPostCommitFiberRoot(Op,n)}catch{}p=!0}return p}finally{rn=l,Hi.transition=i}}return!1}function A0(n,i,l){i=yu(l,i),i=tw(n,i,1),n=Ua(n,i,1),i=Wr(),n!==null&&(Th(n,1,i),si(n,i))}function Vn(n,i,l){if(n.tag===3)A0(n,n,l);else for(;i!==null;){if(i.tag===3){A0(i,n,l);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&($a===null||!$a.has(p))){n=yu(l,n),n=nw(i,n,1),i=Ua(i,n,1),n=Wr(),i!==null&&(Th(i,1,n),si(i,n));break}}i=i.return}}function iE(n,i,l){var p=n.pingCache;p!==null&&p.delete(i),i=Wr(),n.pingedLanes|=n.suspendedLanes&l,dr===n&&(vr&l)===l&&(nr===4||nr===3&&(vr&130023424)===vr&&500>qn()-Py?js(n,0):Iy|=l),si(n,i)}function bw(n,i){i===0&&(n.mode&1?(i=Nd,Nd<<=1,!(Nd&130023424)&&(Nd=4194304)):i=1);var l=Wr();n=oa(n,i),n!==null&&(Th(n,i,l),si(n,l))}function oE(n){var i=n.memoizedState,l=0;i!==null&&(l=i.retryLane),bw(n,l)}function aE(n,i){var l=0;switch(n.tag){case 13:var p=n.stateNode,_=n.memoizedState;_!==null&&(l=_.retryLane);break;case 19:p=n.stateNode;break;default:throw Error($e(314))}p!==null&&p.delete(i),bw(n,l)}var Sw;Sw=function(n,i,l){if(n!==null)if(n.memoizedProps!==i.pendingProps||oi.current)ii=!0;else{if(!(n.lanes&l)&&!(i.flags&128))return ii=!1,GT(n,i,l);ii=!!(n.flags&131072)}else ii=!1,Cn&&i.flags&1048576&&k1(i,bp,i.index);switch(i.lanes=0,i.tag){case 2:var p=i.type;op(n,i),n=i.pendingProps;var _=pu(i,Lr.current);cu(i,l),_=by(null,i,p,n,_,l);var w=Sy();return i.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ai(p)?(w=!0,xp(i)):w=!1,i.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,yy(i),_.updater=qp,i.stateNode=_,_._reactInternals=i,Eg(i,p,n,l),i=Ig(null,i,p,!0,w,l)):(i.tag=0,Cn&&w&&cy(i),Gr(null,i,_,l),i=i.child),i;case 16:p=i.elementType;e:{switch(op(n,i),n=i.pendingProps,_=p._init,p=_(p._payload),i.type=p,_=i.tag=lE(p),n=oo(p,n),_){case 0:i=kg(null,i,p,n,l);break e;case 1:i=b0(null,i,p,n,l);break e;case 11:i=x0(null,i,p,n,l);break e;case 14:i=w0(null,i,p,oo(p.type,n),l);break e}throw Error($e(306,p,""))}return i;case 0:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:oo(p,_),kg(n,i,p,_,l);case 1:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:oo(p,_),b0(n,i,p,_,l);case 3:e:{if(aw(i),n===null)throw Error($e(387));p=i.pendingProps,w=i.memoizedState,_=w.element,D1(n,i),Ep(i,p,null,l);var v=i.memoizedState;if(p=v.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){_=yu(Error($e(423)),i),i=S0(n,i,p,l,_);break e}else if(p!==_){_=yu(Error($e(424)),i),i=S0(n,i,p,l,_);break e}else for(Pi=Va(i.stateNode.containerInfo.firstChild),Mi=i,Cn=!0,lo=null,l=z1(i,null,p,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(fu(),p===_){i=aa(n,i,l);break e}Gr(n,i,p,l)}i=i.child}return i;case 5:return L1(i),n===null&&bg(i),p=i.type,_=i.pendingProps,w=n!==null?n.memoizedProps:null,v=_.children,yg(p,_)?v=null:w!==null&&yg(p,w)&&(i.flags|=32),ow(n,i),Gr(n,i,v,l),i.child;case 6:return n===null&&bg(i),null;case 13:return sw(n,i,l);case 4:return _y(i,i.stateNode.containerInfo),p=i.pendingProps,n===null?i.child=mu(i,null,p,l):Gr(n,i,p,l),i.child;case 11:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:oo(p,_),x0(n,i,p,_,l);case 7:return Gr(n,i,i.pendingProps,l),i.child;case 8:return Gr(n,i,i.pendingProps.children,l),i.child;case 12:return Gr(n,i,i.pendingProps.children,l),i.child;case 10:e:{if(p=i.type._context,_=i.pendingProps,w=i.memoizedProps,v=_.value,gn(Sp,p._currentValue),p._currentValue=v,w!==null)if(ho(w.value,v)){if(w.children===_.children&&!oi.current){i=aa(n,i,l);break e}}else for(w=i.child,w!==null&&(w.return=i);w!==null;){var c=w.dependencies;if(c!==null){v=w.child;for(var A=c.firstContext;A!==null;){if(A.context===p){if(w.tag===1){A=ta(-1,l&-l),A.tag=2;var V=w.updateQueue;if(V!==null){V=V.shared;var W=V.pending;W===null?A.next=A:(A.next=W.next,W.next=A),V.pending=A}}w.lanes|=l,A=w.alternate,A!==null&&(A.lanes|=l),Sg(w.return,l,i),c.lanes|=l;break}A=A.next}}else if(w.tag===10)v=w.type===i.type?null:w.child;else if(w.tag===18){if(v=w.return,v===null)throw Error($e(341));v.lanes|=l,c=v.alternate,c!==null&&(c.lanes|=l),Sg(v,l,i),v=w.sibling}else v=w.child;if(v!==null)v.return=w;else for(v=w;v!==null;){if(v===i){v=null;break}if(w=v.sibling,w!==null){w.return=v.return,v=w;break}v=v.return}w=v}Gr(n,i,_.children,l),i=i.child}return i;case 9:return _=i.type,p=i.pendingProps.children,cu(i,l),_=Gi(_),p=p(_),i.flags|=1,Gr(n,i,p,l),i.child;case 14:return p=i.type,_=oo(p,i.pendingProps),_=oo(p.type,_),w0(n,i,p,_,l);case 15:return rw(n,i,i.type,i.pendingProps,l);case 17:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:oo(p,_),op(n,i),i.tag=1,ai(p)?(n=!0,xp(i)):n=!1,cu(i,l),ew(i,p,_),Eg(i,p,_,l),Ig(null,i,p,!0,n,l);case 19:return lw(n,i,l);case 22:return iw(n,i,l)}throw Error($e(156,i.tag))};function Tw(n,i){return Jx(n,i)}function sE(n,i,l,p){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(n,i,l,p){return new sE(n,i,l,p)}function Dy(n){return n=n.prototype,!(!n||!n.isReactComponent)}function lE(n){if(typeof n=="function")return Dy(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Yg)return 11;if(n===Qg)return 14}return 2}function qa(n,i){var l=n.alternate;return l===null?(l=qi(n.tag,i,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=i,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,i=n.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function lp(n,i,l,p,_,w){var v=2;if(p=n,typeof n=="function")Dy(n)&&(v=1);else if(typeof n=="string")v=5;else e:switch(n){case Wl:return Vs(l.children,_,w,i);case Jg:v=8,_|=8;break;case Xm:return n=qi(12,l,i,_|2),n.elementType=Xm,n.lanes=w,n;case Km:return n=qi(13,l,i,_),n.elementType=Km,n.lanes=w,n;case Jm:return n=qi(19,l,i,_),n.elementType=Jm,n.lanes=w,n;case Lx:return Wp(l,_,w,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ax:v=10;break e;case Dx:v=9;break e;case Yg:v=11;break e;case Qg:v=14;break e;case Aa:v=16,p=null;break e}throw Error($e(130,n==null?n:typeof n,""))}return i=qi(v,l,i,_),i.elementType=n,i.type=p,i.lanes=w,i}function Vs(n,i,l,p){return n=qi(7,n,p,i),n.lanes=l,n}function Wp(n,i,l,p){return n=qi(22,n,p,i),n.elementType=Lx,n.lanes=l,n.stateNode={isHidden:!1},n}function jm(n,i,l){return n=qi(6,n,null,i),n.lanes=l,n}function Vm(n,i,l){return i=qi(4,n.children!==null?n.children:[],n.key,i),i.lanes=l,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function uE(n,i,l,p,_){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wm(0),this.expirationTimes=wm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wm(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ly(n,i,l,p,_,w,v,c,A){return n=new uE(n,i,l,c,A),i===1?(i=1,w===!0&&(i|=8)):i=0,w=qi(3,null,null,i),n.current=w,w.stateNode=n,w.memoizedState={element:p,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},yy(w),n}function cE(n,i,l){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gl,key:p==null?null:""+p,children:n,containerInfo:i,implementation:l}}function Ew(n){if(!n)return Ga;n=n._reactInternals;e:{if(Ks(n)!==n||n.tag!==1)throw Error($e(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ai(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error($e(171))}if(n.tag===1){var l=n.type;if(ai(l))return E1(n,l,i)}return i}function Cw(n,i,l,p,_,w,v,c,A){return n=Ly(l,p,!0,n,_,w,v,c,A),n.context=Ew(null),l=n.current,p=Wr(),_=Za(l),w=ta(p,_),w.callback=i??null,Ua(l,w,_),n.current.lanes=_,Th(n,_,p),si(n,p),n}function Xp(n,i,l,p){var _=i.current,w=Wr(),v=Za(_);return l=Ew(l),i.context===null?i.context=l:i.pendingContext=l,i=ta(w,v),i.payload={element:n},p=p===void 0?null:p,p!==null&&(i.callback=p),n=Ua(_,i,v),n!==null&&(co(n,_,v,w),np(n,_,v)),v}function Dp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function D0(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<i?l:i}}function Ry(n,i){D0(n,i),(n=n.alternate)&&D0(n,i)}function hE(){return null}var kw=typeof reportError=="function"?reportError:function(n){console.error(n)};function Fy(n){this._internalRoot=n}Kp.prototype.render=Fy.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error($e(409));Xp(n,i,null,null)};Kp.prototype.unmount=Fy.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Hs(function(){Xp(null,n,null,null)}),i[ia]=null}};function Kp(n){this._internalRoot=n}Kp.prototype.unstable_scheduleHydration=function(n){if(n){var i=i1();n={blockedOn:null,target:n,priority:i};for(var l=0;l<La.length&&i!==0&&i<La[l].priority;l++);La.splice(l,0,n),l===0&&a1(n)}};function By(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Jp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function L0(){}function dE(n,i,l,p,_){if(_){if(typeof p=="function"){var w=p;p=function(){var V=Dp(v);w.call(V)}}var v=Cw(i,p,n,0,null,!1,!1,"",L0);return n._reactRootContainer=v,n[ia]=v.current,hh(n.nodeType===8?n.parentNode:n),Hs(),v}for(;_=n.lastChild;)n.removeChild(_);if(typeof p=="function"){var c=p;p=function(){var V=Dp(A);c.call(V)}}var A=Ly(n,0,!1,null,null,!1,!1,"",L0);return n._reactRootContainer=A,n[ia]=A.current,hh(n.nodeType===8?n.parentNode:n),Hs(function(){Xp(i,A,l,p)}),A}function Yp(n,i,l,p,_){var w=l._reactRootContainer;if(w){var v=w;if(typeof _=="function"){var c=_;_=function(){var A=Dp(v);c.call(A)}}Xp(i,v,n,_)}else v=dE(l,i,n,_,p);return Dp(v)}n1=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var l=qc(i.pendingLanes);l!==0&&(ny(i,l|1),si(i,qn()),!(Wt&6)&&(_u=qn()+500,Ka()))}break;case 13:Hs(function(){var p=oa(n,1);if(p!==null){var _=Wr();co(p,n,1,_)}}),Ry(n,1)}};ry=function(n){if(n.tag===13){var i=oa(n,134217728);if(i!==null){var l=Wr();co(i,n,134217728,l)}Ry(n,134217728)}};r1=function(n){if(n.tag===13){var i=Za(n),l=oa(n,i);if(l!==null){var p=Wr();co(l,n,i,p)}Ry(n,i)}};i1=function(){return rn};o1=function(n,i){var l=rn;try{return rn=n,i()}finally{rn=l}};sg=function(n,i,l){switch(i){case"input":if(eg(n,l),i=l.name,l.type==="radio"&&i!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<l.length;i++){var p=l[i];if(p!==n&&p.form===n.form){var _=Up(p);if(!_)throw Error($e(90));Fx(p),eg(p,_)}}}break;case"textarea":Ox(n,l);break;case"select":i=l.value,i!=null&&au(n,!!l.multiple,i,!1)}};qx=My;Hx=Hs;var pE={usingClientEntryPoint:!1,Events:[Ch,Yl,Up,$x,Zx,My]},Oc={findFiberByHostInstance:Rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fE={bundleType:Oc.bundleType,version:Oc.version,rendererPackageName:Oc.rendererPackageName,rendererConfig:Oc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sa.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Xx(n),n===null?null:n.stateNode},findFiberByHostInstance:Oc.findFiberByHostInstance||hE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Op=Kd.inject(fE),zo=Kd}catch{}}Ai.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pE;Ai.createPortal=function(n,i){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!By(i))throw Error($e(200));return cE(n,i,null,l)};Ai.createRoot=function(n,i){if(!By(n))throw Error($e(299));var l=!1,p="",_=kw;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),i=Ly(n,1,!1,null,null,l,!1,p,_),n[ia]=i.current,hh(n.nodeType===8?n.parentNode:n),new Fy(i)};Ai.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error($e(188)):(n=Object.keys(n).join(","),Error($e(268,n)));return n=Xx(i),n=n===null?null:n.stateNode,n};Ai.flushSync=function(n){return Hs(n)};Ai.hydrate=function(n,i,l){if(!Jp(i))throw Error($e(200));return Yp(null,n,i,!0,l)};Ai.hydrateRoot=function(n,i,l){if(!By(n))throw Error($e(405));var p=l!=null&&l.hydratedSources||null,_=!1,w="",v=kw;if(l!=null&&(l.unstable_strictMode===!0&&(_=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),i=Cw(i,null,n,1,l??null,_,!1,w,v),n[ia]=i.current,hh(n),p)for(n=0;n<p.length;n++)l=p[n],_=l._getVersion,_=_(l._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[l,_]:i.mutableSourceEagerHydrationData.push(l,_);return new Kp(i)};Ai.render=function(n,i,l){if(!Jp(i))throw Error($e(200));return Yp(null,n,i,!1,l)};Ai.unmountComponentAtNode=function(n){if(!Jp(n))throw Error($e(40));return n._reactRootContainer?(Hs(function(){Yp(null,null,n,!1,function(){n._reactRootContainer=null,n[ia]=null})}),!0):!1};Ai.unstable_batchedUpdates=My;Ai.unstable_renderSubtreeIntoContainer=function(n,i,l,p){if(!Jp(l))throw Error($e(200));if(n==null||n._reactInternals===void 0)throw Error($e(38));return Yp(n,i,l,!1,p)};Ai.version="18.3.1-next-f1338f8080-20240426";function Iw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Iw)}catch(n){console.error(n)}}Iw(),Ix.exports=Ai;var Ih=Ix.exports;const mE=$g(Ih),gE=Ug({__proto__:null,default:mE},[Ih]);var R0=Ih;Gm.createRoot=R0.createRoot,Gm.hydrateRoot=R0.hydrateRoot;/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zn(){return zn=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(n[p]=l[p])}return n},zn.apply(this,arguments)}var Kn;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Kn||(Kn={}));const F0="popstate";function yE(n){n===void 0&&(n={});function i(_,w){let{pathname:v="/",search:c="",hash:A=""}=la(_.location.hash.substr(1));return!v.startsWith("/")&&!v.startsWith(".")&&(v="/"+v),xh("",{pathname:v,search:c,hash:A},w.state&&w.state.usr||null,w.state&&w.state.key||"default")}function l(_,w){let v=_.document.querySelector("base"),c="";if(v&&v.getAttribute("href")){let A=_.location.href,V=A.indexOf("#");c=V===-1?A:A.slice(0,V)}return c+"#"+(typeof w=="string"?w:Ws(w))}function p(_,w){Gs(_.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(w)+")")}return vE(i,l,p,n)}function Ut(n,i){if(n===!1||n===null||typeof n>"u")throw new Error(i)}function Gs(n,i){if(!n){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function _E(){return Math.random().toString(36).substr(2,8)}function B0(n,i){return{usr:n.state,key:n.key,idx:i}}function xh(n,i,l,p){return l===void 0&&(l=null),zn({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof i=="string"?la(i):i,{state:l,key:i&&i.key||p||_E()})}function Ws(n){let{pathname:i="/",search:l="",hash:p=""}=n;return l&&l!=="?"&&(i+=l.charAt(0)==="?"?l:"?"+l),p&&p!=="#"&&(i+=p.charAt(0)==="#"?p:"#"+p),i}function la(n){let i={};if(n){let l=n.indexOf("#");l>=0&&(i.hash=n.substr(l),n=n.substr(0,l));let p=n.indexOf("?");p>=0&&(i.search=n.substr(p),n=n.substr(0,p)),n&&(i.pathname=n)}return i}function vE(n,i,l,p){p===void 0&&(p={});let{window:_=document.defaultView,v5Compat:w=!1}=p,v=_.history,c=Kn.Pop,A=null,V=W();V==null&&(V=0,v.replaceState(zn({},v.state,{idx:V}),""));function W(){return(v.state||{idx:null}).idx}function j(){c=Kn.Pop;let Ze=W(),oe=Ze==null?null:Ze-V;V=Ze,A&&A({action:c,location:be.location,delta:oe})}function N(Ze,oe){c=Kn.Push;let re=xh(be.location,Ze,oe);l&&l(re,Ze),V=W()+1;let ue=B0(re,V),Ce=be.createHref(re);try{v.pushState(ue,"",Ce)}catch(Le){if(Le instanceof DOMException&&Le.name==="DataCloneError")throw Le;_.location.assign(Ce)}w&&A&&A({action:c,location:be.location,delta:1})}function ke(Ze,oe){c=Kn.Replace;let re=xh(be.location,Ze,oe);l&&l(re,Ze),V=W();let ue=B0(re,V),Ce=be.createHref(re);v.replaceState(ue,"",Ce),w&&A&&A({action:c,location:be.location,delta:0})}function Se(Ze){let oe=_.location.origin!=="null"?_.location.origin:_.location.href,re=typeof Ze=="string"?Ze:Ws(Ze);return re=re.replace(/ $/,"%20"),Ut(oe,"No window.location.(origin|href) available to create URL for href: "+re),new URL(re,oe)}let be={get action(){return c},get location(){return n(_,v)},listen(Ze){if(A)throw new Error("A history only accepts one active listener");return _.addEventListener(F0,j),A=Ze,()=>{_.removeEventListener(F0,j),A=null}},createHref(Ze){return i(_,Ze)},createURL:Se,encodeLocation(Ze){let oe=Se(Ze);return{pathname:oe.pathname,search:oe.search,hash:oe.hash}},push:N,replace:ke,go(Ze){return v.go(Ze)}};return be}var un;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(un||(un={}));const xE=new Set(["lazy","caseSensitive","path","id","index","children"]);function wE(n){return n.index===!0}function wh(n,i,l,p){return l===void 0&&(l=[]),p===void 0&&(p={}),n.map((_,w)=>{let v=[...l,String(w)],c=typeof _.id=="string"?_.id:v.join("-");if(Ut(_.index!==!0||!_.children,"Cannot specify children on an index route"),Ut(!p[c],'Found a route id collision on id "'+c+`".  Route id's must be globally unique within Data Router usages`),wE(_)){let A=zn({},_,i(_),{id:c});return p[c]=A,A}else{let A=zn({},_,i(_),{id:c,children:void 0});return p[c]=A,_.children&&(A.children=wh(_.children,i,v,p)),A}})}function Ls(n,i,l){return l===void 0&&(l="/"),up(n,i,l,!1)}function up(n,i,l,p){let _=typeof i=="string"?la(i):i,w=Su(_.pathname||"/",l);if(w==null)return null;let v=Pw(n);SE(v);let c=null;for(let A=0;c==null&&A<v.length;++A){let V=LE(w);c=AE(v[A],V,p)}return c}function bE(n,i){let{route:l,pathname:p,params:_}=n;return{id:l.id,pathname:p,params:_,data:i[l.id],handle:l.handle}}function Pw(n,i,l,p){i===void 0&&(i=[]),l===void 0&&(l=[]),p===void 0&&(p="");let _=(w,v,c)=>{let A={relativePath:c===void 0?w.path||"":c,caseSensitive:w.caseSensitive===!0,childrenIndex:v,route:w};A.relativePath.startsWith("/")&&(Ut(A.relativePath.startsWith(p),'Absolute route path "'+A.relativePath+'" nested under path '+('"'+p+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),A.relativePath=A.relativePath.slice(p.length));let V=na([p,A.relativePath]),W=l.concat(A);w.children&&w.children.length>0&&(Ut(w.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+V+'".')),Pw(w.children,i,W,V)),!(w.path==null&&!w.index)&&i.push({path:V,score:ME(V,w.index),routesMeta:W})};return n.forEach((w,v)=>{var c;if(w.path===""||!((c=w.path)!=null&&c.includes("?")))_(w,v);else for(let A of Mw(w.path))_(w,v,A)}),i}function Mw(n){let i=n.split("/");if(i.length===0)return[];let[l,...p]=i,_=l.endsWith("?"),w=l.replace(/\?$/,"");if(p.length===0)return _?[w,""]:[w];let v=Mw(p.join("/")),c=[];return c.push(...v.map(A=>A===""?w:[w,A].join("/"))),_&&c.push(...v),c.map(A=>n.startsWith("/")&&A===""?"/":A)}function SE(n){n.sort((i,l)=>i.score!==l.score?l.score-i.score:zE(i.routesMeta.map(p=>p.childrenIndex),l.routesMeta.map(p=>p.childrenIndex)))}const TE=/^:[\w-]+$/,EE=3,CE=2,kE=1,IE=10,PE=-2,O0=n=>n==="*";function ME(n,i){let l=n.split("/"),p=l.length;return l.some(O0)&&(p+=PE),i&&(p+=CE),l.filter(_=>!O0(_)).reduce((_,w)=>_+(TE.test(w)?EE:w===""?kE:IE),p)}function zE(n,i){return n.length===i.length&&n.slice(0,-1).every((p,_)=>p===i[_])?n[n.length-1]-i[i.length-1]:0}function AE(n,i,l){l===void 0&&(l=!1);let{routesMeta:p}=n,_={},w="/",v=[];for(let c=0;c<p.length;++c){let A=p[c],V=c===p.length-1,W=w==="/"?i:i.slice(w.length)||"/",j=N0({path:A.relativePath,caseSensitive:A.caseSensitive,end:V},W),N=A.route;if(!j&&V&&l&&!p[p.length-1].route.index&&(j=N0({path:A.relativePath,caseSensitive:A.caseSensitive,end:!1},W)),!j)return null;Object.assign(_,j.params),v.push({params:_,pathname:na([w,j.pathname]),pathnameBase:BE(na([w,j.pathnameBase])),route:N}),j.pathnameBase!=="/"&&(w=na([w,j.pathnameBase]))}return v}function N0(n,i){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[l,p]=DE(n.path,n.caseSensitive,n.end),_=i.match(l);if(!_)return null;let w=_[0],v=w.replace(/(.)\/+$/,"$1"),c=_.slice(1);return{params:p.reduce((V,W,j)=>{let{paramName:N,isOptional:ke}=W;if(N==="*"){let be=c[j]||"";v=w.slice(0,w.length-be.length).replace(/(.)\/+$/,"$1")}const Se=c[j];return ke&&!Se?V[N]=void 0:V[N]=(Se||"").replace(/%2F/g,"/"),V},{}),pathname:w,pathnameBase:v,pattern:n}}function DE(n,i,l){i===void 0&&(i=!1),l===void 0&&(l=!0),Gs(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let p=[],_="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,c,A)=>(p.push({paramName:c,isOptional:A!=null}),A?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(p.push({paramName:"*"}),_+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?_+="\\/*$":n!==""&&n!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,i?void 0:"i"),p]}function LE(n){try{return n.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return Gs(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),n}}function Su(n,i){if(i==="/")return n;if(!n.toLowerCase().startsWith(i.toLowerCase()))return null;let l=i.endsWith("/")?i.length-1:i.length,p=n.charAt(l);return p&&p!=="/"?null:n.slice(l)||"/"}function RE(n,i){i===void 0&&(i="/");let{pathname:l,search:p="",hash:_=""}=typeof n=="string"?la(n):n;return{pathname:l?l.startsWith("/")?l:FE(l,i):i,search:OE(p),hash:NE(_)}}function FE(n,i){let l=i.replace(/\/+$/,"").split("/");return n.split("/").forEach(_=>{_===".."?l.length>1&&l.pop():_!=="."&&l.push(_)}),l.length>1?l.join("/"):"/"}function Um(n,i,l,p){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(p)+"].  Please separate it out to the ")+("`to."+l+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zw(n){return n.filter((i,l)=>l===0||i.route.path&&i.route.path.length>0)}function Oy(n,i){let l=zw(n);return i?l.map((p,_)=>_===l.length-1?p.pathname:p.pathnameBase):l.map(p=>p.pathnameBase)}function Ny(n,i,l,p){p===void 0&&(p=!1);let _;typeof n=="string"?_=la(n):(_=zn({},n),Ut(!_.pathname||!_.pathname.includes("?"),Um("?","pathname","search",_)),Ut(!_.pathname||!_.pathname.includes("#"),Um("#","pathname","hash",_)),Ut(!_.search||!_.search.includes("#"),Um("#","search","hash",_)));let w=n===""||_.pathname==="",v=w?"/":_.pathname,c;if(v==null)c=l;else{let j=i.length-1;if(!p&&v.startsWith("..")){let N=v.split("/");for(;N[0]==="..";)N.shift(),j-=1;_.pathname=N.join("/")}c=j>=0?i[j]:"/"}let A=RE(_,c),V=v&&v!=="/"&&v.endsWith("/"),W=(w||v===".")&&l.endsWith("/");return!A.pathname.endsWith("/")&&(V||W)&&(A.pathname+="/"),A}const na=n=>n.join("/").replace(/\/\/+/g,"/"),BE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),OE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,NE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class Lp{constructor(i,l,p,_){_===void 0&&(_=!1),this.status=i,this.statusText=l||"",this.internal=_,p instanceof Error?(this.data=p.toString(),this.error=p):this.data=p}}function Qp(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Aw=["post","put","patch","delete"],jE=new Set(Aw),VE=["get",...Aw],UE=new Set(VE),$E=new Set([301,302,303,307,308]),ZE=new Set([307,308]),$m={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},qE={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Nc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HE=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),Dw="remix-router-transitions";function GE(n){const i=n.window?n.window:typeof window<"u"?window:void 0,l=typeof i<"u"&&typeof i.document<"u"&&typeof i.document.createElement<"u",p=!l;Ut(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let _;if(n.mapRouteProperties)_=n.mapRouteProperties;else if(n.detectErrorBoundary){let H=n.detectErrorBoundary;_=ee=>({hasErrorBoundary:H(ee)})}else _=HE;let w={},v=wh(n.routes,_,void 0,w),c,A=n.basename||"/",V=n.unstable_dataStrategy||YE,W=n.unstable_patchRoutesOnNavigation,j=zn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},n.future),N=null,ke=new Set,Se=1e3,be=new Set,Ze=null,oe=null,re=null,ue=n.hydrationData!=null,Ce=Ls(v,n.history.location,A),Le=null;if(Ce==null&&!W){let H=Hr(404,{pathname:n.history.location.pathname}),{matches:ee,route:ce}=X0(v);Ce=ee,Le={[ce.id]:H}}Ce&&!n.hydrationData&&me(Ce,v,n.history.location.pathname).active&&(Ce=null);let Xe;if(Ce)if(Ce.some(H=>H.route.lazy))Xe=!1;else if(!Ce.some(H=>H.route.loader))Xe=!0;else if(j.v7_partialHydration){let H=n.hydrationData?n.hydrationData.loaderData:null,ee=n.hydrationData?n.hydrationData.errors:null,ce=xe=>xe.route.loader?typeof xe.route.loader=="function"&&xe.route.loader.hydrate===!0?!1:H&&H[xe.route.id]!==void 0||ee&&ee[xe.route.id]!==void 0:!0;if(ee){let xe=Ce.findIndex(Re=>ee[Re.route.id]!==void 0);Xe=Ce.slice(0,xe+1).every(ce)}else Xe=Ce.every(ce)}else Xe=n.hydrationData!=null;else if(Xe=!1,Ce=[],j.v7_partialHydration){let H=me(null,v,n.history.location.pathname);H.active&&H.matches&&(Ce=H.matches)}let Qe,pe={historyAction:n.history.action,location:n.history.location,matches:Ce,initialized:Xe,navigation:$m,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||Le,fetchers:new Map,blockers:new Map},dt=Kn.Pop,lt=!1,ot,Xt=!1,Ot=new Map,Ft=null,Rn=!1,Hn=!1,Un=[],rt=new Set,ut=new Map,wt=0,Dt=-1,Nt=new Map,kn=new Set,yn=new Map,Fn=new Map,dn=new Set,on=new Map,$n=new Map,Xi=new Map,li=!1;function Do(){if(N=n.history.listen(H=>{let{action:ee,location:ce,delta:xe}=H;if(li){li=!1;return}Gs($n.size===0||xe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Re=Or({currentLocation:pe.location,nextLocation:ce,historyAction:ee});if(Re&&xe!=null){li=!0,n.history.go(xe*-1),Br(Re,{state:"blocked",location:ce,proceed(){Br(Re,{state:"proceeding",proceed:void 0,reset:void 0,location:ce}),n.history.go(xe)},reset(){let Ae=new Map(pe.blockers);Ae.set(Re,Nc),pn({blockers:Ae})}});return}return Fr(ee,ce)}),l){hC(i,Ot);let H=()=>dC(i,Ot);i.addEventListener("pagehide",H),Ft=()=>i.removeEventListener("pagehide",H)}return pe.initialized||Fr(Kn.Pop,pe.location,{initialHydration:!0}),Qe}function ui(){N&&N(),Ft&&Ft(),ke.clear(),ot&&ot.abort(),pe.fetchers.forEach((H,ee)=>Ue(ee)),pe.blockers.forEach((H,ee)=>Yr(ee))}function Li(H){return ke.add(H),()=>ke.delete(H)}function pn(H,ee){ee===void 0&&(ee={}),pe=zn({},pe,H);let ce=[],xe=[];j.v7_fetcherPersist&&pe.fetchers.forEach((Re,Ae)=>{Re.state==="idle"&&(dn.has(Ae)?xe.push(Ae):ce.push(Ae))}),[...ke].forEach(Re=>Re(pe,{deletedFetchers:xe,unstable_viewTransitionOpts:ee.viewTransitionOpts,unstable_flushSync:ee.flushSync===!0})),j.v7_fetcherPersist&&(ce.forEach(Re=>pe.fetchers.delete(Re)),xe.forEach(Re=>Ue(Re)))}function Rr(H,ee,ce){var xe,Re;let{flushSync:Ae}=ce===void 0?{}:ce,nt=pe.actionData!=null&&pe.navigation.formMethod!=null&&so(pe.navigation.formMethod)&&pe.navigation.state==="loading"&&((xe=H.state)==null?void 0:xe._isRedirect)!==!0,Fe;ee.actionData?Object.keys(ee.actionData).length>0?Fe=ee.actionData:Fe=null:nt?Fe=pe.actionData:Fe=null;let mt=ee.loaderData?G0(pe.loaderData,ee.loaderData,ee.matches||[],ee.errors):pe.loaderData,Ve=pe.blockers;Ve.size>0&&(Ve=new Map(Ve),Ve.forEach((kt,At)=>Ve.set(At,Nc)));let at=lt===!0||pe.navigation.formMethod!=null&&so(pe.navigation.formMethod)&&((Re=H.state)==null?void 0:Re._isRedirect)!==!0;c&&(v=c,c=void 0),Rn||dt===Kn.Pop||(dt===Kn.Push?n.history.push(H,H.state):dt===Kn.Replace&&n.history.replace(H,H.state));let xt;if(dt===Kn.Pop){let kt=Ot.get(pe.location.pathname);kt&&kt.has(H.pathname)?xt={currentLocation:pe.location,nextLocation:H}:Ot.has(H.pathname)&&(xt={currentLocation:H,nextLocation:pe.location})}else if(Xt){let kt=Ot.get(pe.location.pathname);kt?kt.add(H.pathname):(kt=new Set([H.pathname]),Ot.set(pe.location.pathname,kt)),xt={currentLocation:pe.location,nextLocation:H}}pn(zn({},ee,{actionData:Fe,loaderData:mt,historyAction:dt,location:H,initialized:!0,navigation:$m,revalidation:"idle",restoreScrollPosition:he(H,ee.matches||pe.matches),preventScrollReset:at,blockers:Ve}),{viewTransitionOpts:xt,flushSync:Ae===!0}),dt=Kn.Pop,lt=!1,Xt=!1,Rn=!1,Hn=!1,Un=[]}async function we(H,ee){if(typeof H=="number"){n.history.go(H);return}let ce=jg(pe.location,pe.matches,A,j.v7_prependBasename,H,j.v7_relativeSplatPath,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:xe,submission:Re,error:Ae}=j0(j.v7_normalizeFormMethod,!1,ce,ee),nt=pe.location,Fe=xh(pe.location,xe,ee&&ee.state);Fe=zn({},Fe,n.history.encodeLocation(Fe));let mt=ee&&ee.replace!=null?ee.replace:void 0,Ve=Kn.Push;mt===!0?Ve=Kn.Replace:mt===!1||Re!=null&&so(Re.formMethod)&&Re.formAction===pe.location.pathname+pe.location.search&&(Ve=Kn.Replace);let at=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,xt=(ee&&ee.unstable_flushSync)===!0,kt=Or({currentLocation:nt,nextLocation:Fe,historyAction:Ve});if(kt){Br(kt,{state:"blocked",location:Fe,proceed(){Br(kt,{state:"proceeding",proceed:void 0,reset:void 0,location:Fe}),we(H,ee)},reset(){let At=new Map(pe.blockers);At.set(kt,Nc),pn({blockers:At})}});return}return await Fr(Ve,Fe,{submission:Re,pendingError:Ae,preventScrollReset:at,replace:ee&&ee.replace,enableViewTransition:ee&&ee.unstable_viewTransition,flushSync:xt})}function Ki(){if(br(),pn({revalidation:"loading"}),pe.navigation.state!=="submitting"){if(pe.navigation.state==="idle"){Fr(pe.historyAction,pe.location,{startUninterruptedRevalidation:!0});return}Fr(dt||pe.historyAction,pe.navigation.location,{overrideNavigation:pe.navigation})}}async function Fr(H,ee,ce){ot&&ot.abort(),ot=null,dt=H,Rn=(ce&&ce.startUninterruptedRevalidation)===!0,se(pe.location,pe.matches),lt=(ce&&ce.preventScrollReset)===!0,Xt=(ce&&ce.enableViewTransition)===!0;let xe=c||v,Re=ce&&ce.overrideNavigation,Ae=Ls(xe,ee,A),nt=(ce&&ce.flushSync)===!0,Fe=me(Ae,xe,ee.pathname);if(Fe.active&&Fe.matches&&(Ae=Fe.matches),!Ae){let{error:It,notFoundMatches:_n,route:Et}=Q(ee.pathname);Rr(ee,{matches:_n,loaderData:{},errors:{[Et.id]:It}},{flushSync:nt});return}if(pe.initialized&&!Hn&&iC(pe.location,ee)&&!(ce&&ce.submission&&so(ce.submission.formMethod))){Rr(ee,{matches:Ae},{flushSync:nt});return}ot=new AbortController;let mt=ql(n.history,ee,ot.signal,ce&&ce.submission),Ve;if(ce&&ce.pendingError)Ve=[ou(Ae).route.id,{type:un.error,error:ce.pendingError}];else if(ce&&ce.submission&&so(ce.submission.formMethod)){let It=await $t(mt,ee,ce.submission,Ae,Fe.active,{replace:ce.replace,flushSync:nt});if(It.shortCircuited)return;if(It.pendingActionResult){let[_n,Et]=It.pendingActionResult;if(Ii(Et)&&Qp(Et.error)&&Et.error.status===404){ot=null,Rr(ee,{matches:It.matches,loaderData:{},errors:{[_n]:Et.error}});return}}Ae=It.matches||Ae,Ve=It.pendingActionResult,Re=Zm(ee,ce.submission),nt=!1,Fe.active=!1,mt=ql(n.history,mt.url,mt.signal)}let{shortCircuited:at,matches:xt,loaderData:kt,errors:At}=await cn(mt,ee,Ae,Fe.active,Re,ce&&ce.submission,ce&&ce.fetcherSubmission,ce&&ce.replace,ce&&ce.initialHydration===!0,nt,Ve);at||(ot=null,Rr(ee,zn({matches:xt||Ae},W0(Ve),{loaderData:kt,errors:At})))}async function $t(H,ee,ce,xe,Re,Ae){Ae===void 0&&(Ae={}),br();let nt=uC(ee,ce);if(pn({navigation:nt},{flushSync:Ae.flushSync===!0}),Re){let Ve=await ie(xe,ee.pathname,H.signal);if(Ve.type==="aborted")return{shortCircuited:!0};if(Ve.type==="error"){let{boundaryId:at,error:xt}=L(ee.pathname,Ve);return{matches:Ve.partialMatches,pendingActionResult:[at,{type:un.error,error:xt}]}}else if(Ve.matches)xe=Ve.matches;else{let{notFoundMatches:at,error:xt,route:kt}=Q(ee.pathname);return{matches:at,pendingActionResult:[kt.id,{type:un.error,error:xt}]}}}let Fe,mt=Gc(xe,ee);if(!mt.route.action&&!mt.route.lazy)Fe={type:un.error,error:Hr(405,{method:H.method,pathname:ee.pathname,routeId:mt.route.id})};else if(Fe=(await di("action",H,[mt],xe))[0],H.signal.aborted)return{shortCircuited:!0};if(Ns(Fe)){let Ve;return Ae&&Ae.replace!=null?Ve=Ae.replace:Ve=Z0(Fe.response.headers.get("Location"),new URL(H.url),A)===pe.location.pathname+pe.location.search,await hi(H,Fe,{submission:ce,replace:Ve}),{shortCircuited:!0}}if(Os(Fe))throw Hr(400,{type:"defer-action"});if(Ii(Fe)){let Ve=ou(xe,mt.route.id);return(Ae&&Ae.replace)!==!0&&(dt=Kn.Push),{matches:xe,pendingActionResult:[Ve.route.id,Fe]}}return{matches:xe,pendingActionResult:[mt.route.id,Fe]}}async function cn(H,ee,ce,xe,Re,Ae,nt,Fe,mt,Ve,at){let xt=Re||Zm(ee,Ae),kt=Ae||nt||Q0(xt),At=!Rn&&(!j.v7_partialHydration||!mt);if(xe){if(At){let Gt=po(at);pn(zn({navigation:xt},Gt!==void 0?{actionData:Gt}:{}),{flushSync:Ve})}let yt=await ie(ce,ee.pathname,H.signal);if(yt.type==="aborted")return{shortCircuited:!0};if(yt.type==="error"){let{boundaryId:Gt,error:Pn}=L(ee.pathname,yt);return{matches:yt.partialMatches,loaderData:{},errors:{[Gt]:Pn}}}else if(yt.matches)ce=yt.matches;else{let{error:Gt,notFoundMatches:Pn,route:Pt}=Q(ee.pathname);return{matches:Pn,loaderData:{},errors:{[Pt.id]:Gt}}}}let It=c||v,[_n,Et]=V0(n.history,pe,ce,kt,ee,j.v7_partialHydration&&mt===!0,j.v7_skipActionErrorRevalidation,Hn,Un,rt,dn,yn,kn,It,A,at);if(R(yt=>!(ce&&ce.some(Gt=>Gt.route.id===yt))||_n&&_n.some(Gt=>Gt.route.id===yt)),Dt=++wt,_n.length===0&&Et.length===0){let yt=Sr();return Rr(ee,zn({matches:ce,loaderData:{},errors:at&&Ii(at[1])?{[at[0]]:at[1].error}:null},W0(at),yt?{fetchers:new Map(pe.fetchers)}:{}),{flushSync:Ve}),{shortCircuited:!0}}if(At){let yt={};if(!xe){yt.navigation=xt;let Gt=po(at);Gt!==void 0&&(yt.actionData=Gt)}Et.length>0&&(yt.fetchers=Ri(Et)),pn(yt,{flushSync:Ve})}Et.forEach(yt=>{ut.has(yt.key)&&gt(yt.key),yt.controller&&ut.set(yt.key,yt.controller)});let Ji=()=>Et.forEach(yt=>gt(yt.key));ot&&ot.signal.addEventListener("abort",Ji);let{loaderResults:Qr,fetcherResults:On}=await Ne(pe.matches,ce,_n,Et,H);if(H.signal.aborted)return{shortCircuited:!0};ot&&ot.signal.removeEventListener("abort",Ji),Et.forEach(yt=>ut.delete(yt.key));let Nn=K0([...Qr,...On]);if(Nn){if(Nn.idx>=_n.length){let yt=Et[Nn.idx-_n.length].key;kn.add(yt)}return await hi(H,Nn.result,{replace:Fe}),{shortCircuited:!0}}let{loaderData:mo,errors:mn}=H0(pe,ce,_n,Qr,at,Et,On,on);on.forEach((yt,Gt)=>{yt.subscribe(Pn=>{(Pn||yt.done)&&on.delete(Gt)})}),j.v7_partialHydration&&mt&&pe.errors&&Object.entries(pe.errors).filter(yt=>{let[Gt]=yt;return!_n.some(Pn=>Pn.route.id===Gt)}).forEach(yt=>{let[Gt,Pn]=yt;mn=Object.assign(mn||{},{[Gt]:Pn})});let In=Sr(),Yi=Tt(Dt),Fi=In||Yi||Et.length>0;return zn({matches:ce,loaderData:mo,errors:mn},Fi?{fetchers:new Map(pe.fetchers)}:{})}function po(H){if(H&&!Ii(H[1]))return{[H[0]]:H[1].data};if(pe.actionData)return Object.keys(pe.actionData).length===0?null:pe.actionData}function Ri(H){return H.forEach(ee=>{let ce=pe.fetchers.get(ee.key),xe=jc(void 0,ce?ce.data:void 0);pe.fetchers.set(ee.key,xe)}),new Map(pe.fetchers)}function ci(H,ee,ce,xe){if(p)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut.has(H)&&gt(H);let Re=(xe&&xe.unstable_flushSync)===!0,Ae=c||v,nt=jg(pe.location,pe.matches,A,j.v7_prependBasename,ce,j.v7_relativeSplatPath,ee,xe==null?void 0:xe.relative),Fe=Ls(Ae,nt,A),mt=me(Fe,Ae,nt);if(mt.active&&mt.matches&&(Fe=mt.matches),!Fe){Bn(H,ee,Hr(404,{pathname:nt}),{flushSync:Re});return}let{path:Ve,submission:at,error:xt}=j0(j.v7_normalizeFormMethod,!0,nt,xe);if(xt){Bn(H,ee,xt,{flushSync:Re});return}let kt=Gc(Fe,Ve);if(lt=(xe&&xe.preventScrollReset)===!0,at&&so(at.formMethod)){fo(H,ee,Ve,kt,Fe,mt.active,Re,at);return}yn.set(H,{routeId:ee,path:Ve}),wr(H,ee,Ve,kt,Fe,mt.active,Re,at)}async function fo(H,ee,ce,xe,Re,Ae,nt,Fe){br(),yn.delete(H);function mt(Pt){if(!Pt.route.action&&!Pt.route.lazy){let Tr=Hr(405,{method:Fe.formMethod,pathname:ce,routeId:ee});return Bn(H,ee,Tr,{flushSync:nt}),!0}return!1}if(!Ae&&mt(xe))return;let Ve=pe.fetchers.get(H);fn(H,cC(Fe,Ve),{flushSync:nt});let at=new AbortController,xt=ql(n.history,ce,at.signal,Fe);if(Ae){let Pt=await ie(Re,ce,xt.signal);if(Pt.type==="aborted")return;if(Pt.type==="error"){let{error:Tr}=L(ce,Pt);Bn(H,ee,Tr,{flushSync:nt});return}else if(Pt.matches){if(Re=Pt.matches,xe=Gc(Re,ce),mt(xe))return}else{Bn(H,ee,Hr(404,{pathname:ce}),{flushSync:nt});return}}ut.set(H,at);let kt=wt,It=(await di("action",xt,[xe],Re))[0];if(xt.signal.aborted){ut.get(H)===at&&ut.delete(H);return}if(j.v7_fetcherPersist&&dn.has(H)){if(Ns(It)||Ii(It)){fn(H,za(void 0));return}}else{if(Ns(It))if(ut.delete(H),Dt>kt){fn(H,za(void 0));return}else return kn.add(H),fn(H,jc(Fe)),hi(xt,It,{fetcherSubmission:Fe});if(Ii(It)){Bn(H,ee,It.error);return}}if(Os(It))throw Hr(400,{type:"defer-action"});let _n=pe.navigation.location||pe.location,Et=ql(n.history,_n,at.signal),Ji=c||v,Qr=pe.navigation.state!=="idle"?Ls(Ji,pe.navigation.location,A):pe.matches;Ut(Qr,"Didn't find any matches after fetcher action");let On=++wt;Nt.set(H,On);let Nn=jc(Fe,It.data);pe.fetchers.set(H,Nn);let[mo,mn]=V0(n.history,pe,Qr,Fe,_n,!1,j.v7_skipActionErrorRevalidation,Hn,Un,rt,dn,yn,kn,Ji,A,[xe.route.id,It]);mn.filter(Pt=>Pt.key!==H).forEach(Pt=>{let Tr=Pt.key,pr=pe.fetchers.get(Tr),Lo=jc(void 0,pr?pr.data:void 0);pe.fetchers.set(Tr,Lo),ut.has(Tr)&&gt(Tr),Pt.controller&&ut.set(Tr,Pt.controller)}),pn({fetchers:new Map(pe.fetchers)});let In=()=>mn.forEach(Pt=>gt(Pt.key));at.signal.addEventListener("abort",In);let{loaderResults:Yi,fetcherResults:Fi}=await Ne(pe.matches,Qr,mo,mn,Et);if(at.signal.aborted)return;at.signal.removeEventListener("abort",In),Nt.delete(H),ut.delete(H),mn.forEach(Pt=>ut.delete(Pt.key));let yt=K0([...Yi,...Fi]);if(yt){if(yt.idx>=mo.length){let Pt=mn[yt.idx-mo.length].key;kn.add(Pt)}return hi(Et,yt.result)}let{loaderData:Gt,errors:Pn}=H0(pe,pe.matches,mo,Yi,void 0,mn,Fi,on);if(pe.fetchers.has(H)){let Pt=za(It.data);pe.fetchers.set(H,Pt)}Tt(On),pe.navigation.state==="loading"&&On>Dt?(Ut(dt,"Expected pending action"),ot&&ot.abort(),Rr(pe.navigation.location,{matches:Qr,loaderData:Gt,errors:Pn,fetchers:new Map(pe.fetchers)})):(pn({errors:Pn,loaderData:G0(pe.loaderData,Gt,Qr,Pn),fetchers:new Map(pe.fetchers)}),Hn=!1)}async function wr(H,ee,ce,xe,Re,Ae,nt,Fe){let mt=pe.fetchers.get(H);fn(H,jc(Fe,mt?mt.data:void 0),{flushSync:nt});let Ve=new AbortController,at=ql(n.history,ce,Ve.signal);if(Ae){let It=await ie(Re,ce,at.signal);if(It.type==="aborted")return;if(It.type==="error"){let{error:_n}=L(ce,It);Bn(H,ee,_n,{flushSync:nt});return}else if(It.matches)Re=It.matches,xe=Gc(Re,ce);else{Bn(H,ee,Hr(404,{pathname:ce}),{flushSync:nt});return}}ut.set(H,Ve);let xt=wt,At=(await di("loader",at,[xe],Re))[0];if(Os(At)&&(At=await Ow(At,at.signal,!0)||At),ut.get(H)===Ve&&ut.delete(H),!at.signal.aborted){if(dn.has(H)){fn(H,za(void 0));return}if(Ns(At))if(Dt>xt){fn(H,za(void 0));return}else{kn.add(H),await hi(at,At);return}if(Ii(At)){Bn(H,ee,At.error);return}Ut(!Os(At),"Unhandled fetcher deferred data"),fn(H,za(At.data))}}async function hi(H,ee,ce){let{submission:xe,fetcherSubmission:Re,replace:Ae}=ce===void 0?{}:ce;ee.response.headers.has("X-Remix-Revalidate")&&(Hn=!0);let nt=ee.response.headers.get("Location");Ut(nt,"Expected a Location header on the redirect Response"),nt=Z0(nt,new URL(H.url),A);let Fe=xh(pe.location,nt,{_isRedirect:!0});if(l){let At=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))At=!0;else if(jy.test(nt)){const It=n.history.createURL(nt);At=It.origin!==i.location.origin||Su(It.pathname,A)==null}if(At){Ae?i.location.replace(nt):i.location.assign(nt);return}}ot=null;let mt=Ae===!0||ee.response.headers.has("X-Remix-Replace")?Kn.Replace:Kn.Push,{formMethod:Ve,formAction:at,formEncType:xt}=pe.navigation;!xe&&!Re&&Ve&&at&&xt&&(xe=Q0(pe.navigation));let kt=xe||Re;if(ZE.has(ee.response.status)&&kt&&so(kt.formMethod))await Fr(mt,Fe,{submission:zn({},kt,{formAction:nt}),preventScrollReset:lt});else{let At=Zm(Fe,xe);await Fr(mt,Fe,{overrideNavigation:At,fetcherSubmission:Re,preventScrollReset:lt})}}async function di(H,ee,ce,xe){try{let Re=await QE(V,H,ee,ce,xe,w,_);return await Promise.all(Re.map((Ae,nt)=>{if(aC(Ae)){let Fe=Ae.result;return{type:un.redirect,response:nC(Fe,ee,ce[nt].route.id,xe,A,j.v7_relativeSplatPath)}}return tC(Ae)}))}catch(Re){return ce.map(()=>({type:un.error,error:Re}))}}async function Ne(H,ee,ce,xe,Re){let[Ae,...nt]=await Promise.all([ce.length?di("loader",Re,ce,ee):[],...xe.map(Fe=>{if(Fe.matches&&Fe.match&&Fe.controller){let mt=ql(n.history,Fe.path,Fe.controller.signal);return di("loader",mt,[Fe.match],Fe.matches).then(Ve=>Ve[0])}else return Promise.resolve({type:un.error,error:Hr(404,{pathname:Fe.path})})})]);return await Promise.all([Y0(H,ce,Ae,Ae.map(()=>Re.signal),!1,pe.loaderData),Y0(H,xe.map(Fe=>Fe.match),nt,xe.map(Fe=>Fe.controller?Fe.controller.signal:null),!0)]),{loaderResults:Ae,fetcherResults:nt}}function br(){Hn=!0,Un.push(...R()),yn.forEach((H,ee)=>{ut.has(ee)&&(rt.add(ee),gt(ee))})}function fn(H,ee,ce){ce===void 0&&(ce={}),pe.fetchers.set(H,ee),pn({fetchers:new Map(pe.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function Bn(H,ee,ce,xe){xe===void 0&&(xe={});let Re=ou(pe.matches,ee);Ue(H),pn({errors:{[Re.route.id]:ce},fetchers:new Map(pe.fetchers)},{flushSync:(xe&&xe.flushSync)===!0})}function pi(H){return j.v7_fetcherPersist&&(Fn.set(H,(Fn.get(H)||0)+1),dn.has(H)&&dn.delete(H)),pe.fetchers.get(H)||qE}function Ue(H){let ee=pe.fetchers.get(H);ut.has(H)&&!(ee&&ee.state==="loading"&&Nt.has(H))&&gt(H),yn.delete(H),Nt.delete(H),kn.delete(H),dn.delete(H),rt.delete(H),pe.fetchers.delete(H)}function Mt(H){if(j.v7_fetcherPersist){let ee=(Fn.get(H)||0)-1;ee<=0?(Fn.delete(H),dn.add(H)):Fn.set(H,ee)}else Ue(H);pn({fetchers:new Map(pe.fetchers)})}function gt(H){let ee=ut.get(H);Ut(ee,"Expected fetch controller: "+H),ee.abort(),ut.delete(H)}function Yn(H){for(let ee of H){let ce=pi(ee),xe=za(ce.data);pe.fetchers.set(ee,xe)}}function Sr(){let H=[],ee=!1;for(let ce of kn){let xe=pe.fetchers.get(ce);Ut(xe,"Expected fetcher: "+ce),xe.state==="loading"&&(kn.delete(ce),H.push(ce),ee=!0)}return Yn(H),ee}function Tt(H){let ee=[];for(let[ce,xe]of Nt)if(xe<H){let Re=pe.fetchers.get(ce);Ut(Re,"Expected fetcher: "+ce),Re.state==="loading"&&(gt(ce),Nt.delete(ce),ee.push(ce))}return Yn(ee),ee.length>0}function Jr(H,ee){let ce=pe.blockers.get(H)||Nc;return $n.get(H)!==ee&&$n.set(H,ee),ce}function Yr(H){pe.blockers.delete(H),$n.delete(H)}function Br(H,ee){let ce=pe.blockers.get(H)||Nc;Ut(ce.state==="unblocked"&&ee.state==="blocked"||ce.state==="blocked"&&ee.state==="blocked"||ce.state==="blocked"&&ee.state==="proceeding"||ce.state==="blocked"&&ee.state==="unblocked"||ce.state==="proceeding"&&ee.state==="unblocked","Invalid blocker state transition: "+ce.state+" -> "+ee.state);let xe=new Map(pe.blockers);xe.set(H,ee),pn({blockers:xe})}function Or(H){let{currentLocation:ee,nextLocation:ce,historyAction:xe}=H;if($n.size===0)return;$n.size>1&&Gs(!1,"A router only supports one blocker at a time");let Re=Array.from($n.entries()),[Ae,nt]=Re[Re.length-1],Fe=pe.blockers.get(Ae);if(!(Fe&&Fe.state==="proceeding")&&nt({currentLocation:ee,nextLocation:ce,historyAction:xe}))return Ae}function Q(H){let ee=Hr(404,{pathname:H}),ce=c||v,{matches:xe,route:Re}=X0(ce);return R(),{notFoundMatches:xe,route:Re,error:ee}}function L(H,ee){return{boundaryId:ou(ee.partialMatches).route.id,error:Hr(400,{type:"route-discovery",pathname:H,message:ee.error!=null&&"message"in ee.error?ee.error:String(ee.error)})}}function R(H){let ee=[];return on.forEach((ce,xe)=>{(!H||H(xe))&&(ce.cancel(),ee.push(xe),on.delete(xe))}),ee}function $(H,ee,ce){if(Ze=H,re=ee,oe=ce||null,!ue&&pe.navigation===$m){ue=!0;let xe=he(pe.location,pe.matches);xe!=null&&pn({restoreScrollPosition:xe})}return()=>{Ze=null,re=null,oe=null}}function X(H,ee){return oe&&oe(H,ee.map(xe=>bE(xe,pe.loaderData)))||H.key}function se(H,ee){if(Ze&&re){let ce=X(H,ee);Ze[ce]=re()}}function he(H,ee){if(Ze){let ce=X(H,ee),xe=Ze[ce];if(typeof xe=="number")return xe}return null}function me(H,ee,ce){if(W){if(be.has(ce))return{active:!1,matches:H};if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:up(ee,ce,A,!0)}}else return{active:!0,matches:up(ee,ce,A,!0)||[]}}return{active:!1,matches:null}}async function ie(H,ee,ce){let xe=H;for(;;){let Re=c==null,Ae=c||v;try{await JE(W,ee,xe,Ae,w,_,Xi,ce)}catch(mt){return{type:"error",error:mt,partialMatches:xe}}finally{Re&&(v=[...v])}if(ce.aborted)return{type:"aborted"};let nt=Ls(Ae,ee,A);if(nt)return Te(ee,be),{type:"success",matches:nt};let Fe=up(Ae,ee,A,!0);if(!Fe||xe.length===Fe.length&&xe.every((mt,Ve)=>mt.route.id===Fe[Ve].route.id))return Te(ee,be),{type:"success",matches:null};xe=Fe}}function Te(H,ee){if(ee.size>=Se){let ce=ee.values().next().value;ee.delete(ce)}ee.add(H)}function ze(H){w={},c=wh(H,_,void 0,w)}function ve(H,ee){let ce=c==null;Rw(H,ee,c||v,w,_),ce&&(v=[...v],pn({}))}return Qe={get basename(){return A},get future(){return j},get state(){return pe},get routes(){return v},get window(){return i},initialize:Do,subscribe:Li,enableScrollRestoration:$,navigate:we,fetch:ci,revalidate:Ki,createHref:H=>n.history.createHref(H),encodeLocation:H=>n.history.encodeLocation(H),getFetcher:pi,deleteFetcher:Mt,dispose:ui,getBlocker:Jr,deleteBlocker:Yr,patchRoutes:ve,_internalFetchControllers:ut,_internalActiveDeferreds:on,_internalSetRoutes:ze},Qe}function WE(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function jg(n,i,l,p,_,w,v,c){let A,V;if(v){A=[];for(let j of i)if(A.push(j),j.route.id===v){V=j;break}}else A=i,V=i[i.length-1];let W=Ny(_||".",Oy(A,w),Su(n.pathname,l)||n.pathname,c==="path");return _==null&&(W.search=n.search,W.hash=n.hash),(_==null||_===""||_===".")&&V&&V.route.index&&!Vy(W.search)&&(W.search=W.search?W.search.replace(/^\?/,"?index&"):"?index"),p&&l!=="/"&&(W.pathname=W.pathname==="/"?l:na([l,W.pathname])),Ws(W)}function j0(n,i,l,p){if(!p||!WE(p))return{path:l};if(p.formMethod&&!lC(p.formMethod))return{path:l,error:Hr(405,{method:p.formMethod})};let _=()=>({path:l,error:Hr(400,{type:"invalid-body"})}),w=p.formMethod||"get",v=n?w.toUpperCase():w.toLowerCase(),c=Fw(l);if(p.body!==void 0){if(p.formEncType==="text/plain"){if(!so(v))return _();let N=typeof p.body=="string"?p.body:p.body instanceof FormData||p.body instanceof URLSearchParams?Array.from(p.body.entries()).reduce((ke,Se)=>{let[be,Ze]=Se;return""+ke+be+"="+Ze+`
`},""):String(p.body);return{path:l,submission:{formMethod:v,formAction:c,formEncType:p.formEncType,formData:void 0,json:void 0,text:N}}}else if(p.formEncType==="application/json"){if(!so(v))return _();try{let N=typeof p.body=="string"?JSON.parse(p.body):p.body;return{path:l,submission:{formMethod:v,formAction:c,formEncType:p.formEncType,formData:void 0,json:N,text:void 0}}}catch{return _()}}}Ut(typeof FormData=="function","FormData is not available in this environment");let A,V;if(p.formData)A=Vg(p.formData),V=p.formData;else if(p.body instanceof FormData)A=Vg(p.body),V=p.body;else if(p.body instanceof URLSearchParams)A=p.body,V=q0(A);else if(p.body==null)A=new URLSearchParams,V=new FormData;else try{A=new URLSearchParams(p.body),V=q0(A)}catch{return _()}let W={formMethod:v,formAction:c,formEncType:p&&p.formEncType||"application/x-www-form-urlencoded",formData:V,json:void 0,text:void 0};if(so(W.formMethod))return{path:l,submission:W};let j=la(l);return i&&j.search&&Vy(j.search)&&A.append("index",""),j.search="?"+A,{path:Ws(j),submission:W}}function XE(n,i){let l=n;if(i){let p=n.findIndex(_=>_.route.id===i);p>=0&&(l=n.slice(0,p))}return l}function V0(n,i,l,p,_,w,v,c,A,V,W,j,N,ke,Se,be){let Ze=be?Ii(be[1])?be[1].error:be[1].data:void 0,oe=n.createURL(i.location),re=n.createURL(_),ue=be&&Ii(be[1])?be[0]:void 0,Ce=ue?XE(l,ue):l,Le=be?be[1].statusCode:void 0,Xe=v&&Le&&Le>=400,Qe=Ce.filter((dt,lt)=>{let{route:ot}=dt;if(ot.lazy)return!0;if(ot.loader==null)return!1;if(w)return typeof ot.loader!="function"||ot.loader.hydrate?!0:i.loaderData[ot.id]===void 0&&(!i.errors||i.errors[ot.id]===void 0);if(KE(i.loaderData,i.matches[lt],dt)||A.some(Ft=>Ft===dt.route.id))return!0;let Xt=i.matches[lt],Ot=dt;return U0(dt,zn({currentUrl:oe,currentParams:Xt.params,nextUrl:re,nextParams:Ot.params},p,{actionResult:Ze,actionStatus:Le,defaultShouldRevalidate:Xe?!1:c||oe.pathname+oe.search===re.pathname+re.search||oe.search!==re.search||Lw(Xt,Ot)}))}),pe=[];return j.forEach((dt,lt)=>{if(w||!l.some(Rn=>Rn.route.id===dt.routeId)||W.has(lt))return;let ot=Ls(ke,dt.path,Se);if(!ot){pe.push({key:lt,routeId:dt.routeId,path:dt.path,matches:null,match:null,controller:null});return}let Xt=i.fetchers.get(lt),Ot=Gc(ot,dt.path),Ft=!1;N.has(lt)?Ft=!1:V.has(lt)?(V.delete(lt),Ft=!0):Xt&&Xt.state!=="idle"&&Xt.data===void 0?Ft=c:Ft=U0(Ot,zn({currentUrl:oe,currentParams:i.matches[i.matches.length-1].params,nextUrl:re,nextParams:l[l.length-1].params},p,{actionResult:Ze,actionStatus:Le,defaultShouldRevalidate:Xe?!1:c})),Ft&&pe.push({key:lt,routeId:dt.routeId,path:dt.path,matches:ot,match:Ot,controller:new AbortController})}),[Qe,pe]}function KE(n,i,l){let p=!i||l.route.id!==i.route.id,_=n[l.route.id]===void 0;return p||_}function Lw(n,i){let l=n.route.path;return n.pathname!==i.pathname||l!=null&&l.endsWith("*")&&n.params["*"]!==i.params["*"]}function U0(n,i){if(n.route.shouldRevalidate){let l=n.route.shouldRevalidate(i);if(typeof l=="boolean")return l}return i.defaultShouldRevalidate}async function JE(n,i,l,p,_,w,v,c){let A=[i,...l.map(V=>V.route.id)].join("-");try{let V=v.get(A);V||(V=n({path:i,matches:l,patch:(W,j)=>{c.aborted||Rw(W,j,p,_,w)}}),v.set(A,V)),V&&oC(V)&&await V}finally{v.delete(A)}}function Rw(n,i,l,p,_){if(n){var w;let v=p[n];Ut(v,"No route found to patch children into: routeId = "+n);let c=wh(i,_,[n,"patch",String(((w=v.children)==null?void 0:w.length)||"0")],p);v.children?v.children.push(...c):v.children=c}else{let v=wh(i,_,["patch",String(l.length||"0")],p);l.push(...v)}}async function $0(n,i,l){if(!n.lazy)return;let p=await n.lazy();if(!n.lazy)return;let _=l[n.id];Ut(_,"No route found in manifest");let w={};for(let v in p){let A=_[v]!==void 0&&v!=="hasErrorBoundary";Gs(!A,'Route "'+_.id+'" has a static property "'+v+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+v+'" will be ignored.')),!A&&!xE.has(v)&&(w[v]=p[v])}Object.assign(_,w),Object.assign(_,zn({},i(_),{lazy:void 0}))}function YE(n){return Promise.all(n.matches.map(i=>i.resolve()))}async function QE(n,i,l,p,_,w,v,c){let A=p.reduce((j,N)=>j.add(N.route.id),new Set),V=new Set,W=await n({matches:_.map(j=>{let N=A.has(j.route.id);return zn({},j,{shouldLoad:N,resolve:Se=>(V.add(j.route.id),N?eC(i,l,j,w,v,Se,c):Promise.resolve({type:un.data,result:void 0}))})}),request:l,params:_[0].params,context:c});return _.forEach(j=>Ut(V.has(j.route.id),'`match.resolve()` was not called for route id "'+j.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),W.filter((j,N)=>A.has(_[N].route.id))}async function eC(n,i,l,p,_,w,v){let c,A,V=W=>{let j,N=new Promise((be,Ze)=>j=Ze);A=()=>j(),i.signal.addEventListener("abort",A);let ke=be=>typeof W!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+n+'" [routeId: '+l.route.id+"]"))):W({request:i,params:l.params,context:v},...be!==void 0?[be]:[]),Se;return w?Se=w(be=>ke(be)):Se=(async()=>{try{return{type:"data",result:await ke()}}catch(be){return{type:"error",result:be}}})(),Promise.race([Se,N])};try{let W=l.route[n];if(l.route.lazy)if(W){let j,[N]=await Promise.all([V(W).catch(ke=>{j=ke}),$0(l.route,_,p)]);if(j!==void 0)throw j;c=N}else if(await $0(l.route,_,p),W=l.route[n],W)c=await V(W);else if(n==="action"){let j=new URL(i.url),N=j.pathname+j.search;throw Hr(405,{method:i.method,pathname:N,routeId:l.route.id})}else return{type:un.data,result:void 0};else if(W)c=await V(W);else{let j=new URL(i.url),N=j.pathname+j.search;throw Hr(404,{pathname:N})}Ut(c.result!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+l.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(W){return{type:un.error,result:W}}finally{A&&i.signal.removeEventListener("abort",A)}return c}async function tC(n){let{result:i,type:l}=n;if(Bw(i)){let V;try{let W=i.headers.get("Content-Type");W&&/\bapplication\/json\b/.test(W)?i.body==null?V=null:V=await i.json():V=await i.text()}catch(W){return{type:un.error,error:W}}return l===un.error?{type:un.error,error:new Lp(i.status,i.statusText,V),statusCode:i.status,headers:i.headers}:{type:un.data,data:V,statusCode:i.status,headers:i.headers}}if(l===un.error){if(J0(i)){var p;if(i.data instanceof Error){var _;return{type:un.error,error:i.data,statusCode:(_=i.init)==null?void 0:_.status}}i=new Lp(((p=i.init)==null?void 0:p.status)||500,void 0,i.data)}return{type:un.error,error:i,statusCode:Qp(i)?i.status:void 0}}if(sC(i)){var w,v;return{type:un.deferred,deferredData:i,statusCode:(w=i.init)==null?void 0:w.status,headers:((v=i.init)==null?void 0:v.headers)&&new Headers(i.init.headers)}}if(J0(i)){var c,A;return{type:un.data,data:i.data,statusCode:(c=i.init)==null?void 0:c.status,headers:(A=i.init)!=null&&A.headers?new Headers(i.init.headers):void 0}}return{type:un.data,data:i}}function nC(n,i,l,p,_,w){let v=n.headers.get("Location");if(Ut(v,"Redirects returned/thrown from loaders/actions must have a Location header"),!jy.test(v)){let c=p.slice(0,p.findIndex(A=>A.route.id===l)+1);v=jg(new URL(i.url),c,_,!0,v,w),n.headers.set("Location",v)}return n}function Z0(n,i,l){if(jy.test(n)){let p=n,_=p.startsWith("//")?new URL(i.protocol+p):new URL(p),w=Su(_.pathname,l)!=null;if(_.origin===i.origin&&w)return _.pathname+_.search+_.hash}return n}function ql(n,i,l,p){let _=n.createURL(Fw(i)).toString(),w={signal:l};if(p&&so(p.formMethod)){let{formMethod:v,formEncType:c}=p;w.method=v.toUpperCase(),c==="application/json"?(w.headers=new Headers({"Content-Type":c}),w.body=JSON.stringify(p.json)):c==="text/plain"?w.body=p.text:c==="application/x-www-form-urlencoded"&&p.formData?w.body=Vg(p.formData):w.body=p.formData}return new Request(_,w)}function Vg(n){let i=new URLSearchParams;for(let[l,p]of n.entries())i.append(l,typeof p=="string"?p:p.name);return i}function q0(n){let i=new FormData;for(let[l,p]of n.entries())i.append(l,p);return i}function rC(n,i,l,p,_,w){let v={},c=null,A,V=!1,W={},j=p&&Ii(p[1])?p[1].error:void 0;return l.forEach((N,ke)=>{let Se=i[ke].route.id;if(Ut(!Ns(N),"Cannot handle redirect results in processLoaderData"),Ii(N)){let be=N.error;j!==void 0&&(be=j,j=void 0),c=c||{};{let Ze=ou(n,Se);c[Ze.route.id]==null&&(c[Ze.route.id]=be)}v[Se]=void 0,V||(V=!0,A=Qp(N.error)?N.error.status:500),N.headers&&(W[Se]=N.headers)}else Os(N)?(_.set(Se,N.deferredData),v[Se]=N.deferredData.data,N.statusCode!=null&&N.statusCode!==200&&!V&&(A=N.statusCode),N.headers&&(W[Se]=N.headers)):(v[Se]=N.data,N.statusCode&&N.statusCode!==200&&!V&&(A=N.statusCode),N.headers&&(W[Se]=N.headers))}),j!==void 0&&p&&(c={[p[0]]:j},v[p[0]]=void 0),{loaderData:v,errors:c,statusCode:A||200,loaderHeaders:W}}function H0(n,i,l,p,_,w,v,c){let{loaderData:A,errors:V}=rC(i,l,p,_,c);for(let W=0;W<w.length;W++){let{key:j,match:N,controller:ke}=w[W];Ut(v!==void 0&&v[W]!==void 0,"Did not find corresponding fetcher result");let Se=v[W];if(!(ke&&ke.signal.aborted))if(Ii(Se)){let be=ou(n.matches,N==null?void 0:N.route.id);V&&V[be.route.id]||(V=zn({},V,{[be.route.id]:Se.error})),n.fetchers.delete(j)}else if(Ns(Se))Ut(!1,"Unhandled fetcher revalidation redirect");else if(Os(Se))Ut(!1,"Unhandled fetcher deferred data");else{let be=za(Se.data);n.fetchers.set(j,be)}}return{loaderData:A,errors:V}}function G0(n,i,l,p){let _=zn({},i);for(let w of l){let v=w.route.id;if(i.hasOwnProperty(v)?i[v]!==void 0&&(_[v]=i[v]):n[v]!==void 0&&w.route.loader&&(_[v]=n[v]),p&&p.hasOwnProperty(v))break}return _}function W0(n){return n?Ii(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function ou(n,i){return(i?n.slice(0,n.findIndex(p=>p.route.id===i)+1):[...n]).reverse().find(p=>p.route.hasErrorBoundary===!0)||n[0]}function X0(n){let i=n.length===1?n[0]:n.find(l=>l.index||!l.path||l.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:i}],route:i}}function Hr(n,i){let{pathname:l,routeId:p,method:_,type:w,message:v}=i===void 0?{}:i,c="Unknown Server Error",A="Unknown @remix-run/router error";return n===400?(c="Bad Request",w==="route-discovery"?A='Unable to match URL "'+l+'" - the `unstable_patchRoutesOnNavigation()` '+(`function threw the following error:
`+v):_&&l&&p?A="You made a "+_+' request to "'+l+'" but '+('did not provide a `loader` for route "'+p+'", ')+"so there is no way to handle the request.":w==="defer-action"?A="defer() is not supported in actions":w==="invalid-body"&&(A="Unable to encode submission body")):n===403?(c="Forbidden",A='Route "'+p+'" does not match URL "'+l+'"'):n===404?(c="Not Found",A='No route matches URL "'+l+'"'):n===405&&(c="Method Not Allowed",_&&l&&p?A="You made a "+_.toUpperCase()+' request to "'+l+'" but '+('did not provide an `action` for route "'+p+'", ')+"so there is no way to handle the request.":_&&(A='Invalid request method "'+_.toUpperCase()+'"')),new Lp(n||500,c,new Error(A),!0)}function K0(n){for(let i=n.length-1;i>=0;i--){let l=n[i];if(Ns(l))return{result:l,idx:i}}}function Fw(n){let i=typeof n=="string"?la(n):n;return Ws(zn({},i,{hash:""}))}function iC(n,i){return n.pathname!==i.pathname||n.search!==i.search?!1:n.hash===""?i.hash!=="":n.hash===i.hash?!0:i.hash!==""}function oC(n){return typeof n=="object"&&n!=null&&"then"in n}function aC(n){return Bw(n.result)&&$E.has(n.result.status)}function Os(n){return n.type===un.deferred}function Ii(n){return n.type===un.error}function Ns(n){return(n&&n.type)===un.redirect}function J0(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function sC(n){let i=n;return i&&typeof i=="object"&&typeof i.data=="object"&&typeof i.subscribe=="function"&&typeof i.cancel=="function"&&typeof i.resolveData=="function"}function Bw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function lC(n){return UE.has(n.toLowerCase())}function so(n){return jE.has(n.toLowerCase())}async function Y0(n,i,l,p,_,w){for(let v=0;v<l.length;v++){let c=l[v],A=i[v];if(!A)continue;let V=n.find(j=>j.route.id===A.route.id),W=V!=null&&!Lw(V,A)&&(w&&w[A.route.id])!==void 0;if(Os(c)&&(_||W)){let j=p[v];Ut(j,"Expected an AbortSignal for revalidating fetcher deferred result"),await Ow(c,j,_).then(N=>{N&&(l[v]=N||l[v])})}}}async function Ow(n,i,l){if(l===void 0&&(l=!1),!await n.deferredData.resolveData(i)){if(l)try{return{type:un.data,data:n.deferredData.unwrappedData}}catch(_){return{type:un.error,error:_}}return{type:un.data,data:n.deferredData.data}}}function Vy(n){return new URLSearchParams(n).getAll("index").some(i=>i==="")}function Gc(n,i){let l=typeof i=="string"?la(i).search:i.search;if(n[n.length-1].route.index&&Vy(l||""))return n[n.length-1];let p=zw(n);return p[p.length-1]}function Q0(n){let{formMethod:i,formAction:l,formEncType:p,text:_,formData:w,json:v}=n;if(!(!i||!l||!p)){if(_!=null)return{formMethod:i,formAction:l,formEncType:p,formData:void 0,json:void 0,text:_};if(w!=null)return{formMethod:i,formAction:l,formEncType:p,formData:w,json:void 0,text:void 0};if(v!==void 0)return{formMethod:i,formAction:l,formEncType:p,formData:void 0,json:v,text:void 0}}}function Zm(n,i){return i?{state:"loading",location:n,formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function uC(n,i){return{state:"submitting",location:n,formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text}}function jc(n,i){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:i}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:i}}function cC(n,i){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:i?i.data:void 0}}function za(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function hC(n,i){try{let l=n.sessionStorage.getItem(Dw);if(l){let p=JSON.parse(l);for(let[_,w]of Object.entries(p||{}))w&&Array.isArray(w)&&i.set(_,new Set(w||[]))}}catch{}}function dC(n,i){if(i.size>0){let l={};for(let[p,_]of i)l[p]=[..._];try{n.sessionStorage.setItem(Dw,JSON.stringify(l))}catch(p){Gs(!1,"Failed to save applied view transitions in sessionStorage ("+p+").")}}}/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rp(){return Rp=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(n[p]=l[p])}return n},Rp.apply(this,arguments)}const ef=Ie.createContext(null),Nw=Ie.createContext(null),Js=Ie.createContext(null),Uy=Ie.createContext(null),Ja=Ie.createContext({outlet:null,matches:[],isDataRoute:!1}),jw=Ie.createContext(null);function pC(n,i){let{relative:l}=i===void 0?{}:i;Ph()||Ut(!1);let{basename:p,navigator:_}=Ie.useContext(Js),{hash:w,pathname:v,search:c}=Uw(n,{relative:l}),A=v;return p!=="/"&&(A=v==="/"?p:na([p,v])),_.createHref({pathname:A,search:c,hash:w})}function Ph(){return Ie.useContext(Uy)!=null}function tf(){return Ph()||Ut(!1),Ie.useContext(Uy).location}function Vw(n){Ie.useContext(Js).static||Ie.useLayoutEffect(n)}function fC(){let{isDataRoute:n}=Ie.useContext(Ja);return n?IC():mC()}function mC(){Ph()||Ut(!1);let n=Ie.useContext(ef),{basename:i,future:l,navigator:p}=Ie.useContext(Js),{matches:_}=Ie.useContext(Ja),{pathname:w}=tf(),v=JSON.stringify(Oy(_,l.v7_relativeSplatPath)),c=Ie.useRef(!1);return Vw(()=>{c.current=!0}),Ie.useCallback(function(V,W){if(W===void 0&&(W={}),!c.current)return;if(typeof V=="number"){p.go(V);return}let j=Ny(V,JSON.parse(v),w,W.relative==="path");n==null&&i!=="/"&&(j.pathname=j.pathname==="/"?i:na([i,j.pathname])),(W.replace?p.replace:p.push)(j,W.state,W)},[i,p,v,w,n])}const gC=Ie.createContext(null);function yC(n){let i=Ie.useContext(Ja).outlet;return i&&Ie.createElement(gC.Provider,{value:n},i)}function Uw(n,i){let{relative:l}=i===void 0?{}:i,{future:p}=Ie.useContext(Js),{matches:_}=Ie.useContext(Ja),{pathname:w}=tf(),v=JSON.stringify(Oy(_,p.v7_relativeSplatPath));return Ie.useMemo(()=>Ny(n,JSON.parse(v),w,l==="path"),[n,v,w,l])}function _C(n,i,l,p){Ph()||Ut(!1);let{navigator:_}=Ie.useContext(Js),{matches:w}=Ie.useContext(Ja),v=w[w.length-1],c=v?v.params:{};v&&v.pathname;let A=v?v.pathnameBase:"/";v&&v.route;let V=tf(),W;W=V;let j=W.pathname||"/",N=j;if(A!=="/"){let be=A.replace(/^\//,"").split("/");N="/"+j.replace(/^\//,"").split("/").slice(be.length).join("/")}let ke=Ls(n,{pathname:N});return SC(ke&&ke.map(be=>Object.assign({},be,{params:Object.assign({},c,be.params),pathname:na([A,_.encodeLocation?_.encodeLocation(be.pathname).pathname:be.pathname]),pathnameBase:be.pathnameBase==="/"?A:na([A,_.encodeLocation?_.encodeLocation(be.pathnameBase).pathname:be.pathnameBase])})),w,l,p)}function vC(){let n=kC(),i=Qp(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),l=n instanceof Error?n.stack:null,_={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ie.createElement(Ie.Fragment,null,Ie.createElement("h2",null,"Unexpected Application Error!"),Ie.createElement("h3",{style:{fontStyle:"italic"}},i),l?Ie.createElement("pre",{style:_},l):null,null)}const xC=Ie.createElement(vC,null);class wC extends Ie.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,l){return l.location!==i.location||l.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:l.error,location:l.location,revalidation:i.revalidation||l.revalidation}}componentDidCatch(i,l){console.error("React Router caught the following error during render",i,l)}render(){return this.state.error!==void 0?Ie.createElement(Ja.Provider,{value:this.props.routeContext},Ie.createElement(jw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bC(n){let{routeContext:i,match:l,children:p}=n,_=Ie.useContext(ef);return _&&_.static&&_.staticContext&&(l.route.errorElement||l.route.ErrorBoundary)&&(_.staticContext._deepestRenderedBoundaryId=l.route.id),Ie.createElement(Ja.Provider,{value:i},p)}function SC(n,i,l,p){var _;if(i===void 0&&(i=[]),l===void 0&&(l=null),p===void 0&&(p=null),n==null){var w;if(!l)return null;if(l.errors)n=l.matches;else if((w=p)!=null&&w.v7_partialHydration&&i.length===0&&!l.initialized&&l.matches.length>0)n=l.matches;else return null}let v=n,c=(_=l)==null?void 0:_.errors;if(c!=null){let W=v.findIndex(j=>j.route.id&&(c==null?void 0:c[j.route.id])!==void 0);W>=0||Ut(!1),v=v.slice(0,Math.min(v.length,W+1))}let A=!1,V=-1;if(l&&p&&p.v7_partialHydration)for(let W=0;W<v.length;W++){let j=v[W];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(V=W),j.route.id){let{loaderData:N,errors:ke}=l,Se=j.route.loader&&N[j.route.id]===void 0&&(!ke||ke[j.route.id]===void 0);if(j.route.lazy||Se){A=!0,V>=0?v=v.slice(0,V+1):v=[v[0]];break}}}return v.reduceRight((W,j,N)=>{let ke,Se=!1,be=null,Ze=null;l&&(ke=c&&j.route.id?c[j.route.id]:void 0,be=j.route.errorElement||xC,A&&(V<0&&N===0?(PC("route-fallback"),Se=!0,Ze=null):V===N&&(Se=!0,Ze=j.route.hydrateFallbackElement||null)));let oe=i.concat(v.slice(0,N+1)),re=()=>{let ue;return ke?ue=be:Se?ue=Ze:j.route.Component?ue=Ie.createElement(j.route.Component,null):j.route.element?ue=j.route.element:ue=W,Ie.createElement(bC,{match:j,routeContext:{outlet:W,matches:oe,isDataRoute:l!=null},children:ue})};return l&&(j.route.ErrorBoundary||j.route.errorElement||N===0)?Ie.createElement(wC,{location:l.location,revalidation:l.revalidation,component:be,error:ke,children:re(),routeContext:{outlet:null,matches:oe,isDataRoute:!0}}):re()},null)}var $w=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}($w||{}),Fp=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Fp||{});function TC(n){let i=Ie.useContext(ef);return i||Ut(!1),i}function EC(n){let i=Ie.useContext(Nw);return i||Ut(!1),i}function CC(n){let i=Ie.useContext(Ja);return i||Ut(!1),i}function Zw(n){let i=CC(),l=i.matches[i.matches.length-1];return l.route.id||Ut(!1),l.route.id}function kC(){var n;let i=Ie.useContext(jw),l=EC(Fp.UseRouteError),p=Zw(Fp.UseRouteError);return i!==void 0?i:(n=l.errors)==null?void 0:n[p]}function IC(){let{router:n}=TC($w.UseNavigateStable),i=Zw(Fp.UseNavigateStable),l=Ie.useRef(!1);return Vw(()=>{l.current=!0}),Ie.useCallback(function(_,w){w===void 0&&(w={}),l.current&&(typeof _=="number"?n.navigate(_):n.navigate(_,Rp({fromRouteId:i},w)))},[n,i])}const ex={};function PC(n,i,l){ex[n]||(ex[n]=!0)}function MC(n){return yC(n.context)}function zC(n){let{basename:i="/",children:l=null,location:p,navigationType:_=Kn.Pop,navigator:w,static:v=!1,future:c}=n;Ph()&&Ut(!1);let A=i.replace(/^\/*/,"/"),V=Ie.useMemo(()=>({basename:A,navigator:w,static:v,future:Rp({v7_relativeSplatPath:!1},c)}),[A,c,w,v]);typeof p=="string"&&(p=la(p));let{pathname:W="/",search:j="",hash:N="",state:ke=null,key:Se="default"}=p,be=Ie.useMemo(()=>{let Ze=Su(W,A);return Ze==null?null:{location:{pathname:Ze,search:j,hash:N,state:ke,key:Se},navigationType:_}},[A,W,j,N,ke,Se,_]);return be==null?null:Ie.createElement(Js.Provider,{value:V},Ie.createElement(Uy.Provider,{children:l,value:be}))}new Promise(()=>{});function AC(n){let i={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(i,{element:Ie.createElement(n.Component),Component:void 0}),n.HydrateFallback&&Object.assign(i,{hydrateFallbackElement:Ie.createElement(n.HydrateFallback),HydrateFallback:void 0}),n.ErrorBoundary&&Object.assign(i,{errorElement:Ie.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),i}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bh(){return bh=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(n[p]=l[p])}return n},bh.apply(this,arguments)}function DC(n,i){if(n==null)return{};var l={},p=Object.keys(n),_,w;for(w=0;w<p.length;w++)_=p[w],!(i.indexOf(_)>=0)&&(l[_]=n[_]);return l}function LC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function RC(n,i){return n.button===0&&(!i||i==="_self")&&!LC(n)}const FC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],BC="6";try{window.__reactRouterVersion=BC}catch{}function OC(n,i){return GE({basename:void 0,future:bh({},void 0,{v7_prependBasename:!0}),history:yE({window:void 0}),hydrationData:NC(),routes:n,mapRouteProperties:AC,unstable_dataStrategy:void 0,unstable_patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function NC(){var n;let i=(n=window)==null?void 0:n.__staticRouterHydrationData;return i&&i.errors&&(i=bh({},i,{errors:jC(i.errors)})),i}function jC(n){if(!n)return null;let i=Object.entries(n),l={};for(let[p,_]of i)if(_&&_.__type==="RouteErrorResponse")l[p]=new Lp(_.status,_.statusText,_.data,_.internal===!0);else if(_&&_.__type==="Error"){if(_.__subType){let w=window[_.__subType];if(typeof w=="function")try{let v=new w(_.message);v.stack="",l[p]=v}catch{}}if(l[p]==null){let w=new Error(_.message);w.stack="",l[p]=w}}else l[p]=_;return l}const VC=Ie.createContext({isTransitioning:!1}),UC=Ie.createContext(new Map),$C="startTransition",tx=iS[$C],ZC="flushSync",nx=gE[ZC];function qC(n){tx?tx(n):n()}function Vc(n){nx?nx(n):n()}class HC{constructor(){this.status="pending",this.promise=new Promise((i,l)=>{this.resolve=p=>{this.status==="pending"&&(this.status="resolved",i(p))},this.reject=p=>{this.status==="pending"&&(this.status="rejected",l(p))}})}}function GC(n){let{fallbackElement:i,router:l,future:p}=n,[_,w]=Ie.useState(l.state),[v,c]=Ie.useState(),[A,V]=Ie.useState({isTransitioning:!1}),[W,j]=Ie.useState(),[N,ke]=Ie.useState(),[Se,be]=Ie.useState(),Ze=Ie.useRef(new Map),{v7_startTransition:oe}=p||{},re=Ie.useCallback(pe=>{oe?qC(pe):pe()},[oe]),ue=Ie.useCallback((pe,dt)=>{let{deletedFetchers:lt,unstable_flushSync:ot,unstable_viewTransitionOpts:Xt}=dt;lt.forEach(Ft=>Ze.current.delete(Ft)),pe.fetchers.forEach((Ft,Rn)=>{Ft.data!==void 0&&Ze.current.set(Rn,Ft.data)});let Ot=l.window==null||l.window.document==null||typeof l.window.document.startViewTransition!="function";if(!Xt||Ot){ot?Vc(()=>w(pe)):re(()=>w(pe));return}if(ot){Vc(()=>{N&&(W&&W.resolve(),N.skipTransition()),V({isTransitioning:!0,flushSync:!0,currentLocation:Xt.currentLocation,nextLocation:Xt.nextLocation})});let Ft=l.window.document.startViewTransition(()=>{Vc(()=>w(pe))});Ft.finished.finally(()=>{Vc(()=>{j(void 0),ke(void 0),c(void 0),V({isTransitioning:!1})})}),Vc(()=>ke(Ft));return}N?(W&&W.resolve(),N.skipTransition(),be({state:pe,currentLocation:Xt.currentLocation,nextLocation:Xt.nextLocation})):(c(pe),V({isTransitioning:!0,flushSync:!1,currentLocation:Xt.currentLocation,nextLocation:Xt.nextLocation}))},[l.window,N,W,Ze,re]);Ie.useLayoutEffect(()=>l.subscribe(ue),[l,ue]),Ie.useEffect(()=>{A.isTransitioning&&!A.flushSync&&j(new HC)},[A]),Ie.useEffect(()=>{if(W&&v&&l.window){let pe=v,dt=W.promise,lt=l.window.document.startViewTransition(async()=>{re(()=>w(pe)),await dt});lt.finished.finally(()=>{j(void 0),ke(void 0),c(void 0),V({isTransitioning:!1})}),ke(lt)}},[re,v,W,l.window]),Ie.useEffect(()=>{W&&v&&_.location.key===v.location.key&&W.resolve()},[W,N,_.location,v]),Ie.useEffect(()=>{!A.isTransitioning&&Se&&(c(Se.state),V({isTransitioning:!0,flushSync:!1,currentLocation:Se.currentLocation,nextLocation:Se.nextLocation}),be(void 0))},[A.isTransitioning,Se]),Ie.useEffect(()=>{},[]);let Ce=Ie.useMemo(()=>({createHref:l.createHref,encodeLocation:l.encodeLocation,go:pe=>l.navigate(pe),push:(pe,dt,lt)=>l.navigate(pe,{state:dt,preventScrollReset:lt==null?void 0:lt.preventScrollReset}),replace:(pe,dt,lt)=>l.navigate(pe,{replace:!0,state:dt,preventScrollReset:lt==null?void 0:lt.preventScrollReset})}),[l]),Le=l.basename||"/",Xe=Ie.useMemo(()=>({router:l,navigator:Ce,static:!1,basename:Le}),[l,Ce,Le]),Qe=Ie.useMemo(()=>({v7_relativeSplatPath:l.future.v7_relativeSplatPath}),[l.future.v7_relativeSplatPath]);return Ie.createElement(Ie.Fragment,null,Ie.createElement(ef.Provider,{value:Xe},Ie.createElement(Nw.Provider,{value:_},Ie.createElement(UC.Provider,{value:Ze.current},Ie.createElement(VC.Provider,{value:A},Ie.createElement(zC,{basename:Le,location:_.location,navigationType:_.historyAction,navigator:Ce,future:Qe},_.initialized||l.future.v7_partialHydration?Ie.createElement(WC,{routes:l.routes,future:l.future,state:_}):i))))),null)}const WC=Ie.memo(XC);function XC(n){let{routes:i,future:l,state:p}=n;return _C(i,void 0,p,l)}const KC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rx=Ie.forwardRef(function(i,l){let{onClick:p,relative:_,reloadDocument:w,replace:v,state:c,target:A,to:V,preventScrollReset:W,unstable_viewTransition:j}=i,N=DC(i,FC),{basename:ke}=Ie.useContext(Js),Se,be=!1;if(typeof V=="string"&&JC.test(V)&&(Se=V,KC))try{let ue=new URL(window.location.href),Ce=V.startsWith("//")?new URL(ue.protocol+V):new URL(V),Le=Su(Ce.pathname,ke);Ce.origin===ue.origin&&Le!=null?V=Le+Ce.search+Ce.hash:be=!0}catch{}let Ze=pC(V,{relative:_}),oe=YC(V,{replace:v,state:c,target:A,preventScrollReset:W,relative:_,unstable_viewTransition:j});function re(ue){p&&p(ue),ue.defaultPrevented||oe(ue)}return Ie.createElement("a",bh({},N,{href:Se||Ze,onClick:be||w?p:re,ref:l,target:A}))});var ix;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ix||(ix={}));var ox;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ox||(ox={}));function YC(n,i){let{target:l,replace:p,state:_,preventScrollReset:w,relative:v,unstable_viewTransition:c}=i===void 0?{}:i,A=fC(),V=tf(),W=Uw(n,{relative:v});return Ie.useCallback(j=>{if(RC(j,l)){j.preventDefault();let N=p!==void 0?p:Ws(V)===Ws(W);A(n,{replace:N,state:_,preventScrollReset:w,relative:v,unstable_viewTransition:c})}},[V,A,W,p,_,l,n,w,v,c])}function QC(){return vt.jsx(vt.Fragment,{children:vt.jsx(MC,{})})}const ek="_navbar_usaze_1",tk="_logo_usaze_14",nk="_us_usaze_18",qm={navbar:ek,logo:tk,us:nk};function rk(){return vt.jsxs("section",{className:qm.navbar,children:[vt.jsx(rx,{to:"/",children:vt.jsx("h1",{className:qm.logo,children:"Mapa de los Comedores"})}),vt.jsx(rx,{to:"/us",children:vt.jsx("h1",{className:qm.us,children:"Us"})})]})}const ik="modulepreload",ok=function(n){return"/MapaDeLosComedores/"+n},ax={},ak=function(i,l,p){let _=Promise.resolve();if(l&&l.length>0){document.getElementsByTagName("link");const w=document.querySelector("meta[property=csp-nonce]"),v=(w==null?void 0:w.nonce)||(w==null?void 0:w.getAttribute("nonce"));_=Promise.all(l.map(c=>{if(c=ok(c),c in ax)return;ax[c]=!0;const A=c.endsWith(".css"),V=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${V}`))return;const W=document.createElement("link");if(W.rel=A?"stylesheet":ik,A||(W.as="script"),W.crossOrigin="",W.href=c,v&&W.setAttribute("nonce",v),document.head.appendChild(W),A)return new Promise((j,N)=>{W.addEventListener("load",j),W.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${c}`)))})}))}return _.then(()=>i()).catch(w=>{const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=w,window.dispatchEvent(v),!v.defaultPrevented)throw w})},sk=Ie.createContext(null);function lk(n,i){const l=Array.isArray(n)?n[0]:n?n.x:0,p=Array.isArray(n)?n[1]:n?n.y:0,_=Array.isArray(i)?i[0]:i?i.x:0,w=Array.isArray(i)?i[1]:i?i.y:0;return l===_&&p===w}function Yo(n,i){if(n===i)return!0;if(!n||!i)return!1;if(Array.isArray(n)){if(!Array.isArray(i)||n.length!==i.length)return!1;for(let l=0;l<n.length;l++)if(!Yo(n[l],i[l]))return!1;return!0}else if(Array.isArray(i))return!1;if(typeof n=="object"&&typeof i=="object"){const l=Object.keys(n),p=Object.keys(i);if(l.length!==p.length)return!1;for(const _ of l)if(!i.hasOwnProperty(_)||!Yo(n[_],i[_]))return!1;return!0}return!1}function uk(n){const i=n.clone();return i.pixelsToGLUnits=n.pixelsToGLUnits,i}function sx(n,i){if(!n.getProjection)return;const l=n.getProjection(),p=i.getProjection();Yo(l,p)||i.setProjection(l)}function lx(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function ux(n,i){const l=i.viewState||i;let p=!1;if("longitude"in l&&"latitude"in l){const _=n.center;n.center=new _.constructor(l.longitude,l.latitude),p=p||_!==n.center}if("zoom"in l){const _=n.zoom;n.zoom=l.zoom,p=p||_!==n.zoom}if("bearing"in l){const _=n.bearing;n.bearing=l.bearing,p=p||_!==n.bearing}if("pitch"in l){const _=n.pitch;n.pitch=l.pitch,p=p||_!==n.pitch}return l.padding&&!n.isPaddingEqual(l.padding)&&(p=!0,n.padding=l.padding),p}const ck=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function cx(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const i={};for(const p of n.layers)i[p.id]=p;const l=n.layers.map(p=>{let _=null;"interactive"in p&&(_=Object.assign({},p),delete _.interactive);const w=i[p.ref];if(w){_=_||Object.assign({},p),delete _.ref;for(const v of ck)v in w&&(_[v]=w[v])}return _||p});return{...n,layers:l}}var hx={};const dx={version:8,sources:{},layers:[]},px={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Hm={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},fx={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},hk=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],dk=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class vu{constructor(i,l,p){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=_=>{const w=this.props[fx[_.type]];w?w(_):_.type==="error"&&console.error(_.error)},this._onPointerEvent=_=>{(_.type==="mousemove"||_.type==="mouseout")&&this._updateHover(_);const w=this.props[px[_.type]];w&&(this.props.interactiveLayerIds&&_.type!=="mouseover"&&_.type!=="mouseout"&&(_.features=this._hoveredFeatures||this._queryRenderedFeatures(_.point)),w(_),delete _.features)},this._onCameraEvent=_=>{if(!this._internalUpdate){const w=this.props[Hm[_.type]];w&&w(_)}_.type in this._deferredEvents&&(this._deferredEvents[_.type]=!1)},this._MapClass=i,this.props=l,this._initialize(p)}get map(){return this._map}get transform(){return this._renderTransform}setProps(i){const l=this.props;this.props=i;const p=this._updateSettings(i,l);p&&this._createShadowTransform(this._map);const _=this._updateSize(i),w=this._updateViewState(i,!0);this._updateStyle(i,l),this._updateStyleComponents(i,l),this._updateHandlers(i,l),(p||_||w&&!this._map.isMoving())&&this.redraw()}static reuse(i,l){const p=vu.savedMaps.pop();if(!p)return null;const _=p.map,w=_.getContainer();for(l.className=w.className;w.childNodes.length>0;)l.appendChild(w.childNodes[0]);_._container=l;const v=_._resizeObserver;v&&(v.disconnect(),v.observe(l)),p.setProps({...i,styleDiffing:!1}),_.resize();const{initialViewState:c}=i;return c&&(c.bounds?_.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):p._updateViewState(c,!1)),_.isStyleLoaded()?_.fire("load"):_.once("styledata",()=>_.fire("load")),_._update(),p}_initialize(i){const{props:l}=this,{mapStyle:p=dx}=l,_={...l,...l.initialViewState,accessToken:l.mapboxAccessToken||pk()||null,container:i,style:cx(p)},w=_.initialViewState||_.viewState||_;if(Object.assign(_,{center:[w.longitude||0,w.latitude||0],zoom:w.zoom||0,pitch:w.pitch||0,bearing:w.bearing||0}),l.gl){const W=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=W,l.gl)}const v=new this._MapClass(_);w.padding&&v.setPadding(w.padding),l.cursor&&(v.getCanvas().style.cursor=l.cursor),this._createShadowTransform(v);const c=v._render;v._render=W=>{this._inRender=!0,c.call(v,W),this._inRender=!1};const A=v._renderTaskQueue.run;v._renderTaskQueue.run=W=>{A.call(v._renderTaskQueue,W),this._onBeforeRepaint()},v.on("render",()=>this._onAfterRepaint());const V=v.fire;v.fire=this._fireEvent.bind(this,V),v.on("resize",()=>{this._renderTransform.resize(v.transform.width,v.transform.height)}),v.on("styledata",()=>{this._updateStyleComponents(this.props,{}),sx(v.transform,this._renderTransform)}),v.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const W in px)v.on(W,this._onPointerEvent);for(const W in Hm)v.on(W,this._onCameraEvent);for(const W in fx)v.on(W,this._onEvent);this._map=v}recycle(){const l=this.map.getContainer().querySelector("[mapboxgl-children]");l==null||l.remove(),vu.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const i=this._map;!this._inRender&&i.style&&(i._frame&&(i._frame.cancel(),i._frame=null),i._render())}_createShadowTransform(i){const l=uk(i.transform);i.painter.transform=l,this._renderTransform=l}_updateSize(i){const{viewState:l}=i;if(l){const p=this._map;if(l.width!==p.transform.width||l.height!==p.transform.height)return p.resize(),!0}return!1}_updateViewState(i,l){if(this._internalUpdate)return!1;const p=this._map,_=this._renderTransform,{zoom:w,pitch:v,bearing:c}=_,A=p.isMoving();A&&(_.cameraElevationReference="sea");const V=ux(_,{...lx(p.transform),...i});if(A&&(_.cameraElevationReference="ground"),V&&l){const W=this._deferredEvents;W.move=!0,W.zoom||(W.zoom=w!==_.zoom),W.rotate||(W.rotate=c!==_.bearing),W.pitch||(W.pitch=v!==_.pitch)}return A||ux(p.transform,i),V}_updateSettings(i,l){const p=this._map;let _=!1;for(const w of hk)if(w in i&&!Yo(i[w],l[w])){_=!0;const v=p[`set${w[0].toUpperCase()}${w.slice(1)}`];v==null||v.call(p,i[w])}return _}_updateStyle(i,l){if(i.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=i.cursor||""),i.mapStyle!==l.mapStyle){const{mapStyle:p=dx,styleDiffing:_=!0}=i,w={diff:_};return"localIdeographFontFamily"in i&&(w.localIdeographFontFamily=i.localIdeographFontFamily),this._map.setStyle(cx(p),w),!0}return!1}_updateStyleComponents(i,l){const p=this._map;let _=!1;return p.isStyleLoaded()&&("light"in i&&p.setLight&&!Yo(i.light,l.light)&&(_=!0,p.setLight(i.light)),"fog"in i&&p.setFog&&!Yo(i.fog,l.fog)&&(_=!0,p.setFog(i.fog)),"terrain"in i&&p.setTerrain&&!Yo(i.terrain,l.terrain)&&(!i.terrain||p.getSource(i.terrain.source))&&(_=!0,p.setTerrain(i.terrain))),_}_updateHandlers(i,l){var p,_;const w=this._map;let v=!1;for(const c of dk){const A=(p=i[c])!==null&&p!==void 0?p:!0,V=(_=l[c])!==null&&_!==void 0?_:!0;Yo(A,V)||(v=!0,A?w[c].enable(A):w[c].disable())}return v}_queryRenderedFeatures(i){const l=this._map,p=l.transform,{interactiveLayerIds:_=[]}=this.props;try{return l.transform=this._renderTransform,l.queryRenderedFeatures(i,{layers:_.filter(l.getLayer.bind(l))})}catch{return[]}finally{l.transform=p}}_updateHover(i){var l;const{props:p}=this;if(p.interactiveLayerIds&&(p.onMouseMove||p.onMouseEnter||p.onMouseLeave)){const w=i.type,v=((l=this._hoveredFeatures)===null||l===void 0?void 0:l.length)>0,c=this._queryRenderedFeatures(i.point),A=c.length>0;!A&&v&&(i.type="mouseleave",this._onPointerEvent(i)),this._hoveredFeatures=c,A&&!v&&(i.type="mouseenter",this._onPointerEvent(i)),i.type=w}else this._hoveredFeatures=null}_fireEvent(i,l,p){const _=this._map,w=_.transform,v=typeof l=="string"?l:l.type;return v==="move"&&this._updateViewState(this.props,!1),v in Hm&&(typeof l=="object"&&(l.viewState=lx(w)),this._map.isMoving())?(_.transform=this._renderTransform,i.call(_,l,p),_.transform=w,_):(i.call(_,l,p),_)}_onBeforeRepaint(){const i=this._map;this._internalUpdate=!0;for(const p in this._deferredEvents)this._deferredEvents[p]&&i.fire(p);this._internalUpdate=!1;const l=this._map.transform;i.transform=this._renderTransform,this._onAfterRepaint=()=>{sx(this._renderTransform,l),i.transform=l}}}vu.savedMaps=[];function pk(){let n=null;if(typeof location<"u"){const i=/access_token=([^&\/]*)/.exec(location.search);n=i&&i[1]}try{n=n||hx.MapboxAccessToken}catch{}try{n=n||hx.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const fk=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function mk(n){if(!n)return null;const i=n.map,l={getMap:()=>i,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:p=>{const _=i.transform;i.transform=n.transform;const w=i.project(p);return i.transform=_,w},unproject:p=>{const _=i.transform;i.transform=n.transform;const w=i.unproject(p);return i.transform=_,w},queryTerrainElevation:(p,_)=>{const w=i.transform;i.transform=n.transform;const v=i.queryTerrainElevation(p,_);return i.transform=w,v},queryRenderedFeatures:(p,_)=>{const w=i.transform;i.transform=n.transform;const v=i.queryRenderedFeatures(p,_);return i.transform=w,v}};for(const p of gk(i))!(p in l)&&!fk.includes(p)&&(l[p]=i[p].bind(i));return l}function gk(n){const i=new Set;let l=n;for(;l;){for(const p of Object.getOwnPropertyNames(l))p[0]!=="_"&&typeof n[p]=="function"&&p!=="fire"&&p!=="setEventedParent"&&i.add(p);l=Object.getPrototypeOf(l)}return Array.from(i)}const yk=typeof document<"u"?Ie.useLayoutEffect:Ie.useEffect,_k=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function vk(n,i){for(const p of _k)p in i&&(n[p]=i[p]);const{RTLTextPlugin:l="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=i;l&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(l,p=>{p&&console.error(p)},!0)}const nf=Ie.createContext(null);function xk(n,i,l){const p=Ie.useContext(sk),[_,w]=Ie.useState(null),v=Ie.useRef(),{current:c}=Ie.useRef({mapLib:null,map:null});Ie.useEffect(()=>{const W=n.mapLib;let j=!0,N;return Promise.resolve(W||l).then(ke=>{if(!j)return;if(!ke)throw new Error("Invalid mapLib");const Se="Map"in ke?ke:ke.default;if(!Se.Map)throw new Error("Invalid mapLib");if(vk(Se,n),!Se.supported||Se.supported(n))n.reuseMaps&&(N=vu.reuse(n,v.current)),N||(N=new vu(Se.Map,n,v.current)),c.map=mk(N),c.mapLib=Se,w(N),p==null||p.onMapMount(c.map,n.id);else throw new Error("Map is not supported by this browser")}).catch(ke=>{const{onError:Se}=n;Se?Se({type:"error",target:null,originalEvent:null,error:ke}):console.error(ke)}),()=>{j=!1,N&&(p==null||p.onMapUnmount(n.id),n.reuseMaps?N.recycle():N.destroy())}},[]),yk(()=>{_&&_.setProps(n)}),Ie.useImperativeHandle(i,()=>c.map,[_]);const A=Ie.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),V={height:"100%"};return Ie.createElement("div",{id:n.id,ref:v,style:A},_&&Ie.createElement(nf.Provider,{value:c},Ie.createElement("div",{"mapboxgl-children":"",style:V},n.children)))}const wk=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Ys(n,i){if(!n||!i)return;const l=n.style;for(const p in i){const _=i[p];Number.isFinite(_)&&!wk.test(p)?l[p]=`${_}px`:l[p]=_}}function bk(n,i){const{map:l,mapLib:p}=Ie.useContext(nf),_=Ie.useRef({props:n});_.current.props=n;const w=Ie.useMemo(()=>{let be=!1;Ie.Children.forEach(n.children,re=>{re&&(be=!0)});const Ze={...n,element:be?document.createElement("div"):null},oe=new p.Marker(Ze);return oe.setLngLat([n.longitude,n.latitude]),oe.getElement().addEventListener("click",re=>{var ue,Ce;(Ce=(ue=_.current.props).onClick)===null||Ce===void 0||Ce.call(ue,{type:"click",target:oe,originalEvent:re})}),oe.on("dragstart",re=>{var ue,Ce;const Le=re;Le.lngLat=w.getLngLat(),(Ce=(ue=_.current.props).onDragStart)===null||Ce===void 0||Ce.call(ue,Le)}),oe.on("drag",re=>{var ue,Ce;const Le=re;Le.lngLat=w.getLngLat(),(Ce=(ue=_.current.props).onDrag)===null||Ce===void 0||Ce.call(ue,Le)}),oe.on("dragend",re=>{var ue,Ce;const Le=re;Le.lngLat=w.getLngLat(),(Ce=(ue=_.current.props).onDragEnd)===null||Ce===void 0||Ce.call(ue,Le)}),oe},[]);Ie.useEffect(()=>(w.addTo(l.getMap()),()=>{w.remove()}),[]);const{longitude:v,latitude:c,offset:A,style:V,draggable:W=!1,popup:j=null,rotation:N=0,rotationAlignment:ke="auto",pitchAlignment:Se="auto"}=n;return Ie.useEffect(()=>{Ys(w.getElement(),V)},[V]),Ie.useImperativeHandle(i,()=>w,[]),(w.getLngLat().lng!==v||w.getLngLat().lat!==c)&&w.setLngLat([v,c]),A&&!lk(w.getOffset(),A)&&w.setOffset(A),w.isDraggable()!==W&&w.setDraggable(W),w.getRotation()!==N&&w.setRotation(N),w.getRotationAlignment()!==ke&&w.setRotationAlignment(ke),w.getPitchAlignment()!==Se&&w.setPitchAlignment(Se),w.getPopup()!==j&&w.setPopup(j),Ih.createPortal(n.children,w.getElement())}const Sk=Ie.memo(Ie.forwardRef(bk));function mx(n){return new Set(n?n.trim().split(/\s+/):[])}function Tk(n,i){const{map:l,mapLib:p}=Ie.useContext(nf),_=Ie.useMemo(()=>document.createElement("div"),[]),w=Ie.useRef({props:n});w.current.props=n;const v=Ie.useMemo(()=>{const c={...n},A=new p.Popup(c);return A.setLngLat([n.longitude,n.latitude]),A.once("open",V=>{var W,j;(j=(W=w.current.props).onOpen)===null||j===void 0||j.call(W,V)}),A},[]);if(Ie.useEffect(()=>{const c=A=>{var V,W;(W=(V=w.current.props).onClose)===null||W===void 0||W.call(V,A)};return v.on("close",c),v.setDOMContent(_).addTo(l.getMap()),()=>{v.off("close",c),v.isOpen()&&v.remove()}},[]),Ie.useEffect(()=>{Ys(v.getElement(),n.style)},[n.style]),Ie.useImperativeHandle(i,()=>v,[]),v.isOpen()&&((v.getLngLat().lng!==n.longitude||v.getLngLat().lat!==n.latitude)&&v.setLngLat([n.longitude,n.latitude]),n.offset&&!Yo(v.options.offset,n.offset)&&v.setOffset(n.offset),(v.options.anchor!==n.anchor||v.options.maxWidth!==n.maxWidth)&&(v.options.anchor=n.anchor,v.setMaxWidth(n.maxWidth)),v.options.className!==n.className)){const c=mx(v.options.className),A=mx(n.className);for(const V of c)A.has(V)||v.removeClassName(V);for(const V of A)c.has(V)||v.addClassName(V);v.options.className=n.className}return Ih.createPortal(n.children,_)}Ie.memo(Ie.forwardRef(Tk));function Mh(n,i,l,p){const _=Ie.useContext(nf),w=Ie.useMemo(()=>n(_),[]);return Ie.useEffect(()=>{const v=i,c=typeof i=="function"&&typeof l=="function"?i:null,A=typeof i=="function"?i:null,{map:V}=_;return V.hasControl(w)||(V.addControl(w,v==null?void 0:v.position),c&&c(_)),()=>{A&&A(_),V.hasControl(w)&&V.removeControl(w)}},[]),w}function Ek(n){const i=Mh(({mapLib:l})=>new l.AttributionControl(n),{position:n.position});return Ie.useEffect(()=>{Ys(i._container,n.style)},[n.style]),null}Ie.memo(Ek);function Ck(n){const i=Mh(({mapLib:l})=>new l.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return Ie.useEffect(()=>{Ys(i._controlContainer,n.style)},[n.style]),null}Ie.memo(Ck);function kk(n,i){const l=Ie.useRef({props:n}),p=Mh(({mapLib:_})=>{const w=new _.GeolocateControl(n),v=w._setupUI;return w._setupUI=c=>{w._container.hasChildNodes()||v(c)},w.on("geolocate",c=>{var A,V;(V=(A=l.current.props).onGeolocate)===null||V===void 0||V.call(A,c)}),w.on("error",c=>{var A,V;(V=(A=l.current.props).onError)===null||V===void 0||V.call(A,c)}),w.on("outofmaxbounds",c=>{var A,V;(V=(A=l.current.props).onOutOfMaxBounds)===null||V===void 0||V.call(A,c)}),w.on("trackuserlocationstart",c=>{var A,V;(V=(A=l.current.props).onTrackUserLocationStart)===null||V===void 0||V.call(A,c)}),w.on("trackuserlocationend",c=>{var A,V;(V=(A=l.current.props).onTrackUserLocationEnd)===null||V===void 0||V.call(A,c)}),w},{position:n.position});return l.current.props=n,Ie.useImperativeHandle(i,()=>p,[]),Ie.useEffect(()=>{Ys(p._container,n.style)},[n.style]),null}Ie.memo(Ie.forwardRef(kk));function Ik(n){const i=Mh(({mapLib:l})=>new l.NavigationControl(n),{position:n.position});return Ie.useEffect(()=>{Ys(i._container,n.style)},[n.style]),null}const Pk=Ie.memo(Ik);function Mk(n){const i=Mh(({mapLib:w})=>new w.ScaleControl(n),{position:n.position}),l=Ie.useRef(n),p=l.current;l.current=n;const{style:_}=n;return n.maxWidth!==void 0&&n.maxWidth!==p.maxWidth&&(i.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==p.unit&&i.setUnit(n.unit),Ie.useEffect(()=>{Ys(i._container,_)},[_]),null}Ie.memo(Mk);const zk=ak(()=>Promise.resolve().then(()=>Rk),void 0),Ak=Ie.forwardRef(function(i,l){return xk(i,l,zk)}),Dk=Sk,Lk=Pk;var qw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.6.0/LICENSE.txt
 */(function(n,i){(function(l,p){n.exports=p()})(U2,function(){var l={},p={};function _(v,c,A){if(p[v]=A,v==="index"){var V="var sharedModule = {}; ("+p.shared+")(sharedModule); ("+p.worker+")(sharedModule);",W={};return p.shared(W),p.index(l,W),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([V],{type:"text/javascript"}))),l}}_("shared",["exports"],function(v){function c(r,t,o,s){return new(o||(o=Promise))(function(d,f){function y(C){try{S(s.next(C))}catch(I){f(I)}}function x(C){try{S(s.throw(C))}catch(I){f(I)}}function S(C){var I;C.done?d(C.value):(I=C.value,I instanceof o?I:new o(function(P){P(I)})).then(y,x)}S((s=s.apply(r,t||[])).next())})}function A(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var V=W;function W(r,t){this.x=r,this.y=t}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,o=r.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),o=Math.sin(r),s=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=s,this},_rotateAround:function(r,t){var o=Math.cos(r),s=Math.sin(r),d=t.y+s*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-s*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},W.convert=function(r){return r instanceof W?r:Array.isArray(r)?new W(r[0],r[1]):r};var j=A(V),N=ke;function ke(r,t,o,s){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=s}ke.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,s=0;s<8;s++){var d=this.sampleCurveX(o)-r;if(Math.abs(d)<t)return o;var f=this.sampleCurveDerivativeX(o);if(Math.abs(f)<1e-6)break;o-=d/f}var y=0,x=1;for(o=r,s=0;s<20&&(d=this.sampleCurveX(o),!(Math.abs(d-r)<t));s++)r>d?y=o:x=o,o=.5*(x-y)+y;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var Se=A(N);let be,Ze;function oe(){return be==null&&(be=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),be}function re(){if(Ze==null&&(Ze=!1,oe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<5*5;s++){const d=4*s;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const o=t.getImageData(0,0,5,5).data;for(let s=0;s<5*5*4;s++)if(s%4!=3&&o[s]!==s){Ze=!0;break}}}return Ze||!1}function ue(r,t,o,s){const d=new Se(r,t,o,s);return f=>d.solve(f)}const Ce=ue(.25,.1,.25,1);function Le(r,t,o){return Math.min(o,Math.max(t,r))}function Xe(r,t,o){const s=o-t,d=((r-t)%s+s)%s+t;return d===t?o:d}function Qe(r,...t){for(const o of t)for(const s in o)r[s]=o[s];return r}let pe=1;function dt(r,t,o){const s={};for(const d in r)s[d]=t.call(this,r[d],d,r);return s}function lt(r,t,o){const s={};for(const d in r)t.call(this,r[d],d,r)&&(s[d]=r[d]);return s}function ot(r){return Array.isArray(r)?r.map(ot):typeof r=="object"&&r?dt(r,ot):r}const Xt={};function Ot(r){Xt[r]||(typeof console<"u"&&console.warn(r),Xt[r]=!0)}function Ft(r,t,o){return(o.y-r.y)*(t.x-r.x)>(t.y-r.y)*(o.x-r.x)}function Rn(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Hn=null;function Un(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ut(r,t,o,s,d){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const f=new VideoFrame(r,{timestamp:0});try{const y=f==null?void 0:f.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const x=y.startsWith("BGR"),S=new Uint8ClampedArray(s*d*4);if(yield f.copyTo(S,function(C,I,P,D,F){const O=4*Math.max(-I,0),U=(Math.max(0,P)-P)*D*4+O,J=4*D,ne=Math.max(0,I),ye=Math.max(0,P);return{rect:{x:ne,y:ye,width:Math.min(C.width,I+D)-ne,height:Math.min(C.height,P+F)-ye},layout:[{offset:U,stride:J}]}}(r,t,o,s,d)),x)for(let C=0;C<S.length;C+=4){const I=S[C];S[C]=S[C+2],S[C+2]=I}return S}finally{f.close()}})}let wt,Dt;const Nt="AbortError";function kn(){return new Error(Nt)}const yn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Fn(r){return yn.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const dn="global-dispatcher";class on extends Error{constructor(t,o,s,d){super(`AJAXError: ${o} (${t}): ${s}`),this.status=t,this.statusText=o,this.url=s,this.body=d}}const $n=()=>Rn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Xi=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const s=Fn(r.url);if(s)return s(r,t);if(Rn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:dn},t)}if(!(/^file:/.test(o=r.url)||/^file:/.test($n())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(s,d){return c(this,void 0,void 0,function*(){const f=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:$n(),signal:d.signal});s.type!=="json"||f.headers.has("Accept")||f.headers.set("Accept","application/json");const y=yield fetch(f);if(!y.ok){const C=yield y.blob();throw new on(y.status,y.statusText,s.url,C)}let x;x=s.type==="arrayBuffer"||s.type==="image"?y.arrayBuffer():s.type==="json"?y.json():y.text();const S=yield x;if(d.signal.aborted)throw kn();return{data:S,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(r,t);if(Rn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:dn},t)}var o;return function(s,d){return new Promise((f,y)=>{var x;const S=new XMLHttpRequest;S.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(S.responseType="arraybuffer");for(const C in s.headers)S.setRequestHeader(C,s.headers[C]);s.type==="json"&&(S.responseType="text",!((x=s.headers)===null||x===void 0)&&x.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=s.credentials==="include",S.onerror=()=>{y(new Error(S.statusText))},S.onload=()=>{if(!d.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(s.type==="json")try{C=JSON.parse(S.response)}catch(I){return void y(I)}f({data:C,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});y(new on(S.status,S.statusText,s.url,C))}},d.signal.addEventListener("abort",()=>{S.abort(),y(kn())}),S.send(s.body)})}(r,t)};function li(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),o=window.location;return t.protocol===o.protocol&&t.host===o.host}function Do(r,t,o){o[r]&&o[r].indexOf(t)!==-1||(o[r]=o[r]||[],o[r].push(t))}function ui(r,t,o){if(o&&o[r]){const s=o[r].indexOf(t);s!==-1&&o[r].splice(s,1)}}class Li{constructor(t,o={}){Qe(this,o),this.type=t}}class pn extends Li{constructor(t,o={}){super("error",Qe({error:t},o))}}class Rr{on(t,o){return this._listeners=this._listeners||{},Do(t,o,this._listeners),this}off(t,o){return ui(t,o,this._listeners),ui(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Do(t,o,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,o){typeof t=="string"&&(t=new Li(t,o||{}));const s=t.type;if(this.listens(s)){t.target=this;const d=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const x of d)x.call(this,t);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const x of f)ui(s,x,this._oneTimeListeners),x.call(this,t);const y=this._eventedParent;y&&(Qe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof pn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var we={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ki=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Fr(r,t){const o={};for(const s in r)s!=="ref"&&(o[s]=r[s]);return Ki.forEach(s=>{s in t&&(o[s]=t[s])}),o}function $t(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let o=0;o<r.length;o++)if(!$t(r[o],t[o]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const o in r)if(!$t(r[o],t[o]))return!1;return!0}return r===t}function cn(r,t){r.push(t)}function po(r,t,o){cn(o,{command:"addSource",args:[r,t[r]]})}function Ri(r,t,o){cn(t,{command:"removeSource",args:[r]}),o[r]=!0}function ci(r,t,o,s){Ri(r,o,s),po(r,t,o)}function fo(r,t,o){let s;for(s in r[o])if(Object.prototype.hasOwnProperty.call(r[o],s)&&s!=="data"&&!$t(r[o][s],t[o][s]))return!1;for(s in t[o])if(Object.prototype.hasOwnProperty.call(t[o],s)&&s!=="data"&&!$t(r[o][s],t[o][s]))return!1;return!0}function wr(r,t,o,s,d,f){r=r||{},t=t||{};for(const y in r)Object.prototype.hasOwnProperty.call(r,y)&&($t(r[y],t[y])||o.push({command:f,args:[s,y,t[y],d]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(r,y)&&($t(r[y],t[y])||o.push({command:f,args:[s,y,t[y],d]}))}function hi(r){return r.id}function di(r,t){return r[t.id]=t,r}class Ne{constructor(t,o,s,d){this.message=(t?`${t}: `:"")+s,d&&(this.identifier=d),o!=null&&o.__line__&&(this.line=o.__line__)}}function br(r,...t){for(const o of t)for(const s in o)r[s]=o[s];return r}class fn extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class Bn{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[s,d]of o)this.bindings[s]=d}concat(t){return new Bn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const pi={kind:"null"},Ue={kind:"number"},Mt={kind:"string"},gt={kind:"boolean"},Yn={kind:"color"},Sr={kind:"object"},Tt={kind:"value"},Jr={kind:"collator"},Yr={kind:"formatted"},Br={kind:"padding"},Or={kind:"resolvedImage"},Q={kind:"variableAnchorOffsetCollection"};function L(r,t){return{kind:"array",itemType:r,N:t}}function R(r){if(r.kind==="array"){const t=R(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const $=[pi,Ue,Mt,gt,Yn,Yr,Sr,L(Tt),Br,Or,Q];function X(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!X(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const o of $)if(!X(o,t))return null}}return`Expected ${R(r)} but found ${R(t)} instead.`}function se(r,t){return t.some(o=>o.kind===r.kind)}function he(r,t){return t.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}function me(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const ie=.96422,Te=.82521,ze=4/29,ve=6/29,H=3*ve*ve,ee=ve*ve*ve,ce=Math.PI/180,xe=180/Math.PI;function Re(r){return(r%=360)<0&&(r+=360),r}function Ae([r,t,o,s]){let d,f;const y=Fe((.2225045*(r=nt(r))+.7168786*(t=nt(t))+.0606169*(o=nt(o)))/1);r===t&&t===o?d=f=y:(d=Fe((.4360747*r+.3850649*t+.1430804*o)/ie),f=Fe((.0139322*r+.0971045*t+.7141733*o)/Te));const x=116*y-16;return[x<0?0:x,500*(d-y),200*(y-f),s]}function nt(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Fe(r){return r>ee?Math.pow(r,1/3):r/H+ze}function mt([r,t,o,s]){let d=(r+16)/116,f=isNaN(t)?d:d+t/500,y=isNaN(o)?d:d-o/200;return d=1*at(d),f=ie*at(f),y=Te*at(y),[Ve(3.1338561*f-1.6168667*d-.4906146*y),Ve(-.9787684*f+1.9161415*d+.033454*y),Ve(.0719453*f-.2289914*d+1.4052427*y),s]}function Ve(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function at(r){return r>ve?r*r*r:H*(r-ze)}function xt(r){return parseInt(r.padEnd(2,r),16)/255}function kt(r,t){return At(t?r/100:r,0,1)}function At(r,t,o){return Math.min(Math.max(t,r),o)}function It(r){return!r.some(Number.isNaN)}const _n={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Et{constructor(t,o,s,d=1,f=!0){this.r=t,this.g=o,this.b=s,this.a=d,f||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,o,s,d]))}static parse(t){if(t instanceof Et)return t;if(typeof t!="string")return;const o=function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=_n[s];if(d){const[y,x,S]=d;return[y/255,x/255,S/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const y=s.length<6?1:2;let x=1;return[xt(s.slice(x,x+=y)),xt(s.slice(x,x+=y)),xt(s.slice(x,x+=y)),xt(s.slice(x,x+y)||"ff")]}if(s.startsWith("rgb")){const y=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,S,C,I,P,D,F,O,U,J,ne,ye]=y,le=[I||" ",F||" ",J].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const fe=[C,D,U].join(""),Ee=fe==="%%%"?100:fe===""?255:0;if(Ee){const De=[At(+S/Ee,0,1),At(+P/Ee,0,1),At(+O/Ee,0,1),ne?kt(+ne,ye):1];if(It(De))return De}}return}}const f=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(f){const[y,x,S,C,I,P,D,F,O]=f,U=[S||" ",I||" ",D].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const J=[+x,At(+C,0,100),At(+P,0,100),F?kt(+F,O):1];if(It(J))return function([ne,ye,le,fe]){function Ee(De){const Ke=(De+ne/30)%12,_t=ye*Math.min(le,1-le);return le-_t*Math.max(-1,Math.min(Ke-3,9-Ke,1))}return ne=Re(ne),ye/=100,le/=100,[Ee(0),Ee(8),Ee(4),fe]}(J)}}}(t);return o?new Et(...o,!1):void 0}get rgb(){const{r:t,g:o,b:s,a:d}=this,f=d||1/0;return this.overwriteGetter("rgb",[t/f,o/f,s/f,d])}get hcl(){return this.overwriteGetter("hcl",function(t){const[o,s,d,f]=Ae(t),y=Math.sqrt(s*s+d*d);return[Math.round(1e4*y)?Re(Math.atan2(d,s)*xe):NaN,y,o,f]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ae(this.rgb))}overwriteGetter(t,o){return Object.defineProperty(this,t,{value:o}),o}toString(){const[t,o,s,d]=this.rgb;return`rgba(${[t,o,s].map(f=>Math.round(255*f)).join(",")},${d})`}}Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1);class Ji{constructor(t,o,s){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Qr{constructor(t,o,s,d,f){this.text=t,this.image=o,this.scale=s,this.fontStack=d,this.textColor=f}}class On{constructor(t){this.sections=t}static fromString(t){return new On([new Qr(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof On?t:On.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Nn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Nn)return t;if(typeof t=="number")return new Nn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const o of t)if(typeof o!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Nn(t)}}toString(){return JSON.stringify(this.values)}}const mo=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class mn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof mn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let o=0;o<t.length;o+=2){const s=t[o],d=t[o+1];if(typeof s!="string"||!mo.has(s)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new mn(t)}}toString(){return JSON.stringify(this.values)}}class In{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new In({name:t,available:!1}):null}}function Yi(r,t,o,s){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,t,o,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,t,o,s]:[r,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fi(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Et||r instanceof Ji||r instanceof On||r instanceof Nn||r instanceof mn||r instanceof In)return!0;if(Array.isArray(r)){for(const t of r)if(!Fi(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Fi(r[t]))return!1;return!0}return!1}function yt(r){if(r===null)return pi;if(typeof r=="string")return Mt;if(typeof r=="boolean")return gt;if(typeof r=="number")return Ue;if(r instanceof Et)return Yn;if(r instanceof Ji)return Jr;if(r instanceof On)return Yr;if(r instanceof Nn)return Br;if(r instanceof mn)return Q;if(r instanceof In)return Or;if(Array.isArray(r)){const t=r.length;let o;for(const s of r){const d=yt(s);if(o){if(o===d)continue;o=Tt;break}o=d}return L(o||Tt,t)}return Sr}function Gt(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Et||r instanceof On||r instanceof Nn||r instanceof mn||r instanceof In?r.toString():JSON.stringify(r)}class Pn{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Fi(t[1]))return o.error("invalid value");const s=t[1];let d=yt(s);const f=o.expectedType;return d.kind!=="array"||d.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(d=f),new Pn(d,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Pt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Tr={string:Mt,number:Ue,boolean:gt,object:Sr};class pr{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let s,d=1;const f=t[0];if(f==="array"){let x,S;if(t.length>2){const C=t[1];if(typeof C!="string"||!(C in Tr)||C==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);x=Tr[C],d++}else x=Tt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}s=L(x,S)}else{if(!Tr[f])throw new Error(`Types doesn't contain name = ${f}`);s=Tr[f]}const y=[];for(;d<t.length;d++){const x=o.parse(t[d],d,Tt);if(!x)return null;y.push(x)}return new pr(s,y)}evaluate(t){for(let o=0;o<this.args.length;o++){const s=this.args[o].evaluate(t);if(!X(this.type,yt(s)))return s;if(o===this.args.length-1)throw new Pt(`Expected value to be of type ${R(this.type)}, but found ${R(yt(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Lo={"to-boolean":gt,"to-color":Yn,"to-number":Ue,"to-string":Mt};class go{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const s=t[0];if(!Lo[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return o.error("Expected one argument.");const d=Lo[s],f=[];for(let y=1;y<t.length;y++){const x=o.parse(t[y],y,Tt);if(!x)return null;f.push(x)}return new go(d,f)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let o,s;for(const d of this.args){if(o=d.evaluate(t),s=null,o instanceof Et)return o;if(typeof o=="string"){const f=t.parseColor(o);if(f)return f}else if(Array.isArray(o)&&(s=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Yi(o[0],o[1],o[2],o[3]),!s))return new Et(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Pt(s||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const s of this.args){o=s.evaluate(t);const d=Nn.parse(o);if(d)return d}throw new Pt(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const s of this.args){o=s.evaluate(t);const d=mn.parse(o);if(d)return d}throw new Pt(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const s of this.args){if(o=s.evaluate(t),o===null)return 0;const d=Number(o);if(!isNaN(d))return d}throw new Pt(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return On.fromString(Gt(this.args[0].evaluate(t)));case"resolvedImage":return In.fromString(Gt(this.args[0].evaluate(t)));default:return Gt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Tu=["Unknown","Point","LineString","Polygon"];class Ya{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Et.parse(t)),o}}class yo{constructor(t,o,s=[],d,f=new Bn,y=[]){this.registry=t,this.path=s,this.key=s.map(x=>`[${x}]`).join(""),this.scope=f,this.errors=y,this.expectedType=d,this._isConstant=o}parse(t,o,s,d,f={}){return o?this.concat(o,s,d)._parse(t,f):this._parse(t,f)}_parse(t,o){function s(d,f,y){return y==="assert"?new pr(f,[d]):y==="coerce"?new go(f,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[d];if(f){let y=f.parse(t,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,S=y.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(x.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(x,S))return null}else y=s(y,x,o.typeAnnotation||"coerce");else y=s(y,x,o.typeAnnotation||"coerce");else y=s(y,x,o.typeAnnotation||"coerce");else y=s(y,x,o.typeAnnotation||"assert")}if(!(y instanceof Pn)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const x=new Ya;try{y=new Pn(y.type,y.evaluate(x))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,s){const d=typeof t=="number"?this.path.concat(t):this.path,f=s?this.scope.concat(s):this.scope;return new yo(this.registry,this._isConstant,d,o||null,f,this.errors)}error(t,...o){const s=`${this.key}${o.map(d=>`[${d}]`).join("")}`;this.errors.push(new fn(s,t))}checkSubtype(t,o){const s=X(t,o);return s&&this.error(s),s}}class Ht{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let f=1;f<t.length-1;f+=2){const y=t[f];if(typeof y!="string")return o.error(`Expected string, but found ${typeof y} instead.`,f);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",f);const x=o.parse(t[f+1],f+1);if(!x)return null;s.push([y,x])}const d=o.parse(t[t.length-1],t.length-1,o.expectedType,s);return d?new Ht(s,d):null}outputDefined(){return this.result.outputDefined()}}class Qs{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const s=t[1];return o.scope.has(s)?new Qs(s,o.scope.get(s)):o.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Eu{constructor(t,o,s){this.type=t,this.index=o,this.input=s}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=o.parse(t[1],1,Ue),d=o.parse(t[2],2,L(o.expectedType||Tt));return s&&d?new Eu(d.type.itemType,s,d):null}evaluate(t){const o=this.index.evaluate(t),s=this.input.evaluate(t);if(o<0)throw new Pt(`Array index out of bounds: ${o} < 0.`);if(o>=s.length)throw new Pt(`Array index out of bounds: ${o} > ${s.length-1}.`);if(o!==Math.floor(o))throw new Pt(`Array index must be an integer, but found ${o} instead.`);return s[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Qa{constructor(t,o){this.type=gt,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=o.parse(t[1],1,Tt),d=o.parse(t[2],2,Tt);return s&&d?se(s.type,[gt,Mt,Ue,pi,Tt])?new Qa(s,d):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(s.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!he(o,["boolean","string","number","null"]))throw new Pt(`Expected first argument to be of type boolean, string, number or null, but found ${R(yt(o))} instead.`);if(!he(s,["string","array"]))throw new Pt(`Expected second argument to be of type array or string, but found ${R(yt(s))} instead.`);return s.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class el{constructor(t,o,s){this.type=Ue,this.needle=t,this.haystack=o,this.fromIndex=s}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=o.parse(t[1],1,Tt),d=o.parse(t[2],2,Tt);if(!s||!d)return null;if(!se(s.type,[gt,Mt,Ue,pi,Tt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(s.type)} instead`);if(t.length===4){const f=o.parse(t[3],3,Ue);return f?new el(s,d,f):null}return new el(s,d)}evaluate(t){const o=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!he(o,["boolean","string","number","null"]))throw new Pt(`Expected first argument to be of type boolean, string, number or null, but found ${R(yt(o))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),he(s,["string"])){const f=s.indexOf(o,d);return f===-1?-1:[...s.slice(0,f)].length}if(he(s,["array"]))return s.indexOf(o,d);throw new Pt(`Expected second argument to be of type array or string, but found ${R(yt(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class tl{constructor(t,o,s,d,f,y){this.inputType=t,this.type=o,this.input=s,this.cases=d,this.outputs=f,this.otherwise=y}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let s,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);const f={},y=[];for(let C=2;C<t.length-1;C+=2){let I=t[C];const P=t[C+1];Array.isArray(I)||(I=[I]);const D=o.concat(C);if(I.length===0)return D.error("Expected at least one branch label.");for(const O of I){if(typeof O!="number"&&typeof O!="string")return D.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return D.error("Numeric branch labels must be integer values.");if(s){if(D.checkSubtype(s,yt(O)))return null}else s=yt(O);if(f[String(O)]!==void 0)return D.error("Branch labels must be unique.");f[String(O)]=y.length}const F=o.parse(P,C,d);if(!F)return null;d=d||F.type,y.push(F)}const x=o.parse(t[1],1,Tt);if(!x)return null;const S=o.parse(t[t.length-1],t.length-1,d);return S?x.type.kind!=="value"&&o.concat(1).checkSubtype(s,x.type)?null:new tl(s,d,x,f,y,S):null}evaluate(t){const o=this.input.evaluate(t);return(yt(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class nl{constructor(t,o,s){this.type=t,this.branches=o,this.otherwise=s}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let s;o.expectedType&&o.expectedType.kind!=="value"&&(s=o.expectedType);const d=[];for(let y=1;y<t.length-1;y+=2){const x=o.parse(t[y],y,gt);if(!x)return null;const S=o.parse(t[y+1],y+1,s);if(!S)return null;d.push([x,S]),s=s||S.type}const f=o.parse(t[t.length-1],t.length-1,s);if(!f)return null;if(!s)throw new Error("Can't infer output type");return new nl(s,d,f)}evaluate(t){for(const[o,s]of this.branches)if(o.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,s]of this.branches)t(o),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(t,o,s,d){this.type=t,this.input=o,this.beginIndex=s,this.endIndex=d}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=o.parse(t[1],1,Tt),d=o.parse(t[2],2,Ue);if(!s||!d)return null;if(!se(s.type,[L(Tt),Mt,Tt]))return o.error(`Expected first argument to be of type array or string, but found ${R(s.type)} instead`);if(t.length===4){const f=o.parse(t[3],3,Ue);return f?new rl(s.type,s,d,f):null}return new rl(s.type,s,d)}evaluate(t){const o=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),he(o,["string"]))return[...o].slice(s,d).join("");if(he(o,["array"]))return o.slice(s,d);throw new Pt(`Expected first argument to be of type array or string, but found ${R(yt(o))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function es(r,t){const o=r.length-1;let s,d,f=0,y=o,x=0;for(;f<=y;)if(x=Math.floor((f+y)/2),s=r[x],d=r[x+1],s<=t){if(x===o||t<d)return x;f=x+1}else{if(!(s>t))throw new Pt("Input is not a number.");y=x-1}return 0}class ua{constructor(t,o,s){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[d,f]of s)this.labels.push(d),this.outputs.push(f)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const s=o.parse(t[1],1,Ue);if(!s)return null;const d=[];let f=null;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);for(let y=1;y<t.length;y+=2){const x=y===1?-1/0:t[y],S=t[y+1],C=y,I=y+1;if(typeof x!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=x)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const P=o.parse(S,I,f);if(!P)return null;f=f||P.type,d.push([x,P])}return new ua(f,s,d)}evaluate(t){const o=this.labels,s=this.outputs;if(o.length===1)return s[0].evaluate(t);const d=this.input.evaluate(t);if(d<=o[0])return s[0].evaluate(t);const f=o.length;return d>=o[f-1]?s[f-1].evaluate(t):s[es(o,d)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function rf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var of=zh;function zh(r,t,o,s){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=s}zh.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,s=0;s<8;s++){var d=this.sampleCurveX(o)-r;if(Math.abs(d)<t)return o;var f=this.sampleCurveDerivativeX(o);if(Math.abs(f)<1e-6)break;o-=d/f}var y=0,x=1;for(o=r,s=0;s<20&&(d=this.sampleCurveX(o),!(Math.abs(d-r)<t));s++)r>d?y=o:x=o,o=.5*(x-y)+y;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var af=rf(of);function _o(r,t,o){return r+o*(t-r)}function ts(r,t,o){return r.map((s,d)=>_o(s,t[d],o))}const Nr={number:_o,color:function(r,t,o,s="rgb"){switch(s){case"rgb":{const[d,f,y,x]=ts(r.rgb,t.rgb,o);return new Et(d,f,y,x,!1)}case"hcl":{const[d,f,y,x]=r.hcl,[S,C,I,P]=t.hcl;let D,F;if(isNaN(d)||isNaN(S))isNaN(d)?isNaN(S)?D=NaN:(D=S,y!==1&&y!==0||(F=C)):(D=d,I!==1&&I!==0||(F=f));else{let ye=S-d;S>d&&ye>180?ye-=360:S<d&&d-S>180&&(ye+=360),D=d+o*ye}const[O,U,J,ne]=function([ye,le,fe,Ee]){return ye=isNaN(ye)?0:ye*ce,mt([fe,Math.cos(ye)*le,Math.sin(ye)*le,Ee])}([D,F??_o(f,C,o),_o(y,I,o),_o(x,P,o)]);return new Et(O,U,J,ne,!1)}case"lab":{const[d,f,y,x]=mt(ts(r.lab,t.lab,o));return new Et(d,f,y,x,!1)}}},array:ts,padding:function(r,t,o){return new Nn(ts(r.values,t.values,o))},variableAnchorOffsetCollection:function(r,t,o){const s=r.values,d=t.values;if(s.length!==d.length)throw new Pt(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);const f=[];for(let y=0;y<s.length;y+=2){if(s[y]!==d[y])throw new Pt(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${s[y]}, to[${y}]: ${d[y]}`);f.push(s[y]);const[x,S]=s[y+1],[C,I]=d[y+1];f.push([_o(x,C,o),_o(S,I,o)])}return new mn(f)}};class jr{constructor(t,o,s,d,f){this.type=t,this.operator=o,this.interpolation=s,this.input=d,this.labels=[],this.outputs=[];for(const[y,x]of f)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(t,o,s,d){let f=0;if(t.name==="exponential")f=ns(o,t.base,s,d);else if(t.name==="linear")f=ns(o,1,s,d);else if(t.name==="cubic-bezier"){const y=t.controlPoints;f=new af(y[0],y[1],y[2],y[3]).solve(ns(o,1,s,d))}return f}static parse(t,o){let[s,d,f,...y]=t;if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const C=d[1];if(typeof C!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if(d[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(C.length!==4||C.some(I=>typeof I!="number"||I<0||I>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(f=o.parse(f,2,Ue),!f)return null;const x=[];let S=null;s==="interpolate-hcl"||s==="interpolate-lab"?S=Yn:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let C=0;C<y.length;C+=2){const I=y[C],P=y[C+1],D=C+3,F=C+4;if(typeof I!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(x.length&&x[x.length-1][0]>=I)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const O=o.parse(P,F,S);if(!O)return null;S=S||O.type,x.push([I,O])}return me(S,Ue)||me(S,Yn)||me(S,Br)||me(S,Q)||me(S,L(Ue))?new jr(S,s,d,f,x):o.error(`Type ${R(S)} is not interpolatable.`)}evaluate(t){const o=this.labels,s=this.outputs;if(o.length===1)return s[0].evaluate(t);const d=this.input.evaluate(t);if(d<=o[0])return s[0].evaluate(t);const f=o.length;if(d>=o[f-1])return s[f-1].evaluate(t);const y=es(o,d),x=jr.interpolationFactor(this.interpolation,d,o[y],o[y+1]),S=s[y].evaluate(t),C=s[y+1].evaluate(t);switch(this.operator){case"interpolate":return Nr[this.type.kind](S,C,x);case"interpolate-hcl":return Nr.color(S,C,x,"hcl");case"interpolate-lab":return Nr.color(S,C,x,"lab")}}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ns(r,t,o,s){const d=s-o,f=r-o;return d===0?0:t===1?f/d:(Math.pow(t,f)-1)/(Math.pow(t,d)-1)}class il{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let s=null;const d=o.expectedType;d&&d.kind!=="value"&&(s=d);const f=[];for(const x of t.slice(1)){const S=o.parse(x,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!S)return null;s=s||S.type,f.push(S)}if(!s)throw new Error("No output type");const y=d&&f.some(x=>X(d,x.type));return new il(y?Tt:s,f)}evaluate(t){let o,s=null,d=0;for(const f of this.args)if(d++,s=f.evaluate(t),s&&s instanceof In&&!s.available&&(o||(o=s.name),s=null,d===this.args.length&&(s=o)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ah(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Dh(r,t,o,s){return s.compare(t,o)===0}function Ro(r,t,o){const s=r!=="=="&&r!=="!=";return class Hw{constructor(f,y,x){this.type=gt,this.lhs=f,this.rhs=y,this.collator=x,this.hasUntypedArgument=f.type.kind==="value"||y.type.kind==="value"}static parse(f,y){if(f.length!==3&&f.length!==4)return y.error("Expected two or three arguments.");const x=f[0];let S=y.parse(f[1],1,Tt);if(!S)return null;if(!Ah(x,S.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${R(S.type)}'.`);let C=y.parse(f[2],2,Tt);if(!C)return null;if(!Ah(x,C.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${R(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${R(S.type)}' and '${R(C.type)}'.`);s&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new pr(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new pr(S.type,[C])));let I=null;if(f.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(I=y.parse(f[3],3,Jr),!I)return null}return new Hw(S,C,I)}evaluate(f){const y=this.lhs.evaluate(f),x=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const S=yt(y),C=yt(x);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new Pt(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const S=yt(y),C=yt(x);if(S.kind!=="string"||C.kind!=="string")return t(f,y,x)}return this.collator?o(f,y,x,this.collator.evaluate(f)):t(f,y,x)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}}}const Lh=Ro("==",function(r,t,o){return t===o},Dh),sf=Ro("!=",function(r,t,o){return t!==o},function(r,t,o,s){return!Dh(0,t,o,s)}),lf=Ro("<",function(r,t,o){return t<o},function(r,t,o,s){return s.compare(t,o)<0}),Rh=Ro(">",function(r,t,o){return t>o},function(r,t,o,s){return s.compare(t,o)>0}),Fh=Ro("<=",function(r,t,o){return t<=o},function(r,t,o,s){return s.compare(t,o)<=0}),uf=Ro(">=",function(r,t,o){return t>=o},function(r,t,o,s){return s.compare(t,o)>=0});class ol{constructor(t,o,s){this.type=Jr,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return o.error("Collator options argument must be an object.");const d=o.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,gt);if(!d)return null;const f=o.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,gt);if(!f)return null;let y=null;return s.locale&&(y=o.parse(s.locale,1,Mt),!y)?null:new ol(d,f,y)}evaluate(t){return new Ji(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Cu{constructor(t,o,s,d,f){this.type=Mt,this.number=t,this.locale=o,this.currency=s,this.minFractionDigits=d,this.maxFractionDigits=f}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const s=o.parse(t[1],1,Ue);if(!s)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");let f=null;if(d.locale&&(f=o.parse(d.locale,1,Mt),!f))return null;let y=null;if(d.currency&&(y=o.parse(d.currency,1,Mt),!y))return null;let x=null;if(d["min-fraction-digits"]&&(x=o.parse(d["min-fraction-digits"],1,Ue),!x))return null;let S=null;return d["max-fraction-digits"]&&(S=o.parse(d["max-fraction-digits"],1,Ue),!S)?null:new Cu(s,f,y,x,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class al{constructor(t){this.type=Yr,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return o.error("First argument must be an image or text section.");const d=[];let f=!1;for(let y=1;y<=t.length-1;++y){const x=t[y];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;let S=null;if(x["font-scale"]&&(S=o.parse(x["font-scale"],1,Ue),!S))return null;let C=null;if(x["text-font"]&&(C=o.parse(x["text-font"],1,L(Mt)),!C))return null;let I=null;if(x["text-color"]&&(I=o.parse(x["text-color"],1,Yn),!I))return null;const P=d[d.length-1];P.scale=S,P.font=C,P.textColor=I}else{const S=o.parse(t[y],1,Tt);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,d.push({content:S,scale:null,font:null,textColor:null})}}return new al(d)}evaluate(t){return new On(this.sections.map(o=>{const s=o.content.evaluate(t);return yt(s)===Or?new Qr("",s,null,null,null):new Qr(Gt(s),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}}class ku{constructor(t){this.type=Or,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");const s=o.parse(t[1],1,Mt);return s?new ku(s):o.error("No image name provided.")}evaluate(t){const o=this.input.evaluate(t),s=In.fromString(o);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(o)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class Iu{constructor(t){this.type=Ue,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=o.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${R(s.type)} instead.`):new Iu(s):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Pt(`Expected value to be of type string or array, but found ${R(yt(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Bi=8192;function Pu(r,t){const o=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(o*d*Bi),Math.round(s*d*Bi)]}function ca(r,t){const o=Math.pow(2,t.z);return[(d=(r[0]/Bi+t.x)/o,360*d-180),(s=(r[1]/Bi+t.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,d}function Vt(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function rs(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function cf(r,t,o){const s=r[0]-t[0],d=r[1]-t[1],f=r[0]-o[0],y=r[1]-o[1];return s*y-f*d==0&&s*f<=0&&d*y<=0}function sl(r,t,o,s){return(d=[s[0]-o[0],s[1]-o[1]])[0]*(f=[t[0]-r[0],t[1]-r[1]])[1]-d[1]*f[0]!=0&&!(!Oh(r,t,o,s)||!Oh(o,s,r,t));var d,f}function hf(r,t,o){for(const s of o)for(let d=0;d<s.length-1;++d)if(sl(r,t,s[d],s[d+1]))return!0;return!1}function ha(r,t,o=!1){let s=!1;for(const x of t)for(let S=0;S<x.length-1;S++){if(cf(r,x[S],x[S+1]))return o;(f=x[S])[1]>(d=r)[1]!=(y=x[S+1])[1]>d[1]&&d[0]<(y[0]-f[0])*(d[1]-f[1])/(y[1]-f[1])+f[0]&&(s=!s)}var d,f,y;return s}function df(r,t){for(const o of t)if(ha(r,o))return!0;return!1}function Bh(r,t){for(const o of r)if(!ha(o,t))return!1;for(let o=0;o<r.length-1;++o)if(hf(r[o],r[o+1],t))return!1;return!0}function pf(r,t){for(const o of t)if(Bh(r,o))return!0;return!1}function Oh(r,t,o,s){const d=s[0]-o[0],f=s[1]-o[1],y=(r[0]-o[0])*f-d*(r[1]-o[1]),x=(t[0]-o[0])*f-d*(t[1]-o[1]);return y>0&&x<0||y<0&&x>0}function Mu(r,t,o){const s=[];for(let d=0;d<r.length;d++){const f=[];for(let y=0;y<r[d].length;y++){const x=Pu(r[d][y],o);Vt(t,x),f.push(x)}s.push(f)}return s}function Nh(r,t,o){const s=[];for(let d=0;d<r.length;d++){const f=Mu(r[d],t,o);s.push(f)}return s}function jh(r,t,o,s){if(r[0]<o[0]||r[0]>o[2]){const d=.5*s;let f=r[0]-o[0]>d?-s:o[0]-r[0]>d?s:0;f===0&&(f=r[0]-o[2]>d?-s:o[2]-r[0]>d?s:0),r[0]+=f}Vt(t,r)}function Vh(r,t,o,s){const d=Math.pow(2,s.z)*Bi,f=[s.x*Bi,s.y*Bi],y=[];for(const x of r)for(const S of x){const C=[S.x+f[0],S.y+f[1]];jh(C,t,o,d),y.push(C)}return y}function Uh(r,t,o,s){const d=Math.pow(2,s.z)*Bi,f=[s.x*Bi,s.y*Bi],y=[];for(const S of r){const C=[];for(const I of S){const P=[I.x+f[0],I.y+f[1]];Vt(t,P),C.push(P)}y.push(C)}if(t[2]-t[0]<=d/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of y)for(const C of S)jh(C,t,o,d)}var x;return y}class Fo{constructor(t,o){this.type=gt,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Fi(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const d=[];for(const f of s.features){const{type:y,coordinates:x}=f.geometry;y==="Polygon"&&d.push(x),y==="MultiPolygon"&&d.push(...x)}if(d.length)return new Fo(s,{type:"MultiPolygon",coordinates:d})}else if(s.type==="Feature"){const d=s.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Fo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Fo(s,s)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,s){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(s.type==="Polygon"){const x=Mu(s.coordinates,f,y),S=Vh(o.geometry(),d,f,y);if(!rs(d,f))return!1;for(const C of S)if(!ha(C,x))return!1}if(s.type==="MultiPolygon"){const x=Nh(s.coordinates,f,y),S=Vh(o.geometry(),d,f,y);if(!rs(d,f))return!1;for(const C of S)if(!df(C,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,s){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(s.type==="Polygon"){const x=Mu(s.coordinates,f,y),S=Uh(o.geometry(),d,f,y);if(!rs(d,f))return!1;for(const C of S)if(!Bh(C,x))return!1}if(s.type==="MultiPolygon"){const x=Nh(s.coordinates,f,y),S=Uh(o.geometry(),d,f,y);if(!rs(d,f))return!1;for(const C of S)if(!pf(C,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let $h=class{constructor(r=[],t=(o,s)=>o<s?-1:o>s?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:o}=this,s=t[r];for(;r>0;){const d=r-1>>1,f=t[d];if(o(s,f)>=0)break;t[r]=f,r=d}t[r]=s}_down(r){const{data:t,compare:o}=this,s=this.length>>1,d=t[r];for(;r<s;){let f=1+(r<<1);const y=f+1;if(y<this.length&&o(t[y],t[f])<0&&(f=y),o(t[f],d)>=0)break;t[r]=t[f],r=f}t[r]=d}};function ff(r,t,o,s,d){Zh(r,t,o,s||r.length-1,d||mf)}function Zh(r,t,o,s,d){for(;s>o;){if(s-o>600){var f=s-o+1,y=t-o+1,x=Math.log(f),S=.5*Math.exp(2*x/3),C=.5*Math.sqrt(x*S*(f-S)/f)*(y-f/2<0?-1:1);Zh(r,t,Math.max(o,Math.floor(t-y*S/f+C)),Math.min(s,Math.floor(t+(f-y)*S/f+C)),d)}var I=r[t],P=o,D=s;for(is(r,o,t),d(r[s],I)>0&&is(r,o,s);P<D;){for(is(r,P,D),P++,D--;d(r[P],I)<0;)P++;for(;d(r[D],I)>0;)D--}d(r[o],I)===0?is(r,o,D):is(r,++D,s),D<=t&&(o=D+1),t<=D&&(s=D-1)}}function is(r,t,o){var s=r[t];r[t]=r[o],r[o]=s}function mf(r,t){return r<t?-1:r>t?1:0}function ll(r,t){if(r.length<=1)return[r];const o=[];let s,d;for(const f of r){const y=yf(f);y!==0&&(f.area=Math.abs(y),d===void 0&&(d=y<0),d===y<0?(s&&o.push(s),s=[f]):s.push(f))}if(s&&o.push(s),t>1)for(let f=0;f<o.length;f++)o[f].length<=t||(ff(o[f],t,1,o[f].length-1,gf),o[f]=o[f].slice(0,t));return o}function gf(r,t){return t.area-r.area}function yf(r){let t=0;for(let o,s,d=0,f=r.length,y=f-1;d<f;y=d++)o=r[d],s=r[y],t+=(s.x-o.x)*(o.y+s.y);return t}const qh=1/298.257223563,Hh=qh*(2-qh),Gh=Math.PI/180;class zu{constructor(t){const o=6378.137*Gh*1e3,s=Math.cos(t*Gh),d=1/(1-Hh*(1-s*s)),f=Math.sqrt(d);this.kx=o*f*s,this.ky=o*f*d*(1-Hh)}distance(t,o){const s=this.wrap(t[0]-o[0])*this.kx,d=(t[1]-o[1])*this.ky;return Math.sqrt(s*s+d*d)}pointOnLine(t,o){let s,d,f,y,x=1/0;for(let S=0;S<t.length-1;S++){let C=t[S][0],I=t[S][1],P=this.wrap(t[S+1][0]-C)*this.kx,D=(t[S+1][1]-I)*this.ky,F=0;P===0&&D===0||(F=(this.wrap(o[0]-C)*this.kx*P+(o[1]-I)*this.ky*D)/(P*P+D*D),F>1?(C=t[S+1][0],I=t[S+1][1]):F>0&&(C+=P/this.kx*F,I+=D/this.ky*F)),P=this.wrap(o[0]-C)*this.kx,D=(o[1]-I)*this.ky;const O=P*P+D*D;O<x&&(x=O,s=C,d=I,f=S,y=F)}return{point:[s,d],index:f,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Wh(r,t){return t[0]-r[0]}function ul(r){return r[1]-r[0]+1}function Qi(r,t){return r[1]>=r[0]&&r[1]<t}function Au(r,t){if(r[0]>r[1])return[null,null];const o=ul(r);if(t){if(o===2)return[r,null];const d=Math.floor(o/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(o===1)return[r,null];const s=Math.floor(o/2)-1;return[[r[0],r[0]+s],[r[0]+s+1,r[1]]]}function os(r,t){if(!Qi(t,r.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)Vt(o,r[s]);return o}function Du(r){const t=[1/0,1/0,-1/0,-1/0];for(const o of r)for(const s of o)Vt(t,s);return t}function Xh(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function Lu(r,t,o){if(!Xh(r)||!Xh(t))return NaN;let s=0,d=0;return r[2]<t[0]&&(s=t[0]-r[2]),r[0]>t[2]&&(s=r[0]-t[2]),r[1]>t[3]&&(d=r[1]-t[3]),r[3]<t[1]&&(d=t[1]-r[3]),o.distance([0,0],[s,d])}function Bo(r,t,o){const s=o.pointOnLine(t,r);return o.distance(r,s.point)}function vn(r,t,o,s,d){const f=Math.min(Bo(r,[o,s],d),Bo(t,[o,s],d)),y=Math.min(Bo(o,[r,t],d),Bo(s,[r,t],d));return Math.min(f,y)}function _f(r,t,o,s,d){if(!Qi(t,r.length)||!Qi(s,o.length))return 1/0;let f=1/0;for(let y=t[0];y<t[1];++y){const x=r[y],S=r[y+1];for(let C=s[0];C<s[1];++C){const I=o[C],P=o[C+1];if(sl(x,S,I,P))return 0;f=Math.min(f,vn(x,S,I,P,d))}}return f}function Rt(r,t,o,s,d){if(!Qi(t,r.length)||!Qi(s,o.length))return NaN;let f=1/0;for(let y=t[0];y<=t[1];++y)for(let x=s[0];x<=s[1];++x)if(f=Math.min(f,d.distance(r[y],o[x])),f===0)return f;return f}function Ru(r,t,o){if(ha(r,t,!0))return 0;let s=1/0;for(const d of t){const f=d[0],y=d[d.length-1];if(f!==y&&(s=Math.min(s,Bo(r,[y,f],o)),s===0))return s;const x=o.pointOnLine(d,r);if(s=Math.min(s,o.distance(r,x.point)),s===0)return s}return s}function hn(r,t,o,s){if(!Qi(t,r.length))return NaN;for(let f=t[0];f<=t[1];++f)if(ha(r[f],o,!0))return 0;let d=1/0;for(let f=t[0];f<t[1];++f){const y=r[f],x=r[f+1];for(const S of o)for(let C=0,I=S.length,P=I-1;C<I;P=C++){const D=S[P],F=S[C];if(sl(y,x,D,F))return 0;d=Math.min(d,vn(y,x,D,F,s))}}return d}function en(r,t){for(const o of r)for(const s of o)if(ha(s,t,!0))return!0;return!1}function cl(r,t,o,s=1/0){const d=Du(r),f=Du(t);if(s!==1/0&&Lu(d,f,o)>=s)return s;if(rs(d,f)){if(en(r,t))return 0}else if(en(t,r))return 0;let y=1/0;for(const x of r)for(let S=0,C=x.length,I=C-1;S<C;I=S++){const P=x[I],D=x[S];for(const F of t)for(let O=0,U=F.length,J=U-1;O<U;J=O++){const ne=F[J],ye=F[O];if(sl(P,D,ne,ye))return 0;y=Math.min(y,vn(P,D,ne,ye,o))}}return y}function Fu(r,t,o,s,d,f){if(!f)return;const y=Lu(os(s,f),d,o);y<t&&r.push([y,f,[0,0]])}function as(r,t,o,s,d,f,y){if(!f||!y)return;const x=Lu(os(s,f),os(d,y),o);x<t&&r.push([x,f,y])}function hl(r,t,o,s,d=1/0){let f=Math.min(s.distance(r[0],o[0][0]),d);if(f===0)return f;const y=new $h([[0,[0,r.length-1],[0,0]]],Wh),x=Du(o);for(;y.length>0;){const S=y.pop();if(S[0]>=f)continue;const C=S[1],I=t?50:100;if(ul(C)<=I){if(!Qi(C,r.length))return NaN;if(t){const P=hn(r,C,o,s);if(isNaN(P)||P===0)return P;f=Math.min(f,P)}else for(let P=C[0];P<=C[1];++P){const D=Ru(r[P],o,s);if(f=Math.min(f,D),f===0)return 0}}else{const P=Au(C,t);Fu(y,f,s,r,x,P[0]),Fu(y,f,s,r,x,P[1])}}return f}function dl(r,t,o,s,d,f=1/0){let y=Math.min(f,d.distance(r[0],o[0]));if(y===0)return y;const x=new $h([[0,[0,r.length-1],[0,o.length-1]]],Wh);for(;x.length>0;){const S=x.pop();if(S[0]>=y)continue;const C=S[1],I=S[2],P=t?50:100,D=s?50:100;if(ul(C)<=P&&ul(I)<=D){if(!Qi(C,r.length)&&Qi(I,o.length))return NaN;let F;if(t&&s)F=_f(r,C,o,I,d),y=Math.min(y,F);else if(t&&!s){const O=r.slice(C[0],C[1]+1);for(let U=I[0];U<=I[1];++U)if(F=Bo(o[U],O,d),y=Math.min(y,F),y===0)return y}else if(!t&&s){const O=o.slice(I[0],I[1]+1);for(let U=C[0];U<=C[1];++U)if(F=Bo(r[U],O,d),y=Math.min(y,F),y===0)return y}else F=Rt(r,C,o,I,d),y=Math.min(y,F)}else{const F=Au(C,t),O=Au(I,s);as(x,y,d,r,o,F[0],O[0]),as(x,y,d,r,o,F[0],O[1]),as(x,y,d,r,o,F[1],O[0]),as(x,y,d,r,o,F[1],O[1])}}return y}function Bu(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class Oo{constructor(t,o){this.type=Ue,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Fi(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Oo(s,s.features.map(d=>Bu(d.geometry)).flat());if(s.type==="Feature")return new Oo(s,Bu(s.geometry));if("type"in s&&"coordinates"in s)return new Oo(s,Bu(s))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,s){const d=o.geometry(),f=d.flat().map(S=>ca([S.x,S.y],o.canonical));if(d.length===0)return NaN;const y=new zu(f[0][1]);let x=1/0;for(const S of s){switch(S.type){case"Point":x=Math.min(x,dl(f,!1,[S.coordinates],!1,y,x));break;case"LineString":x=Math.min(x,dl(f,!1,S.coordinates,!0,y,x));break;case"Polygon":x=Math.min(x,hl(f,!1,S.coordinates,y,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,s){const d=o.geometry(),f=d.flat().map(S=>ca([S.x,S.y],o.canonical));if(d.length===0)return NaN;const y=new zu(f[0][1]);let x=1/0;for(const S of s){switch(S.type){case"Point":x=Math.min(x,dl(f,!0,[S.coordinates],!1,y,x));break;case"LineString":x=Math.min(x,dl(f,!0,S.coordinates,!0,y,x));break;case"Polygon":x=Math.min(x,hl(f,!0,S.coordinates,y,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="Polygon")return function(o,s){const d=o.geometry();if(d.length===0||d[0].length===0)return NaN;const f=ll(d,0).map(S=>S.map(C=>C.map(I=>ca([I.x,I.y],o.canonical)))),y=new zu(f[0][0][0][1]);let x=1/0;for(const S of s)for(const C of f){switch(S.type){case"Point":x=Math.min(x,hl([S.coordinates],!1,C,y,x));break;case"LineString":x=Math.min(x,hl(S.coordinates,!0,C,y,x));break;case"Polygon":x=Math.min(x,cl(C,S.coordinates,y,x))}if(x===0)return x}return x}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const No={"==":Lh,"!=":sf,">":Rh,"<":lf,">=":uf,"<=":Fh,array:pr,at:Eu,boolean:pr,case:nl,coalesce:il,collator:ol,format:al,image:ku,in:Qa,"index-of":el,interpolate:jr,"interpolate-hcl":jr,"interpolate-lab":jr,length:Iu,let:Ht,literal:Pn,match:tl,number:pr,"number-format":Cu,object:pr,slice:rl,step:ua,string:pr,"to-boolean":go,"to-color":go,"to-number":go,"to-string":go,var:Qs,within:Fo,distance:Oo};class Vr{constructor(t,o,s,d){this.name=t,this.type=o,this._evaluate=s,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,o){const s=t[0],d=Vr.definitions[s];if(!d)return o.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=y.filter(([C])=>!Array.isArray(C)||C.length===t.length-1);let S=null;for(const[C,I]of x){S=new yo(o.registry,pl,o.path,null,o.scope);const P=[];let D=!1;for(let F=1;F<t.length;F++){const O=t[F],U=Array.isArray(C)?C[F-1]:C.type,J=S.parse(O,1+P.length,U);if(!J){D=!0;break}P.push(J)}if(!D)if(Array.isArray(C)&&C.length!==P.length)S.error(`Expected ${C.length} arguments, but found ${P.length} instead.`);else{for(let F=0;F<P.length;F++){const O=Array.isArray(C)?C[F]:C.type,U=P[F];S.concat(F+1).checkSubtype(O,U.type)}if(S.errors.length===0)return new Vr(s,f,I,P)}}if(x.length===1)o.errors.push(...S.errors);else{const C=(x.length?x:y).map(([P])=>{return D=P,Array.isArray(D)?`(${D.map(R).join(", ")})`:`(${R(D.type)}...)`;var D}).join(" | "),I=[];for(let P=1;P<t.length;P++){const D=o.parse(t[P],1+I.length);if(!D)return null;I.push(R(D.type))}o.error(`Expected arguments of type ${C}, but found (${I.join(", ")}) instead.`)}return null}static register(t,o){Vr.definitions=o;for(const s in o)t[s]=Vr}}function Ou(r,[t,o,s,d]){t=t.evaluate(r),o=o.evaluate(r),s=s.evaluate(r);const f=d?d.evaluate(r):1,y=Yi(t,o,s,f);if(y)throw new Pt(y);return new Et(t/255,o/255,s/255,f,!1)}function Nu(r,t){return r in t}function ss(r,t){const o=t[r];return o===void 0?null:o}function jo(r){return{type:r}}function pl(r){if(r instanceof Qs)return pl(r.boundExpression);if(r instanceof Vr&&r.name==="error"||r instanceof ol||r instanceof Fo||r instanceof Oo)return!1;const t=r instanceof go||r instanceof pr;let o=!0;return r.eachChild(s=>{o=t?o&&pl(s):o&&s instanceof Pn}),!!o&&fl(r)&&ml(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function fl(r){if(r instanceof Vr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Fo||r instanceof Oo)return!1;let t=!0;return r.eachChild(o=>{t&&!fl(o)&&(t=!1)}),t}function ls(r){if(r instanceof Vr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(o=>{t&&!ls(o)&&(t=!1)}),t}function ml(r,t){if(r instanceof Vr&&t.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(s=>{o&&!ml(s,t)&&(o=!1)}),o}function Kh(r){return{result:"success",value:r}}function da(r){return{result:"error",value:r}}function pa(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function ju(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function gl(r){return!!r.expression&&r.expression.interpolated}function jt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function yl(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Jh(r){return r}function Vu(r,t){const o=t.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",d=s||!(s||r.property!==void 0),f=r.type||(gl(t)?"exponential":"interval");if(o||t.type==="padding"){const I=o?Et.parse:Nn.parse;(r=br({},r)).stops&&(r.stops=r.stops.map(P=>[P[0],I(P[1])])),r.default=I(r.default?r.default:t.default)}if(r.colorSpace&&(y=r.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var y;let x,S,C;if(f==="exponential")x=cs;else if(f==="interval")x=_l;else if(f==="categorical"){x=Uu,S=Object.create(null);for(const I of r.stops)S[I[0]]=I[1];C=typeof r.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);x=Yh}if(s){const I={},P=[];for(let O=0;O<r.stops.length;O++){const U=r.stops[O],J=U[0].zoom;I[J]===void 0&&(I[J]={zoom:J,type:r.type,property:r.property,default:r.default,stops:[]},P.push(J)),I[J].stops.push([U[0].value,U[1]])}const D=[];for(const O of P)D.push([I[O].zoom,Vu(I[O],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:jr.interpolationFactor.bind(void 0,F),zoomStops:D.map(O=>O[0]),evaluate:({zoom:O},U)=>cs({stops:D,base:r.base},t,O).evaluate(O,U)}}if(d){const I=f==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:jr.interpolationFactor.bind(void 0,I),zoomStops:r.stops.map(P=>P[0]),evaluate:({zoom:P})=>x(r,t,P,S,C)}}return{kind:"source",evaluate(I,P){const D=P&&P.properties?P.properties[r.property]:void 0;return D===void 0?us(r.default,t.default):x(r,t,D,S,C)}}}function us(r,t,o){return r!==void 0?r:t!==void 0?t:o!==void 0?o:void 0}function Uu(r,t,o,s,d){return us(typeof o===d?s[o]:void 0,r.default,t.default)}function _l(r,t,o){if(jt(o)!=="number")return us(r.default,t.default);const s=r.stops.length;if(s===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[s-1][0])return r.stops[s-1][1];const d=es(r.stops.map(f=>f[0]),o);return r.stops[d][1]}function cs(r,t,o){const s=r.base!==void 0?r.base:1;if(jt(o)!=="number")return us(r.default,t.default);const d=r.stops.length;if(d===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[d-1][0])return r.stops[d-1][1];const f=es(r.stops.map(I=>I[0]),o),y=function(I,P,D,F){const O=F-D,U=I-D;return O===0?0:P===1?U/O:(Math.pow(P,U)-1)/(Math.pow(P,O)-1)}(o,s,r.stops[f][0],r.stops[f+1][0]),x=r.stops[f][1],S=r.stops[f+1][1],C=Nr[t.type]||Jh;return typeof x.evaluate=="function"?{evaluate(...I){const P=x.evaluate.apply(void 0,I),D=S.evaluate.apply(void 0,I);if(P!==void 0&&D!==void 0)return C(P,D,y,r.colorSpace)}}:C(x,S,y,r.colorSpace)}function Yh(r,t,o){switch(t.type){case"color":o=Et.parse(o);break;case"formatted":o=On.fromString(o.toString());break;case"resolvedImage":o=In.fromString(o.toString());break;case"padding":o=Nn.parse(o);break;default:jt(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0)}return us(o,r.default,t.default)}Vr.register(No,{error:[{kind:"error"},[Mt],(r,[t])=>{throw new Pt(t.evaluate(r))}],typeof:[Mt,[Tt],(r,[t])=>R(yt(t.evaluate(r)))],"to-rgba":[L(Ue,4),[Yn],(r,[t])=>{const[o,s,d,f]=t.evaluate(r).rgb;return[255*o,255*s,255*d,f]}],rgb:[Yn,[Ue,Ue,Ue],Ou],rgba:[Yn,[Ue,Ue,Ue,Ue],Ou],has:{type:gt,overloads:[[[Mt],(r,[t])=>Nu(t.evaluate(r),r.properties())],[[Mt,Sr],(r,[t,o])=>Nu(t.evaluate(r),o.evaluate(r))]]},get:{type:Tt,overloads:[[[Mt],(r,[t])=>ss(t.evaluate(r),r.properties())],[[Mt,Sr],(r,[t,o])=>ss(t.evaluate(r),o.evaluate(r))]]},"feature-state":[Tt,[Mt],(r,[t])=>ss(t.evaluate(r),r.featureState||{})],properties:[Sr,[],r=>r.properties()],"geometry-type":[Mt,[],r=>r.geometryType()],id:[Tt,[],r=>r.id()],zoom:[Ue,[],r=>r.globals.zoom],"heatmap-density":[Ue,[],r=>r.globals.heatmapDensity||0],"line-progress":[Ue,[],r=>r.globals.lineProgress||0],accumulated:[Tt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Ue,jo(Ue),(r,t)=>{let o=0;for(const s of t)o+=s.evaluate(r);return o}],"*":[Ue,jo(Ue),(r,t)=>{let o=1;for(const s of t)o*=s.evaluate(r);return o}],"-":{type:Ue,overloads:[[[Ue,Ue],(r,[t,o])=>t.evaluate(r)-o.evaluate(r)],[[Ue],(r,[t])=>-t.evaluate(r)]]},"/":[Ue,[Ue,Ue],(r,[t,o])=>t.evaluate(r)/o.evaluate(r)],"%":[Ue,[Ue,Ue],(r,[t,o])=>t.evaluate(r)%o.evaluate(r)],ln2:[Ue,[],()=>Math.LN2],pi:[Ue,[],()=>Math.PI],e:[Ue,[],()=>Math.E],"^":[Ue,[Ue,Ue],(r,[t,o])=>Math.pow(t.evaluate(r),o.evaluate(r))],sqrt:[Ue,[Ue],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Ue,[Ue],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Ue,[Ue],(r,[t])=>Math.log(t.evaluate(r))],log2:[Ue,[Ue],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Ue,[Ue],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Ue,[Ue],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Ue,[Ue],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Ue,[Ue],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Ue,[Ue],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Ue,[Ue],(r,[t])=>Math.atan(t.evaluate(r))],min:[Ue,jo(Ue),(r,t)=>Math.min(...t.map(o=>o.evaluate(r)))],max:[Ue,jo(Ue),(r,t)=>Math.max(...t.map(o=>o.evaluate(r)))],abs:[Ue,[Ue],(r,[t])=>Math.abs(t.evaluate(r))],round:[Ue,[Ue],(r,[t])=>{const o=t.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ue,[Ue],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Ue,[Ue],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[gt,[Mt,Tt],(r,[t,o])=>r.properties()[t.value]===o.value],"filter-id-==":[gt,[Tt],(r,[t])=>r.id()===t.value],"filter-type-==":[gt,[Mt],(r,[t])=>r.geometryType()===t.value],"filter-<":[gt,[Mt,Tt],(r,[t,o])=>{const s=r.properties()[t.value],d=o.value;return typeof s==typeof d&&s<d}],"filter-id-<":[gt,[Tt],(r,[t])=>{const o=r.id(),s=t.value;return typeof o==typeof s&&o<s}],"filter->":[gt,[Mt,Tt],(r,[t,o])=>{const s=r.properties()[t.value],d=o.value;return typeof s==typeof d&&s>d}],"filter-id->":[gt,[Tt],(r,[t])=>{const o=r.id(),s=t.value;return typeof o==typeof s&&o>s}],"filter-<=":[gt,[Mt,Tt],(r,[t,o])=>{const s=r.properties()[t.value],d=o.value;return typeof s==typeof d&&s<=d}],"filter-id-<=":[gt,[Tt],(r,[t])=>{const o=r.id(),s=t.value;return typeof o==typeof s&&o<=s}],"filter->=":[gt,[Mt,Tt],(r,[t,o])=>{const s=r.properties()[t.value],d=o.value;return typeof s==typeof d&&s>=d}],"filter-id->=":[gt,[Tt],(r,[t])=>{const o=r.id(),s=t.value;return typeof o==typeof s&&o>=s}],"filter-has":[gt,[Tt],(r,[t])=>t.value in r.properties()],"filter-has-id":[gt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[gt,[L(Mt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[gt,[L(Tt)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[gt,[Mt,L(Tt)],(r,[t,o])=>o.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[gt,[Mt,L(Tt)],(r,[t,o])=>function(s,d,f,y){for(;f<=y;){const x=f+y>>1;if(d[x]===s)return!0;d[x]>s?y=x-1:f=x+1}return!1}(r.properties()[t.value],o.value,0,o.value.length-1)],all:{type:gt,overloads:[[[gt,gt],(r,[t,o])=>t.evaluate(r)&&o.evaluate(r)],[jo(gt),(r,t)=>{for(const o of t)if(!o.evaluate(r))return!1;return!0}]]},any:{type:gt,overloads:[[[gt,gt],(r,[t,o])=>t.evaluate(r)||o.evaluate(r)],[jo(gt),(r,t)=>{for(const o of t)if(o.evaluate(r))return!0;return!1}]]},"!":[gt,[gt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[gt,[Mt],(r,[t])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(t.evaluate(r))}],upcase:[Mt,[Mt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Mt,[Mt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Mt,jo(Tt),(r,t)=>t.map(o=>Gt(o.evaluate(r))).join("")],"resolved-locale":[Mt,[Jr],(r,[t])=>t.evaluate(r).resolvedLocale()]});class hs{constructor(t,o){var s;this.expression=t,this._warningHistory={},this._evaluator=new Ya,this._defaultValue=o?(s=o).type==="color"&&yl(s.default)?new Et(0,0,0,0):s.type==="color"?Et.parse(s.default)||null:s.type==="padding"?Nn.parse(s.default)||null:s.type==="variableAnchorOffsetCollection"?mn.parse(s.default)||null:s.default===void 0?null:s.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,s,d,f,y){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=s,this._evaluator.canonical=d,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,o,s,d,f,y){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=s||null,this._evaluator.canonical=d,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Pt(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function ds(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in No}function ps(r,t){const o=new yo(No,pl,[],t?function(d){const f={color:Yn,string:Mt,number:Ue,enum:Mt,boolean:gt,formatted:Yr,padding:Br,resolvedImage:Or,variableAnchorOffsetCollection:Q};return d.type==="array"?L(f[d.value]||Tt,d.length):f[d.type]}(t):void 0),s=o.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Kh(new hs(s,t)):da(o.errors)}class fa{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!ls(o.expression)}evaluateWithoutErrorHandling(t,o,s,d,f,y){return this._styleExpression.evaluateWithoutErrorHandling(t,o,s,d,f,y)}evaluate(t,o,s,d,f,y){return this._styleExpression.evaluate(t,o,s,d,f,y)}}class $u{constructor(t,o,s,d){this.kind=t,this.zoomStops=s,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!ls(o.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,o,s,d,f,y){return this._styleExpression.evaluateWithoutErrorHandling(t,o,s,d,f,y)}evaluate(t,o,s,d,f,y){return this._styleExpression.evaluate(t,o,s,d,f,y)}interpolationFactor(t,o,s){return this.interpolationType?jr.interpolationFactor(this.interpolationType,t,o,s):0}}function Qh(r,t){const o=ps(r,t);if(o.result==="error")return o;const s=o.value.expression,d=fl(s);if(!d&&!pa(t))return da([new fn("","data expressions not supported")]);const f=ml(s,["zoom"]);if(!f&&!ju(t))return da([new fn("","zoom expressions not supported")]);const y=xl(s);return y||f?y instanceof fn?da([y]):y instanceof jr&&!gl(t)?da([new fn("",'"interpolate" expressions cannot be used with this property')]):Kh(y?new $u(d?"camera":"composite",o.value,y.labels,y instanceof jr?y.interpolation:void 0):new fa(d?"constant":"source",o.value)):da([new fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class vl{constructor(t,o){this._parameters=t,this._specification=o,br(this,Vu(this._parameters,this._specification))}static deserialize(t){return new vl(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function xl(r){let t=null;if(r instanceof Ht)t=xl(r.result);else if(r instanceof il){for(const o of r.args)if(t=xl(o),t)break}else(r instanceof ua||r instanceof jr)&&r.input instanceof Vr&&r.input.name==="zoom"&&(t=r);return t instanceof fn||r.eachChild(o=>{const s=xl(o);s instanceof fn?t=s:!t&&s?t=new fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new fn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Zu(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Zu(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const wl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ma(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Zu(r)||(r=fs(r));const t=ps(r,wl);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,s,d)=>t.value.evaluate(o,s,{},d),needGeometry:ga(r)}}function Ur(r,t){return r<t?-1:r>t?1:0}function ga(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(ga(r[t]))return!0;return!1}function fs(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?qu(r[1],r[2],"=="):t==="!="?ms(qu(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?qu(r[1],r[2],t):t==="any"?(o=r.slice(1),["any"].concat(o.map(fs))):t==="all"?["all"].concat(r.slice(1).map(fs)):t==="none"?["all"].concat(r.slice(1).map(fs).map(ms)):t==="in"?ed(r[1],r.slice(2)):t==="!in"?ms(ed(r[1],r.slice(2))):t==="has"?ya(r[1]):t!=="!has"||ms(ya(r[1]));var o}function qu(r,t,o){switch(r){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,r,t]}}function ed(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",r,["literal",t.sort(Ur)]]:["filter-in-small",r,["literal",t]]}}function ya(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ms(r){return["!",r]}function gs(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(const f of r)d+=`${gs(f)},`;return`${d}]`}const o=Object.keys(r).sort();let s="{";for(let d=0;d<o.length;d++)s+=`${JSON.stringify(o[d])}:${gs(r[o[d]])},`;return`${s}}`}function vf(r){let t="";for(const o of Ki)t+=`/${gs(r[o])}`;return t}function bl(r){const t=r.value;return t?[new Ne(r.key,t,"constants have been deprecated as of v8")]:[]}function Tn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function fi(r){if(Array.isArray(r))return r.map(fi);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const o in r)t[o]=fi(r[o]);return t}return Tn(r)}function ei(r){const t=r.key,o=r.value,s=r.valueSpec||{},d=r.objectElementValidators||{},f=r.style,y=r.styleSpec,x=r.validateSpec;let S=[];const C=jt(o);if(C!=="object")return[new Ne(t,o,`object expected, ${C} found`)];for(const I in o){const P=I.split(".")[0],D=s[P]||s["*"];let F;if(d[P])F=d[P];else if(s[P])F=x;else if(d["*"])F=d["*"];else{if(!s["*"]){S.push(new Ne(t,o[I],`unknown property "${I}"`));continue}F=x}S=S.concat(F({key:(t&&`${t}.`)+I,value:o[I],valueSpec:D,style:f,styleSpec:y,object:o,objectKey:I,validateSpec:x},o))}for(const I in s)d[I]||s[I].required&&s[I].default===void 0&&o[I]===void 0&&S.push(new Ne(t,o,`missing required property "${I}"`));return S}function ys(r){const t=r.value,o=r.valueSpec,s=r.style,d=r.styleSpec,f=r.key,y=r.arrayElementValidator||r.validateSpec;if(jt(t)!=="array")return[new Ne(f,t,`array expected, ${jt(t)} found`)];if(o.length&&t.length!==o.length)return[new Ne(f,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new Ne(f,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let x={type:o.value,values:o.values};d.$version<7&&(x.function=o.function),jt(o.value)==="object"&&(x=o.value);let S=[];for(let C=0;C<t.length;C++)S=S.concat(y({array:t,arrayIndex:C,value:t[C],valueSpec:x,validateSpec:r.validateSpec,style:s,styleSpec:d,key:`${f}[${C}]`}));return S}function Sl(r){const t=r.key,o=r.value,s=r.valueSpec;let d=jt(o);return d==="number"&&o!=o&&(d="NaN"),d!=="number"?[new Ne(t,o,`number expected, ${d} found`)]:"minimum"in s&&o<s.minimum?[new Ne(t,o,`${o} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&o>s.maximum?[new Ne(t,o,`${o} is greater than the maximum value ${s.maximum}`)]:[]}function Tl(r){const t=r.valueSpec,o=Tn(r.value.type);let s,d,f,y={};const x=o!=="categorical"&&r.value.property===void 0,S=!x,C=jt(r.value.stops)==="array"&&jt(r.value.stops[0])==="array"&&jt(r.value.stops[0][0])==="object",I=ei({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(F){if(o==="identity")return[new Ne(F.key,F.value,'identity function may not have a "stops" property')];let O=[];const U=F.value;return O=O.concat(ys({key:F.key,value:U,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:P})),jt(U)==="array"&&U.length===0&&O.push(new Ne(F.key,U,"array must have at least one stop")),O},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return o==="identity"&&x&&I.push(new Ne(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||I.push(new Ne(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!gl(r.valueSpec)&&I.push(new Ne(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!pa(r.valueSpec)?I.push(new Ne(r.key,r.value,"property functions not supported")):x&&!ju(r.valueSpec)&&I.push(new Ne(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!C||r.value.property!==void 0||I.push(new Ne(r.key,r.value,'"property" property is required')),I;function P(F){let O=[];const U=F.value,J=F.key;if(jt(U)!=="array")return[new Ne(J,U,`array expected, ${jt(U)} found`)];if(U.length!==2)return[new Ne(J,U,`array length 2 expected, length ${U.length} found`)];if(C){if(jt(U[0])!=="object")return[new Ne(J,U,`object expected, ${jt(U[0])} found`)];if(U[0].zoom===void 0)return[new Ne(J,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new Ne(J,U,"object stop key must have value")];if(f&&f>Tn(U[0].zoom))return[new Ne(J,U[0].zoom,"stop zoom values must appear in ascending order")];Tn(U[0].zoom)!==f&&(f=Tn(U[0].zoom),d=void 0,y={}),O=O.concat(ei({key:`${J}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:Sl,value:D}}))}else O=O.concat(D({key:`${J}[0]`,value:U[0],valueSpec:{},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},U));return ds(fi(U[1]))?O.concat([new Ne(`${J}[1]`,U[1],"expressions are not allowed in function stops.")]):O.concat(F.validateSpec({key:`${J}[1]`,value:U[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function D(F,O){const U=jt(F.value),J=Tn(F.value),ne=F.value!==null?F.value:O;if(s){if(U!==s)return[new Ne(F.key,ne,`${U} stop domain type must match previous stop domain type ${s}`)]}else s=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new Ne(F.key,ne,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&o!=="categorical"){let ye=`number expected, ${U} found`;return pa(t)&&o===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(F.key,ne,ye)]}return o!=="categorical"||U!=="number"||isFinite(J)&&Math.floor(J)===J?o!=="categorical"&&U==="number"&&d!==void 0&&J<d?[new Ne(F.key,ne,"stop domain values must appear in ascending order")]:(d=J,o==="categorical"&&J in y?[new Ne(F.key,ne,"stop domain values must be unique")]:(y[J]=!0,[])):[new Ne(F.key,ne,`integer expected, found ${J}`)]}}function Vo(r){const t=(r.expressionContext==="property"?Qh:ps)(fi(r.value),r.valueSpec);if(t.result==="error")return t.value.map(s=>new Ne(`${r.key}${s.key}`,r.value,s.message));const o=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new Ne(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ls(o))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!ls(o))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ml(o,["zoom","feature-state"]))return[new Ne(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!fl(o))return[new Ne(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _a(r){const t=r.key,o=r.value,s=r.valueSpec,d=[];return Array.isArray(s.values)?s.values.indexOf(Tn(o))===-1&&d.push(new Ne(t,o,`expected one of [${s.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(s.values).indexOf(Tn(o))===-1&&d.push(new Ne(t,o,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(o)} found`)),d}function Hu(r){return Zu(fi(r.value))?Vo(br({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):El(r)}function El(r){const t=r.value,o=r.key;if(jt(t)!=="array")return[new Ne(o,t,`array expected, ${jt(t)} found`)];const s=r.styleSpec;let d,f=[];if(t.length<1)return[new Ne(o,t,"filter array must have at least 1 element")];switch(f=f.concat(_a({key:`${o}[0]`,value:t[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),Tn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Tn(t[1])==="$type"&&f.push(new Ne(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&f.push(new Ne(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=jt(t[1]),d!=="string"&&f.push(new Ne(`${o}[1]`,t[1],`string expected, ${d} found`)));for(let y=2;y<t.length;y++)d=jt(t[y]),Tn(t[1])==="$type"?f=f.concat(_a({key:`${o}[${y}]`,value:t[y],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&f.push(new Ne(`${o}[${y}]`,t[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)f=f.concat(El({key:`${o}[${y}]`,value:t[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=jt(t[1]),t.length!==2?f.push(new Ne(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&f.push(new Ne(`${o}[1]`,t[1],`string expected, ${d} found`))}return f}function _s(r,t){const o=r.key,s=r.validateSpec,d=r.style,f=r.styleSpec,y=r.value,x=r.objectKey,S=f[`${t}_${r.layerType}`];if(!S)return[];const C=x.match(/^(.*)-transition$/);if(t==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return s({key:o,value:y,valueSpec:f.transition,style:d,styleSpec:f});const I=r.valueSpec||S[x];if(!I)return[new Ne(o,y,`unknown property "${x}"`)];let P;if(jt(y)==="string"&&pa(I)&&!I.tokens&&(P=/^{([^}]+)}$/.exec(y)))return[new Ne(o,y,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const D=[];return r.layerType==="symbol"&&(x==="text-field"&&d&&!d.glyphs&&D.push(new Ne(o,y,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&yl(fi(y))&&Tn(y.type)==="identity"&&D.push(new Ne(o,y,'"text-font" does not support identity functions'))),D.concat(s({key:r.key,value:y,valueSpec:I,style:d,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:x}))}function Gu(r){return _s(r,"paint")}function Wu(r){return _s(r,"layout")}function Xu(r){let t=[];const o=r.value,s=r.key,d=r.style,f=r.styleSpec;o.type||o.ref||t.push(new Ne(s,o,'either "type" or "ref" is required'));let y=Tn(o.type);const x=Tn(o.ref);if(o.id){const S=Tn(o.id);for(let C=0;C<r.arrayIndex;C++){const I=d.layers[C];Tn(I.id)===S&&t.push(new Ne(s,o.id,`duplicate layer id "${o.id}", previously used at line ${I.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in o&&t.push(new Ne(s,o[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{Tn(C.id)===x&&(S=C)}),S?S.ref?t.push(new Ne(s,o.ref,"ref cannot reference another ref layer")):y=Tn(S.type):t.push(new Ne(s,o.ref,`ref layer "${x}" not found`))}else if(y!=="background")if(o.source){const S=d.sources&&d.sources[o.source],C=S&&Tn(S.type);S?C==="vector"&&y==="raster"?t.push(new Ne(s,o.source,`layer "${o.id}" requires a raster source`)):C!=="raster-dem"&&y==="hillshade"?t.push(new Ne(s,o.source,`layer "${o.id}" requires a raster-dem source`)):C==="raster"&&y!=="raster"?t.push(new Ne(s,o.source,`layer "${o.id}" requires a vector source`)):C!=="vector"||o["source-layer"]?C==="raster-dem"&&y!=="hillshade"?t.push(new Ne(s,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!o.paint||!o.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||t.push(new Ne(s,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ne(s,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new Ne(s,o.source,`source "${o.source}" not found`))}else t.push(new Ne(s,o,'missing required property "source"'));return t=t.concat(ei({key:s,value:o,valueSpec:f.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${s}.type`,value:o.type,valueSpec:f.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:o,objectKey:"type"}),filter:Hu,layout:S=>ei({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Wu(br({layerType:y},C))}}),paint:S=>ei({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Gu(br({layerType:y},C))}})}})),t}function vo(r){const t=r.value,o=r.key,s=jt(t);return s!=="string"?[new Ne(o,t,`string expected, ${s} found`)]:[]}const Cl={promoteId:function({key:r,value:t}){if(jt(t)==="string")return vo({key:r,value:t});{const o=[];for(const s in t)o.push(...vo({key:`${r}.${s}`,value:t[s]}));return o}}};function Ku(r){const t=r.value,o=r.key,s=r.styleSpec,d=r.style,f=r.validateSpec;if(!t.type)return[new Ne(o,t,'"type" is required')];const y=Tn(t.type);let x;switch(y){case"vector":case"raster":return x=ei({key:o,value:t,valueSpec:s[`source_${y.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:Cl,validateSpec:f}),x;case"raster-dem":return x=function(S){var C;const I=(C=S.sourceName)!==null&&C!==void 0?C:"",P=S.value,D=S.styleSpec,F=D.source_raster_dem,O=S.style;let U=[];const J=jt(P);if(P===void 0)return U;if(J!=="object")return U.push(new Ne("source_raster_dem",P,`object expected, ${J} found`)),U;const ne=Tn(P.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],le=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const fe in P)!ne&&ye.includes(fe)?U.push(new Ne(fe,P[fe],`In "${I}": "${fe}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):F[fe]?U=U.concat(S.validateSpec({key:fe,value:P[fe],valueSpec:F[fe],validateSpec:S.validateSpec,style:O,styleSpec:D})):U.push(new Ne(fe,P[fe],`unknown property "${fe}"`));return U}({sourceName:o,value:t,style:r.style,styleSpec:s,validateSpec:f}),x;case"geojson":if(x=ei({key:o,value:t,valueSpec:s.source_geojson,style:d,styleSpec:s,validateSpec:f,objectElementValidators:Cl}),t.cluster)for(const S in t.clusterProperties){const[C,I]=t.clusterProperties[S],P=typeof C=="string"?[C,["accumulated"],["get",S]]:C;x.push(...Vo({key:`${o}.${S}.map`,value:I,validateSpec:f,expressionContext:"cluster-map"})),x.push(...Vo({key:`${o}.${S}.reduce`,value:P,validateSpec:f,expressionContext:"cluster-reduce"}))}return x;case"video":return ei({key:o,value:t,valueSpec:s.source_video,style:d,validateSpec:f,styleSpec:s});case"image":return ei({key:o,value:t,valueSpec:s.source_image,style:d,validateSpec:f,styleSpec:s});case"canvas":return[new Ne(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _a({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,validateSpec:f,styleSpec:s})}}function td(r){const t=r.value,o=r.styleSpec,s=o.light,d=r.style;let f=[];const y=jt(t);if(t===void 0)return f;if(y!=="object")return f=f.concat([new Ne("light",t,`object expected, ${y} found`)]),f;for(const x in t){const S=x.match(/^(.*)-transition$/);f=f.concat(S&&s[S[1]]&&s[S[1]].transition?r.validateSpec({key:x,value:t[x],valueSpec:o.transition,validateSpec:r.validateSpec,style:d,styleSpec:o}):s[x]?r.validateSpec({key:x,value:t[x],valueSpec:s[x],validateSpec:r.validateSpec,style:d,styleSpec:o}):[new Ne(x,t[x],`unknown property "${x}"`)])}return f}function Ju(r){const t=r.value,o=r.styleSpec,s=o.sky,d=r.style,f=jt(t);if(t===void 0)return[];if(f!=="object")return[new Ne("sky",t,`object expected, ${f} found`)];let y=[];for(const x in t)y=y.concat(s[x]?r.validateSpec({key:x,value:t[x],valueSpec:s[x],style:d,styleSpec:o}):[new Ne(x,t[x],`unknown property "${x}"`)]);return y}function nd(r){const t=r.value,o=r.styleSpec,s=o.terrain,d=r.style;let f=[];const y=jt(t);if(t===void 0)return f;if(y!=="object")return f=f.concat([new Ne("terrain",t,`object expected, ${y} found`)]),f;for(const x in t)f=f.concat(s[x]?r.validateSpec({key:x,value:t[x],valueSpec:s[x],validateSpec:r.validateSpec,style:d,styleSpec:o}):[new Ne(x,t[x],`unknown property "${x}"`)]);return f}function Yu(r){let t=[];const o=r.value,s=r.key;if(Array.isArray(o)){const d=[],f=[];for(const y in o)o[y].id&&d.includes(o[y].id)&&t.push(new Ne(s,o,`all the sprites' ids must be unique, but ${o[y].id} is duplicated`)),d.push(o[y].id),o[y].url&&f.includes(o[y].url)&&t.push(new Ne(s,o,`all the sprites' URLs must be unique, but ${o[y].url} is duplicated`)),f.push(o[y].url),t=t.concat(ei({key:`${s}[${y}]`,value:o[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return vo({key:s,value:o})}const Qu={"*":()=>[],array:ys,boolean:function(r){const t=r.value,o=r.key,s=jt(t);return s!=="boolean"?[new Ne(o,t,`boolean expected, ${s} found`)]:[]},number:Sl,color:function(r){const t=r.key,o=r.value,s=jt(o);return s!=="string"?[new Ne(t,o,`color expected, ${s} found`)]:Et.parse(String(o))?[]:[new Ne(t,o,`color expected, "${o}" found`)]},constants:bl,enum:_a,filter:Hu,function:Tl,layer:Xu,object:ei,source:Ku,light:td,sky:Ju,terrain:nd,projection:function(r){const t=r.value,o=r.styleSpec,s=o.projection,d=r.style,f=jt(t);if(t===void 0)return[];if(f!=="object")return[new Ne("projection",t,`object expected, ${f} found`)];let y=[];for(const x in t)y=y.concat(s[x]?r.validateSpec({key:x,value:t[x],valueSpec:s[x],style:d,styleSpec:o}):[new Ne(x,t[x],`unknown property "${x}"`)]);return y},string:vo,formatted:function(r){return vo(r).length===0?[]:Vo(r)},resolvedImage:function(r){return vo(r).length===0?[]:Vo(r)},padding:function(r){const t=r.key,o=r.value;if(jt(o)==="array"){if(o.length<1||o.length>4)return[new Ne(t,o,`padding requires 1 to 4 values; ${o.length} values found`)];const s={type:"number"};let d=[];for(let f=0;f<o.length;f++)d=d.concat(r.validateSpec({key:`${t}[${f}]`,value:o[f],validateSpec:r.validateSpec,valueSpec:s}));return d}return Sl({key:t,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,o=r.value,s=jt(o),d=r.styleSpec;if(s!=="array"||o.length<1||o.length%2!=0)return[new Ne(t,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let f=[];for(let y=0;y<o.length;y+=2)f=f.concat(_a({key:`${t}[${y}]`,value:o[y],valueSpec:d.layout_symbol["text-anchor"]})),f=f.concat(ys({key:`${t}[${y+1}]`,value:o[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return f},sprite:Yu};function va(r){const t=r.value,o=r.valueSpec,s=r.styleSpec;return r.validateSpec=va,o.expression&&yl(Tn(t))?Tl(r):o.expression&&ds(fi(t))?Vo(r):o.type&&Qu[o.type]?Qu[o.type](r):ei(br({},r,{valueSpec:o.type?s[o.type]:o}))}function rd(r){const t=r.value,o=r.key,s=vo(r);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Ne(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Ne(o,t,'"glyphs" url must include a "{range}" token'))),s}function mi(r,t=we){let o=[];return o=o.concat(va({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:va,objectElementValidators:{glyphs:rd,"*":()=>[]}})),r.constants&&(o=o.concat(bl({key:"constants",value:r.constants,style:r,styleSpec:t,validateSpec:va}))),ec(o)}function gi(r){return function(t){return r({...t,validateSpec:va})}}function ec(r){return[].concat(r).sort((t,o)=>t.line-o.line)}function yi(r){return function(...t){return ec(r.apply(this,t))}}mi.source=yi(gi(Ku)),mi.sprite=yi(gi(Yu)),mi.glyphs=yi(gi(rd)),mi.light=yi(gi(td)),mi.sky=yi(gi(Ju)),mi.terrain=yi(gi(nd)),mi.layer=yi(gi(Xu)),mi.filter=yi(gi(Hu)),mi.paintProperty=yi(gi(Gu)),mi.layoutProperty=yi(gi(Wu));const Uo=mi,kl=Uo.light,xf=Uo.sky,tc=Uo.paintProperty,wf=Uo.layoutProperty;function id(r,t){let o=!1;if(t&&t.length)for(const s of t)r.fire(new pn(new Error(s.message))),o=!0;return o}class xa{constructor(t,o,s){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(o=y[1])+2*(s=y[2]);for(let S=0;S<this.d*this.d;S++){const C=y[3+S],I=y[3+S+1];d.push(C===I?null:y.subarray(C,I))}const x=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],x),this.bboxes=y.subarray(x),this.insert=this._insertReadonly}else{this.d=o+2*s;for(let y=0;y<this.d*this.d;y++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=s,this.scale=o/t,this.uid=0;const f=s/o*t;this.min=-f,this.max=t+f}insert(t,o,s,d,f){this._forEachCell(o,s,d,f,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(f)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,s,d,f,y){this.cells[f].push(y)}query(t,o,s,d,f){const y=this.min,x=this.max;if(t<=y&&o<=y&&x<=s&&x<=d&&!f)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,o,s,d,this._queryCell,S,{},f),S}}_queryCell(t,o,s,d,f,y,x,S){const C=this.cells[f];if(C!==null){const I=this.keys,P=this.bboxes;for(let D=0;D<C.length;D++){const F=C[D];if(x[F]===void 0){const O=4*F;(S?S(P[O+0],P[O+1],P[O+2],P[O+3]):t<=P[O+2]&&o<=P[O+3]&&s>=P[O+0]&&d>=P[O+1])?(x[F]=!0,y.push(I[F])):x[F]=!1}}}}_forEachCell(t,o,s,d,f,y,x,S){const C=this._convertToCellCoord(t),I=this._convertToCellCoord(o),P=this._convertToCellCoord(s),D=this._convertToCellCoord(d);for(let F=C;F<=P;F++)for(let O=I;O<=D;O++){const U=this.d*O+F;if((!S||S(this._convertFromCellCoord(F),this._convertFromCellCoord(O),this._convertFromCellCoord(F+1),this._convertFromCellCoord(O+1)))&&f.call(this,t,o,s,d,U,y,x,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,o=3+this.cells.length+1+1;let s=0;for(let y=0;y<this.cells.length;y++)s+=this.cells[y].length;const d=new Int32Array(o+s+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let f=o;for(let y=0;y<t.length;y++){const x=t[y];d[3+y]=f,d.set(x,f),f+=x.length}return d[3+t.length]=f,d.set(this.keys,f),f+=this.keys.length,d[3+t.length+1]=f,d.set(this.bboxes,f),f+=this.bboxes.length,d.buffer}static serialize(t,o){const s=t.toArrayBuffer();return o&&o.push(s),{buffer:s}}static deserialize(t){return new xa(t.buffer)}}const Oi={};function et(r,t,o={}){if(Oi[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Oi[r]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}et("Object",Object),et("TransferableGridIndex",xa),et("Color",Et),et("Error",Error),et("AJAXError",on),et("ResolvedImage",In),et("StylePropertyFunction",vl),et("StyleExpression",hs,{omit:["_evaluator"]}),et("ZoomDependentExpression",$u),et("ZoomConstantExpression",fa),et("CompoundExpression",Vr,{omit:["_evaluate"]});for(const r in No)No[r]._classRegistryKey||et(`Expression_${r}`,No[r]);function od(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function nc(r){return r.$name||r.constructor._classRegistryKey}function ad(r){return!function(t){if(t===null||typeof t!="object")return!1;const o=nc(t);return!(!o||o==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||od(r)||Un(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function vs(r,t){if(ad(r))return(od(r)||Un(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const f=[];for(const y of r)f.push(vs(y,t));return f}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const o=nc(r);if(!o)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Oi[o])throw new Error(`${o} is not registered.`);const{klass:s}=Oi[o],d=s.serialize?s.serialize(r,t):{};if(s.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const f in r){if(!r.hasOwnProperty(f)||Oi[o].omit.indexOf(f)>=0)continue;const y=r[f];d[f]=Oi[o].shallow.indexOf(f)>=0?y:vs(y,t)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(d.$name=o),d}function xs(r){if(ad(r))return r;if(Array.isArray(r))return r.map(xs);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=nc(r)||"Object";if(!Oi[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:o}=Oi[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(r);const s=Object.create(o.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const f=r[d];s[d]=Oi[t].shallow.indexOf(d)>=0?f:xs(f)}return s}class $o{constructor(){this.first=!0}update(t,o){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const Bt={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function rc(r){for(const t of r)if(eo(t.charCodeAt(0)))return!0;return!1}function bf(r){for(const t of r)if(!Sf(t.charCodeAt(0)))return!1;return!0}function ic(r){const t=r.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(t.join("|"),"u")}const sd=ic(["Arab","Dupl","Mong","Ougr","Syrc"]);function Sf(r){return!sd.test(String.fromCodePoint(r))}const ld=ic(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function eo(r){return!(r!==746&&r!==747&&(r<4352||!(Bt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Bt["CJK Compatibility"](r)||Bt["CJK Strokes"](r)||!(!Bt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Bt["Enclosed CJK Letters and Months"](r)||Bt["Ideographic Description Characters"](r)||Bt.Kanbun(r)||Bt.Katakana(r)&&r!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Bt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Bt["Vertical Forms"](r)||Bt["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||ld.test(String.fromCodePoint(r)))))}function oc(r){return!(eo(r)||function(t){return!!(Bt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Bt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Bt["Letterlike Symbols"](t)||Bt["Number Forms"](t)||Bt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Bt["Control Pictures"](t)&&t!==9251||Bt["Optical Character Recognition"](t)||Bt["Enclosed Alphanumerics"](t)||Bt["Geometric Shapes"](t)||Bt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Bt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Bt["CJK Symbols and Punctuation"](t)||Bt.Katakana(t)||Bt["Private Use Area"](t)||Bt["CJK Compatibility Forms"](t)||Bt["Small Form Variants"](t)||Bt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const ac=ic(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function sc(r){return ac.test(String.fromCodePoint(r))}function lc(r,t){return!(!t&&sc(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Bt.Khmer(r))}function Tf(r){for(const t of r)if(sc(t.charCodeAt(0)))return!0;return!1}const Ni=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Kt{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $o,this.transition={})}isSupportedScript(t){return function(o,s){for(const d of o)if(!lc(d.charCodeAt(0),s))return!1;return!0}(t,Ni.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,o=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*o}}}class Il{constructor(t,o){this.property=t,this.value=o,this.expression=function(s,d){if(yl(s))return new vl(s,d);if(ds(s)){const f=Qh(s,d);if(f.result==="error")throw new Error(f.value.map(y=>`${y.key}: ${y.message}`).join(", "));return f.value}{let f=s;return d.type==="color"&&typeof s=="string"?f=Et.parse(s):d.type!=="padding"||typeof s!="number"&&!Array.isArray(s)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(s)&&(f=mn.parse(s)):f=Nn.parse(s),{kind:"constant",evaluate:()=>f}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,s){return this.property.possiblyEvaluate(this,t,o,s)}}class Pl{constructor(t){this.property=t,this.value=new Il(t,void 0)}transitioned(t,o){return new ud(this.property,this.value,o,Qe({},t.transition,this.transition),t.now)}untransitioned(){return new ud(this.property,this.value,null,{},0)}}class wa{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ot(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Pl(this._values[t].property)),this._values[t].value=new Il(this._values[t].property,o===null?void 0:ot(o))}getTransition(t){return ot(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Pl(this._values[t].property)),this._values[t].transition=ot(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const s=this.getValue(o);s!==void 0&&(t[o]=s);const d=this.getTransition(o);d!==void 0&&(t[`${o}-transition`]=d)}return t}transitioned(t,o){const s=new cd(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].transitioned(t,o._values[d]);return s}untransitioned(){const t=new cd(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class ud{constructor(t,o,s,d,f){this.property=t,this.value=o,this.begin=f+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=s)}possiblyEvaluate(t,o,s){const d=t.now||0,f=this.value.possiblyEvaluate(t,o,s),y=this.prior;if(y){if(d>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(d<this.begin)return y.possiblyEvaluate(t,o,s);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,o,s),f,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,I=C*S;return 4*(S<.5?I:3*(S-C)+I-.75)}(x))}}return f}}class cd{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,s){const d=new m(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(t,o,s);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class hd{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ot(this._values[t].value)}setValue(t,o){this._values[t]=new Il(this._values[t].property,o===null?void 0:ot(o))}serialize(){const t={};for(const o of Object.keys(this._values)){const s=this.getValue(o);s!==void 0&&(t[o]=s)}return t}possiblyEvaluate(t,o,s){const d=new m(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(t,o,s);return d}}class ji{constructor(t,o,s){this.property=t,this.value=o,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,s,d){return this.property.evaluate(this.value,this.parameters,t,o,s,d)}}class m{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class e{constructor(t){this.specification=t}possiblyEvaluate(t,o){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(o)}interpolate(t,o,s){const d=Nr[this.specification.type];return d?d(t,o,s):t}}class a{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,s,d){return new ji(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},s,d)}:t.expression,o)}interpolate(t,o,s){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ji(this,{kind:"constant",value:void 0},t.parameters);const d=Nr[this.specification.type];if(d){const f=d(t.value.value,o.value.value,s);return new ji(this,{kind:"constant",value:f},t.parameters)}return t}evaluate(t,o,s,d,f,y){return t.kind==="constant"?t.value:t.evaluate(o,s,d,f,y)}}class u extends a{possiblyEvaluate(t,o,s,d){if(t.value===void 0)return new ji(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){const f=t.expression.evaluate(o,null,{},s,d),y=t.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,x=this._calculate(y,y,y,o);return new ji(this,{kind:"constant",value:x},o)}if(t.expression.kind==="camera"){const f=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new ji(this,{kind:"constant",value:f},o)}return new ji(this,t.expression,o)}evaluate(t,o,s,d,f,y){if(t.kind==="source"){const x=t.evaluate(o,s,d,f,y);return this._calculate(x,x,x,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},s,d),t.evaluate({zoom:Math.floor(o.zoom)},s,d),t.evaluate({zoom:Math.floor(o.zoom)+1},s,d),o):t.value}_calculate(t,o,s,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:s,to:o}}interpolate(t){return t}}class h{constructor(t){this.specification=t}possiblyEvaluate(t,o,s,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const f=t.expression.evaluate(o,null,{},s,d);return this._calculate(f,f,f,o)}return this._calculate(t.expression.evaluate(new Kt(Math.floor(o.zoom-1),o)),t.expression.evaluate(new Kt(Math.floor(o.zoom),o)),t.expression.evaluate(new Kt(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,s,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:s,to:o}}interpolate(t){return t}}class g{constructor(t){this.specification=t}possiblyEvaluate(t,o,s,d){return!!t.expression.evaluate(o,null,{},s,d)}interpolate(){return!1}}class b{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in t){const s=t[o];s.specification.overridable&&this.overridableProperties.push(o);const d=this.defaultPropertyValues[o]=new Il(s,void 0),f=this.defaultTransitionablePropertyValues[o]=new Pl(s);this.defaultTransitioningPropertyValues[o]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=d.possiblyEvaluate({})}}}et("DataDrivenProperty",a),et("DataConstantProperty",e),et("CrossFadedDataDrivenProperty",u),et("CrossFadedProperty",h),et("ColorRampProperty",g);const T="-transition";class E extends Rr{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new hd(o.layout)),o.paint)){this._transitionablePaint=new wa(o.paint);for(const s in t.paint)this.setPaintProperty(s,t.paint[s],{validate:!1});for(const s in t.layout)this.setLayoutProperty(s,t.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new m(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,s={}){o!=null&&this._validate(wf,`layers.${this.id}.layout.${t}`,t,o,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(T)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,s={}){if(o!=null&&this._validate(tc,`layers.${this.id}.paint.${t}`,t,o,s))return!1;if(t.endsWith(T))return this._transitionablePaint.setTransition(t.slice(0,-11),o||void 0),!1;{const d=this._transitionablePaint._values[t],f=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||y||f||this._handleOverridablePaintPropertyUpdate(t,x,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),lt(t,(o,s)=>!(o===void 0||s==="layout"&&!Object.keys(o).length||s==="paint"&&!Object.keys(o).length))}_validate(t,o,s,d,f={}){return(!f||f.validate!==!1)&&id(this,t.call(Uo,{key:o,layerType:this.type,objectKey:s,value:d,styleSpec:we,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof ji&&pa(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const k={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class z{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class M{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function B(r,t=1){let o=0,s=0;return{members:r.map(d=>{const f=k[d.type].BYTES_PER_ELEMENT,y=o=Z(o,Math.max(t,f)),x=d.components||1;return s=Math.max(s,f),o+=f*x,{name:d.name,type:d.type,components:x,offset:y}}),size:Z(o,Math.max(s,t)),alignment:t}}function Z(r,t){return Math.ceil(r/t)*t}class q extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,o)}emplace(t,o,s){const d=2*t;return this.int16[d+0]=o,this.int16[d+1]=s,t}}q.prototype.bytesPerElement=4,et("StructArrayLayout2i4",q);class Y extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,s)}emplace(t,o,s,d){const f=3*t;return this.int16[f+0]=o,this.int16[f+1]=s,this.int16[f+2]=d,t}}Y.prototype.bytesPerElement=6,et("StructArrayLayout3i6",Y);class G extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,s,d)}emplace(t,o,s,d,f){const y=4*t;return this.int16[y+0]=o,this.int16[y+1]=s,this.int16[y+2]=d,this.int16[y+3]=f,t}}G.prototype.bytesPerElement=8,et("StructArrayLayout4i8",G);class te extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,s,d,f,y)}emplace(t,o,s,d,f,y,x){const S=6*t;return this.int16[S+0]=o,this.int16[S+1]=s,this.int16[S+2]=d,this.int16[S+3]=f,this.int16[S+4]=y,this.int16[S+5]=x,t}}te.prototype.bytesPerElement=12,et("StructArrayLayout2i4i12",te);class ae extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,s,d,f,y)}emplace(t,o,s,d,f,y,x){const S=4*t,C=8*t;return this.int16[S+0]=o,this.int16[S+1]=s,this.uint8[C+4]=d,this.uint8[C+5]=f,this.uint8[C+6]=y,this.uint8[C+7]=x,t}}ae.prototype.bytesPerElement=8,et("StructArrayLayout2i4ub8",ae);class K extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,o)}emplace(t,o,s){const d=2*t;return this.float32[d+0]=o,this.float32[d+1]=s,t}}K.prototype.bytesPerElement=8,et("StructArrayLayout2f8",K);class de extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y,x,S,C,I){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,s,d,f,y,x,S,C,I)}emplace(t,o,s,d,f,y,x,S,C,I,P){const D=10*t;return this.uint16[D+0]=o,this.uint16[D+1]=s,this.uint16[D+2]=d,this.uint16[D+3]=f,this.uint16[D+4]=y,this.uint16[D+5]=x,this.uint16[D+6]=S,this.uint16[D+7]=C,this.uint16[D+8]=I,this.uint16[D+9]=P,t}}de.prototype.bytesPerElement=20,et("StructArrayLayout10ui20",de);class ge extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y,x,S,C,I,P,D){const F=this.length;return this.resize(F+1),this.emplace(F,t,o,s,d,f,y,x,S,C,I,P,D)}emplace(t,o,s,d,f,y,x,S,C,I,P,D,F){const O=12*t;return this.int16[O+0]=o,this.int16[O+1]=s,this.int16[O+2]=d,this.int16[O+3]=f,this.uint16[O+4]=y,this.uint16[O+5]=x,this.uint16[O+6]=S,this.uint16[O+7]=C,this.int16[O+8]=I,this.int16[O+9]=P,this.int16[O+10]=D,this.int16[O+11]=F,t}}ge.prototype.bytesPerElement=24,et("StructArrayLayout4i4ui4i24",ge);class _e extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,s)}emplace(t,o,s,d){const f=3*t;return this.float32[f+0]=o,this.float32[f+1]=s,this.float32[f+2]=d,t}}_e.prototype.bytesPerElement=12,et("StructArrayLayout3f12",_e);class Me extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}Me.prototype.bytesPerElement=4,et("StructArrayLayout1ul4",Me);class Be extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y,x,S,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,s,d,f,y,x,S,C)}emplace(t,o,s,d,f,y,x,S,C,I){const P=10*t,D=5*t;return this.int16[P+0]=o,this.int16[P+1]=s,this.int16[P+2]=d,this.int16[P+3]=f,this.int16[P+4]=y,this.int16[P+5]=x,this.uint32[D+3]=S,this.uint16[P+8]=C,this.uint16[P+9]=I,t}}Be.prototype.bytesPerElement=20,et("StructArrayLayout6i1ul2ui20",Be);class Je extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,s,d,f,y)}emplace(t,o,s,d,f,y,x){const S=6*t;return this.int16[S+0]=o,this.int16[S+1]=s,this.int16[S+2]=d,this.int16[S+3]=f,this.int16[S+4]=y,this.int16[S+5]=x,t}}Je.prototype.bytesPerElement=12,et("StructArrayLayout2i2i2i12",Je);class Ye extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,o,s,d,f)}emplace(t,o,s,d,f,y){const x=4*t,S=8*t;return this.float32[x+0]=o,this.float32[x+1]=s,this.float32[x+2]=d,this.int16[S+6]=f,this.int16[S+7]=y,t}}Ye.prototype.bytesPerElement=16,et("StructArrayLayout2f1f2i16",Ye);class Oe extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,s,d,f,y)}emplace(t,o,s,d,f,y,x){const S=16*t,C=4*t,I=8*t;return this.uint8[S+0]=o,this.uint8[S+1]=s,this.float32[C+1]=d,this.float32[C+2]=f,this.int16[I+6]=y,this.int16[I+7]=x,t}}Oe.prototype.bytesPerElement=16,et("StructArrayLayout2ub2f2i16",Oe);class je extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,s)}emplace(t,o,s,d){const f=3*t;return this.uint16[f+0]=o,this.uint16[f+1]=s,this.uint16[f+2]=d,t}}je.prototype.bytesPerElement=6,et("StructArrayLayout3ui6",je);class st extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne)}emplace(t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne,ye){const le=24*t,fe=12*t,Ee=48*t;return this.int16[le+0]=o,this.int16[le+1]=s,this.uint16[le+2]=d,this.uint16[le+3]=f,this.uint32[fe+2]=y,this.uint32[fe+3]=x,this.uint32[fe+4]=S,this.uint16[le+10]=C,this.uint16[le+11]=I,this.uint16[le+12]=P,this.float32[fe+7]=D,this.float32[fe+8]=F,this.uint8[Ee+36]=O,this.uint8[Ee+37]=U,this.uint8[Ee+38]=J,this.uint32[fe+10]=ne,this.int16[le+22]=ye,t}}st.prototype.bytesPerElement=48,et("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",st);class Ct extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne,ye,le,fe,Ee,De,Ke,_t,We,He,ht,it){const tt=this.length;return this.resize(tt+1),this.emplace(tt,t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne,ye,le,fe,Ee,De,Ke,_t,We,He,ht,it)}emplace(t,o,s,d,f,y,x,S,C,I,P,D,F,O,U,J,ne,ye,le,fe,Ee,De,Ke,_t,We,He,ht,it,tt){const Pe=32*t,pt=16*t;return this.int16[Pe+0]=o,this.int16[Pe+1]=s,this.int16[Pe+2]=d,this.int16[Pe+3]=f,this.int16[Pe+4]=y,this.int16[Pe+5]=x,this.int16[Pe+6]=S,this.int16[Pe+7]=C,this.uint16[Pe+8]=I,this.uint16[Pe+9]=P,this.uint16[Pe+10]=D,this.uint16[Pe+11]=F,this.uint16[Pe+12]=O,this.uint16[Pe+13]=U,this.uint16[Pe+14]=J,this.uint16[Pe+15]=ne,this.uint16[Pe+16]=ye,this.uint16[Pe+17]=le,this.uint16[Pe+18]=fe,this.uint16[Pe+19]=Ee,this.uint16[Pe+20]=De,this.uint16[Pe+21]=Ke,this.uint16[Pe+22]=_t,this.uint32[pt+12]=We,this.float32[pt+13]=He,this.float32[pt+14]=ht,this.uint16[Pe+30]=it,this.uint16[Pe+31]=tt,t}}Ct.prototype.bytesPerElement=64,et("StructArrayLayout8i15ui1ul2f2ui64",Ct);class qe extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}qe.prototype.bytesPerElement=4,et("StructArrayLayout1f4",qe);class Ge extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,s)}emplace(t,o,s,d){const f=3*t;return this.uint16[6*t+0]=o,this.float32[f+1]=s,this.float32[f+2]=d,t}}Ge.prototype.bytesPerElement=12,et("StructArrayLayout1ui2f12",Ge);class bt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,s)}emplace(t,o,s,d){const f=4*t;return this.uint32[2*t+0]=o,this.uint16[f+2]=s,this.uint16[f+3]=d,t}}bt.prototype.bytesPerElement=8,et("StructArrayLayout1ul2ui8",bt);class tn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,o)}emplace(t,o,s){const d=2*t;return this.uint16[d+0]=o,this.uint16[d+1]=s,t}}tn.prototype.bytesPerElement=4,et("StructArrayLayout2ui4",tn);class zt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}zt.prototype.bytesPerElement=2,et("StructArrayLayout1ui2",zt);class Lt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,s,d)}emplace(t,o,s,d,f){const y=4*t;return this.float32[y+0]=o,this.float32[y+1]=s,this.float32[y+2]=d,this.float32[y+3]=f,t}}Lt.prototype.bytesPerElement=16,et("StructArrayLayout4f16",Lt);class an extends z{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new j(this.anchorPointX,this.anchorPointY)}}an.prototype.size=20;class rr extends Be{get(t){return new an(this,t)}}et("CollisionBoxArray",rr);class _i extends z{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}_i.prototype.size=48;class sn extends st{get(t){return new _i(this,t)}}et("PlacedSymbolArray",sn);class Er extends z{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Er.prototype.size=64;class fr extends Ct{get(t){return new Er(this,t)}}et("SymbolInstanceArray",fr);class ir extends qe{getoffsetX(t){return this.float32[1*t+0]}}et("GlyphOffsetArray",ir);class or extends Y{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}et("SymbolLineVertexArray",or);class vi extends z{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}vi.prototype.size=12;class Zo extends Ge{get(t){return new vi(this,t)}}et("TextAnchorOffsetArray",Zo);class ws extends z{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ws.prototype.size=8;class qo extends bt{get(t){return new ws(this,t)}}et("FeatureIndexArray",qo);class xo extends q{}class Ml extends q{}class uc extends q{}class ti extends te{}class xi extends ae{}class wo extends K{}class wi extends de{}class mr extends ge{}class ar extends _e{}class $r extends Me{}class xn extends Je{}class ba extends Oe{}class bo extends je{}class bs extends tn{}const Ef=B([{name:"a_pos",components:2,type:"Int16"}],4),{members:Cf}=Ef;class Qn{constructor(t=[]){this.segments=t}prepareSegment(t,o,s,d){let f=this.segments[this.segments.length-1];return t>Qn.MAX_VERTEX_ARRAY_LENGTH&&Ot(`Max vertices per segment is ${Qn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!f||f.vertexLength+t>Qn.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==d)&&(f={vertexOffset:o.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},d!==void 0&&(f.sortKey=d),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,s,d){return new Qn([{vertexOffset:t,primitiveOffset:o,vertexLength:s,primitiveLength:d,vaos:{},sortKey:0}])}}function So(r,t){return 256*(r=Le(Math.floor(r),0,255))+Le(Math.floor(t),0,255)}Qn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,et("SegmentVector",Qn);const Ss=B([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ts={exports:{}},cc={exports:{}};cc.exports=function(r,t){var o,s,d,f,y,x,S,C;for(s=r.length-(o=3&r.length),d=t,y=3432918353,x=461845907,C=0;C<s;)S=255&r.charCodeAt(C)|(255&r.charCodeAt(++C))<<8|(255&r.charCodeAt(++C))<<16|(255&r.charCodeAt(++C))<<24,++C,d=27492+(65535&(f=5*(65535&(d=(d^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&r.charCodeAt(C+2))<<16;case 2:S^=(255&r.charCodeAt(C+1))<<8;case 1:d^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(C)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var hc=cc.exports,dc={exports:{}};dc.exports=function(r,t){for(var o,s=r.length,d=t^s,f=0;s>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(f)|(255&r.charCodeAt(++f))<<8|(255&r.charCodeAt(++f))<<16|(255&r.charCodeAt(++f))<<24))+((1540483477*(o>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:d^=(255&r.charCodeAt(f+2))<<16;case 2:d^=(255&r.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var zl=hc,Xw=dc.exports;Ts.exports=zl,Ts.exports.murmur3=zl,Ts.exports.murmur2=Xw;var kf=A(Ts.exports);class dd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,s,d){this.ids.push($y(t)),this.positions.push(o,s,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=$y(t);let s=0,d=this.ids.length-1;for(;s<d;){const y=s+d>>1;this.ids[y]>=o?d=y:s=y+1}const f=[];for(;this.ids[s]===o;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(t,o){const s=new Float64Array(t.ids),d=new Uint32Array(t.positions);return If(s,d,0,s.length-1),o&&o.push(s.buffer,d.buffer),{ids:s,positions:d}}static deserialize(t){const o=new dd;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function $y(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:kf(String(r))}function If(r,t,o,s){for(;o<s;){const d=r[o+s>>1];let f=o-1,y=s+1;for(;;){do f++;while(r[f]<d);do y--;while(r[y]>d);if(f>=y)break;pd(r,f,y),pd(t,3*f,3*y),pd(t,3*f+1,3*y+1),pd(t,3*f+2,3*y+2)}y-o<s-y?(If(r,t,o,y),o=y+1):(If(r,t,y+1,s),s=y)}}function pd(r,t,o){const s=r[t];r[t]=r[o],r[o]=s}et("FeaturePositionMap",dd);class Es{constructor(t,o){this.gl=t.gl,this.location=o}}class fd extends Es{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Zy extends Es{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class qy extends Es{constructor(t,o){super(t,o),this.current=Et.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Kw=new Float32Array(16);function Pf(r){return[So(255*r.r,255*r.g),So(255*r.b,255*r.a)]}class pc{constructor(t,o,s){this.value=t,this.uniformNames=o.map(d=>`u_${d}`),this.type=s}setUniform(t,o,s){t.set(s.constantOr(this.value))}getBinding(t,o,s){return this.type==="color"?new qy(t,o):new fd(t,o)}}class Al{constructor(t,o){this.uniformNames=o.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,s,d){const f=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&t.set(f)}getBinding(t,o,s){return s.substr(0,9)==="u_pattern"?new Zy(t,o):new fd(t,o)}}class Ho{constructor(t,o,s,d){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=o.map(f=>({name:`a_${f}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,o,s,d,f){const y=this.paintVertexArray.length,x=this.expression.evaluate(new Kt(0),o,{},d,[],f);this.paintVertexArray.resize(t),this._setPaintValue(y,t,x)}updatePaintArray(t,o,s,d){const f=this.expression.evaluate({zoom:0},s,d);this._setPaintValue(t,o,f)}_setPaintValue(t,o,s){if(this.type==="color"){const d=Pf(s);for(let f=t;f<o;f++)this.paintVertexArray.emplace(f,d[0],d[1])}else{for(let d=t;d<o;d++)this.paintVertexArray.emplace(d,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class to{constructor(t,o,s,d,f,y){this.expression=t,this.uniformNames=o.map(x=>`u_${x}_t`),this.type=s,this.useIntegerZoom=d,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=o.map(x=>({name:`a_${x}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,o,s,d,f){const y=this.expression.evaluate(new Kt(this.zoom),o,{},d,[],f),x=this.expression.evaluate(new Kt(this.zoom+1),o,{},d,[],f),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,y,x)}updatePaintArray(t,o,s,d){const f=this.expression.evaluate({zoom:this.zoom},s,d),y=this.expression.evaluate({zoom:this.zoom+1},s,d);this._setPaintValue(t,o,f,y)}_setPaintValue(t,o,s,d){if(this.type==="color"){const f=Pf(s),y=Pf(d);for(let x=t;x<o;x++)this.paintVertexArray.emplace(x,f[0],f[1],y[0],y[1])}else{for(let f=t;f<o;f++)this.paintVertexArray.emplace(f,s,d);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){const s=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,d=Le(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,o,s){return new fd(t,o)}}class Sa{constructor(t,o,s,d,f,y){this.expression=t,this.type=o,this.useIntegerZoom=s,this.zoom=d,this.layerId=y,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(t,o,s){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,o.patterns&&o.patterns[this.layerId],s)}updatePaintArray(t,o,s,d,f){this._setPaintValues(t,o,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(t,o,s,d){if(!d||!s)return;const{min:f,mid:y,max:x}=s,S=d[f],C=d[y],I=d[x];if(S&&C&&I)for(let P=t;P<o;P++)this.zoomInPaintVertexArray.emplace(P,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,C.tl[0],C.tl[1],C.br[0],C.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],C.pixelRatio,I.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ss.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ss.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Hy{constructor(t,o,s){this.binders={},this._buffers=[];const d=[];for(const f in t.paint._values){if(!s(f))continue;const y=t.paint.get(f);if(!(y instanceof ji&&pa(y.property.specification)))continue;const x=Jw(f,t.type),S=y.value,C=y.property.specification.type,I=y.property.useIntegerZoom,P=y.property.specification["property-type"],D=P==="cross-faded"||P==="cross-faded-data-driven";if(S.kind==="constant")this.binders[f]=D?new Al(S.value,x):new pc(S.value,x,C),d.push(`/u_${f}`);else if(S.kind==="source"||D){const F=Gy(f,C,"source");this.binders[f]=D?new Sa(S,C,I,o,F,t.id):new Ho(S,x,C,F),d.push(`/a_${f}`)}else{const F=Gy(f,C,"composite");this.binders[f]=new to(S,x,C,I,o,F),d.push(`/z_${f}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof Ho||o instanceof to?o.maxValue:0}populatePaintArrays(t,o,s,d,f){for(const y in this.binders){const x=this.binders[y];(x instanceof Ho||x instanceof to||x instanceof Sa)&&x.populatePaintArray(t,o,s,d,f)}}setConstantPatternPositions(t,o){for(const s in this.binders){const d=this.binders[s];d instanceof Al&&d.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,s,d,f){let y=!1;for(const x in t){const S=o.getPositions(x);for(const C of S){const I=s.feature(C.index);for(const P in this.binders){const D=this.binders[P];if((D instanceof Ho||D instanceof to||D instanceof Sa)&&D.expression.isStateDependent===!0){const F=d.paint.get(P);D.expression=F.value,D.updatePaintArray(C.start,C.end,I,t[x],f),y=!0}}}}return y}defines(){const t=[];for(const o in this.binders){const s=this.binders[o];(s instanceof pc||s instanceof Al)&&t.push(...s.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const s=this.binders[o];if(s instanceof Ho||s instanceof to)for(let d=0;d<s.paintVertexAttributes.length;d++)t.push(s.paintVertexAttributes[d].name);else if(s instanceof Sa)for(let d=0;d<Ss.members.length;d++)t.push(Ss.members[d].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const s=this.binders[o];if(s instanceof pc||s instanceof Al||s instanceof to)for(const d of s.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){const s=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof pc||f instanceof Al||f instanceof to){for(const y of f.uniformNames)if(o[y]){const x=f.getBinding(t,o[y],y);s.push({name:y,property:d,binding:x})}}}return s}setUniforms(t,o,s,d){for(const{name:f,property:y,binding:x}of o)this.binders[y].setUniform(x,d,s.get(y),f)}updatePaintBuffers(t){this._buffers=[];for(const o in this.binders){const s=this.binders[o];if(t&&s instanceof Sa){const d=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(s instanceof Ho||s instanceof to)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const o in this.binders){const s=this.binders[o];(s instanceof Ho||s instanceof to||s instanceof Sa)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof Ho||o instanceof to||o instanceof Sa)&&o.destroy()}}}class Cs{constructor(t,o,s=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new Hy(d,o,s);this.needsUpload=!1,this._featureMap=new dd,this._bufferOffset=0}populatePaintArrays(t,o,s,d,f,y){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,o,d,f,y);o.id!==void 0&&this._featureMap.add(o.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,s,d){for(const f of s)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(t,this._featureMap,o,f,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Jw(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Gy(r,t,o){const s={color:{source:K,composite:Lt},number:{source:qe,composite:K}},d=function(f){return{"line-pattern":{source:wi,composite:wi},"fill-pattern":{source:wi,composite:wi},"fill-extrusion-pattern":{source:wi,composite:wi}}[f]}(r);return d&&d[o]||s[t][o]}et("ConstantBinder",pc),et("CrossFadedConstantBinder",Al),et("SourceExpressionBinder",Ho),et("CrossFadedCompositeBinder",Sa),et("CompositeExpressionBinder",to),et("ProgramConfiguration",Hy,{omit:["_buffers"]}),et("ProgramConfigurationSet",Cs);const jn=8192,Mf=Math.pow(2,14)-1,Wy=-Mf-1;function ks(r){const t=jn/r.extent,o=r.loadGeometry();for(let s=0;s<o.length;s++){const d=o[s];for(let f=0;f<d.length;f++){const y=d[f],x=Math.round(y.x*t),S=Math.round(y.y*t);y.x=Le(x,Wy,Mf),y.y=Le(S,Wy,Mf),(x<y.x||x>y.x+1||S<y.y||S>y.y+1)&&Ot("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Is(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?ks(r):[]}}function md(r,t,o,s,d){r.emplaceBack(2*t+(s+1)/2,2*o+(d+1)/2)}class zf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ml,this.indexArray=new bo,this.segments=new Qn,this.programConfigurations=new Cs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,s){const d=this.layers[0],f=[];let y=null,x=!1;d.type==="circle"&&(y=d.layout.get("circle-sort-key"),x=!y.isConstant());for(const{feature:S,id:C,index:I,sourceLayerIndex:P}of t){const D=this.layers[0]._featureFilter.needGeometry,F=Is(S,D);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),F,s))continue;const O=x?y.evaluate(F,{},s):void 0,U={id:C,properties:S.properties,type:S.type,sourceLayerIndex:P,index:I,geometry:D?F.geometry:ks(S),patterns:{},sortKey:O};f.push(U)}x&&f.sort((S,C)=>S.sortKey-C.sortKey);for(const S of f){const{geometry:C,index:I,sourceLayerIndex:P}=S,D=t[I].feature;this.addFeature(S,C,I,s),o.featureIndex.insert(D,C,I,P,this.index)}}update(t,o,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Cf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,s,d){for(const f of o)for(const y of f){const x=y.x,S=y.y;if(x<0||x>=jn||S<0||S>=jn)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=C.vertexLength;md(this.layoutVertexArray,x,S,-1,-1),md(this.layoutVertexArray,x,S,1,-1),md(this.layoutVertexArray,x,S,1,1),md(this.layoutVertexArray,x,S,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},d)}}function Xy(r,t){for(let o=0;o<r.length;o++)if(Dl(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Dl(r,t[o]))return!0;return!!Af(r,t)}function Yw(r,t,o){return!!Dl(r,t)||!!Df(t,r,o)}function Ky(r,t){if(r.length===1)return Yy(t,r[0]);for(let o=0;o<t.length;o++){const s=t[o];for(let d=0;d<s.length;d++)if(Dl(r,s[d]))return!0}for(let o=0;o<r.length;o++)if(Yy(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Af(r,t[o]))return!0;return!1}function Qw(r,t,o){if(r.length>1){if(Af(r,t))return!0;for(let s=0;s<t.length;s++)if(Df(t[s],r,o))return!0}for(let s=0;s<r.length;s++)if(Df(r[s],t,o))return!0;return!1}function Af(r,t){if(r.length===0||t.length===0)return!1;for(let o=0;o<r.length-1;o++){const s=r[o],d=r[o+1];for(let f=0;f<t.length-1;f++)if(eb(s,d,t[f],t[f+1]))return!0}return!1}function eb(r,t,o,s){return Ft(r,o,s)!==Ft(t,o,s)&&Ft(r,t,o)!==Ft(r,t,s)}function Df(r,t,o){const s=o*o;if(t.length===1)return r.distSqr(t[0])<s;for(let d=1;d<t.length;d++)if(Jy(r,t[d-1],t[d])<s)return!0;return!1}function Jy(r,t,o){const s=t.distSqr(o);if(s===0)return r.distSqr(t);const d=((r.x-t.x)*(o.x-t.x)+(r.y-t.y)*(o.y-t.y))/s;return r.distSqr(d<0?t:d>1?o:o.sub(t)._mult(d)._add(t))}function Yy(r,t){let o,s,d,f=!1;for(let y=0;y<r.length;y++){o=r[y];for(let x=0,S=o.length-1;x<o.length;S=x++)s=o[x],d=o[S],s.y>t.y!=d.y>t.y&&t.x<(d.x-s.x)*(t.y-s.y)/(d.y-s.y)+s.x&&(f=!f)}return f}function Dl(r,t){let o=!1;for(let s=0,d=r.length-1;s<r.length;d=s++){const f=r[s],y=r[d];f.y>t.y!=y.y>t.y&&t.x<(y.x-f.x)*(t.y-f.y)/(y.y-f.y)+f.x&&(o=!o)}return o}function tb(r,t,o){const s=o[0],d=o[2];if(r.x<s.x&&t.x<s.x||r.x>d.x&&t.x>d.x||r.y<s.y&&t.y<s.y||r.y>d.y&&t.y>d.y)return!1;const f=Ft(r,t,o[0]);return f!==Ft(r,t,o[1])||f!==Ft(r,t,o[2])||f!==Ft(r,t,o[3])}function fc(r,t,o){const s=t.paint.get(r).value;return s.kind==="constant"?s.value:o.programConfigurations.get(t.id).getMaxValue(r)}function gd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function yd(r,t,o,s,d){if(!t[0]&&!t[1])return r;const f=j.convert(t)._mult(d);o==="viewport"&&f._rotate(-s);const y=[];for(let x=0;x<r.length;x++)y.push(r[x].sub(f));return y}let Qy,e_;et("CircleBucket",zf,{omit:["layers"]});var nb={get paint(){return e_=e_||new b({"circle-radius":new a(we.paint_circle["circle-radius"]),"circle-color":new a(we.paint_circle["circle-color"]),"circle-blur":new a(we.paint_circle["circle-blur"]),"circle-opacity":new a(we.paint_circle["circle-opacity"]),"circle-translate":new e(we.paint_circle["circle-translate"]),"circle-translate-anchor":new e(we.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new e(we.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new e(we.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new a(we.paint_circle["circle-stroke-width"]),"circle-stroke-color":new a(we.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new a(we.paint_circle["circle-stroke-opacity"])})},get layout(){return Qy=Qy||new b({"circle-sort-key":new a(we.layout_circle["circle-sort-key"])})}},Cr=1e-6,Ll=typeof Float32Array<"u"?Float32Array:Array;function Lf(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function t_(r,t,o){var s=t[0],d=t[1],f=t[2],y=t[3],x=t[4],S=t[5],C=t[6],I=t[7],P=t[8],D=t[9],F=t[10],O=t[11],U=t[12],J=t[13],ne=t[14],ye=t[15],le=o[0],fe=o[1],Ee=o[2],De=o[3];return r[0]=le*s+fe*x+Ee*P+De*U,r[1]=le*d+fe*S+Ee*D+De*J,r[2]=le*f+fe*C+Ee*F+De*ne,r[3]=le*y+fe*I+Ee*O+De*ye,r[4]=(le=o[4])*s+(fe=o[5])*x+(Ee=o[6])*P+(De=o[7])*U,r[5]=le*d+fe*S+Ee*D+De*J,r[6]=le*f+fe*C+Ee*F+De*ne,r[7]=le*y+fe*I+Ee*O+De*ye,r[8]=(le=o[8])*s+(fe=o[9])*x+(Ee=o[10])*P+(De=o[11])*U,r[9]=le*d+fe*S+Ee*D+De*J,r[10]=le*f+fe*C+Ee*F+De*ne,r[11]=le*y+fe*I+Ee*O+De*ye,r[12]=(le=o[12])*s+(fe=o[13])*x+(Ee=o[14])*P+(De=o[15])*U,r[13]=le*d+fe*S+Ee*D+De*J,r[14]=le*f+fe*C+Ee*F+De*ne,r[15]=le*y+fe*I+Ee*O+De*ye,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var mc,rb=t_;function _d(r,t,o){var s=t[0],d=t[1],f=t[2],y=t[3];return r[0]=o[0]*s+o[4]*d+o[8]*f+o[12]*y,r[1]=o[1]*s+o[5]*d+o[9]*f+o[13]*y,r[2]=o[2]*s+o[6]*d+o[10]*f+o[14]*y,r[3]=o[3]*s+o[7]*d+o[11]*f+o[15]*y,r}mc=new Ll(4),Ll!=Float32Array&&(mc[0]=0,mc[1]=0,mc[2]=0,mc[3]=0);class ib extends E{constructor(t){super(t,nb)}createBucket(t){return new zf(t)}queryRadius(t){const o=t;return fc("circle-radius",this,o)+fc("circle-stroke-width",this,o)+gd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,o,s,d,f,y,x,S){const C=yd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,x),I=this.paint.get("circle-radius").evaluate(o,s)+this.paint.get("circle-stroke-width").evaluate(o,s),P=this.paint.get("circle-pitch-alignment")==="map",D=P?C:function(O,U){return O.map(J=>n_(J,U))}(C,S),F=P?I*x:I;for(const O of d)for(const U of O){const J=P?U:n_(U,S);let ne=F;const ye=_d([],[U.x,U.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=ye[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=y.cameraToCenterDistance/ye[3]),Yw(D,J,ne))return!0}return!1}}function n_(r,t){const o=_d([],[r.x,r.y,0,1],t);return new j(o[0]/o[3],o[1]/o[3])}class r_ extends zf{}let i_;et("HeatmapBucket",r_,{omit:["layers"]});var ob={get paint(){return i_=i_||new b({"heatmap-radius":new a(we.paint_heatmap["heatmap-radius"]),"heatmap-weight":new a(we.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new e(we.paint_heatmap["heatmap-intensity"]),"heatmap-color":new g(we.paint_heatmap["heatmap-color"]),"heatmap-opacity":new e(we.paint_heatmap["heatmap-opacity"])})}};function Rf(r,{width:t,height:o},s,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*o*s)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*o*s}`)}else d=new Uint8Array(t*o*s);return r.width=t,r.height=o,r.data=d,r}function o_(r,{width:t,height:o},s){if(t===r.width&&o===r.height)return;const d=Rf({},{width:t,height:o},s);Ff(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,o)},s),r.width=t,r.height=o,r.data=d.data}function Ff(r,t,o,s,d,f){if(d.width===0||d.height===0)return t;if(d.width>r.width||d.height>r.height||o.x>r.width-d.width||o.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||s.x>t.width-d.width||s.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,x=t.data;if(y===x)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<d.height;S++){const C=((o.y+S)*r.width+o.x)*f,I=((s.y+S)*t.width+s.x)*f;for(let P=0;P<d.width*f;P++)x[I+P]=y[C+P]}return t}class gc{constructor(t,o){Rf(this,t,1,o)}resize(t){o_(this,t,1)}clone(){return new gc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,s,d,f){Ff(t,o,s,d,f,1)}}class bi{constructor(t,o){Rf(this,t,4,o)}resize(t){o_(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new bi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,s,d,f){Ff(t,o,s,d,f,4)}}function a_(r){const t={},o=r.resolution||256,s=r.clips?r.clips.length:1,d=r.image||new bi({width:o,height:s});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const f=(y,x,S)=>{t[r.evaluationKey]=S;const C=r.expression.evaluate(t);d.data[y+x+0]=Math.floor(255*C.r/C.a),d.data[y+x+1]=Math.floor(255*C.g/C.a),d.data[y+x+2]=Math.floor(255*C.b/C.a),d.data[y+x+3]=Math.floor(255*C.a)};if(r.clips)for(let y=0,x=0;y<s;++y,x+=4*o)for(let S=0,C=0;S<o;S++,C+=4){const I=S/(o-1),{start:P,end:D}=r.clips[y];f(x,C,P*(1-I)+D*I)}else for(let y=0,x=0;y<o;y++,x+=4)f(0,x,y/(o-1));return d}et("AlphaImage",gc),et("RGBAImage",bi);class ab extends E{createBucket(t){return new r_(t)}constructor(t){super(t,ob),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=a_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let s_;var sb={get paint(){return s_=s_||new b({"hillshade-illumination-direction":new e(we.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new e(we.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new e(we.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new e(we.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new e(we.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new e(we.paint_hillshade["hillshade-accent-color"])})}};class lb extends E{constructor(t){super(t,sb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ub=B([{name:"a_pos",components:2,type:"Int16"}],4),{members:cb}=ub;function l_(r,t,o=2){const s=t&&t.length,d=s?t[0]*o:r.length;let f=u_(r,0,d,o,!0);const y=[];if(!f||f.next===f.prev)return y;let x,S,C;if(s&&(f=function(I,P,D,F){const O=[];for(let U=0,J=P.length;U<J;U++){const ne=u_(I,P[U]*F,U<J-1?P[U+1]*F:I.length,F,!1);ne===ne.next&&(ne.steiner=!0),O.push(_b(ne))}O.sort(mb);for(let U=0;U<O.length;U++)D=gb(O[U],D);return D}(r,t,f,o)),r.length>80*o){x=1/0,S=1/0;let I=-1/0,P=-1/0;for(let D=o;D<d;D+=o){const F=r[D],O=r[D+1];F<x&&(x=F),O<S&&(S=O),F>I&&(I=F),O>P&&(P=O)}C=Math.max(I-x,P-S),C=C!==0?32767/C:0}return yc(f,y,o,x,S,C,0),y}function u_(r,t,o,s,d){let f;if(d===function(y,x,S,C){let I=0;for(let P=x,D=S-C;P<S;P+=C)I+=(y[D]-y[P])*(y[P+1]+y[D+1]),D=P;return I}(r,t,o,s)>0)for(let y=t;y<o;y+=s)f=d_(y/s|0,r[y],r[y+1],f);else for(let y=o-s;y>=t;y-=s)f=d_(y/s|0,r[y],r[y+1],f);return f&&vd(f,f.next)&&(vc(f),f=f.next),f}function Ps(r,t){if(!r)return r;t||(t=r);let o,s=r;do if(o=!1,s.steiner||!vd(s,s.next)&&Mn(s.prev,s,s.next)!==0)s=s.next;else{if(vc(s),s=t=s.prev,s===s.next)break;o=!0}while(o||s!==t);return t}function yc(r,t,o,s,d,f,y){if(!r)return;!y&&f&&function(S,C,I,P){let D=S;do D.z===0&&(D.z=Bf(D.x,D.y,C,I,P)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==S);D.prevZ.nextZ=null,D.prevZ=null,function(F){let O,U=1;do{let J,ne=F;F=null;let ye=null;for(O=0;ne;){O++;let le=ne,fe=0;for(let De=0;De<U&&(fe++,le=le.nextZ,le);De++);let Ee=U;for(;fe>0||Ee>0&&le;)fe!==0&&(Ee===0||!le||ne.z<=le.z)?(J=ne,ne=ne.nextZ,fe--):(J=le,le=le.nextZ,Ee--),ye?ye.nextZ=J:F=J,J.prevZ=ye,ye=J;ne=le}ye.nextZ=null,U*=2}while(O>1)}(D)}(r,s,d,f);let x=r;for(;r.prev!==r.next;){const S=r.prev,C=r.next;if(f?db(r,s,d,f):hb(r))t.push(S.i,r.i,C.i),vc(r),r=C.next,x=C.next;else if((r=C)===x){y?y===1?yc(r=pb(Ps(r),t),t,o,s,d,f,2):y===2&&fb(r,t,o,s,d,f):yc(Ps(r),t,o,s,d,f,1);break}}}function hb(r){const t=r.prev,o=r,s=r.next;if(Mn(t,o,s)>=0)return!1;const d=t.x,f=o.x,y=s.x,x=t.y,S=o.y,C=s.y,I=d<f?d<y?d:y:f<y?f:y,P=x<S?x<C?x:C:S<C?S:C,D=d>f?d>y?d:y:f>y?f:y,F=x>S?x>C?x:C:S>C?S:C;let O=s.next;for(;O!==t;){if(O.x>=I&&O.x<=D&&O.y>=P&&O.y<=F&&Rl(d,x,f,S,y,C,O.x,O.y)&&Mn(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function db(r,t,o,s){const d=r.prev,f=r,y=r.next;if(Mn(d,f,y)>=0)return!1;const x=d.x,S=f.x,C=y.x,I=d.y,P=f.y,D=y.y,F=x<S?x<C?x:C:S<C?S:C,O=I<P?I<D?I:D:P<D?P:D,U=x>S?x>C?x:C:S>C?S:C,J=I>P?I>D?I:D:P>D?P:D,ne=Bf(F,O,t,o,s),ye=Bf(U,J,t,o,s);let le=r.prevZ,fe=r.nextZ;for(;le&&le.z>=ne&&fe&&fe.z<=ye;){if(le.x>=F&&le.x<=U&&le.y>=O&&le.y<=J&&le!==d&&le!==y&&Rl(x,I,S,P,C,D,le.x,le.y)&&Mn(le.prev,le,le.next)>=0||(le=le.prevZ,fe.x>=F&&fe.x<=U&&fe.y>=O&&fe.y<=J&&fe!==d&&fe!==y&&Rl(x,I,S,P,C,D,fe.x,fe.y)&&Mn(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;le&&le.z>=ne;){if(le.x>=F&&le.x<=U&&le.y>=O&&le.y<=J&&le!==d&&le!==y&&Rl(x,I,S,P,C,D,le.x,le.y)&&Mn(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;fe&&fe.z<=ye;){if(fe.x>=F&&fe.x<=U&&fe.y>=O&&fe.y<=J&&fe!==d&&fe!==y&&Rl(x,I,S,P,C,D,fe.x,fe.y)&&Mn(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function pb(r,t){let o=r;do{const s=o.prev,d=o.next.next;!vd(s,d)&&c_(s,o,o.next,d)&&_c(s,d)&&_c(d,s)&&(t.push(s.i,o.i,d.i),vc(o),vc(o.next),o=r=d),o=o.next}while(o!==r);return Ps(o)}function fb(r,t,o,s,d,f){let y=r;do{let x=y.next.next;for(;x!==y.prev;){if(y.i!==x.i&&vb(y,x)){let S=h_(y,x);return y=Ps(y,y.next),S=Ps(S,S.next),yc(y,t,o,s,d,f,0),void yc(S,t,o,s,d,f,0)}x=x.next}y=y.next}while(y!==r)}function mb(r,t){return r.x-t.x}function gb(r,t){const o=function(d,f){let y=f;const x=d.x,S=d.y;let C,I=-1/0;do{if(S<=y.y&&S>=y.next.y&&y.next.y!==y.y){const U=y.x+(S-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(U<=x&&U>I&&(I=U,C=y.x<y.next.x?y:y.next,U===x))return C}y=y.next}while(y!==f);if(!C)return null;const P=C,D=C.x,F=C.y;let O=1/0;y=C;do{if(x>=y.x&&y.x>=D&&x!==y.x&&Rl(S<F?x:I,S,D,F,S<F?I:x,S,y.x,y.y)){const U=Math.abs(S-y.y)/(x-y.x);_c(y,d)&&(U<O||U===O&&(y.x>C.x||y.x===C.x&&yb(C,y)))&&(C=y,O=U)}y=y.next}while(y!==P);return C}(r,t);if(!o)return t;const s=h_(o,r);return Ps(s,s.next),Ps(o,o.next)}function yb(r,t){return Mn(r.prev,r,t.prev)<0&&Mn(t.next,r,r.next)<0}function Bf(r,t,o,s,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _b(r){let t=r,o=r;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==r);return o}function Rl(r,t,o,s,d,f,y,x){return(d-y)*(t-x)>=(r-y)*(f-x)&&(r-y)*(s-x)>=(o-y)*(t-x)&&(o-y)*(f-x)>=(d-y)*(s-x)}function vb(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(o,s){let d=o;do{if(d.i!==o.i&&d.next.i!==o.i&&d.i!==s.i&&d.next.i!==s.i&&c_(d,d.next,o,s))return!0;d=d.next}while(d!==o);return!1}(r,t)&&(_c(r,t)&&_c(t,r)&&function(o,s){let d=o,f=!1;const y=(o.x+s.x)/2,x=(o.y+s.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&y<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(f=!f),d=d.next;while(d!==o);return f}(r,t)&&(Mn(r.prev,r,t.prev)||Mn(r,t.prev,t))||vd(r,t)&&Mn(r.prev,r,r.next)>0&&Mn(t.prev,t,t.next)>0)}function Mn(r,t,o){return(t.y-r.y)*(o.x-t.x)-(t.x-r.x)*(o.y-t.y)}function vd(r,t){return r.x===t.x&&r.y===t.y}function c_(r,t,o,s){const d=wd(Mn(r,t,o)),f=wd(Mn(r,t,s)),y=wd(Mn(o,s,r)),x=wd(Mn(o,s,t));return d!==f&&y!==x||!(d!==0||!xd(r,o,t))||!(f!==0||!xd(r,s,t))||!(y!==0||!xd(o,r,s))||!(x!==0||!xd(o,t,s))}function xd(r,t,o){return t.x<=Math.max(r.x,o.x)&&t.x>=Math.min(r.x,o.x)&&t.y<=Math.max(r.y,o.y)&&t.y>=Math.min(r.y,o.y)}function wd(r){return r>0?1:r<0?-1:0}function _c(r,t){return Mn(r.prev,r,r.next)<0?Mn(r,t,r.next)>=0&&Mn(r,r.prev,t)>=0:Mn(r,t,r.prev)<0||Mn(r,r.next,t)<0}function h_(r,t){const o=Of(r.i,r.x,r.y),s=Of(t.i,t.x,t.y),d=r.next,f=t.prev;return r.next=t,t.prev=r,o.next=d,d.prev=o,s.next=o,o.prev=s,f.next=s,s.prev=f,s}function d_(r,t,o,s){const d=Of(r,t,o);return s?(d.next=s.next,d.prev=s,s.next.prev=d,s.next=d):(d.prev=d,d.next=d),d}function vc(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Of(r,t,o){return{i:r,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Nf(r,t,o){const s=o.patternDependencies;let d=!1;for(const f of t){const y=f.paint.get(`${r}-pattern`);y.isConstant()||(d=!0);const x=y.constantOr(null);x&&(d=!0,s[x.to]=!0,s[x.from]=!0)}return d}function jf(r,t,o,s,d){const f=d.patternDependencies;for(const y of t){const x=y.paint.get(`${r}-pattern`).value;if(x.kind!=="constant"){let S=x.evaluate({zoom:s-1},o,{},d.availableImages),C=x.evaluate({zoom:s},o,{},d.availableImages),I=x.evaluate({zoom:s+1},o,{},d.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,I=I&&I.name?I.name:I,f[S]=!0,f[C]=!0,f[I]=!0,o.patterns[y.id]={min:S,mid:C,max:I}}}return o}class Vf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new uc,this.indexArray=new bo,this.indexArray2=new bs,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Qn,this.segments2=new Qn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,s){this.hasPattern=Nf("fill",this.layers,o);const d=this.layers[0].layout.get("fill-sort-key"),f=!d.isConstant(),y=[];for(const{feature:x,id:S,index:C,sourceLayerIndex:I}of t){const P=this.layers[0]._featureFilter.needGeometry,D=Is(x,P);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),D,s))continue;const F=f?d.evaluate(D,{},s,o.availableImages):void 0,O={id:S,properties:x.properties,type:x.type,sourceLayerIndex:I,index:C,geometry:P?D.geometry:ks(x),patterns:{},sortKey:F};y.push(O)}f&&y.sort((x,S)=>x.sortKey-S.sortKey);for(const x of y){const{geometry:S,index:C,sourceLayerIndex:I}=x;if(this.hasPattern){const P=jf("fill",this.layers,x,this.zoom,o);this.patternFeatures.push(P)}else this.addFeature(x,S,C,s,{});o.featureIndex.insert(t[C].feature,S,C,I,this.index)}}update(t,o,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,s)}addFeatures(t,o,s){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cb),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,s,d,f){for(const y of ll(o,500)){let x=0;for(const F of y)x+=F.length;const S=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),C=S.vertexLength,I=[],P=[];for(const F of y){if(F.length===0)continue;F!==y[0]&&P.push(I.length/2);const O=this.segments2.prepareSegment(F.length,this.layoutVertexArray,this.indexArray2),U=O.vertexLength;this.layoutVertexArray.emplaceBack(F[0].x,F[0].y),this.indexArray2.emplaceBack(U+F.length-1,U),I.push(F[0].x),I.push(F[0].y);for(let J=1;J<F.length;J++)this.layoutVertexArray.emplaceBack(F[J].x,F[J].y),this.indexArray2.emplaceBack(U+J-1,U+J),I.push(F[J].x),I.push(F[J].y);O.vertexLength+=F.length,O.primitiveLength+=F.length}const D=l_(I,P);for(let F=0;F<D.length;F+=3)this.indexArray.emplaceBack(C+D[F],C+D[F+1],C+D[F+2]);S.vertexLength+=x,S.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,f,d)}}let p_,f_;et("FillBucket",Vf,{omit:["layers","patternFeatures"]});var xb={get paint(){return f_=f_||new b({"fill-antialias":new e(we.paint_fill["fill-antialias"]),"fill-opacity":new a(we.paint_fill["fill-opacity"]),"fill-color":new a(we.paint_fill["fill-color"]),"fill-outline-color":new a(we.paint_fill["fill-outline-color"]),"fill-translate":new e(we.paint_fill["fill-translate"]),"fill-translate-anchor":new e(we.paint_fill["fill-translate-anchor"]),"fill-pattern":new u(we.paint_fill["fill-pattern"])})},get layout(){return p_=p_||new b({"fill-sort-key":new a(we.layout_fill["fill-sort-key"])})}};class wb extends E{constructor(t){super(t,xb)}recalculate(t,o){super.recalculate(t,o);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Vf(t)}queryRadius(){return gd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,o,s,d,f,y,x){return Ky(yd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,x),d)}isTileClipped(){return!0}}const bb=B([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Sb=B([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Tb}=bb;var Ta={},Eb=V,m_=Fl;function Fl(r,t,o,s,d){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=s,this._values=d,r.readFields(Cb,this,t)}function Cb(r,t,o){r==1?t.id=o.readVarint():r==2?function(s,d){for(var f=s.readVarint()+s.pos;s.pos<f;){var y=d._keys[s.readVarint()],x=d._values[s.readVarint()];d.properties[y]=x}}(o,t):r==3?t.type=o.readVarint():r==4&&(t._geometry=o.pos)}function kb(r){for(var t,o,s=0,d=0,f=r.length,y=f-1;d<f;y=d++)s+=((o=r[y]).x-(t=r[d]).x)*(t.y+o.y);return s}Fl.types=["Unknown","Point","LineString","Polygon"],Fl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,o=r.readVarint()+r.pos,s=1,d=0,f=0,y=0,x=[];r.pos<o;){if(d<=0){var S=r.readVarint();s=7&S,d=S>>3}if(d--,s===1||s===2)f+=r.readSVarint(),y+=r.readSVarint(),s===1&&(t&&x.push(t),t=[]),t.push(new Eb(f,y));else{if(s!==7)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&x.push(t),x},Fl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,o=1,s=0,d=0,f=0,y=1/0,x=-1/0,S=1/0,C=-1/0;r.pos<t;){if(s<=0){var I=r.readVarint();o=7&I,s=I>>3}if(s--,o===1||o===2)(d+=r.readSVarint())<y&&(y=d),d>x&&(x=d),(f+=r.readSVarint())<S&&(S=f),f>C&&(C=f);else if(o!==7)throw new Error("unknown command "+o)}return[y,S,x,C]},Fl.prototype.toGeoJSON=function(r,t,o){var s,d,f=this.extent*Math.pow(2,o),y=this.extent*r,x=this.extent*t,S=this.loadGeometry(),C=Fl.types[this.type];function I(F){for(var O=0;O<F.length;O++){var U=F[O];F[O]=[360*(U.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+x)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(s=0;s<S.length;s++)P[s]=S[s][0];I(S=P);break;case 2:for(s=0;s<S.length;s++)I(S[s]);break;case 3:for(S=function(F){var O=F.length;if(O<=1)return[F];for(var U,J,ne=[],ye=0;ye<O;ye++){var le=kb(F[ye]);le!==0&&(J===void 0&&(J=le<0),J===le<0?(U&&ne.push(U),U=[F[ye]]):U.push(F[ye]))}return U&&ne.push(U),ne}(S),s=0;s<S.length;s++)for(d=0;d<S[s].length;d++)I(S[s][d])}S.length===1?S=S[0]:C="Multi"+C;var D={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(D.id=this.id),D};var Ib=m_,g_=y_;function y_(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Pb,this,t),this.length=this._features.length}function Pb(r,t,o){r===15?t.version=o.readVarint():r===1?t.name=o.readString():r===5?t.extent=o.readVarint():r===2?t._features.push(o.pos):r===3?t._keys.push(o.readString()):r===4&&t._values.push(function(s){for(var d=null,f=s.readVarint()+s.pos;s.pos<f;){var y=s.readVarint()>>3;d=y===1?s.readString():y===2?s.readFloat():y===3?s.readDouble():y===4?s.readVarint64():y===5?s.readVarint():y===6?s.readSVarint():y===7?s.readBoolean():null}return d}(o))}y_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new Ib(this._pbf,t,this.extent,this._keys,this._values)};var Mb=g_;function zb(r,t,o){if(r===3){var s=new Mb(o,o.readVarint()+o.pos);s.length&&(t[s.name]=s)}}Ta.VectorTile=function(r,t){this.layers=r.readFields(zb,{},t)},Ta.VectorTileFeature=m_,Ta.VectorTileLayer=g_;const Ab=Ta.VectorTileFeature.types,Uf=Math.pow(2,13);function xc(r,t,o,s,d,f,y,x){r.emplaceBack(t,o,2*Math.floor(s*Uf)+y,d*Uf*2,f*Uf*2,Math.round(x))}class $f{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ti,this.centroidVertexArray=new xo,this.indexArray=new bo,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Qn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,s){this.features=[],this.hasPattern=Nf("fill-extrusion",this.layers,o);for(const{feature:d,id:f,index:y,sourceLayerIndex:x}of t){const S=this.layers[0]._featureFilter.needGeometry,C=Is(d,S);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),C,s))continue;const I={id:f,sourceLayerIndex:x,index:y,geometry:S?C.geometry:ks(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(jf("fill-extrusion",this.layers,I,this.zoom,o)):this.addFeature(I,I.geometry,y,s,{}),o.featureIndex.insert(d,I.geometry,y,x,this.index,!0)}}addFeatures(t,o,s){for(const d of this.features){const{geometry:f}=d;this.addFeature(d,f,d.index,o,s)}}update(t,o,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tb),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Sb.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,o,s,d,f){for(const y of ll(o,500)){const x={x:0,y:0,vertexCount:0};let S=0;for(const O of y)S+=O.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const O of y){if(O.length===0||Lb(O))continue;let U=0;for(let J=0;J<O.length;J++){const ne=O[J];if(J>=1){const ye=O[J-1];if(!Db(ne,ye)){C.vertexLength+4>Qn.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const le=ne.sub(ye)._perp()._unit(),fe=ye.dist(ne);U+fe>32768&&(U=0),xc(this.layoutVertexArray,ne.x,ne.y,le.x,le.y,0,0,U),xc(this.layoutVertexArray,ne.x,ne.y,le.x,le.y,0,1,U),x.x+=2*ne.x,x.y+=2*ne.y,x.vertexCount+=2,U+=fe,xc(this.layoutVertexArray,ye.x,ye.y,le.x,le.y,0,0,U),xc(this.layoutVertexArray,ye.x,ye.y,le.x,le.y,0,1,U),x.x+=2*ye.x,x.y+=2*ye.y,x.vertexCount+=2;const Ee=C.vertexLength;this.indexArray.emplaceBack(Ee,Ee+2,Ee+1),this.indexArray.emplaceBack(Ee+1,Ee+2,Ee+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>Qn.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Ab[t.type]!=="Polygon")continue;const I=[],P=[],D=C.vertexLength;for(const O of y)if(O.length!==0){O!==y[0]&&P.push(I.length/2);for(let U=0;U<O.length;U++){const J=O[U];xc(this.layoutVertexArray,J.x,J.y,0,0,1,1,0),x.x+=J.x,x.y+=J.y,x.vertexCount+=1,I.push(J.x),I.push(J.y)}}const F=l_(I,P);for(let O=0;O<F.length;O+=3)this.indexArray.emplaceBack(D+F[O],D+F[O+2],D+F[O+1]);C.primitiveLength+=F.length/3,C.vertexLength+=S;for(let O=0;O<x.vertexCount;O++){const U=Math.floor(x.x/x.vertexCount),J=Math.floor(x.y/x.vertexCount);this.centroidVertexArray.emplaceBack(U,J)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,f,d)}}function Db(r,t){return r.x===t.x&&(r.x<0||r.x>jn)||r.y===t.y&&(r.y<0||r.y>jn)}function Lb(r){return r.every(t=>t.x<0)||r.every(t=>t.x>jn)||r.every(t=>t.y<0)||r.every(t=>t.y>jn)}let __;et("FillExtrusionBucket",$f,{omit:["layers","features"]});var Rb={get paint(){return __=__||new b({"fill-extrusion-opacity":new e(we["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new a(we["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new e(we["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new e(we["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new u(we["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new a(we["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new a(we["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new e(we["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Fb extends E{constructor(t){super(t,Rb)}createBucket(t){return new $f(t)}queryRadius(){return gd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,o,s,d,f,y,x,S){const C=yd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,x),I=this.paint.get("fill-extrusion-height").evaluate(o,s),P=this.paint.get("fill-extrusion-base").evaluate(o,s),D=function(O,U,J,ne){const ye=[];for(const le of O){const fe=[le.x,le.y,0,1];_d(fe,fe,U),ye.push(new j(fe[0]/fe[3],fe[1]/fe[3]))}return ye}(C,S),F=function(O,U,J,ne){const ye=[],le=[],fe=ne[8]*U,Ee=ne[9]*U,De=ne[10]*U,Ke=ne[11]*U,_t=ne[8]*J,We=ne[9]*J,He=ne[10]*J,ht=ne[11]*J;for(const it of O){const tt=[],Pe=[];for(const pt of it){const ct=pt.x,St=pt.y,Qt=ne[0]*ct+ne[4]*St+ne[12],Yt=ne[1]*ct+ne[5]*St+ne[13],Gn=ne[2]*ct+ne[6]*St+ne[14],Vi=ne[3]*ct+ne[7]*St+ne[15],lr=Gn+De,Wn=Vi+Ke,kr=Qt+_t,Ir=Yt+We,Pr=Gn+He,En=Vi+ht,Xn=new j((Qt+fe)/Wn,(Yt+Ee)/Wn);Xn.z=lr/Wn,tt.push(Xn);const gr=new j(kr/En,Ir/En);gr.z=Pr/En,Pe.push(gr)}ye.push(tt),le.push(Pe)}return[ye,le]}(d,P,I,S);return function(O,U,J){let ne=1/0;Ky(J,U)&&(ne=v_(J,U[0]));for(let ye=0;ye<U.length;ye++){const le=U[ye],fe=O[ye];for(let Ee=0;Ee<le.length-1;Ee++){const De=le[Ee],Ke=[De,le[Ee+1],fe[Ee+1],fe[Ee],De];Xy(J,Ke)&&(ne=Math.min(ne,v_(J,Ke)))}}return ne!==1/0&&ne}(F[0],F[1],D)}}function wc(r,t){return r.x*t.x+r.y*t.y}function v_(r,t){if(r.length===1){let o=0;const s=t[o++];let d;for(;!d||s.equals(d);)if(d=t[o++],!d)return 1/0;for(;o<t.length;o++){const f=t[o],y=r[0],x=d.sub(s),S=f.sub(s),C=y.sub(s),I=wc(x,x),P=wc(x,S),D=wc(S,S),F=wc(C,x),O=wc(C,S),U=I*D-P*P,J=(D*F-P*O)/U,ne=(I*O-P*F)/U,ye=s.z*(1-J-ne)+d.z*J+f.z*ne;if(isFinite(ye))return ye}return 1/0}{let o=1/0;for(const s of t)o=Math.min(o,s.z);return o}}const Bb=B([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ob}=Bb,Nb=B([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jb}=Nb,Vb=Ta.VectorTileFeature.types,Ub=Math.cos(Math.PI/180*37.5),x_=Math.pow(2,14)/.5;class Zf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new xi,this.layoutVertexArray2=new wo,this.indexArray=new bo,this.programConfigurations=new Cs(t.layers,t.zoom),this.segments=new Qn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,s){this.hasPattern=Nf("line",this.layers,o);const d=this.layers[0].layout.get("line-sort-key"),f=!d.isConstant(),y=[];for(const{feature:x,id:S,index:C,sourceLayerIndex:I}of t){const P=this.layers[0]._featureFilter.needGeometry,D=Is(x,P);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),D,s))continue;const F=f?d.evaluate(D,{},s):void 0,O={id:S,properties:x.properties,type:x.type,sourceLayerIndex:I,index:C,geometry:P?D.geometry:ks(x),patterns:{},sortKey:F};y.push(O)}f&&y.sort((x,S)=>x.sortKey-S.sortKey);for(const x of y){const{geometry:S,index:C,sourceLayerIndex:I}=x;if(this.hasPattern){const P=jf("line",this.layers,x,this.zoom,o);this.patternFeatures.push(P)}else this.addFeature(x,S,C,s,{});o.featureIndex.insert(t[C].feature,S,C,I,this.index)}}update(t,o,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,s)}addFeatures(t,o,s){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,jb)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ob),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,s,d,f){const y=this.layers[0].layout,x=y.get("line-join").evaluate(t,{}),S=y.get("line-cap"),C=y.get("line-miter-limit"),I=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of o)this.addLine(P,t,x,S,C,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,f,d)}addLine(t,o,s,d,f,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<t.length-1;ne++)this.totalDistance+=t[ne].dist(t[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=Vb[o.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let C=0;for(;C<S-1&&t[C].equals(t[C+1]);)C++;if(S<(x?3:2))return;s==="bevel"&&(f=1.05);const I=this.overscaling<=16?15*jn/(512*this.overscaling):0,P=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let D,F,O,U,J;this.e1=this.e2=-1,x&&(D=t[S-2],J=t[C].sub(D)._unit()._perp());for(let ne=C;ne<S;ne++){if(O=ne===S-1?x?t[C+1]:void 0:t[ne+1],O&&t[ne].equals(O))continue;J&&(U=J),D&&(F=D),D=t[ne],J=O?O.sub(D)._unit()._perp():U,U=U||J;let ye=U.add(J);ye.x===0&&ye.y===0||ye._unit();const le=U.x*J.x+U.y*J.y,fe=ye.x*J.x+ye.y*J.y,Ee=fe!==0?1/fe:1/0,De=2*Math.sqrt(2-2*fe),Ke=fe<Ub&&F&&O,_t=U.x*J.y-U.y*J.x>0;if(Ke&&ne>C){const ht=D.dist(F);if(ht>2*I){const it=D.sub(D.sub(F)._mult(I/ht)._round());this.updateDistance(F,it),this.addCurrentVertex(it,U,0,0,P),F=it}}const We=F&&O;let He=We?s:x?"butt":d;if(We&&He==="round"&&(Ee<y?He="miter":Ee<=2&&(He="fakeround")),He==="miter"&&Ee>f&&(He="bevel"),He==="bevel"&&(Ee>2&&(He="flipbevel"),Ee<f&&(He="miter")),F&&this.updateDistance(F,D),He==="miter")ye._mult(Ee),this.addCurrentVertex(D,ye,0,0,P);else if(He==="flipbevel"){if(Ee>100)ye=J.mult(-1);else{const ht=Ee*U.add(J).mag()/U.sub(J).mag();ye._perp()._mult(ht*(_t?-1:1))}this.addCurrentVertex(D,ye,0,0,P),this.addCurrentVertex(D,ye.mult(-1),0,0,P)}else if(He==="bevel"||He==="fakeround"){const ht=-Math.sqrt(Ee*Ee-1),it=_t?ht:0,tt=_t?0:ht;if(F&&this.addCurrentVertex(D,U,it,tt,P),He==="fakeround"){const Pe=Math.round(180*De/Math.PI/20);for(let pt=1;pt<Pe;pt++){let ct=pt/Pe;if(ct!==.5){const Qt=ct-.5;ct+=ct*Qt*(ct-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Qt*Qt+(.848013+le*(.215638*le-1.06021)))}const St=J.sub(U)._mult(ct)._add(U)._unit()._mult(_t?-1:1);this.addHalfVertex(D,St.x,St.y,!1,_t,0,P)}}O&&this.addCurrentVertex(D,J,-it,-tt,P)}else if(He==="butt")this.addCurrentVertex(D,ye,0,0,P);else if(He==="square"){const ht=F?1:-1;this.addCurrentVertex(D,ye,ht,ht,P)}else He==="round"&&(F&&(this.addCurrentVertex(D,U,0,0,P),this.addCurrentVertex(D,U,1,1,P,!0)),O&&(this.addCurrentVertex(D,J,-1,-1,P,!0),this.addCurrentVertex(D,J,0,0,P)));if(Ke&&ne<S-1){const ht=D.dist(O);if(ht>2*I){const it=D.add(O.sub(D)._mult(I/ht)._round());this.updateDistance(D,it),this.addCurrentVertex(it,J,0,0,P),D=it}}}}addCurrentVertex(t,o,s,d,f,y=!1){const x=o.y*d-o.x,S=-o.y-o.x*d;this.addHalfVertex(t,o.x+o.y*s,o.y-o.x*s,y,!1,s,f),this.addHalfVertex(t,x,S,y,!0,-d,f),this.distance>x_/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,o,s,d,f,y))}addHalfVertex({x:t,y:o},s,d,f,y,x,S){const C=.5*(this.lineClips?this.scaledDistance*(x_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(f?1:0),(o<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),S.primitiveLength++),y?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}let w_,b_;et("LineBucket",Zf,{omit:["layers","patternFeatures"]});var S_={get paint(){return b_=b_||new b({"line-opacity":new a(we.paint_line["line-opacity"]),"line-color":new a(we.paint_line["line-color"]),"line-translate":new e(we.paint_line["line-translate"]),"line-translate-anchor":new e(we.paint_line["line-translate-anchor"]),"line-width":new a(we.paint_line["line-width"]),"line-gap-width":new a(we.paint_line["line-gap-width"]),"line-offset":new a(we.paint_line["line-offset"]),"line-blur":new a(we.paint_line["line-blur"]),"line-dasharray":new h(we.paint_line["line-dasharray"]),"line-pattern":new u(we.paint_line["line-pattern"]),"line-gradient":new g(we.paint_line["line-gradient"])})},get layout(){return w_=w_||new b({"line-cap":new e(we.layout_line["line-cap"]),"line-join":new a(we.layout_line["line-join"]),"line-miter-limit":new e(we.layout_line["line-miter-limit"]),"line-round-limit":new e(we.layout_line["line-round-limit"]),"line-sort-key":new a(we.layout_line["line-sort-key"])})}};class $b extends a{possiblyEvaluate(t,o){return o=new Kt(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,s,d){return o=Qe({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,s,d)}}let bd;class Zb extends E{constructor(t){super(t,S_),this.gradientVersion=0,bd||(bd=new $b(S_.paint.properties["line-width"].specification),bd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(s){return s._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof ua,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,o){super.recalculate(t,o),this.paint._values["line-floorwidth"]=bd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Zf(t)}queryRadius(t){const o=t,s=T_(fc("line-width",this,o),fc("line-gap-width",this,o)),d=fc("line-offset",this,o);return s/2+Math.abs(d)+gd(this.paint.get("line-translate"))}queryIntersectsFeature(t,o,s,d,f,y,x){const S=yd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,x),C=x/2*T_(this.paint.get("line-width").evaluate(o,s),this.paint.get("line-gap-width").evaluate(o,s)),I=this.paint.get("line-offset").evaluate(o,s);return I&&(d=function(P,D){const F=[];for(let O=0;O<P.length;O++){const U=P[O],J=[];for(let ne=0;ne<U.length;ne++){const ye=U[ne-1],le=U[ne],fe=U[ne+1],Ee=ne===0?new j(0,0):le.sub(ye)._unit()._perp(),De=ne===U.length-1?new j(0,0):fe.sub(le)._unit()._perp(),Ke=Ee._add(De)._unit(),_t=Ke.x*De.x+Ke.y*De.y;_t!==0&&Ke._mult(1/_t),J.push(Ke._mult(D)._add(le))}F.push(J)}return F}(d,I*x)),function(P,D,F){for(let O=0;O<D.length;O++){const U=D[O];if(P.length>=3){for(let J=0;J<U.length;J++)if(Dl(P,U[J]))return!0}if(Qw(P,U,F))return!0}return!1}(S,d,C)}isTileClipped(){return!0}}function T_(r,t){return t>0?t+2*r:r}const qb=B([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hb=B([{name:"a_projected_pos",components:3,type:"Float32"}],4);B([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Gb=B([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);B([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const E_=B([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Wb=B([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Xb(r,t,o){return r.sections.forEach(s=>{s.text=function(d,f,y){const x=f.layout.get("text-transform").evaluate(y,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),Ni.applyArabicShaping&&(d=Ni.applyArabicShaping(d)),d}(s.text,t,o)}),r}B([{name:"triangle",components:3,type:"Uint16"}]),B([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),B([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),B([{type:"Float32",name:"offsetX"}]),B([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),B([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const bc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Zn=24,C_=Jt,k_=function(r,t,o,s,d){var f,y,x=8*d-s-1,S=(1<<x)-1,C=S>>1,I=-7,P=d-1,D=-1,F=r[t+P];for(P+=D,f=F&(1<<-I)-1,F>>=-I,I+=x;I>0;f=256*f+r[t+P],P+=D,I-=8);for(y=f&(1<<-I)-1,f>>=-I,I+=s;I>0;y=256*y+r[t+P],P+=D,I-=8);if(f===0)f=1-C;else{if(f===S)return y?NaN:1/0*(F?-1:1);y+=Math.pow(2,s),f-=C}return(F?-1:1)*y*Math.pow(2,f-s)},I_=function(r,t,o,s,d,f){var y,x,S,C=8*f-d-1,I=(1<<C)-1,P=I>>1,D=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=0,O=1,U=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,y=I):(y=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-y))<1&&(y--,S*=2),(t+=y+P>=1?D/S:D*Math.pow(2,1-P))*S>=2&&(y++,S/=2),y+P>=I?(x=0,y=I):y+P>=1?(x=(t*S-1)*Math.pow(2,d),y+=P):(x=t*Math.pow(2,P-1)*Math.pow(2,d),y=0));d>=8;r[o+F]=255&x,F+=O,x/=256,d-=8);for(y=y<<d|x,C+=d;C>0;r[o+F]=255&y,F+=O,y/=256,C-=8);r[o+F-O]|=128*U};function Jt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Jt.Varint=0,Jt.Fixed64=1,Jt.Bytes=2,Jt.Fixed32=5;var qf=4294967296,P_=1/qf,M_=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Go(r){return r.type===Jt.Bytes?r.readVarint()+r.pos:r.pos+1}function Bl(r,t,o){return o?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function z_(r,t,o){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(s);for(var d=o.pos-1;d>=r;d--)o.buf[d+s]=o.buf[d]}function Kb(r,t){for(var o=0;o<r.length;o++)t.writeVarint(r[o])}function Jb(r,t){for(var o=0;o<r.length;o++)t.writeSVarint(r[o])}function Yb(r,t){for(var o=0;o<r.length;o++)t.writeFloat(r[o])}function Qb(r,t){for(var o=0;o<r.length;o++)t.writeDouble(r[o])}function e2(r,t){for(var o=0;o<r.length;o++)t.writeBoolean(r[o])}function t2(r,t){for(var o=0;o<r.length;o++)t.writeFixed32(r[o])}function n2(r,t){for(var o=0;o<r.length;o++)t.writeSFixed32(r[o])}function r2(r,t){for(var o=0;o<r.length;o++)t.writeFixed64(r[o])}function i2(r,t){for(var o=0;o<r.length;o++)t.writeSFixed64(r[o])}function Sd(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Ol(r,t,o){r[o]=t,r[o+1]=t>>>8,r[o+2]=t>>>16,r[o+3]=t>>>24}function A_(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}Jt.prototype={destroy:function(){this.buf=null},readFields:function(r,t,o){for(o=o||this.length;this.pos<o;){var s=this.readVarint(),d=s>>3,f=this.pos;this.type=7&s,r(d,t,this),this.pos===f&&this.skip(s)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=Sd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=A_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Sd(this.buf,this.pos)+Sd(this.buf,this.pos+4)*qf;return this.pos+=8,r},readSFixed64:function(){var r=Sd(this.buf,this.pos)+A_(this.buf,this.pos+4)*qf;return this.pos+=8,r},readFloat:function(){var r=k_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=k_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,o,s=this.buf;return t=127&(o=s[this.pos++]),o<128?t:(t|=(127&(o=s[this.pos++]))<<7,o<128?t:(t|=(127&(o=s[this.pos++]))<<14,o<128?t:(t|=(127&(o=s[this.pos++]))<<21,o<128?t:function(d,f,y){var x,S,C=y.buf;if(x=(112&(S=C[y.pos++]))>>4,S<128||(x|=(127&(S=C[y.pos++]))<<3,S<128)||(x|=(127&(S=C[y.pos++]))<<10,S<128)||(x|=(127&(S=C[y.pos++]))<<17,S<128)||(x|=(127&(S=C[y.pos++]))<<24,S<128)||(x|=(1&(S=C[y.pos++]))<<31,S<128))return Bl(d,x,f);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=s[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&M_?function(o,s,d){return M_.decode(o.subarray(s,d))}(this.buf,t,r):function(o,s,d){for(var f="",y=s;y<d;){var x,S,C,I=o[y],P=null,D=I>239?4:I>223?3:I>191?2:1;if(y+D>d)break;D===1?I<128&&(P=I):D===2?(192&(x=o[y+1]))==128&&(P=(31&I)<<6|63&x)<=127&&(P=null):D===3?(S=o[y+2],(192&(x=o[y+1]))==128&&(192&S)==128&&((P=(15&I)<<12|(63&x)<<6|63&S)<=2047||P>=55296&&P<=57343)&&(P=null)):D===4&&(S=o[y+2],C=o[y+3],(192&(x=o[y+1]))==128&&(192&S)==128&&(192&C)==128&&((P=(15&I)<<18|(63&x)<<12|(63&S)<<6|63&C)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,D=1):P>65535&&(P-=65536,f+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),f+=String.fromCharCode(P),y+=D}return f}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Jt.Bytes)return r.push(this.readVarint(t));var o=Go(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Jt.Bytes)return r.push(this.readSVarint());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Jt.Bytes)return r.push(this.readBoolean());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Jt.Bytes)return r.push(this.readFloat());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Jt.Bytes)return r.push(this.readDouble());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Jt.Bytes)return r.push(this.readFixed32());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Jt.Bytes)return r.push(this.readSFixed32());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Jt.Bytes)return r.push(this.readFixed64());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Jt.Bytes)return r.push(this.readSFixed64());var t=Go(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Jt.Varint)for(;this.buf[this.pos++]>127;);else if(t===Jt.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Jt.Fixed32)this.pos+=4;else{if(t!==Jt.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Ol(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Ol(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Ol(this.buf,-1&r,this.pos),Ol(this.buf,Math.floor(r*P_),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Ol(this.buf,-1&r,this.pos),Ol(this.buf,Math.floor(r*P_),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,o){var s,d;if(t>=0?(s=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(f,y,x){x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,x.buf[x.pos]=127&(f>>>=7)}(s,0,o),function(f,y){var x=(7&f)<<4;y.buf[y.pos++]|=x|((f>>>=3)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f)))))}(d,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(s,d,f){for(var y,x,S=0;S<d.length;S++){if((y=d.charCodeAt(S))>55295&&y<57344){if(!x){y>56319||S+1===d.length?(s[f++]=239,s[f++]=191,s[f++]=189):x=y;continue}if(y<56320){s[f++]=239,s[f++]=191,s[f++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(s[f++]=239,s[f++]=191,s[f++]=189,x=null);y<128?s[f++]=y:(y<2048?s[f++]=y>>6|192:(y<65536?s[f++]=y>>12|224:(s[f++]=y>>18|240,s[f++]=y>>12&63|128),s[f++]=y>>6&63|128),s[f++]=63&y|128)}return f}(this.buf,r,this.pos);var o=this.pos-t;o>=128&&z_(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),I_(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),I_(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,t){this.pos++;var o=this.pos;r(t,this);var s=this.pos-o;s>=128&&z_(o,s,this),this.pos=o-1,this.writeVarint(s),this.pos+=s},writeMessage:function(r,t,o){this.writeTag(r,Jt.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,Kb,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,Jb,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,e2,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Yb,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,Qb,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,t2,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,n2,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,r2,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,i2,t)},writeBytesField:function(r,t){this.writeTag(r,Jt.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Jt.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Jt.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Jt.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Jt.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Jt.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Jt.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Jt.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Jt.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Jt.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var Hf=A(C_);const Gf=3;function o2(r,t,o){r===1&&o.readMessage(a2,t)}function a2(r,t,o){if(r===3){const{id:s,bitmap:d,width:f,height:y,left:x,top:S,advance:C}=o.readMessage(s2,{});t.push({id:s,bitmap:new gc({width:f+2*Gf,height:y+2*Gf},d),metrics:{width:f,height:y,left:x,top:S,advance:C}})}}function s2(r,t,o){r===1?t.id=o.readVarint():r===2?t.bitmap=o.readBytes():r===3?t.width=o.readVarint():r===4?t.height=o.readVarint():r===5?t.left=o.readSVarint():r===6?t.top=o.readSVarint():r===7&&(t.advance=o.readVarint())}const D_=Gf;function L_(r){let t=0,o=0;for(const y of r)t+=y.w*y.h,o=Math.max(o,y.w);r.sort((y,x)=>x.h-y.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let d=0,f=0;for(const y of r)for(let x=s.length-1;x>=0;x--){const S=s[x];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,f=Math.max(f,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===S.w&&y.h===S.h){const C=s.pop();x<s.length&&(s[x]=C)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(s.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:d,h:f,fill:t/(d*f)||0}}const Zr=1;class Wf{constructor(t,{pixelRatio:o,version:s,stretchX:d,stretchY:f,content:y,textFitWidth:x,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=d,this.stretchY=f,this.content=y,this.version=s,this.textFitWidth=x,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Zr,this.paddedRect.y+Zr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Zr,this.paddedRect.y+this.paddedRect.h-Zr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Zr)/this.pixelRatio,(this.paddedRect.h-2*Zr)/this.pixelRatio]}}class R_{constructor(t,o){const s={},d={};this.haveRenderCallbacks=[];const f=[];this.addImages(t,s,f),this.addImages(o,d,f);const{w:y,h:x}=L_(f),S=new bi({width:y||1,height:x||1});for(const C in t){const I=t[C],P=s[C].paddedRect;bi.copy(I.data,S,{x:0,y:0},{x:P.x+Zr,y:P.y+Zr},I.data)}for(const C in o){const I=o[C],P=d[C].paddedRect,D=P.x+Zr,F=P.y+Zr,O=I.data.width,U=I.data.height;bi.copy(I.data,S,{x:0,y:0},{x:D,y:F},I.data),bi.copy(I.data,S,{x:0,y:U-1},{x:D,y:F-1},{width:O,height:1}),bi.copy(I.data,S,{x:0,y:0},{x:D,y:F+U},{width:O,height:1}),bi.copy(I.data,S,{x:O-1,y:0},{x:D-1,y:F},{width:1,height:U}),bi.copy(I.data,S,{x:0,y:0},{x:D+O,y:F},{width:1,height:U})}this.image=S,this.iconPositions=s,this.patternPositions=d}addImages(t,o,s){for(const d in t){const f=t[d],y={x:0,y:0,w:f.data.width+2*Zr,h:f.data.height+2*Zr};s.push(y),o[d]=new Wf(y,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),o),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),o)}patchUpdatedImage(t,o,s){if(!t||!o||t.version===o.version)return;t.version=o.version;const[d,f]=t.tl;s.update(o.data,void 0,{x:d,y:f})}}var Ea;et("ImagePosition",Wf),et("ImageAtlas",R_),v.ah=void 0,(Ea=v.ah||(v.ah={}))[Ea.none=0]="none",Ea[Ea.horizontal=1]="horizontal",Ea[Ea.vertical=2]="vertical",Ea[Ea.horizontalOnly=3]="horizontalOnly";const Sc=-17;class Tc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const s=new Tc;return s.scale=t||1,s.fontStack=o,s}static forImage(t){const o=new Tc;return o.imageName=t,o}}class Nl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const s=new Nl;for(let d=0;d<t.sections.length;d++){const f=t.sections[d];f.image?s.addImageSection(f):s.addTextSection(f,o)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let s=0;s<t.length;s++){const d=t.charCodeAt(s+1)||null,f=t.charCodeAt(s-1)||null;o+=d&&oc(d)&&!bc[t[s+1]]||f&&oc(f)&&!bc[t[s-1]]||!bc[t[s]]?t[s]:bc[t[s]]}return o}(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&Ed[this.text.charCodeAt(s)];s++)t++;let o=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Ed[this.text.charCodeAt(s)];s--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const s=new Nl;return s.text=this.text.substring(t,o),s.sectionIndex=this.sectionIndex.slice(t,o),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(Tc.forText(t.scale,t.fontStack||o));const s=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(s)}addImageSection(t){const o=t.image?t.image.name:"";if(o.length===0)return void Ot("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Tc.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Ot("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Td(r,t,o,s,d,f,y,x,S,C,I,P,D,F,O){const U=Nl.fromFeature(r,d);let J;P===v.ah.vertical&&U.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:ye}=Ni;if(ne&&U.sections.length===1){J=[];const Ee=ne(U.toString(),Xf(U,C,f,t,s,F));for(const De of Ee){const Ke=new Nl;Ke.text=De,Ke.sections=U.sections;for(let _t=0;_t<De.length;_t++)Ke.sectionIndex.push(0);J.push(Ke)}}else if(ye){J=[];const Ee=ye(U.text,U.sectionIndex,Xf(U,C,f,t,s,F));for(const De of Ee){const Ke=new Nl;Ke.text=De[0],Ke.sectionIndex=De[1],Ke.sections=U.sections,J.push(Ke)}}else J=function(Ee,De){const Ke=[],_t=Ee.text;let We=0;for(const He of De)Ke.push(Ee.substring(We,He)),We=He;return We<_t.length&&Ke.push(Ee.substring(We,_t.length)),Ke}(U,Xf(U,C,f,t,s,F));const le=[],fe={positionedLines:le,text:U.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:P,iconsInText:!1,verticalizable:!1};return function(Ee,De,Ke,_t,We,He,ht,it,tt,Pe,pt,ct){let St=0,Qt=Sc,Yt=0,Gn=0;const Vi=it==="right"?1:it==="left"?0:.5;let lr=0;for(const En of We){En.trim();const Xn=En.getMaxScale(),gr=(Xn-1)*Zn,ur={positionedGlyphs:[],lineOffset:0};Ee.positionedLines[lr]=ur;const Mr=ur.positionedGlyphs;let cr=0;if(!En.length()){Qt+=He,++lr;continue}for(let qr=0;qr<En.length();qr++){const qt=En.getSection(qr),nn=En.getSectionIndex(qr),ln=En.getCharCode(qr);let ni=0,wn=null,$l=null,Eo=null,Co=Zn;const Ui=!(tt===v.ah.horizontal||!pt&&!eo(ln)||pt&&(Ed[ln]||(Wn=ln,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Wn)))));if(qt.imageName){const Ei=_t[qt.imageName];if(!Ei)continue;Eo=qt.imageName,Ee.iconsInText=Ee.iconsInText||!0,$l=Ei.paddedRect;const er=Ei.displaySize;qt.scale=qt.scale*Zn/ct,wn={width:er[0],height:er[1],left:Zr,top:-D_,advance:Ui?er[1]:er[0]},ni=gr+(Zn-er[1]*qt.scale),Co=wn.advance;const Wo=Ui?er[0]*qt.scale-Zn*Xn:er[1]*qt.scale-Zn*Xn;Wo>0&&Wo>cr&&(cr=Wo)}else{const Ei=Ke[qt.fontStack],er=Ei&&Ei[ln];if(er&&er.rect)$l=er.rect,wn=er.metrics;else{const Wo=De[qt.fontStack],Mc=Wo&&Wo[ln];if(!Mc)continue;wn=Mc.metrics}ni=(Xn-qt.scale)*Zn}Ui?(Ee.verticalizable=!0,Mr.push({glyph:ln,imageName:Eo,x:St,y:Qt+ni,vertical:Ui,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:nn,metrics:wn,rect:$l}),St+=Co*qt.scale+Pe):(Mr.push({glyph:ln,imageName:Eo,x:St,y:Qt+ni,vertical:Ui,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:nn,metrics:wn,rect:$l}),St+=wn.advance*qt.scale+Pe)}Mr.length!==0&&(Yt=Math.max(St-Pe,Yt),h2(Mr,0,Mr.length-1,Vi,cr)),St=0;const Ti=He*Xn+cr;ur.lineOffset=Math.max(cr,gr),Qt+=Ti,Gn=Math.max(Ti,Gn),++lr}var Wn;const kr=Qt-Sc,{horizontalAlign:Ir,verticalAlign:Pr}=Kf(ht);(function(En,Xn,gr,ur,Mr,cr,Ti,qr,qt){const nn=(Xn-gr)*Mr;let ln=0;ln=cr!==Ti?-qr*ur-Sc:(-ur*qt+.5)*Ti;for(const ni of En)for(const wn of ni.positionedGlyphs)wn.x+=nn,wn.y+=ln})(Ee.positionedLines,Vi,Ir,Pr,Yt,Gn,He,kr,We.length),Ee.top+=-Pr*kr,Ee.bottom=Ee.top+kr,Ee.left+=-Ir*Yt,Ee.right=Ee.left+Yt}(fe,t,o,s,J,y,x,S,P,C,D,O),!function(Ee){for(const De of Ee)if(De.positionedGlyphs.length!==0)return!1;return!0}(le)&&fe}const Ed={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},l2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},u2={40:!0};function F_(r,t,o,s,d,f){if(t.imageName){const y=s[t.imageName];return y?y.displaySize[0]*t.scale*Zn/f+d:0}{const y=o[t.fontStack],x=y&&y[r];return x?x.metrics.advance*t.scale+d:0}}function B_(r,t,o,s){const d=Math.pow(r-t,2);return s?r<t?d/2:2*d:d+Math.abs(o)*o}function c2(r,t,o){let s=0;return r===10&&(s-=1e4),o&&(s+=150),r!==40&&r!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function O_(r,t,o,s,d,f){let y=null,x=B_(t,o,d,f);for(const S of s){const C=B_(t-S.x,o,d,f)+S.badness;C<=x&&(y=S,x=C)}return{index:r,x:t,priorBreak:y,badness:x}}function N_(r){return r?N_(r.priorBreak).concat(r.index):[]}function Xf(r,t,o,s,d,f){if(!r)return[];const y=[],x=function(P,D,F,O,U,J){let ne=0;for(let ye=0;ye<P.length();ye++){const le=P.getSection(ye);ne+=F_(P.getCharCode(ye),le,O,U,D,J)}return ne/Math.max(1,Math.ceil(ne/F))}(r,t,o,s,d,f),S=r.text.indexOf("​")>=0;let C=0;for(let P=0;P<r.length();P++){const D=r.getSection(P),F=r.getCharCode(P);if(Ed[F]||(C+=F_(F,D,s,d,t,f)),P<r.length()-1){const O=!((I=F)<11904)&&(!!Bt["CJK Compatibility Forms"](I)||!!Bt["CJK Compatibility"](I)||!!Bt["CJK Strokes"](I)||!!Bt["CJK Symbols and Punctuation"](I)||!!Bt["Enclosed CJK Letters and Months"](I)||!!Bt["Halfwidth and Fullwidth Forms"](I)||!!Bt["Ideographic Description Characters"](I)||!!Bt["Vertical Forms"](I)||ld.test(String.fromCodePoint(I)));(l2[F]||O||D.imageName||P!==r.length()-2&&u2[r.getCharCode(P+1)])&&y.push(O_(P+1,C,x,y,c2(F,r.getCharCode(P+1),O&&S),!1))}}var I;return N_(O_(r.length(),C,x,y,0,!0))}function Kf(r){let t=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function h2(r,t,o,s,d){if(!s&&!d)return;const f=r[o],y=(r[o].x+f.metrics.advance*f.scale)*s;for(let x=t;x<=o;x++)r[x].x-=y,r[x].y+=d}function d2(r,t,o){const{horizontalAlign:s,verticalAlign:d}=Kf(o),f=t[0]-r.displaySize[0]*s,y=t[1]-r.displaySize[1]*d;return{image:r,top:y,bottom:y+r.displaySize[1],left:f,right:f+r.displaySize[0]}}function j_(r){var t,o;let s=r.left,d=r.top,f=r.right-s,y=r.bottom-d;const x=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(o=r.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",C=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(S==="proportional"){if(x==="stretchOnly"&&f/y<C||x==="proportional"){const I=Math.ceil(y*C);s*=I/f,f=I}}else if(x==="proportional"&&S==="stretchOnly"&&C!==0&&f/y>C){const I=Math.ceil(f/C);d*=I/y,y=I}return{x1:s,y1:d,x2:s+f,y2:d+y}}function V_(r,t,o,s,d,f){const y=r.image;let x;if(y.content){const J=y.content,ne=y.pixelRatio||1;x=[J[0]/ne,J[1]/ne,y.displaySize[0]-J[2]/ne,y.displaySize[1]-J[3]/ne]}const S=t.left*f,C=t.right*f;let I,P,D,F;o==="width"||o==="both"?(F=d[0]+S-s[3],P=d[0]+C+s[1]):(F=d[0]+(S+C-y.displaySize[0])/2,P=F+y.displaySize[0]);const O=t.top*f,U=t.bottom*f;return o==="height"||o==="both"?(I=d[1]+O-s[0],D=d[1]+U+s[2]):(I=d[1]+(O+U-y.displaySize[1])/2,D=I+y.displaySize[1]),{image:y,top:I,right:P,bottom:D,left:F,collisionPadding:x}}const Ec=255,To=128,Ca=Ec*To;function U_(r,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Kt(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:d}=o;let f=0;for(;f<s.length&&s[f]<=r;)f++;f=Math.max(0,f-1);let y=f;for(;y<s.length&&s[y]<r+1;)y++;y=Math.min(s.length-1,y);const x=s[f],S=s[y];return o.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:S,minSize:o.evaluate(new Kt(x)),maxSize:o.evaluate(new Kt(S)),interpolationType:d}}}function Jf(r,t,o){let s="never";const d=r.get(t);return d?s=d:r.get(o)&&(s="always"),s}const p2=Ta.VectorTileFeature.types,f2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cd(r,t,o,s,d,f,y,x,S,C,I,P,D){const F=x?Math.min(Ca,Math.round(x[0])):0,O=x?Math.min(Ca,Math.round(x[1])):0;r.emplaceBack(t,o,Math.round(32*s),Math.round(32*d),f,y,(F<<1)+(S?1:0),O,16*C,16*I,256*P,256*D)}function Yf(r,t,o){r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o)}function m2(r){for(const t of r.sections)if(Tf(t.text))return!0;return!1}class Qf{constructor(t){this.layoutVertexArray=new mr,this.indexArray=new bo,this.programConfigurations=t,this.segments=new Qn,this.dynamicLayoutVertexArray=new ar,this.opacityVertexArray=new $r,this.hasVisibleVertices=!1,this.placedSymbolArray=new sn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,s,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qb.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Hb.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,f2,!0),this.opacityVertexBuffer.itemSize=1),(s||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}et("SymbolBuffers",Qf);class em{constructor(t,o,s){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new s,this.segments=new Qn,this.collisionVertexArray=new ba}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Gb.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}et("CollisionBuffers",em);class jl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Lf([]),this.placementViewportMatrix=Lf([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=U_(this.zoom,o["text-size"]),this.iconSizeData=U_(this.zoom,o["icon-size"]);const s=this.layers[0].layout,d=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=Jf(s,"text-overlap","text-allow-overlap")!=="never"||Jf(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(y=>v.ah[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new Qf(new Cs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Qf(new Cs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ir,this.lineVertexArray=new or,this.symbolInstances=new fr,this.textAnchorOffsets=new Zo}calculateGlyphDependencies(t,o,s,d,f){for(let y=0;y<t.length;y++)if(o[t.charCodeAt(y)]=!0,(s||d)&&f){const x=bc[t.charAt(y)];x&&(o[x.charCodeAt(0)]=!0)}}populate(t,o,s){const d=this.layers[0],f=d.layout,y=f.get("text-font"),x=f.get("text-field"),S=f.get("icon-image"),C=(x.value.kind!=="constant"||x.value.value instanceof On&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),I=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,P=f.get("symbol-sort-key");if(this.features=[],!C&&!I)return;const D=o.iconDependencies,F=o.glyphDependencies,O=o.availableImages,U=new Kt(this.zoom);for(const{feature:J,id:ne,index:ye,sourceLayerIndex:le}of t){const fe=d._featureFilter.needGeometry,Ee=Is(J,fe);if(!d._featureFilter.filter(U,Ee,s))continue;let De,Ke;if(fe||(Ee.geometry=ks(J)),C){const We=d.getValueAndResolveTokens("text-field",Ee,s,O),He=On.factory(We),ht=this.hasRTLText=this.hasRTLText||m2(He);(!ht||Ni.getRTLTextPluginStatus()==="unavailable"||ht&&Ni.isParsed())&&(De=Xb(He,d,Ee))}if(I){const We=d.getValueAndResolveTokens("icon-image",Ee,s,O);Ke=We instanceof In?We:In.fromString(We)}if(!De&&!Ke)continue;const _t=this.sortFeaturesByKey?P.evaluate(Ee,{},s):void 0;if(this.features.push({id:ne,text:De,icon:Ke,index:ye,sourceLayerIndex:le,geometry:Ee.geometry,properties:J.properties,type:p2[J.type],sortKey:_t}),Ke&&(D[Ke.name]=!0),De){const We=y.evaluate(Ee,{},s).join(","),He=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const ht of De.sections)if(ht.image)D[ht.image.name]=!0;else{const it=rc(De.toString()),tt=ht.fontStack||We,Pe=F[tt]=F[tt]||{};this.calculateGlyphDependencies(ht.text,Pe,He,this.allowVerticalPlacement,it)}}}f.get("symbol-placement")==="line"&&(this.features=function(J){const ne={},ye={},le=[];let fe=0;function Ee(We){le.push(J[We]),fe++}function De(We,He,ht){const it=ye[We];return delete ye[We],ye[He]=it,le[it].geometry[0].pop(),le[it].geometry[0]=le[it].geometry[0].concat(ht[0]),it}function Ke(We,He,ht){const it=ne[He];return delete ne[He],ne[We]=it,le[it].geometry[0].shift(),le[it].geometry[0]=ht[0].concat(le[it].geometry[0]),it}function _t(We,He,ht){const it=ht?He[0][He[0].length-1]:He[0][0];return`${We}:${it.x}:${it.y}`}for(let We=0;We<J.length;We++){const He=J[We],ht=He.geometry,it=He.text?He.text.toString():null;if(!it){Ee(We);continue}const tt=_t(it,ht),Pe=_t(it,ht,!0);if(tt in ye&&Pe in ne&&ye[tt]!==ne[Pe]){const pt=Ke(tt,Pe,ht),ct=De(tt,Pe,le[pt].geometry);delete ne[tt],delete ye[Pe],ye[_t(it,le[ct].geometry,!0)]=ct,le[pt].geometry=null}else tt in ye?De(tt,Pe,ht):Pe in ne?Ke(tt,Pe,ht):(Ee(We),ne[tt]=fe-1,ye[Pe]=fe-1)}return le.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,ne)=>J.sortKey-ne.sortKey)}update(t,o,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,s),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const s=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(o[t.segment+1]),f=t.dist(o[t.segment]);const y={};for(let x=t.segment+1;x<o.length;x++)y[x]={x:o[x].x,y:o[x].y,tileUnitDistanceFromAnchor:d},x<o.length-1&&(d+=o[x+1].dist(o[x]));for(let x=t.segment||0;x>=0;x--)y[x]={x:o[x].x,y:o[x].y,tileUnitDistanceFromAnchor:f},x>0&&(f+=o[x-1].dist(o[x]));for(let x=0;x<o.length;x++){const S=y[x];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,o,s,d,f,y,x,S,C,I,P,D){const F=t.indexArray,O=t.layoutVertexArray,U=t.segments.prepareSegment(4*o.length,O,F,this.canOverlap?y.sortKey:void 0),J=this.glyphOffsetArray.length,ne=U.vertexLength,ye=this.allowVerticalPlacement&&x===v.ah.vertical?Math.PI/2:0,le=y.text&&y.text.sections;for(let fe=0;fe<o.length;fe++){const{tl:Ee,tr:De,bl:Ke,br:_t,tex:We,pixelOffsetTL:He,pixelOffsetBR:ht,minFontScaleX:it,minFontScaleY:tt,glyphOffset:Pe,isSDF:pt,sectionIndex:ct}=o[fe],St=U.vertexLength,Qt=Pe[1];Cd(O,S.x,S.y,Ee.x,Qt+Ee.y,We.x,We.y,s,pt,He.x,He.y,it,tt),Cd(O,S.x,S.y,De.x,Qt+De.y,We.x+We.w,We.y,s,pt,ht.x,He.y,it,tt),Cd(O,S.x,S.y,Ke.x,Qt+Ke.y,We.x,We.y+We.h,s,pt,He.x,ht.y,it,tt),Cd(O,S.x,S.y,_t.x,Qt+_t.y,We.x+We.w,We.y+We.h,s,pt,ht.x,ht.y,it,tt),Yf(t.dynamicLayoutVertexArray,S,ye),F.emplaceBack(St,St+1,St+2),F.emplaceBack(St+1,St+2,St+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pe[0]),fe!==o.length-1&&ct===o[fe+1].sectionIndex||t.programConfigurations.populatePaintArrays(O.length,y,y.index,{},D,le&&le[ct])}t.placedSymbolArray.emplaceBack(S.x,S.y,J,this.glyphOffsetArray.length-J,ne,C,I,S.segment,s?s[0]:0,s?s[1]:0,d[0],d[1],x,0,!1,0,P)}_addCollisionDebugVertex(t,o,s,d,f,y){return o.emplaceBack(0,0),t.emplaceBack(s.x,s.y,d,f,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,o,s,d,f,y,x){const S=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),C=S.vertexLength,I=f.layoutVertexArray,P=f.collisionVertexArray,D=x.anchorX,F=x.anchorY;this._addCollisionDebugVertex(I,P,y,D,F,new j(t,o)),this._addCollisionDebugVertex(I,P,y,D,F,new j(s,o)),this._addCollisionDebugVertex(I,P,y,D,F,new j(s,d)),this._addCollisionDebugVertex(I,P,y,D,F,new j(t,d)),S.vertexLength+=4;const O=f.indexArray;O.emplaceBack(C,C+1),O.emplaceBack(C+1,C+2),O.emplaceBack(C+2,C+3),O.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(t,o,s,d){for(let f=t;f<o;f++){const y=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,d?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new em(xn,E_.members,bs),this.iconCollisionBox=new em(xn,E_.members,bs);for(let t=0;t<this.symbolInstances.length;t++){const o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,s,d,f,y,x,S,C){const I={};for(let P=o;P<s;P++){const D=t.get(P);I.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.textFeatureIndex=D.featureIndex;break}for(let P=d;P<f;P++){const D=t.get(P);I.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.verticalTextFeatureIndex=D.featureIndex;break}for(let P=y;P<x;P++){const D=t.get(P);I.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.iconFeatureIndex=D.featureIndex;break}for(let P=S;P<C;P++){const D=t.get(P);I.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.verticalIconFeatureIndex=D.featureIndex;break}return I}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const s=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){const s=t.placedSymbolArray.get(o),d=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<d;f+=4)t.indexArray.emplaceBack(f,f+1,f+2),t.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),s=Math.cos(t),d=[],f=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const S=this.symbolInstances.get(x);d.push(0|Math.round(o*S.anchorX+s*S.anchorY)),f.push(S.featureIndex)}return y.sort((x,S)=>d[x]-d[S]||f[S]-f[x]),y}addToSortKeyRanges(t,o){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===o?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const s=this.symbolInstances.get(o);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((d,f,y)=>{d>=0&&y.indexOf(d)===f&&this.addIndicesForPlacedSymbol(this.text,d)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let $_,Z_;et("SymbolBucket",jl,{omit:["layers","collisionBoxArray","features","compareText"]}),jl.MAX_GLYPHS=65535,jl.addDynamicAttributes=Yf;var tm={get paint(){return Z_=Z_||new b({"icon-opacity":new a(we.paint_symbol["icon-opacity"]),"icon-color":new a(we.paint_symbol["icon-color"]),"icon-halo-color":new a(we.paint_symbol["icon-halo-color"]),"icon-halo-width":new a(we.paint_symbol["icon-halo-width"]),"icon-halo-blur":new a(we.paint_symbol["icon-halo-blur"]),"icon-translate":new e(we.paint_symbol["icon-translate"]),"icon-translate-anchor":new e(we.paint_symbol["icon-translate-anchor"]),"text-opacity":new a(we.paint_symbol["text-opacity"]),"text-color":new a(we.paint_symbol["text-color"],{runtimeType:Yn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new a(we.paint_symbol["text-halo-color"]),"text-halo-width":new a(we.paint_symbol["text-halo-width"]),"text-halo-blur":new a(we.paint_symbol["text-halo-blur"]),"text-translate":new e(we.paint_symbol["text-translate"]),"text-translate-anchor":new e(we.paint_symbol["text-translate-anchor"])})},get layout(){return $_=$_||new b({"symbol-placement":new e(we.layout_symbol["symbol-placement"]),"symbol-spacing":new e(we.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new e(we.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new a(we.layout_symbol["symbol-sort-key"]),"symbol-z-order":new e(we.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new e(we.layout_symbol["icon-allow-overlap"]),"icon-overlap":new e(we.layout_symbol["icon-overlap"]),"icon-ignore-placement":new e(we.layout_symbol["icon-ignore-placement"]),"icon-optional":new e(we.layout_symbol["icon-optional"]),"icon-rotation-alignment":new e(we.layout_symbol["icon-rotation-alignment"]),"icon-size":new a(we.layout_symbol["icon-size"]),"icon-text-fit":new e(we.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new e(we.layout_symbol["icon-text-fit-padding"]),"icon-image":new a(we.layout_symbol["icon-image"]),"icon-rotate":new a(we.layout_symbol["icon-rotate"]),"icon-padding":new a(we.layout_symbol["icon-padding"]),"icon-keep-upright":new e(we.layout_symbol["icon-keep-upright"]),"icon-offset":new a(we.layout_symbol["icon-offset"]),"icon-anchor":new a(we.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new e(we.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new e(we.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new e(we.layout_symbol["text-rotation-alignment"]),"text-field":new a(we.layout_symbol["text-field"]),"text-font":new a(we.layout_symbol["text-font"]),"text-size":new a(we.layout_symbol["text-size"]),"text-max-width":new a(we.layout_symbol["text-max-width"]),"text-line-height":new e(we.layout_symbol["text-line-height"]),"text-letter-spacing":new a(we.layout_symbol["text-letter-spacing"]),"text-justify":new a(we.layout_symbol["text-justify"]),"text-radial-offset":new a(we.layout_symbol["text-radial-offset"]),"text-variable-anchor":new e(we.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new a(we.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new a(we.layout_symbol["text-anchor"]),"text-max-angle":new e(we.layout_symbol["text-max-angle"]),"text-writing-mode":new e(we.layout_symbol["text-writing-mode"]),"text-rotate":new a(we.layout_symbol["text-rotate"]),"text-padding":new e(we.layout_symbol["text-padding"]),"text-keep-upright":new e(we.layout_symbol["text-keep-upright"]),"text-transform":new a(we.layout_symbol["text-transform"]),"text-offset":new a(we.layout_symbol["text-offset"]),"text-allow-overlap":new e(we.layout_symbol["text-allow-overlap"]),"text-overlap":new e(we.layout_symbol["text-overlap"]),"text-ignore-placement":new e(we.layout_symbol["text-ignore-placement"]),"text-optional":new e(we.layout_symbol["text-optional"])})}};class q_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:pi,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}et("FormatSectionOverride",q_,{omit:["defaultValue"]});class kd extends E{constructor(t){super(t,tm)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const d=[];for(const f of s)d.indexOf(f)<0&&d.push(f);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,s,d){const f=this.layout.get(t).evaluate(o,{},s,d),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||ds(y.value)||!f?f:function(x,S){return S.replace(/{([^{}]+)}/g,(C,I)=>x&&I in x?String(x[I]):"")}(o.properties,f)}createBucket(t){return new jl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of tm.paint.overridableProperties){if(!kd.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),s=new q_(o),d=new hs(s,o.property.specification);let f=null;f=o.value.kind==="constant"||o.value.kind==="source"?new fa("source",d):new $u("composite",d,o.value.zoomStops),this.paint._values[t]=new ji(o.property,f,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,s){return!(!this.layout||o.isDataDriven()||s.isDataDriven())&&kd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const s=t.get("text-field"),d=tm.paint.properties[o];let f=!1;const y=x=>{for(const S of x)if(d.overrides&&d.overrides.hasOverride(S))return void(f=!0)};if(s.value.kind==="constant"&&s.value.value instanceof On)y(s.value.value.sections);else if(s.value.kind==="source"){const x=C=>{f||(C instanceof Pn&&yt(C.value)===Yr?y(C.value.sections):C instanceof al?y(C.sections):C.eachChild(x))},S=s.value;S._styleExpression&&x(S._styleExpression.expression)}return f}}let H_;var g2={get paint(){return H_=H_||new b({"background-color":new e(we.paint_background["background-color"]),"background-pattern":new h(we.paint_background["background-pattern"]),"background-opacity":new e(we.paint_background["background-opacity"])})}};class y2 extends E{constructor(t){super(t,g2)}}let G_;var _2={get paint(){return G_=G_||new b({"raster-opacity":new e(we.paint_raster["raster-opacity"]),"raster-hue-rotate":new e(we.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new e(we.paint_raster["raster-brightness-min"]),"raster-brightness-max":new e(we.paint_raster["raster-brightness-max"]),"raster-saturation":new e(we.paint_raster["raster-saturation"]),"raster-contrast":new e(we.paint_raster["raster-contrast"]),"raster-resampling":new e(we.paint_raster["raster-resampling"]),"raster-fade-duration":new e(we.paint_raster["raster-fade-duration"])})}};class v2 extends E{constructor(t){super(t,_2)}}class x2 extends E{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class w2{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const nm=63710088e-1;class ka{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ka(Xe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,s=this.lat*o,d=t.lat*o,f=Math.sin(s)*Math.sin(d)+Math.cos(s)*Math.cos(d)*Math.cos((t.lng-this.lng)*o);return nm*Math.acos(Math.min(f,1))}static convert(t){if(t instanceof ka)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ka(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ka(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const W_=2*Math.PI*nm;function X_(r){return W_*Math.cos(r*Math.PI/180)}function K_(r){return(180+r)/360}function J_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Y_(r,t){return r/X_(t)}function rm(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Cc{constructor(t,o,s=0){this.x=+t,this.y=+o,this.z=+s}static fromLngLat(t,o=0){const s=ka.convert(t);return new Cc(K_(s.lng),J_(s.lat),Y_(o,s.lat))}toLngLat(){return new ka(360*this.x-180,rm(this.y))}toAltitude(){return this.z*X_(rm(this.y))}meterInMercatorCoordinateUnits(){return 1/W_*(t=rm(this.y),1/Math.cos(t*Math.PI/180));var t}}function Q_(r,t,o){var s=2*Math.PI*6378137/256/Math.pow(2,o);return[r*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class im{constructor(t,o,s){if(!function(d,f,y){return!(d<0||d>25||y<0||y>=Math.pow(2,d)||f<0||f>=Math.pow(2,d))}(t,o,s))throw new Error(`x=${o}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=o,this.y=s,this.key=kc(0,t,t,o,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,s){const d=(y=this.y,x=this.z,S=Q_(256*(f=this.x),256*(y=Math.pow(2,x)-y-1),x),C=Q_(256*(f+1),256*(y+1),x),S[0]+","+S[1]+","+C[0]+","+C[1]);var f,y,x,S,C;const I=function(P,D,F){let O,U="";for(let J=P;J>0;J--)O=1<<J-1,U+=(D&O?1:0)+(F&O?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const o=this.z-t.z;return o>0&&t.x===this.x>>o&&t.y===this.y>>o}getTilePoint(t){const o=Math.pow(2,this.z);return new j((t.x*o-this.x)*jn,(t.y*o-this.y)*jn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ev{constructor(t,o){this.wrap=t,this.canonical=o,this.key=kc(t,o.z,o.z,o.x,o.y)}}class Si{constructor(t,o,s,d,f){if(t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=o,this.canonical=new im(s,+d,+f),this.key=kc(o,t,s,d,f)}clone(){return new Si(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?new Si(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Si(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?kc(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):kc(this.wrap*+o,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new Si(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,s=2*this.canonical.x,d=2*this.canonical.y;return[new Si(o,this.wrap,o,s,d),new Si(o,this.wrap,o,s+1,d),new Si(o,this.wrap,o,s,d+1),new Si(o,this.wrap,o,s+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Si(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Si(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ev(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Cc(t.x-this.wrap,t.y))}}function kc(r,t,o,s,d){(r*=2)<0&&(r=-1*r-1);const f=1<<o;return(f*f*r+f*d+s).toString(36)+o.toString(36)+t.toString(36)}et("CanonicalTileID",im),et("OverscaledTileID",Si,{omit:["posMatrix"]});class tv{constructor(t,o,s,d=1,f=1,y=1,x=0){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void Ot(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=f,this.blueFactor=y,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let I=0;I<S;I++){const P=this.get(C,I);P>this.max&&(this.max=P),P<this.min&&(this.min=P)}}get(t,o){const s=new Uint8Array(this.data.buffer),d=4*this._idx(t,o);return this.unpack(s[d],s[d+1],s[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}unpack(t,o,s){return t*this.redFactor+o*this.greenFactor+s*this.blueFactor-this.baseShift}getPixels(){return new bi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=o*this.dim,f=o*this.dim+this.dim,y=s*this.dim,x=s*this.dim+this.dim;switch(o){case-1:d=f-1;break;case 1:f=d+1}switch(s){case-1:y=x-1;break;case 1:x=y+1}const S=-o*this.dim,C=-s*this.dim;for(let I=y;I<x;I++)for(let P=d;P<f;P++)this.data[this._idx(P,I)]=t.data[this._idx(P+S,I+C)]}}et("DEMData",tv);class nv{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const s=t[o];this._stringToNumber[s]=o,this._numberToString[o]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class rv{constructor(t,o,s,d,f){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=s,t._y=d,this.properties=t.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class iv{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new xa(jn,16,0),this.grid3D=new xa(jn,16,0),this.featureIndexArray=new qo,this.promoteId=o}insert(t,o,s,d,f,y){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,d,f);const S=y?this.grid3D:this.grid;for(let C=0;C<o.length;C++){const I=o[C],P=[1/0,1/0,-1/0,-1/0];for(let D=0;D<I.length;D++){const F=I[D];P[0]=Math.min(P[0],F.x),P[1]=Math.min(P[1],F.y),P[2]=Math.max(P[2],F.x),P[3]=Math.max(P[3],F.y)}P[0]<jn&&P[1]<jn&&P[2]>=0&&P[3]>=0&&S.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ta.VectorTile(new Hf(this.rawTileData)).layers,this.sourceLayerCoder=new nv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,s,d){this.loadVTLayers();const f=t.params||{},y=jn/t.tileSize/t.scale,x=ma(f.filter),S=t.queryGeometry,C=t.queryPadding*y,I=av(S),P=this.grid.query(I.minX-C,I.minY-C,I.maxX+C,I.maxY+C),D=av(t.cameraQueryGeometry),F=this.grid3D.query(D.minX-C,D.minY-C,D.maxX+C,D.maxY+C,(J,ne,ye,le)=>function(fe,Ee,De,Ke,_t){for(const He of fe)if(Ee<=He.x&&De<=He.y&&Ke>=He.x&&_t>=He.y)return!0;const We=[new j(Ee,De),new j(Ee,_t),new j(Ke,_t),new j(Ke,De)];if(fe.length>2){for(const He of We)if(Dl(fe,He))return!0}for(let He=0;He<fe.length-1;He++)if(tb(fe[He],fe[He+1],We))return!0;return!1}(t.cameraQueryGeometry,J-C,ne-C,ye+C,le+C));for(const J of F)P.push(J);P.sort(b2);const O={};let U;for(let J=0;J<P.length;J++){const ne=P[J];if(ne===U)continue;U=ne;const ye=this.featureIndexArray.get(ne);let le=null;this.loadMatchingFeature(O,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,x,f.layers,f.availableImages,o,s,d,(fe,Ee,De)=>(le||(le=ks(fe)),Ee.queryIntersectsFeature(S,fe,De,le,this.z,t.transform,y,t.pixelPosMatrix)))}return O}loadMatchingFeature(t,o,s,d,f,y,x,S,C,I,P){const D=this.bucketLayerIDs[o];if(y&&!function(J,ne){for(let ye=0;ye<J.length;ye++)if(ne.indexOf(J[ye])>=0)return!0;return!1}(y,D))return;const F=this.sourceLayerCoder.decode(s),O=this.vtLayers[F].feature(d);if(f.needGeometry){const J=Is(O,!0);if(!f.filter(new Kt(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!f.filter(new Kt(this.tileID.overscaledZ),O))return;const U=this.getId(O,F);for(let J=0;J<D.length;J++){const ne=D[J];if(y&&y.indexOf(ne)<0)continue;const ye=S[ne];if(!ye)continue;let le={};U&&I&&(le=I.getState(ye.sourceLayer||"_geojsonTileLayer",U));const fe=Qe({},C[ne]);fe.paint=ov(fe.paint,ye.paint,O,le,x),fe.layout=ov(fe.layout,ye.layout,O,le,x);const Ee=!P||P(O,ye,le);if(!Ee)continue;const De=new rv(O,this.z,this.x,this.y,U);De.layer=fe;let Ke=t[ne];Ke===void 0&&(Ke=t[ne]=[]),Ke.push({featureIndex:d,feature:De,intersectionZ:Ee})}}lookupSymbolFeatures(t,o,s,d,f,y,x,S){const C={};this.loadVTLayers();const I=ma(f);for(const P of t)this.loadMatchingFeature(C,s,d,P,I,y,x,S,o);return C}hasLayer(t){for(const o of this.bucketLayerIDs)for(const s of o)if(t===s)return!0;return!1}getId(t,o){let s=t.id;return this.promoteId&&(s=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof s=="boolean"&&(s=Number(s))),s}}function ov(r,t,o,s,d){return dt(r,(f,y)=>{const x=t instanceof m?t.get(y):null;return x&&x.evaluate?x.evaluate(o,s,d):x})}function av(r){let t=1/0,o=1/0,s=-1/0,d=-1/0;for(const f of r)t=Math.min(t,f.x),o=Math.min(o,f.y),s=Math.max(s,f.x),d=Math.max(d,f.y);return{minX:t,minY:o,maxX:s,maxY:d}}function b2(r,t){return t-r}function sv(r,t,o,s,d){const f=[];for(let y=0;y<r.length;y++){const x=r[y];let S;for(let C=0;C<x.length-1;C++){let I=x[C],P=x[C+1];I.x<t&&P.x<t||(I.x<t?I=new j(t,I.y+(t-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x<t&&(P=new j(t,I.y+(t-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y<o&&P.y<o||(I.y<o?I=new j(I.x+(o-I.y)/(P.y-I.y)*(P.x-I.x),o)._round():P.y<o&&(P=new j(I.x+(o-I.y)/(P.y-I.y)*(P.x-I.x),o)._round()),I.x>=s&&P.x>=s||(I.x>=s?I=new j(s,I.y+(s-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x>=s&&(P=new j(s,I.y+(s-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y>=d&&P.y>=d||(I.y>=d?I=new j(I.x+(d-I.y)/(P.y-I.y)*(P.x-I.x),d)._round():P.y>=d&&(P=new j(I.x+(d-I.y)/(P.y-I.y)*(P.x-I.x),d)._round()),S&&I.equals(S[S.length-1])||(S=[I],f.push(S)),S.push(P)))))}}return f}et("FeatureIndex",iv,{omit:["rawTileData","sourceLayerCoder"]});class Ia extends j{constructor(t,o,s,d){super(t,o),this.angle=s,d!==void 0&&(this.segment=d)}clone(){return new Ia(this.x,this.y,this.angle,this.segment)}}function lv(r,t,o,s,d){if(t.segment===void 0||o===0)return!0;let f=t,y=t.segment+1,x=0;for(;x>-o/2;){if(y--,y<0)return!1;x-=r[y].dist(f),f=r[y]}x+=r[y].dist(r[y+1]),y++;const S=[];let C=0;for(;x<o/2;){const I=r[y],P=r[y+1];if(!P)return!1;let D=r[y-1].angleTo(I)-I.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:D}),C+=D;x-S[0].distance>s;)C-=S.shift().angleDelta;if(C>d)return!1;y++,x+=I.dist(P)}return!0}function uv(r){let t=0;for(let o=0;o<r.length-1;o++)t+=r[o].dist(r[o+1]);return t}function cv(r,t,o){return r?.6*t*o:0}function hv(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function S2(r,t,o,s,d,f){const y=cv(o,d,f),x=hv(o,s)*f;let S=0;const C=uv(r)/2;for(let I=0;I<r.length-1;I++){const P=r[I],D=r[I+1],F=P.dist(D);if(S+F>C){const O=(C-S)/F,U=Nr.number(P.x,D.x,O),J=Nr.number(P.y,D.y,O),ne=new Ia(U,J,D.angleTo(P),I);return ne._round(),!y||lv(r,ne,x,y,t)?ne:void 0}S+=F}}function T2(r,t,o,s,d,f,y,x,S){const C=cv(s,f,y),I=hv(s,d),P=I*y,D=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return t-P<t/4&&(t=P+t/4),dv(r,D?t/2*x%t:(I/2+2*f)*y*x%t,t,C,o,P,D,!1,S)}function dv(r,t,o,s,d,f,y,x,S){const C=f/2,I=uv(r);let P=0,D=t-o,F=[];for(let O=0;O<r.length-1;O++){const U=r[O],J=r[O+1],ne=U.dist(J),ye=J.angleTo(U);for(;D+o<P+ne;){D+=o;const le=(D-P)/ne,fe=Nr.number(U.x,J.x,le),Ee=Nr.number(U.y,J.y,le);if(fe>=0&&fe<S&&Ee>=0&&Ee<S&&D-C>=0&&D+C<=I){const De=new Ia(fe,Ee,ye,O);De._round(),s&&!lv(r,De,f,s,d)||F.push(De)}}P+=ne}return x||F.length||y||(F=dv(r,P/2,o,s,d,f,y,!0,S)),F}et("Anchor",Ia);const Vl=Zr;function pv(r,t,o,s){const d=[],f=r.image,y=f.pixelRatio,x=f.paddedRect.w-2*Vl,S=f.paddedRect.h-2*Vl;let C={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const I=f.stretchX||[[0,x]],P=f.stretchY||[[0,S]],D=(Pe,pt)=>Pe+pt[1]-pt[0],F=I.reduce(D,0),O=P.reduce(D,0),U=x-F,J=S-O;let ne=0,ye=F,le=0,fe=O,Ee=0,De=U,Ke=0,_t=J;if(f.content&&s){const Pe=f.content,pt=Pe[2]-Pe[0],ct=Pe[3]-Pe[1];(f.textFitWidth||f.textFitHeight)&&(C=j_(r)),ne=Id(I,0,Pe[0]),le=Id(P,0,Pe[1]),ye=Id(I,Pe[0],Pe[2]),fe=Id(P,Pe[1],Pe[3]),Ee=Pe[0]-ne,Ke=Pe[1]-le,De=pt-ye,_t=ct-fe}const We=C.x1,He=C.y1,ht=C.x2-We,it=C.y2-He,tt=(Pe,pt,ct,St)=>{const Qt=Pd(Pe.stretch-ne,ye,ht,We),Yt=Md(Pe.fixed-Ee,De,Pe.stretch,F),Gn=Pd(pt.stretch-le,fe,it,He),Vi=Md(pt.fixed-Ke,_t,pt.stretch,O),lr=Pd(ct.stretch-ne,ye,ht,We),Wn=Md(ct.fixed-Ee,De,ct.stretch,F),kr=Pd(St.stretch-le,fe,it,He),Ir=Md(St.fixed-Ke,_t,St.stretch,O),Pr=new j(Qt,Gn),En=new j(lr,Gn),Xn=new j(lr,kr),gr=new j(Qt,kr),ur=new j(Yt/y,Vi/y),Mr=new j(Wn/y,Ir/y),cr=t*Math.PI/180;if(cr){const qt=Math.sin(cr),nn=Math.cos(cr),ln=[nn,-qt,qt,nn];Pr._matMult(ln),En._matMult(ln),gr._matMult(ln),Xn._matMult(ln)}const Ti=Pe.stretch+Pe.fixed,qr=pt.stretch+pt.fixed;return{tl:Pr,tr:En,bl:gr,br:Xn,tex:{x:f.paddedRect.x+Vl+Ti,y:f.paddedRect.y+Vl+qr,w:ct.stretch+ct.fixed-Ti,h:St.stretch+St.fixed-qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ur,pixelOffsetBR:Mr,minFontScaleX:De/y/ht,minFontScaleY:_t/y/it,isSDF:o}};if(s&&(f.stretchX||f.stretchY)){const Pe=fv(I,U,F),pt=fv(P,J,O);for(let ct=0;ct<Pe.length-1;ct++){const St=Pe[ct],Qt=Pe[ct+1];for(let Yt=0;Yt<pt.length-1;Yt++)d.push(tt(St,pt[Yt],Qt,pt[Yt+1]))}}else d.push(tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return d}function Id(r,t,o){let s=0;for(const d of r)s+=Math.max(t,Math.min(o,d[1]))-Math.max(t,Math.min(o,d[0]));return s}function fv(r,t,o){const s=[{fixed:-Vl,stretch:0}];for(const[d,f]of r){const y=s[s.length-1];s.push({fixed:d-y.stretch,stretch:y.stretch}),s.push({fixed:d-y.stretch,stretch:y.stretch+(f-d)})}return s.push({fixed:t+Vl,stretch:o}),s}function Pd(r,t,o,s){return r/t*o+s}function Md(r,t,o,s){return r-t*o/s}class zd{constructor(t,o,s,d,f,y,x,S,C,I){var P;if(this.boxStartIndex=t.length,C){let D=y.top,F=y.bottom;const O=y.collisionPadding;O&&(D-=O[1],F+=O[3]);let U=F-D;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{const D=!((P=y.image)===null||P===void 0)&&P.content&&(y.image.textFitWidth||y.image.textFitHeight)?j_(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};D.y1=D.y1*x-S[0],D.y2=D.y2*x+S[2],D.x1=D.x1*x-S[3],D.x2=D.x2*x+S[1];const F=y.collisionPadding;if(F&&(D.x1-=F[0]*x,D.y1-=F[1]*x,D.x2+=F[2]*x,D.y2+=F[3]*x),I){const O=new j(D.x1,D.y1),U=new j(D.x2,D.y1),J=new j(D.x1,D.y2),ne=new j(D.x2,D.y2),ye=I*Math.PI/180;O._rotate(ye),U._rotate(ye),J._rotate(ye),ne._rotate(ye),D.x1=Math.min(O.x,U.x,J.x,ne.x),D.x2=Math.max(O.x,U.x,J.x,ne.x),D.y1=Math.min(O.y,U.y,J.y,ne.y),D.y2=Math.max(O.y,U.y,J.y,ne.y)}t.emplaceBack(o.x,o.y,D.x1,D.y1,D.x2,D.y2,s,d,f)}this.boxEndIndex=t.length}}class E2{constructor(t=[],o=(s,d)=>s<d?-1:s>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:s}=this,d=o[t];for(;t>0;){const f=t-1>>1,y=o[f];if(s(d,y)>=0)break;o[t]=y,t=f}o[t]=d}_down(t){const{data:o,compare:s}=this,d=this.length>>1,f=o[t];for(;t<d;){let y=1+(t<<1);const x=y+1;if(x<this.length&&s(o[x],o[y])<0&&(y=x),s(o[y],f)>=0)break;o[t]=o[y],t=y}o[t]=f}}function C2(r,t=1,o=!1){let s=1/0,d=1/0,f=-1/0,y=-1/0;const x=r[0];for(let F=0;F<x.length;F++){const O=x[F];(!F||O.x<s)&&(s=O.x),(!F||O.y<d)&&(d=O.y),(!F||O.x>f)&&(f=O.x),(!F||O.y>y)&&(y=O.y)}const S=Math.min(f-s,y-d);let C=S/2;const I=new E2([],k2);if(S===0)return new j(s,d);for(let F=s;F<f;F+=S)for(let O=d;O<y;O+=S)I.push(new Ul(F+C,O+C,C,r));let P=function(F){let O=0,U=0,J=0;const ne=F[0];for(let ye=0,le=ne.length,fe=le-1;ye<le;fe=ye++){const Ee=ne[ye],De=ne[fe],Ke=Ee.x*De.y-De.x*Ee.y;U+=(Ee.x+De.x)*Ke,J+=(Ee.y+De.y)*Ke,O+=3*Ke}return new Ul(U/O,J/O,0,F)}(r),D=I.length;for(;I.length;){const F=I.pop();(F.d>P.d||!P.d)&&(P=F,o&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,D)),F.max-P.d<=t||(C=F.h/2,I.push(new Ul(F.p.x-C,F.p.y-C,C,r)),I.push(new Ul(F.p.x+C,F.p.y-C,C,r)),I.push(new Ul(F.p.x-C,F.p.y+C,C,r)),I.push(new Ul(F.p.x+C,F.p.y+C,C,r)),D+=4)}return o&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function k2(r,t){return t.max-r.max}function Ul(r,t,o,s){this.p=new j(r,t),this.h=o,this.d=function(d,f){let y=!1,x=1/0;for(let S=0;S<f.length;S++){const C=f[S];for(let I=0,P=C.length,D=P-1;I<P;D=I++){const F=C[I],O=C[D];F.y>d.y!=O.y>d.y&&d.x<(O.x-F.x)*(d.y-F.y)/(O.y-F.y)+F.x&&(y=!y),x=Math.min(x,Jy(d,F,O))}}return(y?1:-1)*Math.sqrt(x)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}var sr;v.aq=void 0,(sr=v.aq||(v.aq={}))[sr.center=1]="center",sr[sr.left=2]="left",sr[sr.right=3]="right",sr[sr.top=4]="top",sr[sr.bottom=5]="bottom",sr[sr["top-left"]=6]="top-left",sr[sr["top-right"]=7]="top-right",sr[sr["bottom-left"]=8]="bottom-left",sr[sr["bottom-right"]=9]="bottom-right";const Pa=7,om=Number.POSITIVE_INFINITY;function mv(r,t){return t[1]!==om?function(o,s,d){let f=0,y=0;switch(s=Math.abs(s),d=Math.abs(d),o){case"top-right":case"top-left":case"top":y=d-Pa;break;case"bottom-right":case"bottom-left":case"bottom":y=-d+Pa}switch(o){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}return[f,y]}(r,t[0],t[1]):function(o,s){let d=0,f=0;s<0&&(s=0);const y=s/Math.SQRT2;switch(o){case"top-right":case"top-left":f=y-Pa;break;case"bottom-right":case"bottom-left":f=-y+Pa;break;case"bottom":f=-s+Pa;break;case"top":f=s-Pa}switch(o){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=s;break;case"right":d=-s}return[d,f]}(r,t[0])}function gv(r,t,o){var s;const d=r.layout,f=(s=d.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},o);if(f){const x=f.values,S=[];for(let C=0;C<x.length;C+=2){const I=S[C]=x[C],P=x[C+1].map(D=>D*Zn);I.startsWith("top")?P[1]-=Pa:I.startsWith("bottom")&&(P[1]+=Pa),S[C+1]=P}return new mn(S)}const y=d.get("text-variable-anchor");if(y){let x;x=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},o)*Zn,om]:d.get("text-offset").evaluate(t,{},o).map(C=>C*Zn);const S=[];for(const C of y)S.push(C,mv(C,x));return new mn(S)}return null}function am(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function I2(r,t,o,s,d,f,y,x,S,C,I){let P=f.textMaxSize.evaluate(t,{});P===void 0&&(P=y);const D=r.layers[0].layout,F=D.get("icon-offset").evaluate(t,{},I),O=_v(o.horizontal),U=y/24,J=r.tilePixelRatio*U,ne=r.tilePixelRatio*P/24,ye=r.tilePixelRatio*x,le=r.tilePixelRatio*D.get("symbol-spacing"),fe=D.get("text-padding")*r.tilePixelRatio,Ee=function(Pe,pt,ct,St=1){const Qt=Pe.get("icon-padding").evaluate(pt,{},ct),Yt=Qt&&Qt.values;return[Yt[0]*St,Yt[1]*St,Yt[2]*St,Yt[3]*St]}(D,t,I,r.tilePixelRatio),De=D.get("text-max-angle")/180*Math.PI,Ke=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point",_t=D.get("icon-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",We=D.get("symbol-placement"),He=le/2,ht=D.get("icon-text-fit");let it;s&&ht!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(it=V_(s,o.vertical,ht,D.get("icon-text-fit-padding"),F,U)),O&&(s=V_(s,O,ht,D.get("icon-text-fit-padding"),F,U)));const tt=(Pe,pt)=>{pt.x<0||pt.x>=jn||pt.y<0||pt.y>=jn||function(ct,St,Qt,Yt,Gn,Vi,lr,Wn,kr,Ir,Pr,En,Xn,gr,ur,Mr,cr,Ti,qr,qt,nn,ln,ni,wn,$l){const Eo=ct.addToLineVertexArray(St,Qt);let Co,Ui,Ei,er,Wo=0,Mc=0,bv=0,Sv=0,fm=-1,mm=-1;const Xo={};let Tv=kf("");if(ct.allowVerticalPlacement&&Yt.vertical){const yr=Wn.layout.get("text-rotate").evaluate(nn,{},wn)+90;Ei=new zd(kr,St,Ir,Pr,En,Yt.vertical,Xn,gr,ur,yr),lr&&(er=new zd(kr,St,Ir,Pr,En,lr,cr,Ti,ur,yr))}if(Gn){const yr=Wn.layout.get("icon-rotate").evaluate(nn,{}),Ci=Wn.layout.get("icon-text-fit")!=="none",Ms=pv(Gn,yr,ni,Ci),ro=lr?pv(lr,yr,ni,Ci):void 0;Ui=new zd(kr,St,Ir,Pr,En,Gn,cr,Ti,!1,yr),Wo=4*Ms.length;const zs=ct.iconSizeData;let ko=null;zs.kind==="source"?(ko=[To*Wn.layout.get("icon-size").evaluate(nn,{})],ko[0]>Ca&&Ot(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Ec}. Reduce your "icon-size".`)):zs.kind==="composite"&&(ko=[To*ln.compositeIconSizes[0].evaluate(nn,{},wn),To*ln.compositeIconSizes[1].evaluate(nn,{},wn)],(ko[0]>Ca||ko[1]>Ca)&&Ot(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Ec}. Reduce your "icon-size".`)),ct.addSymbols(ct.icon,Ms,ko,qt,qr,nn,v.ah.none,St,Eo.lineStartIndex,Eo.lineLength,-1,wn),fm=ct.icon.placedSymbolArray.length-1,ro&&(Mc=4*ro.length,ct.addSymbols(ct.icon,ro,ko,qt,qr,nn,v.ah.vertical,St,Eo.lineStartIndex,Eo.lineLength,-1,wn),mm=ct.icon.placedSymbolArray.length-1)}const Ev=Object.keys(Yt.horizontal);for(const yr of Ev){const Ci=Yt.horizontal[yr];if(!Co){Tv=kf(Ci.text);const ro=Wn.layout.get("text-rotate").evaluate(nn,{},wn);Co=new zd(kr,St,Ir,Pr,En,Ci,Xn,gr,ur,ro)}const Ms=Ci.positionedLines.length===1;if(bv+=yv(ct,St,Ci,Vi,Wn,ur,nn,Mr,Eo,Yt.vertical?v.ah.horizontal:v.ah.horizontalOnly,Ms?Ev:[yr],Xo,fm,ln,wn),Ms)break}Yt.vertical&&(Sv+=yv(ct,St,Yt.vertical,Vi,Wn,ur,nn,Mr,Eo,v.ah.vertical,["vertical"],Xo,mm,ln,wn));const z2=Co?Co.boxStartIndex:ct.collisionBoxArray.length,A2=Co?Co.boxEndIndex:ct.collisionBoxArray.length,D2=Ei?Ei.boxStartIndex:ct.collisionBoxArray.length,L2=Ei?Ei.boxEndIndex:ct.collisionBoxArray.length,R2=Ui?Ui.boxStartIndex:ct.collisionBoxArray.length,F2=Ui?Ui.boxEndIndex:ct.collisionBoxArray.length,B2=er?er.boxStartIndex:ct.collisionBoxArray.length,O2=er?er.boxEndIndex:ct.collisionBoxArray.length;let no=-1;const Dd=(yr,Ci)=>yr&&yr.circleDiameter?Math.max(yr.circleDiameter,Ci):Ci;no=Dd(Co,no),no=Dd(Ei,no),no=Dd(Ui,no),no=Dd(er,no);const Cv=no>-1?1:0;Cv&&(no*=$l/Zn),ct.glyphOffsetArray.length>=jl.MAX_GLYPHS&&Ot("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&ct.addToSortKeyRanges(ct.symbolInstances.length,nn.sortKey);const N2=gv(Wn,nn,wn),[j2,V2]=function(yr,Ci){const Ms=yr.length,ro=Ci==null?void 0:Ci.values;if((ro==null?void 0:ro.length)>0)for(let zs=0;zs<ro.length;zs+=2){const ko=ro[zs+1];yr.emplaceBack(v.aq[ro[zs]],ko[0],ko[1])}return[Ms,yr.length]}(ct.textAnchorOffsets,N2);ct.symbolInstances.emplaceBack(St.x,St.y,Xo.right>=0?Xo.right:-1,Xo.center>=0?Xo.center:-1,Xo.left>=0?Xo.left:-1,Xo.vertical||-1,fm,mm,Tv,z2,A2,D2,L2,R2,F2,B2,O2,Ir,bv,Sv,Wo,Mc,Cv,0,Xn,no,j2,V2)}(r,pt,Pe,o,s,d,it,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,J,[fe,fe,fe,fe],Ke,S,ye,Ee,_t,F,t,f,C,I,y)};if(We==="line")for(const Pe of sv(t.geometry,0,0,jn,jn)){const pt=T2(Pe,le,De,o.vertical||O,s,24,ne,r.overscaling,jn);for(const ct of pt)O&&P2(r,O.text,He,ct)||tt(Pe,ct)}else if(We==="line-center"){for(const Pe of t.geometry)if(Pe.length>1){const pt=S2(Pe,De,o.vertical||O,s,24,ne);pt&&tt(Pe,pt)}}else if(t.type==="Polygon")for(const Pe of ll(t.geometry,0)){const pt=C2(Pe,16);tt(Pe[0],new Ia(pt.x,pt.y,0))}else if(t.type==="LineString")for(const Pe of t.geometry)tt(Pe,new Ia(Pe[0].x,Pe[0].y,0));else if(t.type==="Point")for(const Pe of t.geometry)for(const pt of Pe)tt([pt],new Ia(pt.x,pt.y,0))}function yv(r,t,o,s,d,f,y,x,S,C,I,P,D,F,O){const U=function(ye,le,fe,Ee,De,Ke,_t,We){const He=Ee.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,ht=[];for(const it of le.positionedLines)for(const tt of it.positionedGlyphs){if(!tt.rect)continue;const Pe=tt.rect||{};let pt=D_+1,ct=!0,St=1,Qt=0;const Yt=(De||We)&&tt.vertical,Gn=tt.metrics.advance*tt.scale/2;if(We&&le.verticalizable&&(Qt=it.lineOffset/2-(tt.imageName?-(Zn-tt.metrics.width*tt.scale)/2:(tt.scale-1)*Zn)),tt.imageName){const qt=_t[tt.imageName];ct=qt.sdf,St=qt.pixelRatio,pt=Zr/St}const Vi=De?[tt.x+Gn,tt.y]:[0,0];let lr=De?[0,0]:[tt.x+Gn+fe[0],tt.y+fe[1]-Qt],Wn=[0,0];Yt&&(Wn=lr,lr=[0,0]);const kr=tt.metrics.isDoubleResolution?2:1,Ir=(tt.metrics.left-pt)*tt.scale-Gn+lr[0],Pr=(-tt.metrics.top-pt)*tt.scale+lr[1],En=Ir+Pe.w/kr*tt.scale/St,Xn=Pr+Pe.h/kr*tt.scale/St,gr=new j(Ir,Pr),ur=new j(En,Pr),Mr=new j(Ir,Xn),cr=new j(En,Xn);if(Yt){const qt=new j(-Gn,Gn-Sc),nn=-Math.PI/2,ln=Zn/2-Gn,ni=new j(5-Sc-ln,-(tt.imageName?ln:0)),wn=new j(...Wn);gr._rotateAround(nn,qt)._add(ni)._add(wn),ur._rotateAround(nn,qt)._add(ni)._add(wn),Mr._rotateAround(nn,qt)._add(ni)._add(wn),cr._rotateAround(nn,qt)._add(ni)._add(wn)}if(He){const qt=Math.sin(He),nn=Math.cos(He),ln=[nn,-qt,qt,nn];gr._matMult(ln),ur._matMult(ln),Mr._matMult(ln),cr._matMult(ln)}const Ti=new j(0,0),qr=new j(0,0);ht.push({tl:gr,tr:ur,bl:Mr,br:cr,tex:Pe,writingMode:le.writingMode,glyphOffset:Vi,sectionIndex:tt.sectionIndex,isSDF:ct,pixelOffsetTL:Ti,pixelOffsetBR:qr,minFontScaleX:0,minFontScaleY:0})}return ht}(0,o,x,d,f,y,s,r.allowVerticalPlacement),J=r.textSizeData;let ne=null;J.kind==="source"?(ne=[To*d.layout.get("text-size").evaluate(y,{})],ne[0]>Ca&&Ot(`${r.layerIds[0]}: Value for "text-size" is >= ${Ec}. Reduce your "text-size".`)):J.kind==="composite"&&(ne=[To*F.compositeTextSizes[0].evaluate(y,{},O),To*F.compositeTextSizes[1].evaluate(y,{},O)],(ne[0]>Ca||ne[1]>Ca)&&Ot(`${r.layerIds[0]}: Value for "text-size" is >= ${Ec}. Reduce your "text-size".`)),r.addSymbols(r.text,U,ne,x,f,y,C,t,S.lineStartIndex,S.lineLength,D,O);for(const ye of I)P[ye]=r.text.placedSymbolArray.length-1;return 4*U.length}function _v(r){for(const t in r)return r[t];return null}function P2(r,t,o,s){const d=r.compareText;if(t in d){const f=d[t];for(let y=f.length-1;y>=0;y--)if(s.dist(f[y])<o)return!0}else d[t]=[];return d[t].push(s),!1}const vv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class sm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,s]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=s>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const f=vv[15&s];if(!f)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new sm(x,y,f,t)}constructor(t,o=64,s=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const f=vv.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-x%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+x+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=o,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return lm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,s,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:x}=this,S=[0,f.length-1,0],C=[];for(;S.length;){const I=S.pop()||0,P=S.pop()||0,D=S.pop()||0;if(P-D<=x){for(let J=D;J<=P;J++){const ne=y[2*J],ye=y[2*J+1];ne>=t&&ne<=s&&ye>=o&&ye<=d&&C.push(f[J])}continue}const F=D+P>>1,O=y[2*F],U=y[2*F+1];O>=t&&O<=s&&U>=o&&U<=d&&C.push(f[F]),(I===0?t<=O:o<=U)&&(S.push(D),S.push(F-1),S.push(1-I)),(I===0?s>=O:d>=U)&&(S.push(F+1),S.push(P),S.push(1-I))}return C}within(t,o,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:f,nodeSize:y}=this,x=[0,d.length-1,0],S=[],C=s*s;for(;x.length;){const I=x.pop()||0,P=x.pop()||0,D=x.pop()||0;if(P-D<=y){for(let J=D;J<=P;J++)wv(f[2*J],f[2*J+1],t,o)<=C&&S.push(d[J]);continue}const F=D+P>>1,O=f[2*F],U=f[2*F+1];wv(O,U,t,o)<=C&&S.push(d[F]),(I===0?t-s<=O:o-s<=U)&&(x.push(D),x.push(F-1),x.push(1-I)),(I===0?t+s>=O:o+s>=U)&&(x.push(F+1),x.push(P),x.push(1-I))}return S}}function lm(r,t,o,s,d,f){if(d-s<=o)return;const y=s+d>>1;xv(r,t,y,s,d,f),lm(r,t,o,s,y-1,1-f),lm(r,t,o,y+1,d,1-f)}function xv(r,t,o,s,d,f){for(;d>s;){if(d-s>600){const C=d-s+1,I=o-s+1,P=Math.log(C),D=.5*Math.exp(2*P/3),F=.5*Math.sqrt(P*D*(C-D)/C)*(I-C/2<0?-1:1);xv(r,t,o,Math.max(s,Math.floor(o-I*D/C+F)),Math.min(d,Math.floor(o+(C-I)*D/C+F)),f)}const y=t[2*o+f];let x=s,S=d;for(Ic(r,t,s,o),t[2*d+f]>y&&Ic(r,t,s,d);x<S;){for(Ic(r,t,x,S),x++,S--;t[2*x+f]<y;)x++;for(;t[2*S+f]>y;)S--}t[2*s+f]===y?Ic(r,t,s,S):(S++,Ic(r,t,S,d)),S<=o&&(s=S+1),o<=S&&(d=S-1)}}function Ic(r,t,o,s){um(r,o,s),um(t,2*o,2*s),um(t,2*o+1,2*s+1)}function um(r,t,o){const s=r[t];r[t]=r[o],r[o]=s}function wv(r,t,o,s){const d=r-o,f=t-s;return d*d+f*f}var cm;v.bf=void 0,(cm=v.bf||(v.bf={})).create="create",cm.load="load",cm.fullLoad="fullLoad";let Ad=null,Pc=[];const hm=1e3/60,dm="loadTime",pm="fullLoadTime",M2={mark(r){performance.mark(r)},frame(r){const t=r;Ad!=null&&Pc.push(t-Ad),Ad=t},clearMetrics(){Ad=null,Pc=[],performance.clearMeasures(dm),performance.clearMeasures(pm);for(const r in v.bf)performance.clearMarks(v.bf[r])},getPerformanceMetrics(){performance.measure(dm,v.bf.create,v.bf.load),performance.measure(pm,v.bf.create,v.bf.fullLoad);const r=performance.getEntriesByName(dm)[0].duration,t=performance.getEntriesByName(pm)[0].duration,o=Pc.length,s=1/(Pc.reduce((f,y)=>f+y,0)/o/1e3),d=Pc.filter(f=>f>hm).reduce((f,y)=>f+(y-hm)/hm,0);return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:d/(o+d)*100,totalFrames:o}}};v.$=class extends G{},v.A=Ll,v.B=xf,v.C=function(r){if(Hn==null){const t=r.navigator?r.navigator.userAgent:null;Hn=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Hn},v.D=e,v.E=Rr,v.F=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new w2(()=>this.process()),this.subscription=function(o,s,d,f){return o.addEventListener(s,d,!1),{unsubscribe:()=>{o.removeEventListener(s,d,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=Rn(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((o,s)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[d]={resolve:o,reject:s},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[d];const x={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(x)},{once:!0});const f=[],y=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:vs(r.data,f)});this.target.postMessage(y,{transfer:f})})}receive(r){const t=r.data,o=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[o];const s=this.abortControllers[o];return delete this.abortControllers[o],void(s&&s.abort())}if(Rn(self)||t.mustQueue)return this.tasks[o]=t,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(t.error?d.reject(xs(t.error)):d.resolve(xs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=xs(t.data),s=new AbortController;this.abortControllers[r]=s;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,o,s);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}})}completeTask(r,t,o){const s=[];delete this.abortControllers[r];const d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?vs(t):null,data:vs(o,s)};this.target.postMessage(d,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.G=dn,v.H=function(){var r=new Ll(16);return Ll!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},v.I=Wf,v.J=function(r,t,o){var s,d,f,y,x,S,C,I,P,D,F,O,U=o[0],J=o[1],ne=o[2];return t===r?(r[12]=t[0]*U+t[4]*J+t[8]*ne+t[12],r[13]=t[1]*U+t[5]*J+t[9]*ne+t[13],r[14]=t[2]*U+t[6]*J+t[10]*ne+t[14],r[15]=t[3]*U+t[7]*J+t[11]*ne+t[15]):(d=t[1],f=t[2],y=t[3],x=t[4],S=t[5],C=t[6],I=t[7],P=t[8],D=t[9],F=t[10],O=t[11],r[0]=s=t[0],r[1]=d,r[2]=f,r[3]=y,r[4]=x,r[5]=S,r[6]=C,r[7]=I,r[8]=P,r[9]=D,r[10]=F,r[11]=O,r[12]=s*U+x*J+P*ne+t[12],r[13]=d*U+S*J+D*ne+t[13],r[14]=f*U+C*J+F*ne+t[14],r[15]=y*U+I*J+O*ne+t[15]),r},v.K=function(r,t,o){var s=o[0],d=o[1],f=o[2];return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=t[3]*s,r[4]=t[4]*d,r[5]=t[5]*d,r[6]=t[6]*d,r[7]=t[7]*d,r[8]=t[8]*f,r[9]=t[9]*f,r[10]=t[10]*f,r[11]=t[11]*f,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},v.L=t_,v.M=function(r,t){const o={};for(let s=0;s<t.length;s++){const d=t[s];d in r&&(o[d]=r[d])}return o},v.N=ka,v.O=K_,v.P=j,v.Q=J_,v.R=bi,v.S=Si,v.T=wa,v.U=oe,v.V=re,v.W=ut,v.X=jn,v.Y=B,v.Z=Cc,v._=c,v.a=yn,v.a$=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},v.a0=Qn,v.a1=im,v.a2=Ne,v.a3=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(o=>{t.onloadstart=()=>{o(t)};for(const s of r){const d=window.document.createElement("source");li(s)||(t.crossOrigin="Anonymous"),d.src=s,t.appendChild(d)}})},v.a4=function(){return pe++},v.a5=rr,v.a6=jl,v.a7=ma,v.a8=Is,v.a9=rv,v.aA=function(r){if(r.type==="custom")return new x2(r);switch(r.type){case"background":return new y2(r);case"circle":return new ib(r);case"fill":return new wb(r);case"fill-extrusion":return new Fb(r);case"heatmap":return new ab(r);case"hillshade":return new lb(r);case"line":return new Zb(r);case"raster":return new v2(r);case"symbol":return new kd(r)}},v.aB=ot,v.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let o=[];try{if(!$t(r.version,t.version))return[{command:"setStyle",args:[t]}];$t(r.center,t.center)||o.push({command:"setCenter",args:[t.center]}),$t(r.zoom,t.zoom)||o.push({command:"setZoom",args:[t.zoom]}),$t(r.bearing,t.bearing)||o.push({command:"setBearing",args:[t.bearing]}),$t(r.pitch,t.pitch)||o.push({command:"setPitch",args:[t.pitch]}),$t(r.sprite,t.sprite)||o.push({command:"setSprite",args:[t.sprite]}),$t(r.glyphs,t.glyphs)||o.push({command:"setGlyphs",args:[t.glyphs]}),$t(r.transition,t.transition)||o.push({command:"setTransition",args:[t.transition]}),$t(r.light,t.light)||o.push({command:"setLight",args:[t.light]}),$t(r.terrain,t.terrain)||o.push({command:"setTerrain",args:[t.terrain]}),$t(r.sky,t.sky)||o.push({command:"setSky",args:[t.sky]}),$t(r.projection,t.projection)||o.push({command:"setProjection",args:[t.projection]});const s={},d=[];(function(y,x,S,C){let I;for(I in x=x||{},y=y||{})Object.prototype.hasOwnProperty.call(y,I)&&(Object.prototype.hasOwnProperty.call(x,I)||Ri(I,S,C));for(I in x)Object.prototype.hasOwnProperty.call(x,I)&&(Object.prototype.hasOwnProperty.call(y,I)?$t(y[I],x[I])||(y[I].type==="geojson"&&x[I].type==="geojson"&&fo(y,x,I)?cn(S,{command:"setGeoJSONSourceData",args:[I,x[I].data]}):ci(I,x,S,C)):po(I,x,S))})(r.sources,t.sources,d,s);const f=[];r.layers&&r.layers.forEach(y=>{"source"in y&&s[y.source]?o.push({command:"removeLayer",args:[y.id]}):f.push(y)}),o=o.concat(d),function(y,x,S){x=x||[];const C=(y=y||[]).map(hi),I=x.map(hi),P=y.reduce(di,{}),D=x.reduce(di,{}),F=C.slice(),O=Object.create(null);let U,J,ne,ye,le;for(let fe=0,Ee=0;fe<C.length;fe++)U=C[fe],Object.prototype.hasOwnProperty.call(D,U)?Ee++:(cn(S,{command:"removeLayer",args:[U]}),F.splice(F.indexOf(U,Ee),1));for(let fe=0,Ee=0;fe<I.length;fe++)U=I[I.length-1-fe],F[F.length-1-fe]!==U&&(Object.prototype.hasOwnProperty.call(P,U)?(cn(S,{command:"removeLayer",args:[U]}),F.splice(F.lastIndexOf(U,F.length-Ee),1)):Ee++,ye=F[F.length-fe],cn(S,{command:"addLayer",args:[D[U],ye]}),F.splice(F.length-fe,0,U),O[U]=!0);for(let fe=0;fe<I.length;fe++)if(U=I[fe],J=P[U],ne=D[U],!O[U]&&!$t(J,ne))if($t(J.source,ne.source)&&$t(J["source-layer"],ne["source-layer"])&&$t(J.type,ne.type)){for(le in wr(J.layout,ne.layout,S,U,null,"setLayoutProperty"),wr(J.paint,ne.paint,S,U,null,"setPaintProperty"),$t(J.filter,ne.filter)||cn(S,{command:"setFilter",args:[U,ne.filter]}),$t(J.minzoom,ne.minzoom)&&$t(J.maxzoom,ne.maxzoom)||cn(S,{command:"setLayerZoomRange",args:[U,ne.minzoom,ne.maxzoom]}),J)Object.prototype.hasOwnProperty.call(J,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?wr(J[le],ne[le],S,U,le.slice(6),"setPaintProperty"):$t(J[le],ne[le])||cn(S,{command:"setLayerProperty",args:[U,le,ne[le]]}));for(le in ne)Object.prototype.hasOwnProperty.call(ne,le)&&!Object.prototype.hasOwnProperty.call(J,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?wr(J[le],ne[le],S,U,le.slice(6),"setPaintProperty"):$t(J[le],ne[le])||cn(S,{command:"setLayerProperty",args:[U,le,ne[le]]}))}else cn(S,{command:"removeLayer",args:[U]}),ye=F[F.lastIndexOf(U)+1],cn(S,{command:"addLayer",args:[ne,ye]})}(f,t.layers,o)}catch(s){console.warn("Unable to compute style diff:",s),o=[{command:"setStyle",args:[t]}]}return o},v.aD=function(r){const t=[],o=r.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},v.aE=function r(t,o){if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(let s=0;s<t.length;s++)if(!r(t[s],o[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&o!==null){if(typeof o!="object"||Object.keys(t).length!==Object.keys(o).length)return!1;for(const s in t)if(!r(t[s],o[s]))return!1;return!0}return t===o},v.aF=dt,v.aG=lt,v.aH=class extends Es{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},v.aI=fd,v.aJ=class extends Es{constructor(r,t){super(r,t),this.current=Kw}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},v.aK=Zy,v.aL=qy,v.aM=Et,v.aN=class extends Es{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},v.aO=class extends Es{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},v.aP=function(r,t,o,s,d,f,y){var x=1/(t-o),S=1/(s-d),C=1/(f-y);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*C,r[11]=0,r[12]=(t+o)*x,r[13]=(d+s)*S,r[14]=(y+f)*C,r[15]=1,r},v.aQ=rb,v.aR=class extends Ye{},v.aS=Wb,v.aT=class extends je{},v.aU=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},v.aV=a_,v.aW=xo,v.aX=bo,v.aY=class extends zt{},v.aZ=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},v.a_=function(r,t){var o=r[0],s=r[1],d=r[2],f=r[3],y=r[4],x=r[5],S=r[6],C=r[7],I=r[8],P=r[9],D=r[10],F=r[11],O=r[12],U=r[13],J=r[14],ne=r[15],ye=t[0],le=t[1],fe=t[2],Ee=t[3],De=t[4],Ke=t[5],_t=t[6],We=t[7],He=t[8],ht=t[9],it=t[10],tt=t[11],Pe=t[12],pt=t[13],ct=t[14],St=t[15];return Math.abs(o-ye)<=Cr*Math.max(1,Math.abs(o),Math.abs(ye))&&Math.abs(s-le)<=Cr*Math.max(1,Math.abs(s),Math.abs(le))&&Math.abs(d-fe)<=Cr*Math.max(1,Math.abs(d),Math.abs(fe))&&Math.abs(f-Ee)<=Cr*Math.max(1,Math.abs(f),Math.abs(Ee))&&Math.abs(y-De)<=Cr*Math.max(1,Math.abs(y),Math.abs(De))&&Math.abs(x-Ke)<=Cr*Math.max(1,Math.abs(x),Math.abs(Ke))&&Math.abs(S-_t)<=Cr*Math.max(1,Math.abs(S),Math.abs(_t))&&Math.abs(C-We)<=Cr*Math.max(1,Math.abs(C),Math.abs(We))&&Math.abs(I-He)<=Cr*Math.max(1,Math.abs(I),Math.abs(He))&&Math.abs(P-ht)<=Cr*Math.max(1,Math.abs(P),Math.abs(ht))&&Math.abs(D-it)<=Cr*Math.max(1,Math.abs(D),Math.abs(it))&&Math.abs(F-tt)<=Cr*Math.max(1,Math.abs(F),Math.abs(tt))&&Math.abs(O-Pe)<=Cr*Math.max(1,Math.abs(O),Math.abs(Pe))&&Math.abs(U-pt)<=Cr*Math.max(1,Math.abs(U),Math.abs(pt))&&Math.abs(J-ct)<=Cr*Math.max(1,Math.abs(J),Math.abs(ct))&&Math.abs(ne-St)<=Cr*Math.max(1,Math.abs(ne),Math.abs(St))},v.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,s,d,f)=>{const y=d||f;return t[s]=!y||y.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t},v.ab=function(r,t){const o=[];for(const s in r)s in t||o.push(s);return o},v.ac=Le,v.ad=function(r,t,o){var s=Math.sin(o),d=Math.cos(o),f=t[0],y=t[1],x=t[2],S=t[3],C=t[4],I=t[5],P=t[6],D=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=f*d+C*s,r[1]=y*d+I*s,r[2]=x*d+P*s,r[3]=S*d+D*s,r[4]=C*d-f*s,r[5]=I*d-y*s,r[6]=P*d-x*s,r[7]=D*d-S*s,r},v.ae=function(r){var t=new Ll(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},v.af=_d,v.ag=function(r,t){let o=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:f,maxZoom:y}=r,x=d?Le(jr.interpolationFactor(d,t,f,y),0,1):0;r.kind==="camera"?s=Nr.number(r.minSize,r.maxSize,x):o=x}return{uSizeT:o,uSize:s}},v.ai=function(r,{uSize:t,uSizeT:o},{lowerSize:s,upperSize:d}){return r.kind==="source"?s/To:r.kind==="composite"?Nr.number(s/To,d/To,o):t},v.aj=Yf,v.ak=function(r,t,o,s){const d=t.y-r.y,f=t.x-r.x,y=s.y-o.y,x=s.x-o.x,S=y*f-x*d;if(S===0)return null;const C=(x*(r.y-o.y)-y*(r.x-o.x))/S;return new j(r.x+C*f,r.y+C*d)},v.al=sv,v.am=Xy,v.an=Lf,v.ao=function(r){let t=1/0,o=1/0,s=-1/0,d=-1/0;for(const f of r)t=Math.min(t,f.x),o=Math.min(o,f.y),s=Math.max(s,f.x),d=Math.max(d,f.y);return[t,o,s,d]},v.ap=Zn,v.ar=Jf,v.as=function(r,t){var o=t[0],s=t[1],d=t[2],f=t[3],y=t[4],x=t[5],S=t[6],C=t[7],I=t[8],P=t[9],D=t[10],F=t[11],O=t[12],U=t[13],J=t[14],ne=t[15],ye=o*x-s*y,le=o*S-d*y,fe=o*C-f*y,Ee=s*S-d*x,De=s*C-f*x,Ke=d*C-f*S,_t=I*U-P*O,We=I*J-D*O,He=I*ne-F*O,ht=P*J-D*U,it=P*ne-F*U,tt=D*ne-F*J,Pe=ye*tt-le*it+fe*ht+Ee*He-De*We+Ke*_t;return Pe?(r[0]=(x*tt-S*it+C*ht)*(Pe=1/Pe),r[1]=(d*it-s*tt-f*ht)*Pe,r[2]=(U*Ke-J*De+ne*Ee)*Pe,r[3]=(D*De-P*Ke-F*Ee)*Pe,r[4]=(S*He-y*tt-C*We)*Pe,r[5]=(o*tt-d*He+f*We)*Pe,r[6]=(J*fe-O*Ke-ne*le)*Pe,r[7]=(I*Ke-D*fe+F*le)*Pe,r[8]=(y*it-x*He+C*_t)*Pe,r[9]=(s*He-o*it-f*_t)*Pe,r[10]=(O*De-U*fe+ne*ye)*Pe,r[11]=(P*fe-I*De-F*ye)*Pe,r[12]=(x*We-y*ht-S*_t)*Pe,r[13]=(o*ht-s*We+d*_t)*Pe,r[14]=(U*le-O*Ee-J*ye)*Pe,r[15]=(I*Ee-P*le+D*ye)*Pe,r):null},v.at=am,v.au=Kf,v.av=sm,v.aw=function(){const r={},t=we.$version;for(const o in we.$root){const s=we.$root[o];if(s.required){let d=null;d=o==="version"?t:s.type==="array"?[]:{},d!=null&&(r[o]=d)}}return r},v.ax=$o,v.ay=$n,v.az=function(r){r=r.slice();const t=Object.create(null);for(let o=0;o<r.length;o++)t[r[o].id]=r[o];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=Fr(r[o],t[r[o].ref]));return r},v.b=Un,v.b0=function(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r[3]=t[3]*o[3],r},v.b1=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},v.b2=Xe,v.b3=ev,v.b4=Y_,v.b5=function(r,t,o,s,d){var f,y=1/Math.tan(t/2);return r[0]=y/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+s)*(f=1/(s-d)),r[14]=2*d*s*f):(r[10]=-1,r[14]=-2*s),r},v.b6=function(r,t,o){var s=Math.sin(o),d=Math.cos(o),f=t[4],y=t[5],x=t[6],S=t[7],C=t[8],I=t[9],P=t[10],D=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=f*d+C*s,r[5]=y*d+I*s,r[6]=x*d+P*s,r[7]=S*d+D*s,r[8]=C*d-f*s,r[9]=I*d-y*s,r[10]=P*d-x*s,r[11]=D*d-S*s,r},v.b7=ue,v.b8=Ce,v.b9=function(r){return r*Math.PI/180},v.bA=function(r){return r.message===Nt},v.bB=ps,v.bC=Ni,v.ba=function(r,t){const{x:o,y:s}=Cc.fromLngLat(t);return!(r<0||r>25||s<0||s>=1||o<0||o>=1)},v.bb=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},v.bc=class extends Y{},v.bd=nm,v.be=M2,v.bg=on,v.bh=function(r,t){yn.REGISTERED_PROTOCOLS[r]=t},v.bi=function(r){delete yn.REGISTERED_PROTOCOLS[r]},v.bj=function(r,t){const o={};for(let d=0;d<r.length;d++){const f=t&&t[r[d].id]||vf(r[d]);t&&(t[r[d].id]=f);let y=o[f];y||(y=o[f]=[]),y.push(r[d])}const s=[];for(const d in o)s.push(o[d]);return s},v.bk=et,v.bl=nv,v.bm=iv,v.bn=R_,v.bo=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=jn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],o=t.layout,s=t._unevaluatedLayout._values,d={layoutIconSize:s["icon-size"].possiblyEvaluate(new Kt(r.bucket.zoom+1),r.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Kt(r.bucket.zoom+1),r.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Kt(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:I}=r.bucket.textSizeData;d.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Kt(C),r.canonical),s["text-size"].possiblyEvaluate(new Kt(I),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:I}=r.bucket.iconSizeData;d.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Kt(C),r.canonical),s["icon-size"].possiblyEvaluate(new Kt(I),r.canonical)]}const f=o.get("text-line-height")*Zn,y=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",x=o.get("text-keep-upright"),S=o.get("text-size");for(const C of r.bucket.features){const I=o.get("text-font").evaluate(C,{},r.canonical).join(","),P=S.evaluate(C,{},r.canonical),D=d.layoutTextSize.evaluate(C,{},r.canonical),F=d.layoutIconSize.evaluate(C,{},r.canonical),O={horizontal:{},vertical:void 0},U=C.text;let J,ne=[0,0];if(U){const fe=U.toString(),Ee=o.get("text-letter-spacing").evaluate(C,{},r.canonical)*Zn,De=bf(fe)?Ee:0,Ke=o.get("text-anchor").evaluate(C,{},r.canonical),_t=gv(t,C,r.canonical);if(!_t){const it=o.get("text-radial-offset").evaluate(C,{},r.canonical);ne=it?mv(Ke,[it*Zn,om]):o.get("text-offset").evaluate(C,{},r.canonical).map(tt=>tt*Zn)}let We=y?"center":o.get("text-justify").evaluate(C,{},r.canonical);const He=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(C,{},r.canonical)*Zn:1/0,ht=()=>{r.bucket.allowVerticalPlacement&&rc(fe)&&(O.vertical=Td(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,He,f,Ke,"left",De,ne,v.ah.vertical,!0,D,P))};if(!y&&_t){const it=new Set;if(We==="auto")for(let Pe=0;Pe<_t.values.length;Pe+=2)it.add(am(_t.values[Pe]));else it.add(We);let tt=!1;for(const Pe of it)if(!O.horizontal[Pe])if(tt)O.horizontal[Pe]=O.horizontal[0];else{const pt=Td(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,He,f,"center",Pe,De,ne,v.ah.horizontal,!1,D,P);pt&&(O.horizontal[Pe]=pt,tt=pt.positionedLines.length===1)}ht()}else{We==="auto"&&(We=am(Ke));const it=Td(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,He,f,Ke,We,De,ne,v.ah.horizontal,!1,D,P);it&&(O.horizontal[We]=it),ht(),rc(fe)&&y&&x&&(O.vertical=Td(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,He,f,Ke,We,De,ne,v.ah.vertical,!1,D,P))}}let ye=!1;if(C.icon&&C.icon.name){const fe=r.imageMap[C.icon.name];fe&&(J=d2(r.imagePositions[C.icon.name],o.get("icon-offset").evaluate(C,{},r.canonical),o.get("icon-anchor").evaluate(C,{},r.canonical)),ye=!!fe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ye:r.bucket.sdfIcons!==ye&&Ot("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==r.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const le=_v(O.horizontal)||O.vertical;r.bucket.iconsInText=!!le&&le.iconsInText,(le||J)&&I2(r.bucket,C,O,J,r.imageMap,d,D,F,ne,ye,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},v.bp=Zf,v.bq=Vf,v.br=$f,v.bs=Ta,v.bt=Hf,v.bu=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},v.bv=function(r,t,o,s,d){return c(this,void 0,void 0,function*(){if(re())try{return yield ut(r,t,o,s,d)}catch{}return function(f,y,x,S,C){const I=f.width,P=f.height;wt&&Dt||(wt=new OffscreenCanvas(I,P),Dt=wt.getContext("2d",{willReadFrequently:!0})),wt.width=I,wt.height=P,Dt.drawImage(f,0,0,I,P);const D=Dt.getImageData(y,x,S,C);return Dt.clearRect(0,0,I,P),D.data}(r,t,o,s,d)})},v.bw=tv,v.bx=A,v.by=V,v.bz=C_,v.c=kn,v.d=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.e=Qe,v.f=r=>new Promise((t,o)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=rt})},s.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(r)],{type:"image/png"});s.src=r.byteLength?URL.createObjectURL(d):rt}),v.g=Fn,v.h=(r,t)=>Xi(Qe(r,{type:"json"}),t),v.i=Rn,v.j=pn,v.k=Li,v.l=(r,t)=>Xi(Qe(r,{type:"arrayBuffer"}),t),v.m=Xi,v.n=function(r){return new Hf(r).readFields(o2,[])},v.o=gc,v.p=L_,v.q=b,v.r=kl,v.s=li,v.t=id,v.u=Uo,v.v=we,v.w=Ot,v.x=function([r,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(o),y:r*Math.sin(t)*Math.sin(o),z:r*Math.cos(o)}},v.y=Nr,v.z=Kt}),_("worker",["./shared"],function(v){class c{constructor(L){this.keyCache={},L&&this.replace(L)}replace(L){this._layerConfigs={},this._layers={},this.update(L,[])}update(L,R){for(const X of L){this._layerConfigs[X.id]=X;const se=this._layers[X.id]=v.aA(X);se._featureFilter=v.a7(se.filter),this.keyCache[X.id]&&delete this.keyCache[X.id]}for(const X of R)delete this.keyCache[X],delete this._layerConfigs[X],delete this._layers[X];this.familiesBySource={};const $=v.bj(Object.values(this._layerConfigs),this.keyCache);for(const X of $){const se=X.map(ve=>this._layers[ve.id]),he=se[0];if(he.visibility==="none")continue;const me=he.source||"";let ie=this.familiesBySource[me];ie||(ie=this.familiesBySource[me]={});const Te=he.sourceLayer||"_geojsonTileLayer";let ze=ie[Te];ze||(ze=ie[Te]=[]),ze.push(se)}}}class A{constructor(L){const R={},$=[];for(const me in L){const ie=L[me],Te=R[me]={};for(const ze in ie){const ve=ie[+ze];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const H={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};$.push(H),Te[ze]={rect:H,metrics:ve.metrics}}}const{w:X,h:se}=v.p($),he=new v.o({width:X||1,height:se||1});for(const me in L){const ie=L[me];for(const Te in ie){const ze=ie[+Te];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const ve=R[me][Te].rect;v.o.copy(ze.bitmap,he,{x:0,y:0},{x:ve.x+1,y:ve.y+1},ze.bitmap)}}this.image=he,this.positions=R}}v.bk("GlyphAtlas",A);class V{constructor(L){this.tileID=new v.S(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId,this.inFlightDependencies=[]}parse(L,R,$,X){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=L,this.collisionBoxArray=new v.a5;const se=new v.bl(Object.keys(L.layers).sort()),he=new v.bm(this.tileID,this.promoteId);he.bucketLayerIDs=[];const me={},ie={featureIndex:he,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},Te=R.familiesBySource[this.source];for(const Ve in Te){const at=L.layers[Ve];if(!at)continue;at.version===1&&v.w(`Vector tile source "${this.source}" layer "${Ve}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xt=se.encode(Ve),kt=[];for(let At=0;At<at.length;At++){const It=at.feature(At),_n=he.getId(It,Ve);kt.push({feature:It,id:_n,index:At,sourceLayerIndex:xt})}for(const At of Te[Ve]){const It=At[0];It.source!==this.source&&v.w(`layer.source = ${It.source} does not equal this.source = ${this.source}`),It.minzoom&&this.zoom<Math.floor(It.minzoom)||It.maxzoom&&this.zoom>=It.maxzoom||It.visibility!=="none"&&(W(At,this.zoom,$),(me[It.id]=It.createBucket({index:he.bucketLayerIDs.length,layers:At,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xt,sourceID:this.source})).populate(kt,ie,this.tileID.canonical),he.bucketLayerIDs.push(At.map(_n=>_n.id)))}}const ze=v.aF(ie.glyphDependencies,Ve=>Object.keys(Ve).map(Number));this.inFlightDependencies.forEach(Ve=>Ve==null?void 0:Ve.abort()),this.inFlightDependencies=[];let ve=Promise.resolve({});if(Object.keys(ze).length){const Ve=new AbortController;this.inFlightDependencies.push(Ve),ve=X.sendAsync({type:"GG",data:{stacks:ze,source:this.source,tileID:this.tileID,type:"glyphs"}},Ve)}const H=Object.keys(ie.iconDependencies);let ee=Promise.resolve({});if(H.length){const Ve=new AbortController;this.inFlightDependencies.push(Ve),ee=X.sendAsync({type:"GI",data:{icons:H,source:this.source,tileID:this.tileID,type:"icons"}},Ve)}const ce=Object.keys(ie.patternDependencies);let xe=Promise.resolve({});if(ce.length){const Ve=new AbortController;this.inFlightDependencies.push(Ve),xe=X.sendAsync({type:"GI",data:{icons:ce,source:this.source,tileID:this.tileID,type:"patterns"}},Ve)}const[Re,Ae,nt]=yield Promise.all([ve,ee,xe]),Fe=new A(Re),mt=new v.bn(Ae,nt);for(const Ve in me){const at=me[Ve];at instanceof v.a6?(W(at.layers,this.zoom,$),v.bo({bucket:at,glyphMap:Re,glyphPositions:Fe.positions,imageMap:Ae,imagePositions:mt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):at.hasPattern&&(at instanceof v.bp||at instanceof v.bq||at instanceof v.br)&&(W(at.layers,this.zoom,$),at.addFeatures(ie,this.tileID.canonical,mt.patternPositions))}return this.status="done",{buckets:Object.values(me).filter(Ve=>!Ve.isEmpty()),featureIndex:he,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Fe.image,imageAtlas:mt,glyphMap:this.returnDependencies?Re:null,iconMap:this.returnDependencies?Ae:null,glyphPositions:this.returnDependencies?Fe.positions:null}})}}function W(Q,L,R){const $=new v.z(L);for(const X of Q)X.recalculate($,R)}class j{constructor(L,R,$){this.actor=L,this.layerIndex=R,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(L,R){return v._(this,void 0,void 0,function*(){const $=yield v.l(L.request,R);try{return{vectorTile:new v.bs.VectorTile(new v.bt($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(X){const se=new Uint8Array($.data);let he=`Unable to parse the tile at ${L.request.url}, `;throw he+=se[0]===31&&se[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${X.message}`,new Error(he)}})}loadTile(L){return v._(this,void 0,void 0,function*(){const R=L.uid,$=!!(L&&L.request&&L.request.collectResourceTiming)&&new v.bu(L.request),X=new V(L);this.loading[R]=X;const se=new AbortController;X.abort=se;try{const he=yield this.loadVectorTile(L,se);if(delete this.loading[R],!he)return null;const me=he.rawData,ie={};he.expires&&(ie.expires=he.expires),he.cacheControl&&(ie.cacheControl=he.cacheControl);const Te={};if($){const ve=$.finish();ve&&(Te.resourceTiming=JSON.parse(JSON.stringify(ve)))}X.vectorTile=he.vectorTile;const ze=X.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[R]=X,this.fetching[R]={rawTileData:me,cacheControl:ie,resourceTiming:Te};try{const ve=yield ze;return v.e({rawTileData:me.slice(0)},ve,ie,Te)}finally{delete this.fetching[R]}}catch(he){throw delete this.loading[R],X.status="done",this.loaded[R]=X,he}})}reloadTile(L){return v._(this,void 0,void 0,function*(){const R=L.uid;if(!this.loaded||!this.loaded[R])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[R];if($.showCollisionBoxes=L.showCollisionBoxes,$.status==="parsing"){const X=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor);let se;if(this.fetching[R]){const{rawTileData:he,cacheControl:me,resourceTiming:ie}=this.fetching[R];delete this.fetching[R],se=v.e({rawTileData:he.slice(0)},X,me,ie)}else se=X;return se}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(L){return v._(this,void 0,void 0,function*(){const R=this.loading,$=L.uid;R&&R[$]&&R[$].abort&&(R[$].abort.abort(),delete R[$])})}removeTile(L){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[L.uid]&&delete this.loaded[L.uid]})}}class N{constructor(){this.loaded={}}loadTile(L){return v._(this,void 0,void 0,function*(){const{uid:R,encoding:$,rawImageData:X,redFactor:se,greenFactor:he,blueFactor:me,baseShift:ie}=L,Te=X.width+2,ze=X.height+2,ve=v.b(X)?new v.R({width:Te,height:ze},yield v.bv(X,-1,-1,Te,ze)):X,H=new v.bw(R,ve,$,se,he,me,ie);return this.loaded=this.loaded||{},this.loaded[R]=H,H})}removeTile(L){const R=this.loaded,$=L.uid;R&&R[$]&&delete R[$]}}function ke(Q,L){if(Q.length!==0){Se(Q[0],L);for(var R=1;R<Q.length;R++)Se(Q[R],!L)}}function Se(Q,L){for(var R=0,$=0,X=0,se=Q.length,he=se-1;X<se;he=X++){var me=(Q[X][0]-Q[he][0])*(Q[he][1]+Q[X][1]),ie=R+me;$+=Math.abs(R)>=Math.abs(me)?R-ie+me:me-ie+R,R=ie}R+$>=0!=!!L&&Q.reverse()}var be=v.bx(function Q(L,R){var $,X=L&&L.type;if(X==="FeatureCollection")for($=0;$<L.features.length;$++)Q(L.features[$],R);else if(X==="GeometryCollection")for($=0;$<L.geometries.length;$++)Q(L.geometries[$],R);else if(X==="Feature")Q(L.geometry,R);else if(X==="Polygon")ke(L.coordinates,R);else if(X==="MultiPolygon")for($=0;$<L.coordinates.length;$++)ke(L.coordinates[$],R);return L});const Ze=v.bs.VectorTileFeature.prototype.toGeoJSON;var oe={exports:{}},re=v.by,ue=v.bs.VectorTileFeature,Ce=Le;function Le(Q,L){this.options=L||{},this.features=Q,this.length=Q.length}function Xe(Q,L){this.id=typeof Q.id=="number"?Q.id:void 0,this.type=Q.type,this.rawGeometry=Q.type===1?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=L||4096}Le.prototype.feature=function(Q){return new Xe(this.features[Q],this.options.extent)},Xe.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var L=0;L<Q.length;L++){for(var R=Q[L],$=[],X=0;X<R.length;X++)$.push(new re(R[X][0],R[X][1]));this.geometry.push($)}return this.geometry},Xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,L=1/0,R=-1/0,$=1/0,X=-1/0,se=0;se<Q.length;se++)for(var he=Q[se],me=0;me<he.length;me++){var ie=he[me];L=Math.min(L,ie.x),R=Math.max(R,ie.x),$=Math.min($,ie.y),X=Math.max(X,ie.y)}return[L,$,R,X]},Xe.prototype.toGeoJSON=ue.prototype.toGeoJSON;var Qe=v.bz,pe=Ce;function dt(Q){var L=new Qe;return function(R,$){for(var X in R.layers)$.writeMessage(3,lt,R.layers[X])}(Q,L),L.finish()}function lt(Q,L){var R;L.writeVarintField(15,Q.version||1),L.writeStringField(1,Q.name||""),L.writeVarintField(5,Q.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<Q.length;R++)$.feature=Q.feature(R),L.writeMessage(2,ot,$);var X=$.keys;for(R=0;R<X.length;R++)L.writeStringField(3,X[R]);var se=$.values;for(R=0;R<se.length;R++)L.writeMessage(4,Hn,se[R])}function ot(Q,L){var R=Q.feature;R.id!==void 0&&L.writeVarintField(1,R.id),L.writeMessage(2,Xt,Q),L.writeVarintField(3,R.type),L.writeMessage(4,Rn,R)}function Xt(Q,L){var R=Q.feature,$=Q.keys,X=Q.values,se=Q.keycache,he=Q.valuecache;for(var me in R.properties){var ie=R.properties[me],Te=se[me];if(ie!==null){Te===void 0&&($.push(me),se[me]=Te=$.length-1),L.writeVarint(Te);var ze=typeof ie;ze!=="string"&&ze!=="boolean"&&ze!=="number"&&(ie=JSON.stringify(ie));var ve=ze+":"+ie,H=he[ve];H===void 0&&(X.push(ie),he[ve]=H=X.length-1),L.writeVarint(H)}}}function Ot(Q,L){return(L<<3)+(7&Q)}function Ft(Q){return Q<<1^Q>>31}function Rn(Q,L){for(var R=Q.loadGeometry(),$=Q.type,X=0,se=0,he=R.length,me=0;me<he;me++){var ie=R[me],Te=1;$===1&&(Te=ie.length),L.writeVarint(Ot(1,Te));for(var ze=$===3?ie.length-1:ie.length,ve=0;ve<ze;ve++){ve===1&&$!==1&&L.writeVarint(Ot(2,ze-1));var H=ie[ve].x-X,ee=ie[ve].y-se;L.writeVarint(Ft(H)),L.writeVarint(Ft(ee)),X+=H,se+=ee}$===3&&L.writeVarint(Ot(7,1))}}function Hn(Q,L){var R=typeof Q;R==="string"?L.writeStringField(1,Q):R==="boolean"?L.writeBooleanField(7,Q):R==="number"&&(Q%1!=0?L.writeDoubleField(3,Q):Q<0?L.writeSVarintField(6,Q):L.writeVarintField(5,Q))}oe.exports=dt,oe.exports.fromVectorTileJs=dt,oe.exports.fromGeojsonVt=function(Q,L){L=L||{};var R={};for(var $ in Q)R[$]=new pe(Q[$].features,L),R[$].name=$,R[$].version=L.version,R[$].extent=L.extent;return dt({layers:R})},oe.exports.GeoJSONWrapper=pe;var Un=v.bx(oe.exports);const rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Q=>Q},ut=Math.fround||(wt=new Float32Array(1),Q=>(wt[0]=+Q,wt[0]));var wt;const Dt=3,Nt=5,kn=6;class yn{constructor(L){this.options=Object.assign(Object.create(rt),L),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(L){const{log:R,minZoom:$,maxZoom:X}=this.options;R&&console.time("total time");const se=`prepare ${L.length} points`;R&&console.time(se),this.points=L;const he=[];for(let ie=0;ie<L.length;ie++){const Te=L[ie];if(!Te.geometry)continue;const[ze,ve]=Te.geometry.coordinates,H=ut(on(ze)),ee=ut($n(ve));he.push(H,ee,1/0,ie,-1,1),this.options.reduce&&he.push(0)}let me=this.trees[X+1]=this._createTree(he);R&&console.timeEnd(se);for(let ie=X;ie>=$;ie--){const Te=+Date.now();me=this.trees[ie]=this._createTree(this._cluster(me,ie)),R&&console.log("z%d: %d clusters in %dms",ie,me.numItems,+Date.now()-Te)}return R&&console.timeEnd("total time"),this}getClusters(L,R){let $=((L[0]+180)%360+360)%360-180;const X=Math.max(-90,Math.min(90,L[1]));let se=L[2]===180?180:((L[2]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)$=-180,se=180;else if($>se){const ve=this.getClusters([$,X,180,he],R),H=this.getClusters([-180,X,se,he],R);return ve.concat(H)}const me=this.trees[this._limitZoom(R)],ie=me.range(on($),$n(he),on(se),$n(X)),Te=me.data,ze=[];for(const ve of ie){const H=this.stride*ve;ze.push(Te[H+Nt]>1?Fn(Te,H,this.clusterProps):this.points[Te[H+Dt]])}return ze}getChildren(L){const R=this._getOriginId(L),$=this._getOriginZoom(L),X="No cluster with the specified id.",se=this.trees[$];if(!se)throw new Error(X);const he=se.data;if(R*this.stride>=he.length)throw new Error(X);const me=this.options.radius/(this.options.extent*Math.pow(2,$-1)),ie=se.within(he[R*this.stride],he[R*this.stride+1],me),Te=[];for(const ze of ie){const ve=ze*this.stride;he[ve+4]===L&&Te.push(he[ve+Nt]>1?Fn(he,ve,this.clusterProps):this.points[he[ve+Dt]])}if(Te.length===0)throw new Error(X);return Te}getLeaves(L,R,$){const X=[];return this._appendLeaves(X,L,R=R||10,$=$||0,0),X}getTile(L,R,$){const X=this.trees[this._limitZoom(L)],se=Math.pow(2,L),{extent:he,radius:me}=this.options,ie=me/he,Te=($-ie)/se,ze=($+1+ie)/se,ve={features:[]};return this._addTileFeatures(X.range((R-ie)/se,Te,(R+1+ie)/se,ze),X.data,R,$,se,ve),R===0&&this._addTileFeatures(X.range(1-ie/se,Te,1,ze),X.data,se,$,se,ve),R===se-1&&this._addTileFeatures(X.range(0,Te,ie/se,ze),X.data,-1,$,se,ve),ve.features.length?ve:null}getClusterExpansionZoom(L){let R=this._getOriginZoom(L)-1;for(;R<=this.options.maxZoom;){const $=this.getChildren(L);if(R++,$.length!==1)break;L=$[0].properties.cluster_id}return R}_appendLeaves(L,R,$,X,se){const he=this.getChildren(R);for(const me of he){const ie=me.properties;if(ie&&ie.cluster?se+ie.point_count<=X?se+=ie.point_count:se=this._appendLeaves(L,ie.cluster_id,$,X,se):se<X?se++:L.push(me),L.length===$)break}return se}_createTree(L){const R=new v.av(L.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<L.length;$+=this.stride)R.add(L[$],L[$+1]);return R.finish(),R.data=L,R}_addTileFeatures(L,R,$,X,se,he){for(const me of L){const ie=me*this.stride,Te=R[ie+Nt]>1;let ze,ve,H;if(Te)ze=dn(R,ie,this.clusterProps),ve=R[ie],H=R[ie+1];else{const xe=this.points[R[ie+Dt]];ze=xe.properties;const[Re,Ae]=xe.geometry.coordinates;ve=on(Re),H=$n(Ae)}const ee={type:1,geometry:[[Math.round(this.options.extent*(ve*se-$)),Math.round(this.options.extent*(H*se-X))]],tags:ze};let ce;ce=Te||this.options.generateId?R[ie+Dt]:this.points[R[ie+Dt]].id,ce!==void 0&&(ee.id=ce),he.features.push(ee)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(Math.floor(+L),this.options.maxZoom+1))}_cluster(L,R){const{radius:$,extent:X,reduce:se,minPoints:he}=this.options,me=$/(X*Math.pow(2,R)),ie=L.data,Te=[],ze=this.stride;for(let ve=0;ve<ie.length;ve+=ze){if(ie[ve+2]<=R)continue;ie[ve+2]=R;const H=ie[ve],ee=ie[ve+1],ce=L.within(ie[ve],ie[ve+1],me),xe=ie[ve+Nt];let Re=xe;for(const Ae of ce){const nt=Ae*ze;ie[nt+2]>R&&(Re+=ie[nt+Nt])}if(Re>xe&&Re>=he){let Ae,nt=H*xe,Fe=ee*xe,mt=-1;const Ve=((ve/ze|0)<<5)+(R+1)+this.points.length;for(const at of ce){const xt=at*ze;if(ie[xt+2]<=R)continue;ie[xt+2]=R;const kt=ie[xt+Nt];nt+=ie[xt]*kt,Fe+=ie[xt+1]*kt,ie[xt+4]=Ve,se&&(Ae||(Ae=this._map(ie,ve,!0),mt=this.clusterProps.length,this.clusterProps.push(Ae)),se(Ae,this._map(ie,xt)))}ie[ve+4]=Ve,Te.push(nt/Re,Fe/Re,1/0,Ve,-1,Re),se&&Te.push(mt)}else{for(let Ae=0;Ae<ze;Ae++)Te.push(ie[ve+Ae]);if(Re>1)for(const Ae of ce){const nt=Ae*ze;if(!(ie[nt+2]<=R)){ie[nt+2]=R;for(let Fe=0;Fe<ze;Fe++)Te.push(ie[nt+Fe])}}}}return Te}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,R,$){if(L[R+Nt]>1){const he=this.clusterProps[L[R+kn]];return $?Object.assign({},he):he}const X=this.points[L[R+Dt]].properties,se=this.options.map(X);return $&&se===X?Object.assign({},se):se}}function Fn(Q,L,R){return{type:"Feature",id:Q[L+Dt],properties:dn(Q,L,R),geometry:{type:"Point",coordinates:[($=Q[L],360*($-.5)),Xi(Q[L+1])]}};var $}function dn(Q,L,R){const $=Q[L+Nt],X=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,se=Q[L+kn],he=se===-1?{}:Object.assign({},R[se]);return Object.assign(he,{cluster:!0,cluster_id:Q[L+Dt],point_count:$,point_count_abbreviated:X})}function on(Q){return Q/360+.5}function $n(Q){const L=Math.sin(Q*Math.PI/180),R=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return R<0?0:R>1?1:R}function Xi(Q){const L=(180-360*Q)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function li(Q,L,R,$){let X=$;const se=L+(R-L>>1);let he,me=R-L;const ie=Q[L],Te=Q[L+1],ze=Q[R],ve=Q[R+1];for(let H=L+3;H<R;H+=3){const ee=Do(Q[H],Q[H+1],ie,Te,ze,ve);if(ee>X)he=H,X=ee;else if(ee===X){const ce=Math.abs(H-se);ce<me&&(he=H,me=ce)}}X>$&&(he-L>3&&li(Q,L,he,$),Q[he+2]=X,R-he>3&&li(Q,he,R,$))}function Do(Q,L,R,$,X,se){let he=X-R,me=se-$;if(he!==0||me!==0){const ie=((Q-R)*he+(L-$)*me)/(he*he+me*me);ie>1?(R=X,$=se):ie>0&&(R+=he*ie,$+=me*ie)}return he=Q-R,me=L-$,he*he+me*me}function ui(Q,L,R,$){const X={id:Q??null,type:L,geometry:R,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(L==="Point"||L==="MultiPoint"||L==="LineString")Li(X,R);else if(L==="Polygon")Li(X,R[0]);else if(L==="MultiLineString")for(const se of R)Li(X,se);else if(L==="MultiPolygon")for(const se of R)Li(X,se[0]);return X}function Li(Q,L){for(let R=0;R<L.length;R+=3)Q.minX=Math.min(Q.minX,L[R]),Q.minY=Math.min(Q.minY,L[R+1]),Q.maxX=Math.max(Q.maxX,L[R]),Q.maxY=Math.max(Q.maxY,L[R+1])}function pn(Q,L,R,$){if(!L.geometry)return;const X=L.geometry.coordinates;if(X&&X.length===0)return;const se=L.geometry.type,he=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2);let me=[],ie=L.id;if(R.promoteId?ie=L.properties[R.promoteId]:R.generateId&&(ie=$||0),se==="Point")Rr(X,me);else if(se==="MultiPoint")for(const Te of X)Rr(Te,me);else if(se==="LineString")we(X,me,he,!1);else if(se==="MultiLineString"){if(R.lineMetrics){for(const Te of X)me=[],we(Te,me,he,!1),Q.push(ui(ie,"LineString",me,L.properties));return}Ki(X,me,he,!1)}else if(se==="Polygon")Ki(X,me,he,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(const Te of L.geometry.geometries)pn(Q,{id:ie,geometry:Te,properties:L.properties},R,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Te of X){const ze=[];Ki(Te,ze,he,!0),me.push(ze)}}Q.push(ui(ie,se,me,L.properties))}function Rr(Q,L){L.push(Fr(Q[0]),$t(Q[1]),0)}function we(Q,L,R,$){let X,se,he=0;for(let ie=0;ie<Q.length;ie++){const Te=Fr(Q[ie][0]),ze=$t(Q[ie][1]);L.push(Te,ze,0),ie>0&&(he+=$?(X*ze-Te*se)/2:Math.sqrt(Math.pow(Te-X,2)+Math.pow(ze-se,2))),X=Te,se=ze}const me=L.length-3;L[2]=1,li(L,0,me,R),L[me+2]=1,L.size=Math.abs(he),L.start=0,L.end=L.size}function Ki(Q,L,R,$){for(let X=0;X<Q.length;X++){const se=[];we(Q[X],se,R,$),L.push(se)}}function Fr(Q){return Q/360+.5}function $t(Q){const L=Math.sin(Q*Math.PI/180),R=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return R<0?0:R>1?1:R}function cn(Q,L,R,$,X,se,he,me){if($/=L,se>=(R/=L)&&he<$)return Q;if(he<R||se>=$)return null;const ie=[];for(const Te of Q){const ze=Te.geometry;let ve=Te.type;const H=X===0?Te.minX:Te.minY,ee=X===0?Te.maxX:Te.maxY;if(H>=R&&ee<$){ie.push(Te);continue}if(ee<R||H>=$)continue;let ce=[];if(ve==="Point"||ve==="MultiPoint")po(ze,ce,R,$,X);else if(ve==="LineString")Ri(ze,ce,R,$,X,!1,me.lineMetrics);else if(ve==="MultiLineString")fo(ze,ce,R,$,X,!1);else if(ve==="Polygon")fo(ze,ce,R,$,X,!0);else if(ve==="MultiPolygon")for(const xe of ze){const Re=[];fo(xe,Re,R,$,X,!0),Re.length&&ce.push(Re)}if(ce.length){if(me.lineMetrics&&ve==="LineString"){for(const xe of ce)ie.push(ui(Te.id,ve,xe,Te.tags));continue}ve!=="LineString"&&ve!=="MultiLineString"||(ce.length===1?(ve="LineString",ce=ce[0]):ve="MultiLineString"),ve!=="Point"&&ve!=="MultiPoint"||(ve=ce.length===3?"Point":"MultiPoint"),ie.push(ui(Te.id,ve,ce,Te.tags))}}return ie.length?ie:null}function po(Q,L,R,$,X){for(let se=0;se<Q.length;se+=3){const he=Q[se+X];he>=R&&he<=$&&wr(L,Q[se],Q[se+1],Q[se+2])}}function Ri(Q,L,R,$,X,se,he){let me=ci(Q);const ie=X===0?hi:di;let Te,ze,ve=Q.start;for(let Re=0;Re<Q.length-3;Re+=3){const Ae=Q[Re],nt=Q[Re+1],Fe=Q[Re+2],mt=Q[Re+3],Ve=Q[Re+4],at=X===0?Ae:nt,xt=X===0?mt:Ve;let kt=!1;he&&(Te=Math.sqrt(Math.pow(Ae-mt,2)+Math.pow(nt-Ve,2))),at<R?xt>R&&(ze=ie(me,Ae,nt,mt,Ve,R),he&&(me.start=ve+Te*ze)):at>$?xt<$&&(ze=ie(me,Ae,nt,mt,Ve,$),he&&(me.start=ve+Te*ze)):wr(me,Ae,nt,Fe),xt<R&&at>=R&&(ze=ie(me,Ae,nt,mt,Ve,R),kt=!0),xt>$&&at<=$&&(ze=ie(me,Ae,nt,mt,Ve,$),kt=!0),!se&&kt&&(he&&(me.end=ve+Te*ze),L.push(me),me=ci(Q)),he&&(ve+=Te)}let H=Q.length-3;const ee=Q[H],ce=Q[H+1],xe=X===0?ee:ce;xe>=R&&xe<=$&&wr(me,ee,ce,Q[H+2]),H=me.length-3,se&&H>=3&&(me[H]!==me[0]||me[H+1]!==me[1])&&wr(me,me[0],me[1],me[2]),me.length&&L.push(me)}function ci(Q){const L=[];return L.size=Q.size,L.start=Q.start,L.end=Q.end,L}function fo(Q,L,R,$,X,se){for(const he of Q)Ri(he,L,R,$,X,se,!1)}function wr(Q,L,R,$){Q.push(L,R,$)}function hi(Q,L,R,$,X,se){const he=(se-L)/($-L);return wr(Q,se,R+(X-R)*he,1),he}function di(Q,L,R,$,X,se){const he=(se-R)/(X-R);return wr(Q,L+($-L)*he,se,1),he}function Ne(Q,L){const R=[];for(let $=0;$<Q.length;$++){const X=Q[$],se=X.type;let he;if(se==="Point"||se==="MultiPoint"||se==="LineString")he=br(X.geometry,L);else if(se==="MultiLineString"||se==="Polygon"){he=[];for(const me of X.geometry)he.push(br(me,L))}else if(se==="MultiPolygon"){he=[];for(const me of X.geometry){const ie=[];for(const Te of me)ie.push(br(Te,L));he.push(ie)}}R.push(ui(X.id,se,he,X.tags))}return R}function br(Q,L){const R=[];R.size=Q.size,Q.start!==void 0&&(R.start=Q.start,R.end=Q.end);for(let $=0;$<Q.length;$+=3)R.push(Q[$]+L,Q[$+1],Q[$+2]);return R}function fn(Q,L){if(Q.transformed)return Q;const R=1<<Q.z,$=Q.x,X=Q.y;for(const se of Q.features){const he=se.geometry,me=se.type;if(se.geometry=[],me===1)for(let ie=0;ie<he.length;ie+=2)se.geometry.push(Bn(he[ie],he[ie+1],L,R,$,X));else for(let ie=0;ie<he.length;ie++){const Te=[];for(let ze=0;ze<he[ie].length;ze+=2)Te.push(Bn(he[ie][ze],he[ie][ze+1],L,R,$,X));se.geometry.push(Te)}}return Q.transformed=!0,Q}function Bn(Q,L,R,$,X,se){return[Math.round(R*(Q*$-X)),Math.round(R*(L*$-se))]}function pi(Q,L,R,$,X){const se=L===X.maxZoom?0:X.tolerance/((1<<L)*X.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:Q.length,source:null,x:R,y:$,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const me of Q)Ue(he,me,se,X);return he}function Ue(Q,L,R,$){const X=L.geometry,se=L.type,he=[];if(Q.minX=Math.min(Q.minX,L.minX),Q.minY=Math.min(Q.minY,L.minY),Q.maxX=Math.max(Q.maxX,L.maxX),Q.maxY=Math.max(Q.maxY,L.maxY),se==="Point"||se==="MultiPoint")for(let me=0;me<X.length;me+=3)he.push(X[me],X[me+1]),Q.numPoints++,Q.numSimplified++;else if(se==="LineString")Mt(he,X,Q,R,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(let me=0;me<X.length;me++)Mt(he,X[me],Q,R,se==="Polygon",me===0);else if(se==="MultiPolygon")for(let me=0;me<X.length;me++){const ie=X[me];for(let Te=0;Te<ie.length;Te++)Mt(he,ie[Te],Q,R,!0,Te===0)}if(he.length){let me=L.tags||null;if(se==="LineString"&&$.lineMetrics){me={};for(const Te in L.tags)me[Te]=L.tags[Te];me.mapbox_clip_start=X.start/X.size,me.mapbox_clip_end=X.end/X.size}const ie={geometry:he,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:me};L.id!==null&&(ie.id=L.id),Q.features.push(ie)}}function Mt(Q,L,R,$,X,se){const he=$*$;if($>0&&L.size<(X?he:$))return void(R.numPoints+=L.length/3);const me=[];for(let ie=0;ie<L.length;ie+=3)($===0||L[ie+2]>he)&&(R.numSimplified++,me.push(L[ie],L[ie+1])),R.numPoints++;X&&function(ie,Te){let ze=0;for(let ve=0,H=ie.length,ee=H-2;ve<H;ee=ve,ve+=2)ze+=(ie[ve]-ie[ee])*(ie[ve+1]+ie[ee+1]);if(ze>0===Te)for(let ve=0,H=ie.length;ve<H/2;ve+=2){const ee=ie[ve],ce=ie[ve+1];ie[ve]=ie[H-2-ve],ie[ve+1]=ie[H-1-ve],ie[H-2-ve]=ee,ie[H-1-ve]=ce}}(me,se),Q.push(me)}const gt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Yn{constructor(L,R){const $=(R=this.options=function(se,he){for(const me in he)se[me]=he[me];return se}(Object.create(gt),R)).debug;if($&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");let X=function(se,he){const me=[];if(se.type==="FeatureCollection")for(let ie=0;ie<se.features.length;ie++)pn(me,se.features[ie],he,ie);else pn(me,se.type==="Feature"?se:{geometry:se},he);return me}(L,R);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(se,he){const me=he.buffer/he.extent;let ie=se;const Te=cn(se,1,-1-me,me,0,-1,2,he),ze=cn(se,1,1-me,2+me,0,-1,2,he);return(Te||ze)&&(ie=cn(se,1,-me,1+me,0,-1,2,he)||[],Te&&(ie=Ne(Te,1).concat(ie)),ze&&(ie=ie.concat(Ne(ze,-1)))),ie}(X,R),X.length&&this.splitTile(X,0,0,0),$&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(L,R,$,X,se,he,me){const ie=[L,R,$,X],Te=this.options,ze=Te.debug;for(;ie.length;){X=ie.pop(),$=ie.pop(),R=ie.pop(),L=ie.pop();const ve=1<<R,H=Sr(R,$,X);let ee=this.tiles[H];if(!ee&&(ze>1&&console.time("creation"),ee=this.tiles[H]=pi(L,R,$,X,Te),this.tileCoords.push({z:R,x:$,y:X}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,$,X,ee.numFeatures,ee.numPoints,ee.numSimplified),console.timeEnd("creation"));const kt=`z${R}`;this.stats[kt]=(this.stats[kt]||0)+1,this.total++}if(ee.source=L,se==null){if(R===Te.indexMaxZoom||ee.numPoints<=Te.indexMaxPoints)continue}else{if(R===Te.maxZoom||R===se)continue;if(se!=null){const kt=se-R;if($!==he>>kt||X!==me>>kt)continue}}if(ee.source=null,L.length===0)continue;ze>1&&console.time("clipping");const ce=.5*Te.buffer/Te.extent,xe=.5-ce,Re=.5+ce,Ae=1+ce;let nt=null,Fe=null,mt=null,Ve=null,at=cn(L,ve,$-ce,$+Re,0,ee.minX,ee.maxX,Te),xt=cn(L,ve,$+xe,$+Ae,0,ee.minX,ee.maxX,Te);L=null,at&&(nt=cn(at,ve,X-ce,X+Re,1,ee.minY,ee.maxY,Te),Fe=cn(at,ve,X+xe,X+Ae,1,ee.minY,ee.maxY,Te),at=null),xt&&(mt=cn(xt,ve,X-ce,X+Re,1,ee.minY,ee.maxY,Te),Ve=cn(xt,ve,X+xe,X+Ae,1,ee.minY,ee.maxY,Te),xt=null),ze>1&&console.timeEnd("clipping"),ie.push(nt||[],R+1,2*$,2*X),ie.push(Fe||[],R+1,2*$,2*X+1),ie.push(mt||[],R+1,2*$+1,2*X),ie.push(Ve||[],R+1,2*$+1,2*X+1)}}getTile(L,R,$){L=+L,R=+R,$=+$;const X=this.options,{extent:se,debug:he}=X;if(L<0||L>24)return null;const me=1<<L,ie=Sr(L,R=R+me&me-1,$);if(this.tiles[ie])return fn(this.tiles[ie],se);he>1&&console.log("drilling down to z%d-%d-%d",L,R,$);let Te,ze=L,ve=R,H=$;for(;!Te&&ze>0;)ze--,ve>>=1,H>>=1,Te=this.tiles[Sr(ze,ve,H)];return Te&&Te.source?(he>1&&(console.log("found parent tile z%d-%d-%d",ze,ve,H),console.time("drilling down")),this.splitTile(Te.source,ze,ve,H,L,R,$),he>1&&console.timeEnd("drilling down"),this.tiles[ie]?fn(this.tiles[ie],se):null):null}}function Sr(Q,L,R){return 32*((1<<Q)*R+L)+Q}function Tt(Q,L){return L?Q.properties[L]:Q.id}function Jr(Q,L){if(Q==null)return!0;if(Q.type==="Feature")return Tt(Q,L)!=null;if(Q.type==="FeatureCollection"){const R=new Set;for(const $ of Q.features){const X=Tt($,L);if(X==null||R.has(X))return!1;R.add(X)}return!0}return!1}function Yr(Q,L){const R=new Map;if(Q!=null)if(Q.type==="Feature")R.set(Tt(Q,L),Q);else for(const $ of Q.features)R.set(Tt($,L),$);return R}class Br extends j{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(L,R){return v._(this,void 0,void 0,function*(){const $=L.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const X=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!X)return null;const se=new class{constructor(me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.X,this.length=me.length,this._features=me}feature(me){return new class{constructor(ie){this._feature=ie,this.extent=v.X,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(this._feature.type===1){const ie=[];for(const Te of this._feature.geometry)ie.push([new v.P(Te[0],Te[1])]);return ie}{const ie=[];for(const Te of this._feature.geometry){const ze=[];for(const ve of Te)ze.push(new v.P(ve[0],ve[1]));ie.push(ze)}return ie}}toGeoJSON(ie,Te,ze){return Ze.call(this,ie,Te,ze)}}(this._features[me])}}(X.features);let he=Un(se);return he.byteOffset===0&&he.byteLength===he.buffer.byteLength||(he=new Uint8Array(he)),{vectorTile:se,rawData:he.buffer}})}loadData(L){return v._(this,void 0,void 0,function*(){var R;(R=this._pendingRequest)===null||R===void 0||R.abort();const $=!!(L&&L.request&&L.request.collectResourceTiming)&&new v.bu(L.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(L,this._pendingRequest),this._geoJSONIndex=L.cluster?new yn(function({superclusterOptions:he,clusterProperties:me}){if(!me||!he)return he;const ie={},Te={},ze={accumulated:null,zoom:0},ve={properties:null},H=Object.keys(me);for(const ee of H){const[ce,xe]=me[ee],Re=v.bB(xe),Ae=v.bB(typeof ce=="string"?[ce,["accumulated"],["get",ee]]:ce);ie[ee]=Re.value,Te[ee]=Ae.value}return he.map=ee=>{ve.properties=ee;const ce={};for(const xe of H)ce[xe]=ie[xe].evaluate(ze,ve);return ce},he.reduce=(ee,ce)=>{ve.properties=ce;for(const xe of H)ze.accumulated=ee[xe],ee[xe]=Te[xe].evaluate(ze,ve)},he}(L)).load((yield this._pendingData).features):(X=yield this._pendingData,new Yn(X,L.geojsonVtOptions)),this.loaded={};const se={};if($){const he=$.finish();he&&(se.resourceTiming={},se.resourceTiming[L.source]=JSON.parse(JSON.stringify(he)))}return se}catch(se){if(delete this._pendingRequest,v.bA(se))return{abandoned:!0};throw se}var X})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(L){const R=this.loaded;return R&&R[L.uid]?super.reloadTile(L):this.loadTile(L)}loadAndProcessGeoJSON(L,R){return v._(this,void 0,void 0,function*(){let $=yield this.loadGeoJSON(L,R);if(delete this._pendingRequest,typeof $!="object")throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(be($,!0),L.filter){const X=v.bB(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(X.result==="error")throw new Error(X.value.map(he=>`${he.key}: ${he.message}`).join(", "));$={type:"FeatureCollection",features:$.features.filter(he=>X.value.evaluate({zoom:0},he))}}return $})}loadGeoJSON(L,R){return v._(this,void 0,void 0,function*(){const{promoteId:$}=L;if(L.request){const X=yield v.h(L.request,R);return this._dataUpdateable=Jr(X.data,$)?Yr(X.data,$):void 0,X.data}if(typeof L.data=="string")try{const X=JSON.parse(L.data);return this._dataUpdateable=Jr(X,$)?Yr(X,$):void 0,X}catch{throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`)}if(!L.dataDiff)throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${L.source}`);return function(X,se,he){var me,ie,Te,ze;if(se.removeAll&&X.clear(),se.remove)for(const ve of se.remove)X.delete(ve);if(se.add)for(const ve of se.add){const H=Tt(ve,he);H!=null&&X.set(H,ve)}if(se.update)for(const ve of se.update){let H=X.get(ve.id);if(H==null)continue;const ee=!ve.removeAllProperties&&(((me=ve.removeProperties)===null||me===void 0?void 0:me.length)>0||((ie=ve.addOrUpdateProperties)===null||ie===void 0?void 0:ie.length)>0);if((ve.newGeometry||ve.removeAllProperties||ee)&&(H=Object.assign({},H),X.set(ve.id,H),ee&&(H.properties=Object.assign({},H.properties))),ve.newGeometry&&(H.geometry=ve.newGeometry),ve.removeAllProperties)H.properties={};else if(((Te=ve.removeProperties)===null||Te===void 0?void 0:Te.length)>0)for(const ce of ve.removeProperties)Object.prototype.hasOwnProperty.call(H.properties,ce)&&delete H.properties[ce];if(((ze=ve.addOrUpdateProperties)===null||ze===void 0?void 0:ze.length)>0)for(const{key:ce,value:xe}of ve.addOrUpdateProperties)H.properties[ce]=xe}}(this._dataUpdateable,L.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(L){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(L){return this._geoJSONIndex.getClusterExpansionZoom(L.clusterId)}getClusterChildren(L){return this._geoJSONIndex.getChildren(L.clusterId)}getClusterLeaves(L){return this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset)}}class Or{constructor(L){this.self=L,this.actor=new v.F(L),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(R,$)=>{if(this.externalWorkerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.externalWorkerSourceTypes[R]=$},this.self.addProtocol=v.bh,this.self.removeProtocol=v.bi,this.self.registerRTLTextPlugin=R=>{if(v.bC.isParsed())throw new Error("RTL text plugin already registered.");v.bC.setMethods(R)},this.actor.registerMessageHandler("LDT",(R,$)=>this._getDEMWorkerSource(R,$.source).loadTile($)),this.actor.registerMessageHandler("RDT",(R,$)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(R,$.source).removeTile($)})),this.actor.registerMessageHandler("GCEZ",(R,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(R,$.type,$.source).getClusterExpansionZoom($)})),this.actor.registerMessageHandler("GCC",(R,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(R,$.type,$.source).getClusterChildren($)})),this.actor.registerMessageHandler("GCL",(R,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(R,$.type,$.source).getClusterLeaves($)})),this.actor.registerMessageHandler("LD",(R,$)=>this._getWorkerSource(R,$.type,$.source).loadData($)),this.actor.registerMessageHandler("GD",(R,$)=>this._getWorkerSource(R,$.type,$.source).getData()),this.actor.registerMessageHandler("LT",(R,$)=>this._getWorkerSource(R,$.type,$.source).loadTile($)),this.actor.registerMessageHandler("RT",(R,$)=>this._getWorkerSource(R,$.type,$.source).reloadTile($)),this.actor.registerMessageHandler("AT",(R,$)=>this._getWorkerSource(R,$.type,$.source).abortTile($)),this.actor.registerMessageHandler("RMT",(R,$)=>this._getWorkerSource(R,$.type,$.source).removeTile($)),this.actor.registerMessageHandler("RS",(R,$)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[R]||!this.workerSources[R][$.type]||!this.workerSources[R][$.type][$.source])return;const X=this.workerSources[R][$.type][$.source];delete this.workerSources[R][$.type][$.source],X.removeSource!==void 0&&X.removeSource($)})),this.actor.registerMessageHandler("RM",R=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[R],delete this.availableImages[R],delete this.workerSources[R],delete this.demWorkerSources[R]})),this.actor.registerMessageHandler("SR",(R,$)=>v._(this,void 0,void 0,function*(){this.referrer=$})),this.actor.registerMessageHandler("SRPS",(R,$)=>this._syncRTLPluginState(R,$)),this.actor.registerMessageHandler("IS",(R,$)=>v._(this,void 0,void 0,function*(){this.self.importScripts($)})),this.actor.registerMessageHandler("SI",(R,$)=>this._setImages(R,$)),this.actor.registerMessageHandler("UL",(R,$)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(R).update($.layers,$.removedIds)})),this.actor.registerMessageHandler("SL",(R,$)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(R).replace($)}))}_setImages(L,R){return v._(this,void 0,void 0,function*(){this.availableImages[L]=R;for(const $ in this.workerSources[L]){const X=this.workerSources[L][$];for(const se in X)X[se].availableImages=R}})}_syncRTLPluginState(L,R){return v._(this,void 0,void 0,function*(){if(v.bC.isParsed())return v.bC.getState();if(R.pluginStatus!=="loading")return v.bC.setState(R),R;const $=R.pluginURL;if(this.self.importScripts($),v.bC.isParsed()){const X={pluginStatus:"loaded",pluginURL:$};return v.bC.setState(X),X}throw v.bC.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${$}`)})}_getAvailableImages(L){let R=this.availableImages[L];return R||(R=[]),R}_getLayerIndex(L){let R=this.layerIndexes[L];return R||(R=this.layerIndexes[L]=new c),R}_getWorkerSource(L,R,$){if(this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][R]||(this.workerSources[L][R]={}),!this.workerSources[L][R][$]){const X={sendAsync:(se,he)=>(se.targetMapId=L,this.actor.sendAsync(se,he))};switch(R){case"vector":this.workerSources[L][R][$]=new j(X,this._getLayerIndex(L),this._getAvailableImages(L));break;case"geojson":this.workerSources[L][R][$]=new Br(X,this._getLayerIndex(L),this._getAvailableImages(L));break;default:this.workerSources[L][R][$]=new this.externalWorkerSourceTypes[R](X,this._getLayerIndex(L),this._getAvailableImages(L))}}return this.workerSources[L][R][$]}_getDEMWorkerSource(L,R){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][R]||(this.demWorkerSources[L][R]=new N),this.demWorkerSources[L][R]}}return v.i(self)&&(self.worker=new Or(self)),Or}),_("index",["exports","./shared"],function(v,c){var A="4.6.0";let V,W;const j={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:m=>new Promise((e,a)=>{const u=requestAnimationFrame(e);m.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),a(c.c())})}),getImageData(m,e=0){return this.getImageCanvasContext(m).getImageData(-e,-e,m.width+2*e,m.height+2*e)},getImageCanvasContext(m){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=m.width,e.height=m.height,a.drawImage(m,0,0,m.width,m.height),a},resolveURL:m=>(V||(V=document.createElement("a")),V.href=m,V.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(W==null&&(W=matchMedia("(prefers-reduced-motion: reduce)")),W.matches)}};class N{static testProp(e){if(!N.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in N.docStyle)return e[a];return e[0]}static create(e,a,u){const h=window.document.createElement(e);return a!==void 0&&(h.className=a),u&&u.appendChild(h),h}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(e,a){e.style[N.transformProp]=a}static addEventListener(e,a,u,h={}){e.addEventListener(a,u,"passive"in h?h:h.capture)}static removeEventListener(e,a,u,h={}){e.removeEventListener(a,u,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",N.suppressClickInternal,!0)},0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,u){const h=a.boundingClientRect;return new c.P((u.clientX-h.left)/a.x-e.clientLeft,(u.clientY-h.top)/a.y-e.clientTop)}static mousePos(e,a){const u=N.getScale(e);return N.getPoint(e,u,a)}static touchPos(e,a){const u=[],h=N.getScale(e);for(let g=0;g<a.length;g++)u.push(N.getPoint(e,h,a[g]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const ke={supported:!1,testSupport:function(m){!Ze&&be&&(oe?re(m):Se=m)}};let Se,be,Ze=!1,oe=!1;function re(m){const e=m.createTexture();m.bindTexture(m.TEXTURE_2D,e);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,be),m.isContextLost())return;ke.supported=!0}catch{}m.deleteTexture(e),Ze=!0}var ue;typeof document<"u"&&(be=document.createElement("img"),be.onload=()=>{Se&&re(Se),Se=null,oe=!0},be.onerror=()=>{Ze=!0,Se=null},be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let e,a,u,h;m.resetRequestQueue=()=>{e=[],a=0,u=0,h={}},m.addThrottleControl=E=>{const k=u++;return h[k]=E,k},m.removeThrottleControl=E=>{delete h[E],b()},m.getImage=(E,k,z=!0)=>new Promise((M,B)=>{ke.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),c.e(E,{type:"image"}),e.push({abortController:k,requestParameters:E,supportImageRefresh:z,state:"queued",onError:Z=>{B(Z)},onSuccess:Z=>{M(Z)}}),b()});const g=E=>c._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:k,supportImageRefresh:z,onError:M,onSuccess:B,abortController:Z}=E,q=z===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((te,ae)=>te&&ae==="accept",!0));a++;const Y=q?T(k,Z):c.m(k,Z);try{const te=yield Y;delete E.abortController,E.state="completed",te.data instanceof HTMLImageElement||c.b(te.data)?B(te):te.data&&B({data:yield(G=te.data,typeof createImageBitmap=="function"?c.d(G):c.f(G)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete E.abortController,M(te)}finally{a--,b()}var G}),b=()=>{const E=(()=>{for(const k of Object.keys(h))if(h[k]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<E&&e.length>0;k++){const z=e.shift();z.abortController.signal.aborted?k--:g(z)}},T=(E,k)=>new Promise((z,M)=>{const B=new Image,Z=E.url,q=E.credentials;q&&q==="include"?B.crossOrigin="use-credentials":(q&&q==="same-origin"||!c.s(Z))&&(B.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{B.src="",M(c.c())}),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,z({data:B})},B.onerror=()=>{B.onerror=B.onload=null,k.signal.aborted||M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=Z})}(ue||(ue={})),ue.resetRequestQueue();class Ce{constructor(e){this._transformRequestFn=e}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Le(m){var e=new c.A(3);return e[0]=m[0],e[1]=m[1],e[2]=m[2],e}var Xe,Qe=function(m,e,a){return m[0]=e[0]-a[0],m[1]=e[1]-a[1],m[2]=e[2]-a[2],m};Xe=new c.A(3),c.A!=Float32Array&&(Xe[0]=0,Xe[1]=0,Xe[2]=0);var pe=function(m){var e=m[0],a=m[1];return e*e+a*a};function dt(m){const e=[];if(typeof m=="string")e.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:u,url:h}of m){const g=`${u}${h}`;a.indexOf(g)===-1&&(a.push(g),e.push({id:u,url:h}))}}return e}function lt(m,e,a){const u=m.split("?");return u[0]+=`${e}${a}`,u.join("?")}(function(){var m=new c.A(2);c.A!=Float32Array&&(m[0]=0,m[1]=0)})();class ot{constructor(e,a,u,h){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(a,h)}update(e,a,u){const{width:h,height:g}=e,b=!(this.size&&this.size[0]===h&&this.size[1]===g||u),{context:T}=this,{gl:E}=T;if(this.useMipmap=!!(a&&a.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!a||a.premultiply!==!1)),b)this.size=[h,g],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,h,g,0,this.format,E.UNSIGNED_BYTE,e.data);else{const{x:k,y:z}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?E.texSubImage2D(E.TEXTURE_2D,0,k,z,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,k,z,h,g,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(e,a,u){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),e!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||e),this.filter=e),a!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Xt(m){const{userImage:e}=m;return!!(e&&e.render&&e.render())&&(m.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ot extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:u}of this.requestors)u(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const u=a.spriteData;a.data=new c.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let u=!0;const h=a.data||a.spriteData;return this._validateStretch(a.stretchX,h&&h.width)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(a.stretchY,h&&h.height)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,a){if(!e)return!0;let u=0;for(const h of e){if(h[0]<u||h[1]<h[0]||a<h[1])return!1;u=h[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const u=a.spriteData,h=u&&u.width||a.data.width,g=u&&u.height||a.data.height;return!(e[0]<0||h<e[0]||e[1]<0||g<e[1]||e[2]<0||h<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,u=!0){const h=this.getImage(e);if(u&&(h.data.width!==a.data.width||h.data.height!==a.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=h.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((a,u)=>{let h=!0;if(!this.isLoaded())for(const g of e)this.images[g]||(h=!1);this.isLoaded()||h?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})})}_getImagesForIds(e){const a={};for(const u of e){let h=this.getImage(u);h||(this.fire(new c.k("styleimagemissing",{id:u})),h=this.getImage(u)),h?a[u]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:c.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],u=this.getImage(e);if(!u)return null;if(a&&a.position.version===u.version)return a.position;if(a)a.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new c.I(h,u);this.patterns[e]={bin:h,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const g in this.patterns)e.push(this.patterns[g].bin);const{w:a,h:u}=c.p(e),h=this.atlasImage;h.resize({width:a||1,height:u||1});for(const g in this.patterns){const{bin:b}=this.patterns[g],T=b.x+1,E=b.y+1,k=this.getImage(g).data,z=k.width,M=k.height;c.R.copy(k,h,{x:0,y:0},{x:T,y:E},{width:z,height:M}),c.R.copy(k,h,{x:0,y:M-1},{x:T,y:E-1},{width:z,height:1}),c.R.copy(k,h,{x:0,y:0},{x:T,y:E+M},{width:z,height:1}),c.R.copy(k,h,{x:z-1,y:0},{x:T-1,y:E},{width:1,height:M}),c.R.copy(k,h,{x:0,y:0},{x:T+z,y:E},{width:1,height:M})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const u=this.getImage(a);u||c.w(`Image with ID: "${a}" was not found`),Xt(u)&&this.updateImage(a,u)}}}const Ft=1e20;function Rn(m,e,a,u,h,g,b,T,E){for(let k=e;k<e+u;k++)Hn(m,a*g+k,g,h,b,T,E);for(let k=a;k<a+h;k++)Hn(m,k*g+e,1,u,b,T,E)}function Hn(m,e,a,u,h,g,b){g[0]=0,b[0]=-Ft,b[1]=Ft,h[0]=m[e];for(let T=1,E=0,k=0;T<u;T++){h[T]=m[e+T*a];const z=T*T;do{const M=g[E];k=(h[T]-h[M]+z-M*M)/(T-M)/2}while(k<=b[E]&&--E>-1);E++,g[E]=T,b[E]=k,b[E+1]=Ft}for(let T=0,E=0;T<u;T++){for(;b[E+1]<T;)E++;const k=g[E],z=T-k;m[e+T*a]=h[k]+z*z}}class Un{constructor(e,a){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const a=[];for(const g in e)for(const b of e[g])a.push(this._getAndCacheGlyphsPromise(g,b));const u=yield Promise.all(a),h={};for(const{stack:g,id:b,glyph:T}of u)h[g]||(h[g]={}),h[g][b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return h})}_getAndCacheGlyphsPromise(e,a){return c._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=u.glyphs[a];if(h!==void 0)return{stack:e,id:a,glyph:h};if(h=this._tinySDF(u,e,a),h)return u.glyphs[a]=h,{stack:e,id:a,glyph:h};const g=Math.floor(a/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[g])return{stack:e,id:a,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[g]){const T=Un.loadGlyphRange(e,g,this.url,this.requestManager);u.requests[g]=T}const b=yield u.requests[g];for(const T in b)this._doesCharSupportLocalGlyph(+T)||(u.glyphs[+T]=b[+T]);return u.ranges[g]=!0,{stack:e,id:a,glyph:b[a]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,a,u){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(u))return;let g=e.tinySDF;if(!g){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),g=e.tinySDF=new Un.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:T})}const b=g.draw(String.fromCharCode(u));return{id:u,bitmap:new c.o({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}Un.loadGlyphRange=function(m,e,a,u){return c._(this,void 0,void 0,function*(){const h=256*e,g=h+255,b=u.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${h}-${g}`),"Glyphs"),T=yield c.l(b,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${g}`);const E={};for(const k of c.n(T.data))E[k.id]=k;return E})},Un.TinySDF=class{constructor({fontSize:m=24,buffer:e=3,radius:a=8,cutoff:u=.25,fontFamily:h="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=a;const T=this.size=m+4*e,E=this._createCanvas(T),k=this.ctx=E.getContext("2d",{willReadFrequently:!0});k.font=`${b} ${g} ${m}px ${h}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(m){const e=document.createElement("canvas");return e.width=e.height=m,e}draw(m){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:h,actualBoundingBoxRight:g}=this.ctx.measureText(m),b=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-h))),E=Math.min(this.size-this.buffer,b+Math.ceil(u)),k=T+2*this.buffer,z=E+2*this.buffer,M=Math.max(k*z,0),B=new Uint8ClampedArray(M),Z={data:B,width:k,height:z,glyphWidth:T,glyphHeight:E,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(T===0||E===0)return Z;const{ctx:q,buffer:Y,gridInner:G,gridOuter:te}=this;q.clearRect(Y,Y,T,E),q.fillText(m,Y,Y+b);const ae=q.getImageData(Y,Y,T,E);te.fill(Ft,0,M),G.fill(0,0,M);for(let K=0;K<E;K++)for(let de=0;de<T;de++){const ge=ae.data[4*(K*T+de)+3]/255;if(ge===0)continue;const _e=(K+Y)*k+de+Y;if(ge===1)te[_e]=0,G[_e]=Ft;else{const Me=.5-ge;te[_e]=Me>0?Me*Me:0,G[_e]=Me<0?Me*Me:0}}Rn(te,0,0,k,z,k,this.f,this.v,this.z),Rn(G,Y,Y,T,E,k,this.f,this.v,this.z);for(let K=0;K<M;K++){const de=Math.sqrt(te[K])-Math.sqrt(G[K]);B[K]=Math.round(255-255*(de/this.radius+this.cutoff))}return Z}};class rt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,a){return c.x(e.expression.evaluate(a))}interpolate(e,a,u){return{x:c.y.number(e.x,a.x,u),y:c.y.number(e.y,a.y,u),z:c.y.number(e.z,a.z,u)}}}let ut;class wt extends c.E{constructor(e){super(),ut=ut||new c.q({anchor:new c.D(c.v.light.anchor),position:new rt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(ut),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(c.r,e,a))for(const u in e){const h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,u){return(!u||u.validate!==!1)&&c.t(this,e.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Dt=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Nt extends c.E{constructor(e){super(),this._transitionable=new c.T(Dt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(e,a={}){if(!this._validate(c.B,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent"});for(const u in e){const h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,u={}){return(u==null?void 0:u.validate)!==!1&&c.t(this,e.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class kn{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const u=e.join(",")+String(a);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,a)),this.dashEntry[u]}getDashRanges(e,a,u){const h=[];let g=e.length%2==1?-e[e.length-1]*u:0,b=e[0]*u,T=!0;h.push({left:g,right:b,isDash:T,zeroLength:e[0]===0});let E=e[0];for(let k=1;k<e.length;k++){T=!T;const z=e[k];g=E*u,E+=z,b=E*u,h.push({left:g,right:b,isDash:T,zeroLength:z===0})}return h}addRoundDash(e,a,u){const h=a/2;for(let g=-u;g<=u;g++){const b=this.width*(this.nextRow+u+g);let T=0,E=e[T];for(let k=0;k<this.width;k++){k/E.right>1&&(E=e[++T]);const z=Math.abs(k-E.left),M=Math.abs(k-E.right),B=Math.min(z,M);let Z;const q=g/u*(h+1);if(E.isDash){const Y=h-Math.abs(q);Z=Math.sqrt(B*B+Y*Y)}else Z=h-Math.sqrt(B*B+q*q);this.data[b+k]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(e){for(let T=e.length-1;T>=0;--T){const E=e[T],k=e[T+1];E.zeroLength?e.splice(T,1):k&&k.isDash===E.isDash&&(k.left=E.left,e.splice(T,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const h=this.width*this.nextRow;let g=0,b=e[g];for(let T=0;T<this.width;T++){T/b.right>1&&(b=e[++g]);const E=Math.abs(T-b.left),k=Math.abs(T-b.right),z=Math.min(E,k);this.data[h+T]=Math.max(0,Math.min(255,(b.isDash?z:-z)+128))}}addDash(e,a){const u=a?7:0,h=2*u+1;if(this.nextRow+h>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let T=0;T<e.length;T++)g+=e[T];if(g!==0){const T=this.width/g,E=this.getDashRanges(e,this.width,T);a?this.addRoundDash(E,T,u):this.addRegularDash(E)}const b={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=h,this.dirty=!0,b}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const yn="maplibre_preloaded_worker_pool";class Fn{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Fn.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[yn]}numActive(){return Object.keys(this.active).length}}const dn=Math.floor(j.hardwareConcurrency/2);let on,$n;function Xi(){return on||(on=new Fn),on}Fn.workerCount=c.C(globalThis)?Math.max(Math.min(dn,3),1):1;class li{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const u=this.workerPool.acquire(a);for(let h=0;h<u.length;h++){const g=new c.F(u[h],a);g.name=`Worker ${h}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const u=[];for(const h of this.actors)u.push(h.sendAsync({type:e,data:a}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const u of this.actors)u.registerMessageHandler(e,a)}}function Do(){return $n||($n=new li(Xi(),c.G),$n.registerMessageHandler("GR",(m,e,a)=>c.m(e,a))),$n}function ui(m,e){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*m.width,.5*m.height,1]),c.L(a,a,m.calculatePosMatrix(e.toUnwrapped()))}function Li(m,e,a,u,h,g){const b=function(M,B,Z){if(M)for(const q of M){const Y=B[q];if(Y&&Y.source===Z&&Y.type==="fill-extrusion")return!0}else for(const q in B){const Y=B[q];if(Y.source===Z&&Y.type==="fill-extrusion")return!0}return!1}(h&&h.layers,e,m.id),T=g.maxPitchScaleFactor(),E=m.tilesIn(u,T,b);E.sort(pn);const k=[];for(const M of E)k.push({wrappedTileID:M.tileID.wrapped().key,queryResults:M.tile.queryRenderedFeatures(e,a,m._state,M.queryGeometry,M.cameraQueryGeometry,M.scale,h,g,T,ui(m.transform,M.tileID))});const z=function(M){const B={},Z={};for(const q of M){const Y=q.queryResults,G=q.wrappedTileID,te=Z[G]=Z[G]||{};for(const ae in Y){const K=Y[ae],de=te[ae]=te[ae]||{},ge=B[ae]=B[ae]||[];for(const _e of K)de[_e.featureIndex]||(de[_e.featureIndex]=!0,ge.push(_e))}}return B}(k);for(const M in z)z[M].forEach(B=>{const Z=B.feature,q=m.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=q});return z}function pn(m,e){const a=m.tileID,u=e.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}function Rr(m,e,a){return c._(this,void 0,void 0,function*(){let u=m;if(m.url?u=(yield c.h(e.transformRequest(m.url,"Source"),a)).data:yield j.frameAsync(a),!u)return null;const h=c.M(c.e(u,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(h.vectorLayerIds=u.vector_layers.map(g=>g.id)),h})}class we{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}extend(e){const a=this._sw,u=this._ne;let h,g;if(e instanceof c.N)h=e,g=e;else{if(!(e instanceof we))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(we.convert(e)):this.extend(c.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.N.convert(e)):this;if(h=e._sw,g=e._ne,!h||!g)return this}return a||u?(a.lng=Math.min(h.lng,a.lng),a.lat=Math.min(h.lat,a.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new c.N(h.lng,h.lat),this._ne=new c.N(g.lng,g.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:u}=c.N.convert(e);let h=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h}static convert(e){return e instanceof we?e:e&&new we(e)}static fromLngLat(e,a=0){const u=360*a/40075017,h=u/Math.cos(Math.PI/180*e.lat);return new we(new c.N(e.lng-h,e.lat-u),new c.N(e.lng+h,e.lat+u))}}class Ki{constructor(e,a,u){this.bounds=we.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),u=Math.floor(c.O(this.bounds.getWest())*a),h=Math.floor(c.Q(this.bounds.getNorth())*a),g=Math.ceil(c.O(this.bounds.getEast())*a),b=Math.ceil(c.Q(this.bounds.getSouth())*a);return e.x>=u&&e.x<g&&e.y>=h&&e.y<b}}class Fr extends c.E{constructor(e,a,u,h){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Ki(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((g,b)=>{e.reloadPromise={resolve:g,reject:b}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const g=yield e.actor.sendAsync({type:h,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class $t extends c.E{constructor(e,a,u,h){super(),this.id=e,this.dispatcher=u,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Ki(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield ue.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const h=this.map.painter.context,g=h.gl,b=u.data;e.texture=this.map.painter.getTileTexture(b.width),e.texture?e.texture.update(b,{useMipmap:!0}):(e.texture=new ot(h,b,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class cn extends $t{constructor(e,a,u,h){super(e,a,u,h),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield ue.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const g=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const b=c.b(g)&&c.U()?g:yield this.readImageNow(g),T={type:this.type,uid:e.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const E=yield e.actor.sendAsync({type:"LDT",data:T});e.dem=E,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=e.width+2,u=e.height+2;try{return new c.R({width:a,height:u},yield c.W(e,-1,-1,a,u))}catch{}}return j.getImageData(e,1)})}_getNeighboringTiles(e){const a=e.canonical,u=Math.pow(2,a.z),h=(a.x-1+u)%u,g=a.x===0?e.wrap-1:e.wrap,b=(a.x+1+u)%u,T=a.x+1===u?e.wrap+1:e.wrap,E={};return E[new c.S(e.overscaledZ,g,a.z,h,a.y).key]={backfilled:!1},E[new c.S(e.overscaledZ,T,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(E[new c.S(e.overscaledZ,g,a.z,h,a.y-1).key]={backfilled:!1},E[new c.S(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},E[new c.S(e.overscaledZ,T,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<u&&(E[new c.S(e.overscaledZ,g,a.z,h,a.y+1).key]={backfilled:!1},E[new c.S(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},E[new c.S(e.overscaledZ,T,a.z,b,a.y+1).key]={backfilled:!1}),E}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class po extends c.E{constructor(e,a,u,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(h),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const g=c.X/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*g,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*g,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*g,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:u}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);e?a.dataDiff=e:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(j.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let h=null;u.resourceTiming&&u.resourceTiming[this.id]&&(h=u.resourceTiming[this.id].slice(0));const g={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&c.e(g,{resourceTiming:h}),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:a,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,a==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ri=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ci extends c.E{constructor(e,a,u,h){super(),this.id=e,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=a}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield ue.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(c.Z.fromLngLat);this.tileID=function(h){let g=1/0,b=1/0,T=-1/0,E=-1/0;for(const B of h)g=Math.min(g,B.x),b=Math.min(b,B.y),T=Math.max(T,B.x),E=Math.max(E,B.y);const k=Math.max(T-g,E-b),z=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),M=Math.pow(2,z);return new c.a1(z,Math.floor((g+T)/2*M),Math.floor((b+E)/2*M))}(a),this.minzoom=this.maxzoom=this.tileID.z;const u=a.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,c.X,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,c.X),this._boundsArray.emplaceBack(u[2].x,u[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Ri.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const h in this.tiles){const g=this.tiles[h];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class fo extends ci{constructor(e,a,u,h){super(e,a,u,h),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Ri.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new ot(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const h in this.tiles){const g=this.tiles[h];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class wr extends ci{constructor(e,a,u,h){super(e,a,u,h),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(b=>typeof b!="number"))||this.fire(new c.j(new c.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,u=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ri.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(a,this.canvas,u.RGBA,{premultiply:!0});let h=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const hi={},di=m=>{switch(m){case"geojson":return po;case"image":return ci;case"raster":return $t;case"raster-dem":return cn;case"vector":return Fr;case"video":return fo;case"canvas":return wr}return hi[m]},Ne="RTLPluginLoaded";class br extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Do()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(a,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Ne))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let fn=null;function Bn(){return fn||(fn=new br),fn}class pi{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,g){const b={};if(!g)return b;for(const T of h){const E=T.layerIds.map(k=>g.getLayer(k)).filter(Boolean);if(E.length!==0){T.layers=E,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(k=>E.filter(z=>z.id===k)[0]));for(const k of E)b[k.id]=T}}return b}(e.buckets,a.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const g=this.buckets[h];if(g instanceof c.a6){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const g=this.buckets[h];if(g instanceof c.a6&&g.hasRTLText){this.hasRTLText=!0,Bn().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const g=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(h).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const h=this.buckets[u];h.uploadPending()&&h.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,u,h,g,b,T,E,k,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:g,scale:b,tileSize:this.tileSize,pixelPosMatrix:z,transform:E,params:T,queryPadding:this.queryPadding*k},e,a,u):{}}querySourceFeatures(e,a){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const h=u.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",b=h._geojsonTileLayer||h[g];if(!b)return;const T=c.a7(a&&a.filter),{z:E,x:k,y:z}=this.tileID.canonical,M={z:E,x:k,y:z};for(let B=0;B<b.length;B++){const Z=b.feature(B);if(T.needGeometry){const G=c.a8(Z,!0);if(!T.filter(new c.z(this.tileID.overscaledZ),G,this.tileID.canonical))continue}else if(!T.filter(new c.z(this.tileID.overscaledZ),Z))continue;const q=u.getId(Z,g),Y=new c.a9(Z,E,k,z,q);Y.tile=M,e.push(Y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const u=c.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let h=!1;if(this.expirationTime>u)h=!1;else if(a)if(this.expirationTime<a)h=!0;else{const g=this.expirationTime-a;g?this.expirationTime=u+Math.max(g,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!a.style.hasLayer(h))continue;const g=this.buckets[h],b=g.layers[0].sourceLayer||"_geojsonTileLayer",T=u[b],E=e[b];if(!T||!E||Object.keys(E).length===0)continue;g.update(E,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=a&&a.style&&a.style.getLayer(h);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=j.now()+e}setDependencies(e,a){const u={};for(const h of a)u[h]=!0;this.dependencies[e]=u}hasDependency(e,a){for(const u of e){const h=this.dependencies[u];if(h){for(const g of a)if(h[g])return!0}}return!1}}class Ue{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,u){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const g={value:a,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(e,g)},u)),this.data[h].push(g),this.order.push(h),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const u=e.wrapped().key,h=a===void 0?0:this.data[u].indexOf(a),g=this.data[u][h];return this.data[u].splice(h,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const u in this.data)for(const h of this.data[u])e(h.value)||a.push(h);for(const u of a)this.remove(u.value.tileID,u)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,u){const h=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},c.e(this.stateChanges[e][h],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==h&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const g in this.state[e][h])u[g]||(this.deletedStates[e][h][g]=null)}else for(const g in u)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][g]===null&&delete this.deletedStates[e][h][g]}removeFeatureState(e,a,u){if(this.deletedStates[e]===null)return;const h=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&a!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][u]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(u in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][u]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,a){const u=String(a),h=c.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][a];if(g===null)return{};for(const b in g)delete h[b]}return h}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const u={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const g={};for(const b in this.stateChanges[h])this.state[h][b]||(this.state[h][b]={}),c.e(this.state[h][b],this.stateChanges[h][b]),g[b]=this.state[h][b];u[h]=g}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const g={};if(this.deletedStates[h]===null)for(const b in this.state[h])g[b]={},this.state[h][b]={};else for(const b in this.deletedStates[h]){if(this.deletedStates[h][b]===null)this.state[h][b]={};else for(const T of Object.keys(this.deletedStates[h][b]))delete this.state[h][b][T];g[b]=this.state[h][b]}u[h]=u[h]||{},c.e(u[h],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const h in e)e[h].setFeatureState(u,a)}}class gt extends c.E{constructor(e,a,u){super(),this.id=e,this.dispatcher=u,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,g,b,T)=>{const E=new(di(g.type))(h,g,b,T);if(E.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${E.id}`);return E})(e,a,u,this),this._tiles={},this._cache=new Ue(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,u){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,u)}catch(h){e.state="errored",h.status!==404?this._source.fire(new c.j(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const u=this._tiles[a];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Yn).map(e=>e.key)}getRenderableIds(e){const a=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&a.push(this._tiles[u]);return e?a.sort((u,h)=>{const g=u.tileID,b=h.tileID,T=new c.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new c.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||E.y-T.y||E.x-T.x}).map(u=>u.tileID.key):a.map(u=>u.tileID).sort(Yn).map(u=>u.key)}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,a){return c._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=a),yield this._loadTile(u,e,a))})}_tileLoaded(e,a,u){e.timeAdded=j.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let h=0;h<a.length;h++){const g=a[h];if(e.neighboringTiles&&e.neighboringTiles[g]){const b=this.getTileByID(g);u(e,b),u(b,e)}}function u(h,g){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let b=g.tileID.canonical.x-h.tileID.canonical.x;const T=g.tileID.canonical.y-h.tileID.canonical.y,E=Math.pow(2,h.tileID.canonical.z),k=g.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+E)===1?b+=E:Math.abs(b-E)===1&&(b-=E)),g.dem&&h.dem&&(h.dem.backfillBorder(g.dem,b,T),h.neighboringTiles&&h.neighboringTiles[k]&&(h.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a,u,h){for(const g in this._tiles){let b=this._tiles[g];if(h[g]||!b.hasData()||b.tileID.overscaledZ<=a||b.tileID.overscaledZ>u)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>a+1;){const k=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[k.key],b&&b.hasData()&&(T=k)}let E=T;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){h[T.key]=T;break}}}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=e.overscaledZ-1;u>=a;u--){const h=e.scaledTo(u),g=this._getLoadedTile(h);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(a*u*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(g)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const u={};for(const h in this._tiles){const g=this._tiles[h];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),u[g.tileID.key]=g}this._tiles=u;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,a,u,h,g,b){const T={},E={},k=Object.keys(e),z=j.now();for(const M of k){const B=e[M],Z=this._tiles[M];if(!Z||Z.fadeEndTime!==0&&Z.fadeEndTime<=z)continue;const q=this.findLoadedParent(B,a),Y=this.findLoadedSibling(B),G=q||Y||null;G&&(this._addTile(G.tileID),T[G.tileID.key]=G.tileID),E[M]=B}this._retainLoadedChildren(E,h,u,e);for(const M in T)e[M]||(this._coveredTiles[M]=!0,e[M]=T[M]);if(b){const M={},B={};for(const Z of g)this._tiles[Z.key].hasData()?M[Z.key]=Z:B[Z.key]=Z;for(const Z in B){const q=B[Z].children(this._source.maxzoom);this._tiles[q[0].key]&&this._tiles[q[1].key]&&this._tiles[q[2].key]&&this._tiles[q[3].key]&&(M[q[0].key]=e[q[0].key]=q[0],M[q[1].key]=e[q[1].key]=q[1],M[q[2].key]=e[q[2].key]=q[2],M[q[3].key]=e[q[3].key]=q[3],delete B[Z])}for(const Z in B){const q=B[Z],Y=this.findLoadedParent(q,this._source.minzoom),G=this.findLoadedSibling(q),te=Y||G||null;if(te){M[te.tileID.key]=e[te.tileID.key]=te.tileID;for(const ae in M)M[ae].isChildOf(te.tileID)&&delete M[ae]}}for(const Z in this._tiles)M[Z]||(this._coveredTiles[Z]=!0)}}update(e,a){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new c.S(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(u=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(u=u.filter(z=>this._source.hasTile(z)))):u=[];const h=e.coveringZoomLevel(this._source),g=Math.max(h-gt.maxOverzooming,this._source.minzoom),b=Math.max(h+gt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const M of u)if(M.canonical.z>this._source.minzoom){const B=M.scaledTo(M.canonical.z-1);z[B.key]=B;const Z=M.scaledTo(Math.max(this._source.minzoom,Math.min(M.canonical.z,5)));z[Z.key]=Z}u=u.concat(Object.values(z))}const T=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(u,h);Sr(this._source.type)&&this._updateCoveredAndRetainedTiles(E,g,b,h,u,a);for(const z in E)this._tiles[z].clearFadeHold();const k=c.ab(this._tiles,E);for(const z of k){const M=this._tiles[z];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var u;const h={},g={},b=Math.max(a-gt.maxOverzooming,this._source.minzoom),T=Math.max(a+gt.maxUnderzooming,this._source.minzoom),E={};for(const k of e){const z=this._addTile(k);h[k.key]=k,z.hasData()||a<this._source.maxzoom&&(E[k.key]=k)}this._retainLoadedChildren(E,a,T,h);for(const k of e){let z=this._tiles[k.key];if(z.hasData())continue;if(a+1>this._source.maxzoom){const B=k.children(this._source.maxzoom)[0],Z=this.getTile(B);if(Z&&Z.hasData()){h[B.key]=B;continue}}else{const B=k.children(this._source.maxzoom);if(h[B[0].key]&&h[B[1].key]&&h[B[2].key]&&h[B[3].key])continue}let M=z.wasRequested();for(let B=k.overscaledZ-1;B>=b;--B){const Z=k.scaledTo(B);if(g[Z.key])break;if(g[Z.key]=!0,z=this.getTile(Z),!z&&M&&(z=this._addTile(Z)),z){const q=z.hasData();if((q||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||M)&&(h[Z.key]=Z),M=z.wasRequested(),q)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let u,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){u=this._loadedParentTiles[h.key];break}a.push(h.key);const g=h.scaledTo(h.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;h=g}for(const g of a)this._loadedParentTiles[g]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const a=this._tiles[e].tileID,u=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=u}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const u=a;return a||(a=new pi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,u||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=a.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){const a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,u){const h=[],g=this.transform;if(!g)return h;const b=u?g.getCameraQueryGeometry(e):e,T=e.map(q=>g.pointCoordinate(q,this.terrain)),E=b.map(q=>g.pointCoordinate(q,this.terrain)),k=this.getIds();let z=1/0,M=1/0,B=-1/0,Z=-1/0;for(const q of E)z=Math.min(z,q.x),M=Math.min(M,q.y),B=Math.max(B,q.x),Z=Math.max(Z,q.y);for(let q=0;q<k.length;q++){const Y=this._tiles[k[q]];if(Y.holdingForFade())continue;const G=Y.tileID,te=Math.pow(2,g.zoom-Y.tileID.overscaledZ),ae=a*Y.queryPadding*c.X/Y.tileSize/te,K=[G.getTilePoint(new c.Z(z,M)),G.getTilePoint(new c.Z(B,Z))];if(K[0].x-ae<c.X&&K[0].y-ae<c.X&&K[1].x+ae>=0&&K[1].y+ae>=0){const de=T.map(_e=>G.getTilePoint(_e)),ge=E.map(_e=>G.getTilePoint(_e));h.push({tile:Y,tileID:G,queryGeometry:de,cameraQueryGeometry:ge,scale:te})}}return h}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);for(const u of a)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Sr(this._source.type)){const e=j.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,u){this._state.updateState(e=e||"_geojsonTileLayer",a,u)}removeFeatureState(e,a,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,u)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,u){const h=this._tiles[e];h&&h.setDependencies(a,u)}reloadTilesForDependencies(e,a){for(const u in this._tiles)this._tiles[u].hasDependency(e,a)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,a))}}function Yn(m,e){const a=Math.abs(2*m.wrap)-+(m.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return m.overscaledZ-e.overscaledZ||u-a||e.canonical.y-m.canonical.y||e.canonical.x-m.canonical.x}function Sr(m){return m==="raster"||m==="image"||m==="video"}gt.maxOverzooming=10,gt.maxUnderzooming=3;class Tt{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ac(e,0,1);let a=1,u=this._distances[a];const h=e*this.paddedLength+this.padding;for(;u<h&&a<this._distances.length;)u=this._distances[++a];const g=a-1,b=this._distances[g],T=u-b,E=T>0?(h-b)/T:0;return this.points[g].mult(1-E).add(this.points[a].mult(E))}}function Jr(m,e){let a=!0;return m==="always"||m!=="never"&&e!=="never"||(a=!1),a}class Yr{constructor(e,a,u){const h=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(a/u);for(let b=0;b<this.xCellCount*this.yCellCount;b++)h.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,u,h,g){this._forEachCell(a,u,h,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(g)}insertCircle(e,a,u,h){this._forEachCell(a-h,u-h,a+h,u+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(u),this.circles.push(h)}_insertBoxCell(e,a,u,h,g,b){this.boxCells[g].push(b)}_insertCircleCell(e,a,u,h,g,b){this.circleCells[g].push(b)}_query(e,a,u,h,g,b,T){if(u<0||e>this.width||h<0||a>this.height)return[];const E=[];if(e<=0&&a<=0&&this.width<=u&&this.height<=h){if(g)return[{key:null,x1:e,y1:a,x2:u,y2:h}];for(let k=0;k<this.boxKeys.length;k++)E.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const z=this.circles[3*k],M=this.circles[3*k+1],B=this.circles[3*k+2];E.push({key:this.circleKeys[k],x1:z-B,y1:M-B,x2:z+B,y2:M+B})}}else this._forEachCell(e,a,u,h,this._queryCell,E,{hitTest:g,overlapMode:b,seenUids:{box:{},circle:{}}},T);return E}query(e,a,u,h){return this._query(e,a,u,h,!1,null)}hitTest(e,a,u,h,g,b){return this._query(e,a,u,h,!0,g,b).length>0}hitTestCircle(e,a,u,h,g){const b=e-u,T=e+u,E=a-u,k=a+u;if(T<0||b>this.width||k<0||E>this.height)return!1;const z=[];return this._forEachCell(b,E,T,k,this._queryCellCircle,z,{hitTest:!0,overlapMode:h,circle:{x:e,y:a,radius:u},seenUids:{box:{},circle:{}}},g),z.length>0}_queryCell(e,a,u,h,g,b,T,E){const{seenUids:k,hitTest:z,overlapMode:M}=T,B=this.boxCells[g];if(B!==null){const q=this.bboxes;for(const Y of B)if(!k.box[Y]){k.box[Y]=!0;const G=4*Y,te=this.boxKeys[Y];if(e<=q[G+2]&&a<=q[G+3]&&u>=q[G+0]&&h>=q[G+1]&&(!E||E(te))&&(!z||!Jr(M,te.overlapMode))&&(b.push({key:te,x1:q[G],y1:q[G+1],x2:q[G+2],y2:q[G+3]}),z))return!0}}const Z=this.circleCells[g];if(Z!==null){const q=this.circles;for(const Y of Z)if(!k.circle[Y]){k.circle[Y]=!0;const G=3*Y,te=this.circleKeys[Y];if(this._circleAndRectCollide(q[G],q[G+1],q[G+2],e,a,u,h)&&(!E||E(te))&&(!z||!Jr(M,te.overlapMode))){const ae=q[G],K=q[G+1],de=q[G+2];if(b.push({key:te,x1:ae-de,y1:K-de,x2:ae+de,y2:K+de}),z)return!0}}}return!1}_queryCellCircle(e,a,u,h,g,b,T,E){const{circle:k,seenUids:z,overlapMode:M}=T,B=this.boxCells[g];if(B!==null){const q=this.bboxes;for(const Y of B)if(!z.box[Y]){z.box[Y]=!0;const G=4*Y,te=this.boxKeys[Y];if(this._circleAndRectCollide(k.x,k.y,k.radius,q[G+0],q[G+1],q[G+2],q[G+3])&&(!E||E(te))&&!Jr(M,te.overlapMode))return b.push(!0),!0}}const Z=this.circleCells[g];if(Z!==null){const q=this.circles;for(const Y of Z)if(!z.circle[Y]){z.circle[Y]=!0;const G=3*Y,te=this.circleKeys[Y];if(this._circlesCollide(q[G],q[G+1],q[G+2],k.x,k.y,k.radius)&&(!E||E(te))&&!Jr(M,te.overlapMode))return b.push(!0),!0}}}_forEachCell(e,a,u,h,g,b,T,E){const k=this._convertToXCellCoord(e),z=this._convertToYCellCoord(a),M=this._convertToXCellCoord(u),B=this._convertToYCellCoord(h);for(let Z=k;Z<=M;Z++)for(let q=z;q<=B;q++)if(g.call(this,e,a,u,h,this.xCellCount*q+Z,b,T,E))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,u,h,g,b){const T=h-e,E=g-a,k=u+b;return k*k>T*T+E*E}_circleAndRectCollide(e,a,u,h,g,b,T){const E=(b-h)/2,k=Math.abs(e-(h+E));if(k>E+u)return!1;const z=(T-g)/2,M=Math.abs(a-(g+z));if(M>z+u)return!1;if(k<=E||M<=z)return!0;const B=k-E,Z=M-z;return B*B+Z*Z<=u*u}}function Br(m,e,a,u,h){const g=c.H();return e?(c.K(g,g,[1/h,1/h,1]),a||c.ad(g,g,u.angle)):c.L(g,u.labelPlaneMatrix,m),g}function Or(m,e,a,u,h){if(e){const g=c.ae(m);return c.K(g,g,[h,h,1]),a||c.ad(g,g,-u.angle),g}return u.glCoordMatrix}function Q(m,e,a){let u;a?(u=[m.x,m.y,a(m.x,m.y),1],c.af(u,u,e)):(u=[m.x,m.y,0,1],function(g,b,T){const E=b[0],k=b[1];g[0]=T[0]*E+T[4]*k+T[12],g[1]=T[1]*E+T[5]*k+T[13],g[3]=T[3]*E+T[7]*k+T[15]}(u,u,e));const h=u[3];return{point:new c.P(u[0]/h,u[1]/h),signedDistanceFromCamera:h,isOccluded:!1}}function L(m,e){return .5+m/e*.5}function R(m,e){return m.x>=-e[0]&&m.x<=e[0]&&m.y>=-e[1]&&m.y<=e[1]}function $(m,e,a,u,h,g,b,T,E,k,z,M,B,Z,q){const Y=u?m.textSizeData:m.iconSizeData,G=c.ag(Y,a.transform.zoom),te=[256/a.width*2+1,256/a.height*2+1],ae=u?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ae.clear();const K=m.lineVertexArray,de=u?m.text.placedSymbolArray:m.icon.placedSymbolArray,ge=a.transform.width/a.transform.height;let _e=!1;for(let Me=0;Me<de.length;Me++){const Be=de.get(Me);if(Be.hidden||Be.writingMode===c.ah.vertical&&!_e){ce(Be.numGlyphs,ae);continue}_e=!1;const Je=Q(new c.P(Be.anchorX,Be.anchorY),e,q);if(!R(Je.point,te)){ce(Be.numGlyphs,ae);continue}const Ye=L(a.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),Oe=c.ai(Y,G,Be),je=b?Oe/Ye:Oe*Ye,st={getElevation:q,labelPlaneMatrix:h,lineVertexArray:K,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:k,tileAnchorPoint:new c.P(Be.anchorX,Be.anchorY),unwrappedTileID:z,width:M,height:B,translation:Z},Ct=he(st,Be,je,!1,T,e,g,m.glyphOffsetArray,ae,ge,E);_e=Ct.useVertical,(Ct.notEnoughRoom||_e||Ct.needsFlipping&&he(st,Be,je,!0,T,e,g,m.glyphOffsetArray,ae,ge,E).notEnoughRoom)&&ce(Be.numGlyphs,ae)}u?m.text.dynamicLayoutVertexBuffer.updateData(ae):m.icon.dynamicLayoutVertexBuffer.updateData(ae)}function X(m,e,a,u,h,g,b,T){const E=g.glyphStartIndex+g.numGlyphs,k=g.lineStartIndex,z=g.lineStartIndex+g.lineLength,M=e.getoffsetX(g.glyphStartIndex),B=e.getoffsetX(E-1),Z=H(m*M,a,u,h,g.segment,k,z,T,b);if(!Z)return null;const q=H(m*B,a,u,h,g.segment,k,z,T,b);return q?T.projectionCache.anyProjectionOccluded?null:{first:Z,last:q}:null}function se(m,e,a,u){return m===c.ah.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*u?{useVertical:!0}:(m===c.ah.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function he(m,e,a,u,h,g,b,T,E,k,z){const M=a/24,B=e.lineOffsetX*M,Z=e.lineOffsetY*M;let q;if(e.numGlyphs>1){const Y=e.glyphStartIndex+e.numGlyphs,G=e.lineStartIndex,te=e.lineStartIndex+e.lineLength,ae=X(M,T,B,Z,u,e,z,m);if(!ae)return{notEnoughRoom:!0};const K=Q(ae.first.point,b,m.getElevation).point,de=Q(ae.last.point,b,m.getElevation).point;if(h&&!u){const ge=se(e.writingMode,K,de,k);if(ge)return ge}q=[ae.first];for(let ge=e.glyphStartIndex+1;ge<Y-1;ge++)q.push(H(M*T.getoffsetX(ge),B,Z,u,e.segment,G,te,m,z));q.push(ae.last)}else{if(h&&!u){const G=Q(m.tileAnchorPoint,g,m.getElevation).point,te=e.lineStartIndex+e.segment+1,ae=new c.P(m.lineVertexArray.getx(te),m.lineVertexArray.gety(te)),K=Q(ae,g,m.getElevation),de=K.signedDistanceFromCamera>0?K.point:function(_e,Me,Be,Je,Ye,Oe){return me(_e,Me,Be,1,Ye,Oe)}(m.tileAnchorPoint,ae,G,0,g,m),ge=se(e.writingMode,G,de,k);if(ge)return ge}const Y=H(M*T.getoffsetX(e.glyphStartIndex),B,Z,u,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,m,z);if(!Y||m.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};q=[Y]}for(const Y of q)c.aj(E,Y.point,Y.angle);return{}}function me(m,e,a,u,h,g){const b=m.add(m.sub(e)._unit()),T=h!==void 0?Q(b,h,g.getElevation).point:Te(b.x,b.y,g).point,E=a.sub(T);return a.add(E._mult(u/E.mag()))}function ie(m,e,a){const u=e.projectionCache;if(u.projections[m])return u.projections[m];const h=new c.P(e.lineVertexArray.getx(m),e.lineVertexArray.gety(m)),g=Te(h.x,h.y,e);if(g.signedDistanceFromCamera>0)return u.projections[m]=g.point,u.anyProjectionOccluded=u.anyProjectionOccluded||g.isOccluded,g.point;const b=m-a.direction;return function(T,E,k,z,M){return me(T,E,k,z,void 0,M)}(a.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),h,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Te(m,e,a){const u=m+a.translation[0],h=e+a.translation[1];let g;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(g=a.projection.projectTileCoordinates(u,h,a.unwrappedTileID,a.getElevation),g.point.x=(.5*g.point.x+.5)*a.width,g.point.y=(.5*-g.point.y+.5)*a.height):(g=Q(new c.P(u,h),a.labelPlaneMatrix,a.getElevation),g.isOccluded=!1),g}function ze(m,e,a){return m._unit()._perp()._mult(e*a)}function ve(m,e,a,u,h,g,b,T,E){if(T.projectionCache.offsets[m])return T.projectionCache.offsets[m];const k=a.add(e);if(m+E.direction<u||m+E.direction>=h)return T.projectionCache.offsets[m]=k,k;const z=ie(m+E.direction,T,E),M=ze(z.sub(a),b,E.direction),B=a.add(M),Z=z.add(M);return T.projectionCache.offsets[m]=c.ak(g,k,B,Z)||k,T.projectionCache.offsets[m]}function H(m,e,a,u,h,g,b,T,E){const k=u?m-e:m+e;let z=k>0?1:-1,M=0;u&&(z*=-1,M=Math.PI),z<0&&(M+=Math.PI);let B,Z=z>0?g+h:g+h+1;T.projectionCache.cachedAnchorPoint?B=T.projectionCache.cachedAnchorPoint:(B=Te(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=B);let q,Y,G=B,te=B,ae=0,K=0;const de=Math.abs(k),ge=[];let _e;for(;ae+K<=de;){if(Z+=z,Z<g||Z>=b)return null;ae+=K,te=G,Y=q;const Je={absOffsetX:de,direction:z,distanceFromAnchor:ae,previousVertex:te};if(G=ie(Z,T,Je),a===0)ge.push(te),_e=G.sub(te);else{let Ye;const Oe=G.sub(te);Ye=Oe.mag()===0?ze(ie(Z+z,T,Je).sub(G),a,z):ze(Oe,a,z),Y||(Y=te.add(Ye)),q=ve(Z,Ye,G,g,b,Y,a,T,Je),ge.push(Y),_e=q.sub(Y)}K=_e.mag()}const Me=_e._mult((de-ae)/K)._add(Y||te),Be=M+Math.atan2(G.y-te.y,G.x-te.x);return ge.push(Me),{point:Me,angle:E?Be:0,path:ge}}const ee=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ce(m,e){for(let a=0;a<m;a++){const u=e.length;e.resize(u+4),e.float32.set(ee,3*u)}}const xe=100;class Re{constructor(e,a,u=new Yr(e.width+200,e.height+200,25),h=new Yr(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=a,this.grid=u,this.ignoredGrid=h,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+xe,this.screenBottomBoundary=e.height+xe,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,u,h,g,b,T,E,k,z,M){const B=e.anchorPointX+E[0],Z=e.anchorPointY+E[1],q=this.projectAndGetPerspectiveRatio(h,B,Z,g,z),Y=this._projectCollisionBox(e,u,h,g,b,T,E,q,z,M),[G,te,ae,K]=Y.box;return this.mapProjection.useSpecialProjectionForSymbols&&(b?Y.allPointsOccluded:this.mapProjection.isOccluded(B,Z,g))||q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(G,te,ae,K)||a!=="always"&&this.grid.hitTest(G,te,ae,K,a,k)?{box:[G,te,ae,K],placeable:!1,offscreen:!1}:{box:[G,te,ae,K],placeable:!0,offscreen:this.isOffscreen(G,te,ae,K)}}placeCollisionCircles(e,a,u,h,g,b,T,E,k,z,M,B,Z,q,Y,G){const te=[],ae=new c.P(a.anchorX,a.anchorY),K=this.getPerspectiveRatio(b,ae.x,ae.y,T,G),de=(M?g/K:g*K)/c.ap,ge={getElevation:G,labelPlaneMatrix:E,lineVertexArray:u,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ae,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:Y},_e=X(de,h,a.lineOffsetX*de,a.lineOffsetY*de,!1,a,!1,ge);let Me=!1,Be=!1,Je=!0;if(_e){const Ye=.5*Z*K+q,Oe=new c.P(-100,-100),je=new c.P(this.screenRightBoundary,this.screenBottomBoundary),st=new Tt,Ct=_e.first,qe=_e.last;let Ge=[];for(let zt=Ct.path.length-1;zt>=1;zt--)Ge.push(Ct.path[zt]);for(let zt=1;zt<qe.path.length;zt++)Ge.push(qe.path[zt]);const bt=2.5*Ye;if(k){const zt=this.projectPathToScreenSpace(Ge,ge,k);Ge=zt.some(Lt=>Lt.signedDistanceFromCamera<=0)?[]:zt.map(Lt=>Lt.point)}let tn=[];if(Ge.length>0){const zt=Ge[0].clone(),Lt=Ge[0].clone();for(let an=1;an<Ge.length;an++)zt.x=Math.min(zt.x,Ge[an].x),zt.y=Math.min(zt.y,Ge[an].y),Lt.x=Math.max(Lt.x,Ge[an].x),Lt.y=Math.max(Lt.y,Ge[an].y);tn=zt.x>=Oe.x&&Lt.x<=je.x&&zt.y>=Oe.y&&Lt.y<=je.y?[Ge]:Lt.x<Oe.x||zt.x>je.x||Lt.y<Oe.y||zt.y>je.y?[]:c.al([Ge],Oe.x,Oe.y,je.x,je.y)}for(const zt of tn){st.reset(zt,.25*Ye);let Lt=0;Lt=st.length<=.5*Ye?1:Math.ceil(st.paddedLength/bt)+1;for(let an=0;an<Lt;an++){const rr=an/Math.max(Lt-1,1),_i=st.lerp(rr),sn=_i.x+xe,Er=_i.y+xe;te.push(sn,Er,Ye,0);const fr=sn-Ye,ir=Er-Ye,or=sn+Ye,vi=Er+Ye;if(Je=Je&&this.isOffscreen(fr,ir,or,vi),Be=Be||this.isInsideGrid(fr,ir,or,vi),e!=="always"&&this.grid.hitTestCircle(sn,Er,Ye,e,B)&&(Me=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Me}}}}return{circles:!z&&Me||!Be||K<this.perspectiveRatioCutoff?[]:te,offscreen:Je,collisionDetected:Me}}projectPathToScreenSpace(e,a,u){return e.map(h=>Q(h,u,a.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let u=1/0,h=1/0,g=-1/0,b=-1/0;for(const z of e){const M=new c.P(z.x+xe,z.y+xe);u=Math.min(u,M.x),h=Math.min(h,M.y),g=Math.max(g,M.x),b=Math.max(b,M.y),a.push(M)}const T=this.grid.query(u,h,g,b).concat(this.ignoredGrid.query(u,h,g,b)),E={},k={};for(const z of T){const M=z.key;if(E[M.bucketInstanceId]===void 0&&(E[M.bucketInstanceId]={}),E[M.bucketInstanceId][M.featureIndex])continue;const B=[new c.P(z.x1,z.y1),new c.P(z.x2,z.y1),new c.P(z.x2,z.y2),new c.P(z.x1,z.y2)];c.am(a,B)&&(E[M.bucketInstanceId][M.featureIndex]=!0,k[M.bucketInstanceId]===void 0&&(k[M.bucketInstanceId]=[]),k[M.bucketInstanceId].push(M.featureIndex))}return k}insertCollisionBox(e,a,u,h,g,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:b,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,u,h,g,b){const T=u?this.ignoredGrid:this.grid,E={bucketInstanceId:h,featureIndex:g,collisionGroupID:b,overlapMode:a};for(let k=0;k<e.length;k+=4)T.insertCircle(E,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,a,u,h,g){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,u,h,g):Q(new c.P(a,u),e,g);return{point:new c.P((b.point.x+1)/2*this.transform.width+xe,(1-b.point.y)/2*this.transform.height+xe),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5,isOccluded:b.isOccluded,signedDistanceFromCamera:b.signedDistanceFromCamera}}getPerspectiveRatio(e,a,u,h,g){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,u,h,g):Q(new c.P(a,u),e,g);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(e,a,u,h){return u<xe||e>=this.screenRightBoundary||h<xe||a>this.screenBottomBoundary}isInsideGrid(e,a,u,h){return u>=0&&e<this.gridRightBoundary&&h>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=c.an([]);return c.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,u,h,g,b,T,E,k,z){const M=a*E.perspectiveRatio;let B=new c.P(1,0),Z=new c.P(0,1);const q=new c.P(e.anchorPointX+T[0],e.anchorPointY+T[1]);if(b&&!g){const Ye=this.projectAndGetPerspectiveRatio(u,q.x+1,q.y,h,k).point.sub(E.point).unit(),Oe=Math.atan(Ye.y/Ye.x)+(Ye.x<0?Math.PI:0),je=Math.sin(Oe),st=Math.cos(Oe);B=new c.P(st,je),Z=new c.P(-je,st)}else if(!b&&g){const Ye=-this.transform.angle,Oe=Math.sin(Ye),je=Math.cos(Ye);B=new c.P(je,Oe),Z=new c.P(-Oe,je)}let Y=E.point,G=M;if(g){Y=q;const Ye=this.transform.zoom-Math.floor(this.transform.zoom);G=Math.pow(2,-Ye),G*=this.mapProjection.getPitchedTextCorrection(this.transform,q,h),z||(G*=c.ac(.5+E.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}z&&(Y=Y.add(B.mult(z.x*G)).add(Z.mult(z.y*G)));const te=e.x1*G,ae=e.x2*G,K=(te+ae)/2,de=e.y1*G,ge=e.y2*G,_e=(de+ge)/2,Me=[{offsetX:te,offsetY:de},{offsetX:K,offsetY:de},{offsetX:ae,offsetY:de},{offsetX:ae,offsetY:_e},{offsetX:ae,offsetY:ge},{offsetX:K,offsetY:ge},{offsetX:te,offsetY:ge},{offsetX:te,offsetY:_e}];let Be=[];for(const{offsetX:Ye,offsetY:Oe}of Me)Be.push(new c.P(Y.x+B.x*Ye+Z.x*Oe,Y.y+B.y*Ye+Z.y*Oe));let Je=!1;if(g){const Ye=Be.map(Oe=>this.projectAndGetPerspectiveRatio(u,Oe.x,Oe.y,h,k));Je=Ye.some(Oe=>!Oe.isOccluded),Be=Ye.map(Oe=>Oe.point)}else Je=!0;return{box:c.ao(Be),allPointsOccluded:!Je}}}function Ae(m,e,a){return e*(c.X/(m.tileSize*Math.pow(2,a-m.tileID.overscaledZ)))}class nt{constructor(e,a,u,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):h&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Fe{constructor(e,a,u,h,g){this.text=new nt(e?e.text:null,a,u,g),this.icon=new nt(e?e.icon:null,a,h,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class mt{constructor(e,a,u){this.text=e,this.icon=a,this.skipFade=u}}class Ve{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class at{constructor(e,a,u,h,g){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=u,this.bucketIndex=h,this.tileID=g}}class xt{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:u=>u.collisionGroupID===a}}return this.collisionGroups[e]}}function kt(m,e,a,u,h){const{horizontalAlign:g,verticalAlign:b}=c.au(m);return new c.P(-(g-.5)*e+u[0]*h,-(b-.5)*a+u[1]*h)}class At{constructor(e,a,u,h,g,b){this.transform=e.clone(),this.terrain=u,this.collisionIndex=new Re(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new xt(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(u,h)=>a.getElevation(e,u,h):null}getBucketParts(e,a,u,h){const g=u.getBucket(a),b=u.latestFeatureIndex;if(!g||!b||a.id!==g.layerIds[0])return;const T=u.collisionBoxArray,E=g.layers[0].layout,k=g.layers[0].paint,z=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),M=u.tileSize/c.X,B=u.tileID.toUnwrapped(),Z=this.transform.calculatePosMatrix(B),q=E.get("text-pitch-alignment")==="map",Y=E.get("text-rotation-alignment")==="map",G=Ae(u,1,this.transform.zoom),te=this.collisionIndex.mapProjection.translatePosition(this.transform,u,k.get("text-translate"),k.get("text-translate-anchor")),ae=this.collisionIndex.mapProjection.translatePosition(this.transform,u,k.get("icon-translate"),k.get("icon-translate-anchor")),K=Br(Z,q,Y,this.transform,G);let de=null;if(q){const _e=Or(Z,q,Y,this.transform,G);de=c.L([],this.transform.labelPlaneMatrix,_e)}this.retainedQueryData[g.bucketInstanceId]=new at(g.bucketInstanceId,b,g.sourceLayerIndex,g.index,u.tileID);const ge={bucket:g,layout:E,translationText:te,translationIcon:ae,posMatrix:Z,unwrappedTileID:B,textLabelPlaneMatrix:K,labelToScreenMatrix:de,scale:z,textPixelRatio:M,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:c.ag(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(h)for(const _e of g.sortKeyRanges){const{sortKey:Me,symbolInstanceStart:Be,symbolInstanceEnd:Je}=_e;e.push({sortKey:Me,symbolInstanceStart:Be,symbolInstanceEnd:Je,parameters:ge})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:ge})}attemptAnchorPlacement(e,a,u,h,g,b,T,E,k,z,M,B,Z,q,Y,G,te,ae,K){const de=c.aq[e.textAnchor],ge=[e.textOffset0,e.textOffset1],_e=kt(de,u,h,ge,g),Me=this.collisionIndex.placeCollisionBox(a,B,E,k,z,T,b,G,M.predicate,K,_e);if((!ae||this.collisionIndex.placeCollisionBox(ae,B,E,k,z,T,b,te,M.predicate,K,_e).placeable)&&Me.placeable){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),Z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Z.crossTileID]={textOffset:ge,width:u,height:h,anchor:de,textBoxScale:g,prevAnchor:Be},this.markUsedJustification(q,de,Z,Y),q.allowVerticalPlacement&&(this.markUsedOrientation(q,Y,Z),this.placedOrientations[Z.crossTileID]=Y),{shift:_e,placedGlyphBoxes:Me}}}placeLayerBucketPart(e,a,u){const{bucket:h,layout:g,translationText:b,translationIcon:T,posMatrix:E,unwrappedTileID:k,textLabelPlaneMatrix:z,labelToScreenMatrix:M,textPixelRatio:B,holdingForFade:Z,collisionBoxArray:q,partiallyEvaluatedTextSize:Y,collisionGroup:G}=e.parameters,te=g.get("text-optional"),ae=g.get("icon-optional"),K=c.ar(g,"text-overlap","text-allow-overlap"),de=K==="always",ge=c.ar(g,"icon-overlap","icon-allow-overlap"),_e=ge==="always",Me=g.get("text-rotation-alignment")==="map",Be=g.get("text-pitch-alignment")==="map",Je=g.get("icon-text-fit")!=="none",Ye=g.get("symbol-z-order")==="viewport-y",Oe=de&&(_e||!h.hasIconData()||ae),je=_e&&(de||!h.hasTextData()||te);!h.collisionArrays&&q&&h.deserializeCollisionBoxes(q);const st=this._getTerrainElevationFunc(this.retainedQueryData[h.bucketInstanceId].tileID),Ct=(qe,Ge,bt)=>{var tn,zt;if(a[qe.crossTileID])return;if(Z)return void(this.placements[qe.crossTileID]=new mt(!1,!1,!1));let Lt=!1,an=!1,rr=!0,_i=null,sn={box:null,placeable:!1,offscreen:null},Er={box:null,placeable:!1,offscreen:null},fr=null,ir=null,or=null,vi=0,Zo=0,ws=0;Ge.textFeatureIndex?vi=Ge.textFeatureIndex:qe.useRuntimeCollisionCircles&&(vi=qe.featureIndex),Ge.verticalTextFeatureIndex&&(Zo=Ge.verticalTextFeatureIndex);const qo=Ge.textBox;if(qo){const ti=mr=>{let ar=c.ah.horizontal;if(h.allowVerticalPlacement&&!mr&&this.prevPlacement){const $r=this.prevPlacement.placedOrientations[qe.crossTileID];$r&&(this.placedOrientations[qe.crossTileID]=$r,ar=$r,this.markUsedOrientation(h,ar,qe))}return ar},xi=(mr,ar)=>{if(h.allowVerticalPlacement&&qe.numVerticalGlyphVertices>0&&Ge.verticalTextBox){for(const $r of h.writingModes)if($r===c.ah.vertical?(sn=ar(),Er=sn):sn=mr(),sn&&sn.placeable)break}else sn=mr()},wo=qe.textAnchorOffsetStartIndex,wi=qe.textAnchorOffsetEndIndex;if(wi===wo){const mr=(ar,$r)=>{const xn=this.collisionIndex.placeCollisionBox(ar,K,B,E,k,Be,Me,b,G.predicate,st);return xn&&xn.placeable&&(this.markUsedOrientation(h,$r,qe),this.placedOrientations[qe.crossTileID]=$r),xn};xi(()=>mr(qo,c.ah.horizontal),()=>{const ar=Ge.verticalTextBox;return h.allowVerticalPlacement&&qe.numVerticalGlyphVertices>0&&ar?mr(ar,c.ah.vertical):{box:null,offscreen:null}}),ti(sn&&sn.placeable)}else{let mr=c.aq[(zt=(tn=this.prevPlacement)===null||tn===void 0?void 0:tn.variableOffsets[qe.crossTileID])===null||zt===void 0?void 0:zt.anchor];const ar=(xn,ba,bo)=>{const bs=xn.x2-xn.x1,Ef=xn.y2-xn.y1,Cf=qe.textBoxScale,Qn=Je&&ge==="never"?ba:null;let So=null,Ss=K==="never"?1:2,Ts="never";mr&&Ss++;for(let cc=0;cc<Ss;cc++){for(let hc=wo;hc<wi;hc++){const dc=h.textAnchorOffsets.get(hc);if(mr&&dc.textAnchor!==mr)continue;const zl=this.attemptAnchorPlacement(dc,xn,bs,Ef,Cf,Me,Be,B,E,k,G,Ts,qe,h,bo,b,T,Qn,st);if(zl&&(So=zl.placedGlyphBoxes,So&&So.placeable))return Lt=!0,_i=zl.shift,So}mr?mr=null:Ts=K}return u&&!So&&(So={box:this.collisionIndex.placeCollisionBox(qo,"always",B,E,k,Be,Me,b,G.predicate,st,new c.P(0,0)).box,offscreen:!1,placeable:!1}),So};xi(()=>ar(qo,Ge.iconBox,c.ah.horizontal),()=>{const xn=Ge.verticalTextBox;return h.allowVerticalPlacement&&(!sn||!sn.placeable)&&qe.numVerticalGlyphVertices>0&&xn?ar(xn,Ge.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),sn&&(Lt=sn.placeable,rr=sn.offscreen);const $r=ti(sn&&sn.placeable);if(!Lt&&this.prevPlacement){const xn=this.prevPlacement.variableOffsets[qe.crossTileID];xn&&(this.variableOffsets[qe.crossTileID]=xn,this.markUsedJustification(h,xn.anchor,qe,$r))}}}if(fr=sn,Lt=fr&&fr.placeable,rr=fr&&fr.offscreen,qe.useRuntimeCollisionCircles){const ti=h.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex),xi=c.ai(h.textSizeData,Y,ti),wo=g.get("text-padding");ir=this.collisionIndex.placeCollisionCircles(K,ti,h.lineVertexArray,h.glyphOffsetArray,xi,E,k,z,M,u,Be,G.predicate,qe.collisionCircleDiameter,wo,b,st),ir.circles.length&&ir.collisionDetected&&!u&&c.w("Collisions detected, but collision boxes are not shown"),Lt=de||ir.circles.length>0&&!ir.collisionDetected,rr=rr&&ir.offscreen}if(Ge.iconFeatureIndex&&(ws=Ge.iconFeatureIndex),Ge.iconBox){const ti=xi=>this.collisionIndex.placeCollisionBox(xi,ge,B,E,k,Be,Me,T,G.predicate,st,Je&&_i?_i:void 0);Er&&Er.placeable&&Ge.verticalIconBox?(or=ti(Ge.verticalIconBox),an=or.placeable):(or=ti(Ge.iconBox),an=or.placeable),rr=rr&&or.offscreen}const xo=te||qe.numHorizontalGlyphVertices===0&&qe.numVerticalGlyphVertices===0,Ml=ae||qe.numIconVertices===0;xo||Ml?Ml?xo||(an=an&&Lt):Lt=an&&Lt:an=Lt=an&&Lt;const uc=an&&or.placeable;if(Lt&&fr.placeable&&this.collisionIndex.insertCollisionBox(fr.box,K,g.get("text-ignore-placement"),h.bucketInstanceId,Er&&Er.placeable&&Zo?Zo:vi,G.ID),uc&&this.collisionIndex.insertCollisionBox(or.box,ge,g.get("icon-ignore-placement"),h.bucketInstanceId,ws,G.ID),ir&&Lt&&this.collisionIndex.insertCollisionCircles(ir.circles,K,g.get("text-ignore-placement"),h.bucketInstanceId,vi,G.ID),u&&this.storeCollisionData(h.bucketInstanceId,bt,Ge,fr,or,ir),qe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[qe.crossTileID]=new mt(Lt||Oe,an||je,rr||h.justReloaded),a[qe.crossTileID]=!0};if(Ye){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const qe=h.getSortedSymbolIndexes(this.transform.angle);for(let Ge=qe.length-1;Ge>=0;--Ge){const bt=qe[Ge];Ct(h.symbolInstances.get(bt),h.collisionArrays[bt],bt)}}else for(let qe=e.symbolInstanceStart;qe<e.symbolInstanceEnd;qe++)Ct(h.symbolInstances.get(qe),h.collisionArrays[qe],qe);if(u&&h.bucketInstanceId in this.collisionCircleArrays){const qe=this.collisionCircleArrays[h.bucketInstanceId];c.as(qe.invProjMatrix,E),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}storeCollisionData(e,a,u,h,g,b){if(u.textBox||u.iconBox){let T,E;this.collisionBoxArrays.has(e)?T=this.collisionBoxArrays.get(e):(T=new Map,this.collisionBoxArrays.set(e,T)),T.has(a)?E=T.get(a):(E={text:null,icon:null},T.set(a,E)),u.textBox&&(E.text=h.box),u.iconBox&&(E.icon=g.box)}if(b){let T=this.collisionCircleArrays[e];T===void 0&&(T=this.collisionCircleArrays[e]=new Ve);for(let E=0;E<b.circles.length;E+=4)T.circles.push(b.circles[E+0]),T.circles.push(b.circles[E+1]),T.circles.push(b.circles[E+2]),T.circles.push(b.collisionDetected?1:0)}}markUsedJustification(e,a,u,h){let g;g=h===c.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[c.at(a)];const b=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const T of b)T>=0&&(e.text.placedSymbolArray.get(T).crossTileID=g>=0&&T!==g?0:u.crossTileID)}markUsedOrientation(e,a,u){const h=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,g=a===c.ah.vertical?a:0,b=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const T of b)e.text.placedSymbolArray.get(T).placedOrientation=h;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let u=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const h=a?a.symbolFadeChange(e):1,g=a?a.opacities:{},b=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const E in this.placements){const k=this.placements[E],z=g[E];z?(this.opacities[E]=new Fe(z,h,k.text,k.icon),u=u||k.text!==z.text.placed||k.icon!==z.icon.placed):(this.opacities[E]=new Fe(null,h,k.text,k.icon,k.skipFade),u=u||k.text||k.icon)}for(const E in g){const k=g[E];if(!this.opacities[E]){const z=new Fe(k,h,!1,!1);z.isHidden()||(this.opacities[E]=z,u=u||k.text.placed||k.icon.placed)}}for(const E in b)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=b[E]);for(const E in T)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=T[E]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const u={};for(const h of a){const g=h.getBucket(e);g&&h.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,h.tileID,u,h.collisionBoxArray)}}updateBucketOpacities(e,a,u,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const g=e.layers[0],b=g.layout,T=new Fe(null,0,!1,!1,!0),E=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),z=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),M=b.get("text-rotation-alignment")==="map",B=b.get("text-pitch-alignment")==="map",Z=b.get("icon-text-fit")!=="none",q=new Fe(null,0,E&&(k||!e.hasIconData()||b.get("icon-optional")),k&&(E||!e.hasTextData()||b.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const Y=(te,ae,K)=>{for(let de=0;de<ae/4;de++)te.opacityVertexArray.emplaceBack(K);te.hasVisibleVertices=te.hasVisibleVertices||K!==In},G=this.collisionBoxArrays.get(e.bucketInstanceId);for(let te=0;te<e.symbolInstances.length;te++){const ae=e.symbolInstances.get(te),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:de,crossTileID:ge}=ae;let _e=this.opacities[ge];u[ge]?_e=T:_e||(_e=q,this.opacities[ge]=_e),u[ge]=!0;const Me=ae.numIconVertices>0,Be=this.placedOrientations[ae.crossTileID],Je=Be===c.ah.vertical,Ye=Be===c.ah.horizontal||Be===c.ah.horizontalOnly;if(K>0||de>0){const je=mn(_e.text);Y(e.text,K,Je?In:je),Y(e.text,de,Ye?In:je);const st=_e.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach(Ge=>{Ge>=0&&(e.text.placedSymbolArray.get(Ge).hidden=st||Je?1:0)}),ae.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=st||Ye?1:0);const Ct=this.variableOffsets[ae.crossTileID];Ct&&this.markUsedJustification(e,Ct.anchor,ae,Be);const qe=this.placedOrientations[ae.crossTileID];qe&&(this.markUsedJustification(e,"left",ae,qe),this.markUsedOrientation(e,qe,ae))}if(Me){const je=mn(_e.icon),st=!(Z&&ae.verticalPlacedIconSymbolIndex&&Je);ae.placedIconSymbolIndex>=0&&(Y(e.icon,ae.numIconVertices,st?je:In),e.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=_e.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(Y(e.icon,ae.numVerticalIconVertices,st?In:je),e.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}const Oe=G&&G.has(te)?G.get(te):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const je=e.collisionArrays[te];if(je){let st=new c.P(0,0);if(je.textBox||je.verticalTextBox){let Ct=!0;if(z){const qe=this.variableOffsets[ge];qe?(st=kt(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textBoxScale),M&&st._rotate(B?this.transform.angle:-this.transform.angle)):Ct=!1}if(je.textBox||je.verticalTextBox){let qe;je.textBox&&(qe=Je),je.verticalTextBox&&(qe=Ye),It(e.textCollisionBox.collisionVertexArray,_e.text.placed,!Ct||qe,Oe.text,st.x,st.y)}}if(je.iconBox||je.verticalIconBox){const Ct=!!(!Ye&&je.verticalIconBox);let qe;je.iconBox&&(qe=Ct),je.verticalIconBox&&(qe=!Ct),It(e.iconCollisionBox.collisionVertexArray,_e.icon.placed,qe,Oe.icon,Z?st.x:0,Z?st.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=te.invProjMatrix,e.placementViewportMatrix=te.viewportMatrix,e.collisionCircleArray=te.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const u=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function It(m,e,a,u,h,g){u&&u.length!==0||(u=[0,0,0,0]);const b=u[0]-xe,T=u[1]-xe,E=u[2]-xe,k=u[3]-xe;m.emplaceBack(e?1:0,a?1:0,h||0,g||0,b,T),m.emplaceBack(e?1:0,a?1:0,h||0,g||0,E,T),m.emplaceBack(e?1:0,a?1:0,h||0,g||0,E,k),m.emplaceBack(e?1:0,a?1:0,h||0,g||0,b,k)}const _n=Math.pow(2,25),Et=Math.pow(2,24),Ji=Math.pow(2,17),Qr=Math.pow(2,16),On=Math.pow(2,9),Nn=Math.pow(2,8),mo=Math.pow(2,1);function mn(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const e=m.placed?1:0,a=Math.floor(127*m.opacity);return a*_n+e*Et+a*Ji+e*Qr+a*On+e*Nn+a*mo+e}const In=0;function Yi(){return{isOccluded:(m,e,a)=>!1,getPitchedTextCorrection:(m,e,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(m,e,a,u){throw new Error("Not implemented.")},translatePosition:(m,e,a,u)=>function(h,g,b,T,E=!1){if(!b[0]&&!b[1])return[0,0];const k=E?T==="map"?h.angle:0:T==="viewport"?-h.angle:0;if(k){const z=Math.sin(k),M=Math.cos(k);b=[b[0]*M-b[1]*z,b[0]*z+b[1]*M]}return[E?b[0]:Ae(g,b[0],h.zoom),E?b[1]:Ae(g,b[1],h.zoom)]}(m,e,a,u),getCircleRadiusCorrection:m=>1}}class Fi{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,u,h,g){const b=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(b,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((T,E)=>T.sortKey-E.sortKey));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class yt{constructor(e,a,u,h,g,b,T,E){this.placement=new At(e,Yi(),a,b,T,E),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,a,u){const h=j.now(),g=()=>!this._forceFullPlacement&&j.now()-h>2;for(;this._currentPlacementIndex>=0;){const b=a[e[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=T)&&(!b.maxzoom||b.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Fi(b)),this._inProgressLayer.continuePlacement(u[b.source],this.placement,this._showCollisionBoxes,b,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Gt=512/c.X/2;class Pn{constructor(e,a,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const h=new Map;for(let g=0;g<a.length;g++){const b=a.get(g),T=b.key,E=h.get(T);E?E.push(b):h.set(T,[b])}for(const[g,b]of h){const T={positions:b.map(E=>({x:Math.floor(E.anchorX*Gt),y:Math.floor(E.anchorY*Gt)})),crossTileIDs:b.map(E=>E.crossTileID)};if(T.positions.length>128){const E=new c.av(T.positions.length,16,Uint16Array);for(const{x:k,y:z}of T.positions)E.add(k,z);E.finish(),delete T.positions,T.index=E}this._symbolsByKey[g]=T}}getScaledCoordinates(e,a){const{x:u,y:h,z:g}=this.tileID.canonical,{x:b,y:T,z:E}=a.canonical,k=Gt/Math.pow(2,E-g),z=(T*c.X+e.anchorY)*k,M=h*c.X*Gt;return{x:Math.floor((b*c.X+e.anchorX)*k-u*c.X*Gt),y:Math.floor(z-M)}}findMatches(e,a,u){const h=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<e.length;g++){const b=e.get(g);if(b.crossTileID)continue;const T=this._symbolsByKey[b.key];if(!T)continue;const E=this.getScaledCoordinates(b,a);if(T.index){const k=T.index.range(E.x-h,E.y-h,E.x+h,E.y+h).sort();for(const z of k){const M=T.crossTileIDs[z];if(!u[M]){u[M]=!0,b.crossTileID=M;break}}}else if(T.positions)for(let k=0;k<T.positions.length;k++){const z=T.positions[k],M=T.crossTileIDs[k];if(Math.abs(z.x-E.x)<=h&&Math.abs(z.y-E.y)<=h&&!u[M]){u[M]=!0,b.crossTileID=M;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Pt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Tr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const u in this.indexes){const h=this.indexes[u],g={};for(const b in h){const T=h[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),g[T.tileID.key]=T}this.indexes[u]=g}this.lng=e}addBucket(e,a,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const g in this.indexes){const b=this.indexes[g];if(Number(g)>e.overscaledZ)for(const T in b){const E=b[T];E.tileID.isChildOf(e)&&E.findMatches(a.symbolInstances,e,h)}else{const T=b[e.scaledTo(Number(g)).key];T&&T.findMatches(a.symbolInstances,e,h)}}for(let g=0;g<a.symbolInstances.length;g++){const b=a.symbolInstances.get(g);b.crossTileID||(b.crossTileID=u.generate(),h[b.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Pn(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const u of a.getCrossTileIDsLists())for(const h of u)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let a=!1;for(const u in this.indexes){const h=this.indexes[u];for(const g in h)e[h[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,h[g]),delete h[g],a=!0)}return a}}class pr{constructor(){this.layerIndexes={},this.crossTileIDs=new Pt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,u){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Tr);let g=!1;const b={};h.handleWrapJump(u);for(const T of a){const E=T.getBucket(e);E&&e.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(T.tileID,E,this.crossTileIDs)&&(g=!0),b[E.bucketInstanceId]=!0)}return h.removeStaleBuckets(b)&&(g=!0),g}pruneUnusedLayers(e){const a={};e.forEach(u=>{a[u]=!0});for(const u in this.layerIndexes)a[u]||delete this.layerIndexes[u]}}const Lo=(m,e)=>c.t(m,e&&e.filter(a=>a.identifier!=="source.canvas")),go=c.aw();class Tu extends c.E{constructor(e,a={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const h=this.sourceCaches[u].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new li(Xi(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,h)=>this.getGlyphs(u,h)),this.dispatcher.registerMessageHandler("GI",(u,h)=>this.getImages(u,h)),this.imageManager=new Ot,this.imageManager.setEventedParent(this),this.glyphManager=new Un(e._requestManager,a.localIdeographFontFamily),this.lineAtlas=new kn(256,512),this.crossTileSymbolIndex=new pr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),Bn().on(Ne,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.sourceCaches[u.sourceId];if(!h)return;const g=h.getSource();if(g&&g.vectorLayerIds)for(const b in this._layers){const T=this._layers[b];T.source===g.id&&this._validateLayer(T)}})}loadURL(e,a={},u){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.h(h,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,a,u)}).catch(b=>{this._loadStyleRequest=null,b&&!g.signal.aborted&&this.fire(new c.j(b))})}loadJSON(e,a={},u){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,u)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(go,{validate:!1})}_load(e,a,u){var h;const g=a.transformStyle?a.transformStyle(u,e):e;if(!a.validate||!Lo(this,c.u(g))){this._loaded=!0,this.stylesheet=g;for(const b in g.sources)this.addSource(b,g.sources[b],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new wt(this.stylesheet.light),this.sky=new Nt(this.stylesheet.sky),this.map.setTerrain((h=this.stylesheet.terrain)!==null&&h!==void 0?h:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const e=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of e){const u=c.aA(a);u.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=u}}_loadSprite(e,a=!1,u=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,b,T,E){return c._(this,void 0,void 0,function*(){const k=dt(g),z=T>1?"@2x":"",M={},B={};for(const{id:Z,url:q}of k){const Y=b.transformRequest(lt(q,z,".json"),"SpriteJSON");M[Z]=c.h(Y,E);const G=b.transformRequest(lt(q,z,".png"),"SpriteImage");B[Z]=ue.getImage(G,E)}return yield Promise.all([...Object.values(M),...Object.values(B)]),function(Z,q){return c._(this,void 0,void 0,function*(){const Y={};for(const G in Z){Y[G]={};const te=j.getImageCanvasContext((yield q[G]).data),ae=(yield Z[G]).data;for(const K in ae){const{width:de,height:ge,x:_e,y:Me,sdf:Be,pixelRatio:Je,stretchX:Ye,stretchY:Oe,content:je,textFitWidth:st,textFitHeight:Ct}=ae[K];Y[G][K]={data:null,pixelRatio:Je,sdf:Be,stretchX:Ye,stretchY:Oe,content:je,textFitWidth:st,textFitHeight:Ct,spriteData:{width:de,height:ge,x:_e,y:Me,context:te}}}}return Y})}(M,B)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(const b in g){this._spritesImagesIds[b]=[];const T=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(E=>!(E in g)):[];for(const E of T)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in g[b]){const k=b==="default"?E:`${b}:${E}`;this._spritesImagesIds[b].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,g[b][E],!1):this.imageManager.addImage(k,g[b][E]),a&&(this._changedImages[k]=!0)}}}).catch(g=>{this._spriteRequest=null,h=g,this.fire(new c.j(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),u&&u(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(e){const a=this.sourceCaches[e.source];if(!a)return;const u=e.sourceLayer;if(!u)return;const h=a.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(u)===-1)&&this.fire(new c.j(new Error(`Source layer "${u}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?c.aB(u):u);const h=[];for(const g of e)if(u[g]){const b=a?c.aB(u[g]):u[g];h.push(b)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const u of a){const h=this._layers[u];h.type!=="custom"&&(e[u]=h.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const h=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(h.length||g.length)&&this._updateWorkerLayers(h,g);for(const b in this._updatedSources){const T=this._updatedSources[b];if(T==="reload")this._reloadSource(b);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const h in this.sourceCaches){const g=this.sourceCaches[h];u[h]=g.used,g.used=!1}for(const h of this._order){const g=this._layers[h];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const h in u){const g=this.sourceCaches[h];!!u[h]!=!!g.used&&g.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var u;this._checkLoaded();const h=this.serialize();if(e=a.transformStyle?a.transformStyle(h,e):e,((u=a.validate)===null||u===void 0||u)&&Lo(this,c.u(e)))return!1;(e=c.aB(e)).layers=c.az(e.layers);const g=c.aC(h,e),b=this._getOperationsToPerform(g);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const T of b.operations)T();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],u=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":a.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":a.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,h.args));break;case"setSky":a.push(()=>this.setSky.apply(this,h.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setTransition":a.push(()=>{});break;default:u.push(h.command)}return{operations:a,unimplemented:u}}addImage(e,a){if(this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${e}`,a,null,u))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const h=this.sourceCaches[e]=new gt(e,a,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new c.j(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,u={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new c.j(new Error(`Layer "${h}" already exists on this map.`)));let g;if(e.type==="custom"){if(Lo(this,c.aD(e)))return;g=c.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=c.aB(e),e=c.e(e,{source:h})),this._validate(c.u.layer,`layers.${h}`,e,{arrayIndex:-1},u))return;g=c.aA(e),this._validateLayer(g),g.setEventedParent(this,{layer:{id:h}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new c.j(new Error(`Cannot add layer "${h}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,h),this._layerOrderChanged=!0,this._layers[h]=g,this._removedLayers[h]&&g.source&&g.type!=="custom"){const T=this._removedLayers[h];delete this._removedLayers[h],T.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const u=this._order.indexOf(e);this._order.splice(u,1);const h=a?this._order.indexOf(a):this._order.length;a&&h===-1?this.fire(new c.j(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,u){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===a&&h.maxzoom===u||(a!=null&&(h.minzoom=a),u!=null&&(h.maxzoom=u),this._updateLayer(h)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,u={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!c.aE(h.filter,a))return a==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(c.u.filter,`layers.${h.id}.filter`,a,null,u)||(h.filter=c.aB(a),this._updateLayer(h)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.aB(this.getLayer(e).filter)}setLayoutProperty(e,a,u,h={}){this._checkLoaded();const g=this.getLayer(e);g?c.aE(g.getLayoutProperty(a),u)||(g.setLayoutProperty(a,u,h),this._updateLayer(g)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const u=this.getLayer(e);if(u)return u.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,u,h={}){this._checkLoaded();const g=this.getLayer(e);g?c.aE(g.getPaintProperty(a),u)||(g.setPaintProperty(a,u,h)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const u=e.source,h=e.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const b=g.getSource().type;b==="geojson"&&h?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||h?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),g.setFeatureState(h,e.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const u=e.source,h=this.sourceCaches[u];if(h===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const g=h.getSource().type,b=g==="vector"?e.sourceLayer:void 0;g!=="vector"||b?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(b,e.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,u=e.sourceLayer,h=this.sourceCaches[a];if(h!==void 0)return h.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),h.getFeatureState(u,e.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.aF(this.sourceCaches,g=>g.serialize()),a=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,h=this.stylesheet;return c.aG({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,sources:e,layers:a,terrain:u},g=>g!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=b=>this._layers[b].type==="fill-extrusion",u={},h=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T)){u[T]=b;for(const E of e){const k=E[T];if(k)for(const z of k)h.push(z)}}}h.sort((b,T)=>T.intersectionZ-b.intersectionZ);const g=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T))for(let E=h.length-1;E>=0;E--){const k=h[E].feature;if(u[k.layer.id]<b)break;g.push(k),h.pop()}else for(const E of e){const k=E[T];if(k)for(const z of k)g.push(z.feature)}}return g}queryRenderedFeatures(e,a,u){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const h={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const E=this._layers[T];if(!E)return this.fire(new c.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];h[E.source]=!0}}const g=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!h[T]||g.push(Li(this.sourceCaches[T],this._layers,b,e,a,u));return this.placement&&g.push(function(T,E,k,z,M,B,Z){const q={},Y=B.queryRenderedSymbols(z),G=[];for(const te of Object.keys(Y).map(Number))G.push(Z[te]);G.sort(pn);for(const te of G){const ae=te.featureIndex.lookupSymbolFeatures(Y[te.bucketInstanceId],E,te.bucketIndex,te.sourceLayerIndex,M.filter,M.layers,M.availableImages,T);for(const K in ae){const de=q[K]=q[K]||[],ge=ae[K];ge.sort((_e,Me)=>{const Be=te.featureSortOrder;if(Be){const Je=Be.indexOf(_e.featureIndex);return Be.indexOf(Me.featureIndex)-Je}return Me.featureIndex-_e.featureIndex});for(const _e of ge)de.push(_e)}}for(const te in q)q[te].forEach(ae=>{const K=ae.feature,de=k[T[te].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=de});return q}(this._layers,b,this.sourceCaches,e,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const u=this.sourceCaches[e];return u?function(h,g){const b=h.getRenderableIds().map(k=>h.getTileByID(k)),T=[],E={};for(let k=0;k<b.length;k++){const z=b[k],M=z.tileID.canonical.key;E[M]||(E[M]=!0,z.querySourceFeatures(T,g))}return T}(u,a):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const b in e)if(!c.aE(e[b],u[b])){h=!0;break}if(!h)return;const g={now:j.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(g)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){const u=this.getSky();let h=!1;if(!e&&!u)return;if(e&&!u)h=!0;else if(!e&&u)h=!0;else for(const b in e)if(!c.aE(e[b],u[b])){h=!0;break}if(!h)return;const g={now:j.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(g)}_validate(e,a,u,h,g={}){return(!g||g.validate!==!1)&&Lo(this,e.call(c.u,c.e({key:a,style:this.serialize(),value:u,styleSpec:c.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Bn().off(Ne,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const u=this.sourceCaches[a];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,u,h,g=!1){let b=!1,T=!1;const E={};for(const k of this._order){const z=this._layers[k];if(z.type!=="symbol")continue;if(!E[z.source]){const B=this.sourceCaches[z.source];E[z.source]=B.getRenderableIds(!0).map(Z=>B.getTileByID(Z)).sort((Z,q)=>q.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(q.tileID)?-1:1))}const M=this.crossTileSymbolIndex.addLayer(z,E[z.source],e.center.lng);b=b||M}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(j.now(),e.zoom))&&(this.pauseablePlacement=new yt(e,this.map.terrain,this._order,g,a,u,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(j.now()),T=!0),b&&this.pauseablePlacement.placement.setStale()),T||b)for(const k of this._order){const z=this._layers[k];z.type==="symbol"&&this.placement.updateLayerOpacities(z,E[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(j.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return c._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,a.icons),u})}getGlyphs(e,a){return c._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(a.stacks),h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(c.u.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,a,u={},h){this._checkLoaded();const g=[{id:e,url:a}],b=[...dt(this.stylesheet.sprite),...g];this._validate(c.u.sprite,"sprite",b,null,u)||(this.stylesheet.sprite=b,this._loadSprite(g,!0,h))}removeSprite(e){this._checkLoaded();const a=dt(this.stylesheet.sprite);if(a.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;a.splice(a.findIndex(u=>u.id===e),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return dt(this.stylesheet.sprite)}setSprite(e,a={},u){this._checkLoaded(),e&&this._validate(c.u.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Ya=c.Y([{name:"a_pos",type:"Int16",components:2}]);const yo={prelude:Ht(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ht(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ht(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ht(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ht("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ht(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ht(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ht("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ht("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ht("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ht(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ht(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ht(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ht(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ht(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ht(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ht(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ht(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ht(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ht(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ht(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ht("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ht("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ht("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Ht("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ht(m,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/attribute ([\w]+) ([\w]+)/g),h=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=g?g.concat(h):h,T={};return{fragmentSource:m=m.replace(a,(E,k,z,M,B)=>(T[B]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
varying ${z} ${M} ${B};
#else
uniform ${z} ${M} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${z} ${M} ${B} = u_${B};
#endif
`)),vertexSource:e=e.replace(a,(E,k,z,M,B)=>{const Z=M==="float"?"vec2":"vec4",q=B.match(/color/)?"color":Z;return T[B]?k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${z} ${Z} a_${B};
varying ${z} ${M} ${B};
#else
uniform ${z} ${M} u_${B};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${z} ${M} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${q}(a_${B}, u_${B}_t);
#else
    ${z} ${M} ${B} = u_${B};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
attribute ${z} ${Z} a_${B};
#else
uniform ${z} ${M} u_${B};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${z} ${M} ${B} = a_${B};
#else
    ${z} ${M} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${z} ${M} ${B} = unpack_mix_${q}(a_${B}, u_${B}_t);
#else
    ${z} ${M} ${B} = u_${B};
#endif
`}),staticAttributes:u,staticUniforms:b}}class Qs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,u,h,g,b,T,E,k){this.context=e;let z=this.boundPaintVertexBuffers.length!==h.length;for(let M=0;!z&&M<h.length;M++)this.boundPaintVertexBuffers[M]!==h[M]&&(z=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==u||z||this.boundIndexBuffer!==g||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,u,h,g,b,T,E,k):(e.bindVertexArray.set(this.vao),T&&T.bind(),g&&g.dynamicDraw&&g.bind(),E&&E.bind(),k&&k.bind())}freshBind(e,a,u,h,g,b,T,E){const k=e.numAttributes,z=this.context,M=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=h,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=E,a.enableAttributes(M,e);for(const B of u)B.enableAttributes(M,e);b&&b.enableAttributes(M,e),T&&T.enableAttributes(M,e),E&&E.enableAttributes(M,e),a.bind(),a.setVertexAttribPointers(M,e,g);for(const B of u)B.bind(),B.setVertexAttribPointers(M,e,g);b&&(b.bind(),b.setVertexAttribPointers(M,e,g)),h&&h.bind(),T&&(T.bind(),T.setVertexAttribPointers(M,e,g)),E&&(E.bind(),E.setVertexAttribPointers(M,e,g)),z.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Eu=(m,e,a,u,h)=>({u_matrix:m,u_texture:0,u_ele_delta:e,u_fog_matrix:a,u_fog_color:u?u.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?u.calculateFogBlendOpacity(h):0,u_horizon_color:u?u.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1});function Qa(m){const e=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const u=m[a].split(" ");e.push(u.pop())}return e}class el{constructor(e,a,u,h,g,b){const T=e.gl;this.program=T.createProgram();const E=Qa(a.staticAttributes),k=u?u.getBinderAttributes():[],z=E.concat(k),M=yo.prelude.staticUniforms?Qa(yo.prelude.staticUniforms):[],B=a.staticUniforms?Qa(a.staticUniforms):[],Z=u?u.getBinderUniforms():[],q=M.concat(B).concat(Z),Y=[];for(const _e of q)Y.indexOf(_e)<0&&Y.push(_e);const G=u?u.defines():[];g&&G.push("#define OVERDRAW_INSPECTOR;"),b&&G.push("#define TERRAIN3D;");const te=G.concat(yo.prelude.fragmentSource,a.fragmentSource).join(`
`),ae=G.concat(yo.prelude.vertexSource,a.vertexSource).join(`
`),K=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(K,te),T.compileShader(K),!T.getShaderParameter(K,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(K)}`);T.attachShader(this.program,K);const de=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(de,ae),T.compileShader(de),!T.getShaderParameter(de,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(de)}`);T.attachShader(this.program,de),this.attributes={};const ge={};this.numAttributes=z.length;for(let _e=0;_e<this.numAttributes;_e++)z[_e]&&(T.bindAttribLocation(this.program,_e,z[_e]),this.attributes[z[_e]]=_e);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(de),T.deleteShader(K);for(let _e=0;_e<Y.length;_e++){const Me=Y[_e];if(Me&&!ge[Me]){const Be=T.getUniformLocation(this.program,Me);Be&&(ge[Me]=Be)}}this.fixedUniforms=h(e,ge),this.terrainUniforms=((_e,Me)=>({u_depth:new c.aH(_e,Me.u_depth),u_terrain:new c.aH(_e,Me.u_terrain),u_terrain_dim:new c.aI(_e,Me.u_terrain_dim),u_terrain_matrix:new c.aJ(_e,Me.u_terrain_matrix),u_terrain_unpack:new c.aK(_e,Me.u_terrain_unpack),u_terrain_exaggeration:new c.aI(_e,Me.u_terrain_exaggeration)}))(e,ge),this.binderUniforms=u?u.getUniforms(e,ge):[]}draw(e,a,u,h,g,b,T,E,k,z,M,B,Z,q,Y,G,te,ae){const K=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(h),e.setColorMode(g),e.setCullFace(b),E){e.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,E.depthTexture),e.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,E.texture);for(const ge in this.terrainUniforms)this.terrainUniforms[ge].set(E[ge])}for(const ge in this.fixedUniforms)this.fixedUniforms[ge].set(T[ge]);Y&&Y.setUniforms(e,this.binderUniforms,Z,{zoom:q});let de=0;switch(a){case K.LINES:de=2;break;case K.TRIANGLES:de=3;break;case K.LINE_STRIP:de=1}for(const ge of B.get()){const _e=ge.vaos||(ge.vaos={});(_e[k]||(_e[k]=new Qs)).bind(e,this,z,Y?Y.getPaintVertexBuffers():[],M,ge.vertexOffset,G,te,ae),K.drawElements(a,ge.primitiveLength*de,K.UNSIGNED_SHORT,ge.primitiveOffset*de*2)}}}function tl(m,e,a){const u=1/Ae(a,1,e.transform.tileZoom),h=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,e.transform.tileZoom)/h,b=g*(a.tileID.canonical.x+a.tileID.wrap*h),T=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const nl=(m,e,a,u)=>{const h=e.style.light,g=h.properties.get("position"),b=[g.x,g.y,g.z],T=function(){var k=new c.A(9);return c.A!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();h.properties.get("anchor")==="viewport"&&function(k,z){var M=Math.sin(z),B=Math.cos(z);k[0]=B,k[1]=M,k[2]=0,k[3]=-M,k[4]=B,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(T,-e.transform.angle),function(k,z,M){var B=z[0],Z=z[1],q=z[2];k[0]=B*M[0]+Z*M[3]+q*M[6],k[1]=B*M[1]+Z*M[4]+q*M[7],k[2]=B*M[2]+Z*M[5]+q*M[8]}(b,b,T);const E=h.properties.get("color");return{u_matrix:m,u_lightpos:b,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+a,u_opacity:u}},rl=(m,e,a,u,h,g,b)=>c.e(nl(m,e,a,u),tl(g,e,b),{u_height_factor:-Math.pow(2,h.overscaledZ)/b.tileSize/8}),es=m=>({u_matrix:m}),ua=(m,e,a,u)=>c.e(es(m),tl(a,e,u)),rf=(m,e)=>({u_matrix:m,u_world:e}),of=(m,e,a,u,h)=>c.e(ua(m,e,a,u),{u_world:h}),zh=(m,e,a,u)=>{const h=m.transform;let g,b;if(u.paint.get("circle-pitch-alignment")==="map"){const T=Ae(a,1,h.zoom);g=!0,b=[T,T]}else g=!1,b=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(e.posMatrix,a,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:b}},af=(m,e,a)=>({u_matrix:m,u_inv_matrix:e,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),_o=(m,e,a=1)=>({u_matrix:m,u_color:e,u_overlay:0,u_overlay_scale:a}),ts=m=>({u_matrix:m}),Nr=(m,e,a,u)=>({u_matrix:m,u_extrude_scale:Ae(e,1,a),u_intensity:u});function jr(m,e){const a=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new c.Z(0,u/a).toLngLat().lat,new c.Z(0,(u+1)/a).toLngLat().lat]}const ns=(m,e,a,u)=>{const h=m.transform;return{u_matrix:Lh(m,e,a,u),u_ratio:1/Ae(e,1,h.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},il=(m,e,a,u,h)=>c.e(ns(m,e,a,h),{u_image:0,u_image_height:u}),Ah=(m,e,a,u,h)=>{const g=m.transform,b=Ro(e,g);return{u_matrix:Lh(m,e,a,h),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Ae(e,1,g.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[b,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Dh=(m,e,a,u,h,g)=>{const b=m.lineAtlas,T=Ro(e,m.transform),E=a.layout.get("line-cap")==="round",k=b.getDash(u.from,E),z=b.getDash(u.to,E),M=k.width*h.fromScale,B=z.width*h.toScale;return c.e(ns(m,e,a,g),{u_patternscale_a:[T/M,-k.height/2],u_patternscale_b:[T/B,-z.height/2],u_sdfgamma:b.width/(256*Math.min(M,B)*m.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:z.y,u_mix:h.t})};function Ro(m,e){return 1/Ae(m,1,e.tileZoom)}function Lh(m,e,a,u){return m.translatePosMatrix(u?u.posMatrix:e.tileID.posMatrix,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const sf=(m,e,a,u,h)=>{return{u_matrix:m,u_tl_parent:e,u_scale_parent:a,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(b=h.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(g=h.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:lf(h.paint.get("raster-hue-rotate"))};var g,b};function lf(m){m*=Math.PI/180;const e=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const Rh=(m,e,a,u,h,g,b,T,E,k,z,M,B,Z)=>{const q=b.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:q.width/q.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:E,u_coord_matrix:k,u_is_text:+M,u_pitch_with_map:+u,u_is_along_line:h,u_is_variable_anchor:g,u_texsize:B,u_texture:0,u_translation:z,u_pitched_scale:Z}},Fh=(m,e,a,u,h,g,b,T,E,k,z,M,B,Z,q)=>{const Y=b.transform;return c.e(Rh(m,e,a,u,h,g,b,T,E,k,z,M,B,q),{u_gamma_scale:u?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:+Z})},uf=(m,e,a,u,h,g,b,T,E,k,z,M,B,Z)=>c.e(Fh(m,e,a,u,h,g,b,T,E,k,z,!0,M,!0,Z),{u_texsize_icon:B,u_texture_icon:1}),ol=(m,e,a)=>({u_matrix:m,u_opacity:e,u_color:a}),Cu=(m,e,a,u,h,g)=>c.e(function(b,T,E,k){const z=E.imageManager.getPattern(b.from.toString()),M=E.imageManager.getPattern(b.to.toString()),{width:B,height:Z}=E.imageManager.getPixelSize(),q=Math.pow(2,k.tileID.overscaledZ),Y=k.tileSize*Math.pow(2,E.transform.tileZoom)/q,G=Y*(k.tileID.canonical.x+k.tileID.wrap*q),te=Y*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:M.tl,u_pattern_br_b:M.br,u_texsize:[B,Z],u_mix:T.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:M.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Ae(k,1,E.transform.tileZoom),u_pixel_coord_upper:[G>>16,te>>16],u_pixel_coord_lower:[65535&G,65535&te]}}(u,g,a,h),{u_matrix:m,u_opacity:e}),al={fillExtrusion:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_lightpos:new c.aN(m,e.u_lightpos),u_lightintensity:new c.aI(m,e.u_lightintensity),u_lightcolor:new c.aN(m,e.u_lightcolor),u_vertical_gradient:new c.aI(m,e.u_vertical_gradient),u_opacity:new c.aI(m,e.u_opacity)}),fillExtrusionPattern:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_lightpos:new c.aN(m,e.u_lightpos),u_lightintensity:new c.aI(m,e.u_lightintensity),u_lightcolor:new c.aN(m,e.u_lightcolor),u_vertical_gradient:new c.aI(m,e.u_vertical_gradient),u_height_factor:new c.aI(m,e.u_height_factor),u_image:new c.aH(m,e.u_image),u_texsize:new c.aO(m,e.u_texsize),u_pixel_coord_upper:new c.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,e.u_pixel_coord_lower),u_scale:new c.aN(m,e.u_scale),u_fade:new c.aI(m,e.u_fade),u_opacity:new c.aI(m,e.u_opacity)}),fill:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix)}),fillPattern:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_image:new c.aH(m,e.u_image),u_texsize:new c.aO(m,e.u_texsize),u_pixel_coord_upper:new c.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,e.u_pixel_coord_lower),u_scale:new c.aN(m,e.u_scale),u_fade:new c.aI(m,e.u_fade)}),fillOutline:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_world:new c.aO(m,e.u_world)}),fillOutlinePattern:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_world:new c.aO(m,e.u_world),u_image:new c.aH(m,e.u_image),u_texsize:new c.aO(m,e.u_texsize),u_pixel_coord_upper:new c.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,e.u_pixel_coord_lower),u_scale:new c.aN(m,e.u_scale),u_fade:new c.aI(m,e.u_fade)}),circle:(m,e)=>({u_camera_to_center_distance:new c.aI(m,e.u_camera_to_center_distance),u_scale_with_map:new c.aH(m,e.u_scale_with_map),u_pitch_with_map:new c.aH(m,e.u_pitch_with_map),u_extrude_scale:new c.aO(m,e.u_extrude_scale),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_matrix:new c.aJ(m,e.u_matrix)}),collisionBox:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_pixel_extrude_scale:new c.aO(m,e.u_pixel_extrude_scale)}),collisionCircle:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_inv_matrix:new c.aJ(m,e.u_inv_matrix),u_camera_to_center_distance:new c.aI(m,e.u_camera_to_center_distance),u_viewport_size:new c.aO(m,e.u_viewport_size)}),debug:(m,e)=>({u_color:new c.aL(m,e.u_color),u_matrix:new c.aJ(m,e.u_matrix),u_overlay:new c.aH(m,e.u_overlay),u_overlay_scale:new c.aI(m,e.u_overlay_scale)}),clippingMask:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix)}),heatmap:(m,e)=>({u_extrude_scale:new c.aI(m,e.u_extrude_scale),u_intensity:new c.aI(m,e.u_intensity),u_matrix:new c.aJ(m,e.u_matrix)}),heatmapTexture:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_world:new c.aO(m,e.u_world),u_image:new c.aH(m,e.u_image),u_color_ramp:new c.aH(m,e.u_color_ramp),u_opacity:new c.aI(m,e.u_opacity)}),hillshade:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_image:new c.aH(m,e.u_image),u_latrange:new c.aO(m,e.u_latrange),u_light:new c.aO(m,e.u_light),u_shadow:new c.aL(m,e.u_shadow),u_highlight:new c.aL(m,e.u_highlight),u_accent:new c.aL(m,e.u_accent)}),hillshadePrepare:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_image:new c.aH(m,e.u_image),u_dimension:new c.aO(m,e.u_dimension),u_zoom:new c.aI(m,e.u_zoom),u_unpack:new c.aK(m,e.u_unpack)}),line:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_ratio:new c.aI(m,e.u_ratio),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,e.u_units_to_pixels)}),lineGradient:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_ratio:new c.aI(m,e.u_ratio),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,e.u_units_to_pixels),u_image:new c.aH(m,e.u_image),u_image_height:new c.aI(m,e.u_image_height)}),linePattern:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_texsize:new c.aO(m,e.u_texsize),u_ratio:new c.aI(m,e.u_ratio),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_image:new c.aH(m,e.u_image),u_units_to_pixels:new c.aO(m,e.u_units_to_pixels),u_scale:new c.aN(m,e.u_scale),u_fade:new c.aI(m,e.u_fade)}),lineSDF:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_ratio:new c.aI(m,e.u_ratio),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(m,e.u_units_to_pixels),u_patternscale_a:new c.aO(m,e.u_patternscale_a),u_patternscale_b:new c.aO(m,e.u_patternscale_b),u_sdfgamma:new c.aI(m,e.u_sdfgamma),u_image:new c.aH(m,e.u_image),u_tex_y_a:new c.aI(m,e.u_tex_y_a),u_tex_y_b:new c.aI(m,e.u_tex_y_b),u_mix:new c.aI(m,e.u_mix)}),raster:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_tl_parent:new c.aO(m,e.u_tl_parent),u_scale_parent:new c.aI(m,e.u_scale_parent),u_buffer_scale:new c.aI(m,e.u_buffer_scale),u_fade_t:new c.aI(m,e.u_fade_t),u_opacity:new c.aI(m,e.u_opacity),u_image0:new c.aH(m,e.u_image0),u_image1:new c.aH(m,e.u_image1),u_brightness_low:new c.aI(m,e.u_brightness_low),u_brightness_high:new c.aI(m,e.u_brightness_high),u_saturation_factor:new c.aI(m,e.u_saturation_factor),u_contrast_factor:new c.aI(m,e.u_contrast_factor),u_spin_weights:new c.aN(m,e.u_spin_weights)}),symbolIcon:(m,e)=>({u_is_size_zoom_constant:new c.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,e.u_is_size_feature_constant),u_size_t:new c.aI(m,e.u_size_t),u_size:new c.aI(m,e.u_size),u_camera_to_center_distance:new c.aI(m,e.u_camera_to_center_distance),u_pitch:new c.aI(m,e.u_pitch),u_rotate_symbol:new c.aH(m,e.u_rotate_symbol),u_aspect_ratio:new c.aI(m,e.u_aspect_ratio),u_fade_change:new c.aI(m,e.u_fade_change),u_matrix:new c.aJ(m,e.u_matrix),u_label_plane_matrix:new c.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,e.u_coord_matrix),u_is_text:new c.aH(m,e.u_is_text),u_pitch_with_map:new c.aH(m,e.u_pitch_with_map),u_is_along_line:new c.aH(m,e.u_is_along_line),u_is_variable_anchor:new c.aH(m,e.u_is_variable_anchor),u_texsize:new c.aO(m,e.u_texsize),u_texture:new c.aH(m,e.u_texture),u_translation:new c.aO(m,e.u_translation),u_pitched_scale:new c.aI(m,e.u_pitched_scale)}),symbolSDF:(m,e)=>({u_is_size_zoom_constant:new c.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,e.u_is_size_feature_constant),u_size_t:new c.aI(m,e.u_size_t),u_size:new c.aI(m,e.u_size),u_camera_to_center_distance:new c.aI(m,e.u_camera_to_center_distance),u_pitch:new c.aI(m,e.u_pitch),u_rotate_symbol:new c.aH(m,e.u_rotate_symbol),u_aspect_ratio:new c.aI(m,e.u_aspect_ratio),u_fade_change:new c.aI(m,e.u_fade_change),u_matrix:new c.aJ(m,e.u_matrix),u_label_plane_matrix:new c.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,e.u_coord_matrix),u_is_text:new c.aH(m,e.u_is_text),u_pitch_with_map:new c.aH(m,e.u_pitch_with_map),u_is_along_line:new c.aH(m,e.u_is_along_line),u_is_variable_anchor:new c.aH(m,e.u_is_variable_anchor),u_texsize:new c.aO(m,e.u_texsize),u_texture:new c.aH(m,e.u_texture),u_gamma_scale:new c.aI(m,e.u_gamma_scale),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_is_halo:new c.aH(m,e.u_is_halo),u_translation:new c.aO(m,e.u_translation),u_pitched_scale:new c.aI(m,e.u_pitched_scale)}),symbolTextAndIcon:(m,e)=>({u_is_size_zoom_constant:new c.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(m,e.u_is_size_feature_constant),u_size_t:new c.aI(m,e.u_size_t),u_size:new c.aI(m,e.u_size),u_camera_to_center_distance:new c.aI(m,e.u_camera_to_center_distance),u_pitch:new c.aI(m,e.u_pitch),u_rotate_symbol:new c.aH(m,e.u_rotate_symbol),u_aspect_ratio:new c.aI(m,e.u_aspect_ratio),u_fade_change:new c.aI(m,e.u_fade_change),u_matrix:new c.aJ(m,e.u_matrix),u_label_plane_matrix:new c.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(m,e.u_coord_matrix),u_is_text:new c.aH(m,e.u_is_text),u_pitch_with_map:new c.aH(m,e.u_pitch_with_map),u_is_along_line:new c.aH(m,e.u_is_along_line),u_is_variable_anchor:new c.aH(m,e.u_is_variable_anchor),u_texsize:new c.aO(m,e.u_texsize),u_texsize_icon:new c.aO(m,e.u_texsize_icon),u_texture:new c.aH(m,e.u_texture),u_texture_icon:new c.aH(m,e.u_texture_icon),u_gamma_scale:new c.aI(m,e.u_gamma_scale),u_device_pixel_ratio:new c.aI(m,e.u_device_pixel_ratio),u_is_halo:new c.aH(m,e.u_is_halo),u_translation:new c.aO(m,e.u_translation),u_pitched_scale:new c.aI(m,e.u_pitched_scale)}),background:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_opacity:new c.aI(m,e.u_opacity),u_color:new c.aL(m,e.u_color)}),backgroundPattern:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_opacity:new c.aI(m,e.u_opacity),u_image:new c.aH(m,e.u_image),u_pattern_tl_a:new c.aO(m,e.u_pattern_tl_a),u_pattern_br_a:new c.aO(m,e.u_pattern_br_a),u_pattern_tl_b:new c.aO(m,e.u_pattern_tl_b),u_pattern_br_b:new c.aO(m,e.u_pattern_br_b),u_texsize:new c.aO(m,e.u_texsize),u_mix:new c.aI(m,e.u_mix),u_pattern_size_a:new c.aO(m,e.u_pattern_size_a),u_pattern_size_b:new c.aO(m,e.u_pattern_size_b),u_scale_a:new c.aI(m,e.u_scale_a),u_scale_b:new c.aI(m,e.u_scale_b),u_pixel_coord_upper:new c.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(m,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(m,e.u_tile_units_to_pixels)}),terrain:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_texture:new c.aH(m,e.u_texture),u_ele_delta:new c.aI(m,e.u_ele_delta),u_fog_matrix:new c.aJ(m,e.u_fog_matrix),u_fog_color:new c.aL(m,e.u_fog_color),u_fog_ground_blend:new c.aI(m,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(m,e.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(m,e.u_horizon_color),u_horizon_fog_blend:new c.aI(m,e.u_horizon_fog_blend)}),terrainDepth:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_ele_delta:new c.aI(m,e.u_ele_delta)}),terrainCoords:(m,e)=>({u_matrix:new c.aJ(m,e.u_matrix),u_texture:new c.aH(m,e.u_texture),u_terrain_coords_id:new c.aI(m,e.u_terrain_coords_id),u_ele_delta:new c.aI(m,e.u_ele_delta)}),sky:(m,e)=>({u_sky_color:new c.aL(m,e.u_sky_color),u_horizon_color:new c.aL(m,e.u_horizon_color),u_horizon:new c.aI(m,e.u_horizon),u_sky_horizon_blend:new c.aI(m,e.u_sky_horizon_blend)})};class ku{constructor(e,a,u){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Iu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bi{constructor(e,a,u,h){this.length=a.length,this.attributes=u,this.itemSize=a.bytesPerElement,this.dynamicDraw=h,this.context=e;const g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let u=0;u<this.attributes.length;u++){const h=a.attributes[this.attributes[u].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,a,u){for(let h=0;h<this.attributes.length;h++){const g=this.attributes[h],b=a.attributes[g.name];b!==void 0&&e.vertexAttribPointer(b,g.components,e[Iu[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Pu=new WeakMap;function ca(m){var e;if(Pu.has(m))return Pu.get(m);{const a=(e=m.getParameter(m.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Pu.set(m,a),a}}class Vt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rs extends Vt{getDefault(){return c.aM.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class cf extends Vt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class sl extends Vt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class hf extends Vt{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ha extends Vt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class df extends Vt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Bh extends Vt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class pf extends Vt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Oh extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class Mu extends Vt{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Nh extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class jh extends Vt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Vh extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class Uh extends Vt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Fo extends Vt{getDefault(){return c.aM.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class $h extends Vt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ff extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class Zh extends Vt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class is extends Vt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class mf extends Vt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class ll extends Vt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class gf extends Vt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class yf extends Vt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class qh extends Vt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Hh extends Vt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Gh extends Vt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class zu extends Vt{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Wh extends Vt{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const u=this.gl;ca(u)?u.bindVertexArray(e):(a=u.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ul extends Vt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Qi extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Au extends Vt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class os extends Vt{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class Du extends os{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Xh extends os{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Lu extends os{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Bo{constructor(e,a,u,h,g){this.context=e,this.width=a,this.height=u;const b=e.gl,T=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new Du(e,T),h)this.depthAttachment=g?new Lu(e,T):new Xh(e,T);else if(g)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class vn{constructor(e,a,u){this.blendFunction=e,this.blendColor=a,this.mask=u}}vn.Replace=[1,0],vn.disabled=new vn(vn.Replace,c.aM.transparent,[!1,!1,!1,!1]),vn.unblended=new vn(vn.Replace,c.aM.transparent,[!0,!0,!0,!0]),vn.alphaBlended=new vn([1,771],c.aM.transparent,[!0,!0,!0,!0]);class _f{constructor(e){var a,u;if(this.gl=e,this.clearColor=new rs(this),this.clearDepth=new cf(this),this.clearStencil=new sl(this),this.colorMask=new hf(this),this.depthMask=new ha(this),this.stencilMask=new df(this),this.stencilFunc=new Bh(this),this.stencilOp=new pf(this),this.stencilTest=new Oh(this),this.depthRange=new Mu(this),this.depthTest=new Nh(this),this.depthFunc=new jh(this),this.blend=new Vh(this),this.blendFunc=new Uh(this),this.blendColor=new Fo(this),this.blendEquation=new $h(this),this.cullFace=new ff(this),this.cullFaceSide=new Zh(this),this.frontFace=new is(this),this.program=new mf(this),this.activeTexture=new ll(this),this.viewport=new gf(this),this.bindFramebuffer=new yf(this),this.bindRenderbuffer=new qh(this),this.bindTexture=new Hh(this),this.bindVertexBuffer=new Gh(this),this.bindElementBuffer=new zu(this),this.bindVertexArray=new Wh(this),this.pixelStoreUnpack=new ul(this),this.pixelStoreUnpackPremultiplyAlpha=new Qi(this),this.pixelStoreUnpackFlipY=new Au(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ca(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new ku(this,e,a)}createVertexBuffer(e,a,u){return new Bi(this,e,a,u)}createRenderbuffer(e,a,u){const h=this.gl,g=h.createRenderbuffer();return this.bindRenderbuffer.set(g),h.renderbufferStorage(h.RENDERBUFFER,e,a,u),this.bindRenderbuffer.set(null),g}createFramebuffer(e,a,u,h){return new Bo(this,e,a,u,h)}clear({color:e,depth:a,stencil:u}){const h=this.gl;let g=0;e&&(g|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u!==void 0&&(g|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),h.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.aE(e.blendFunction,vn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ca(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return ca(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Rt{constructor(e,a,u){this.func=e,this.mask=a,this.range=u}}Rt.ReadOnly=!1,Rt.ReadWrite=!0,Rt.disabled=new Rt(519,Rt.ReadOnly,[0,1]);const Ru=7680;class hn{constructor(e,a,u,h,g,b){this.test=e,this.ref=a,this.mask=u,this.fail=h,this.depthFail=g,this.pass=b}}hn.disabled=new hn({func:519,mask:0},0,0,Ru,Ru,Ru);class en{constructor(e,a,u){this.enable=e,this.mode=a,this.frontFace=u}}let cl;function Fu(m,e,a,u,h){const g=m.context,b=g.gl,T=m.useProgram("collisionBox"),E=[];let k=0,z=0;for(let te=0;te<u.length;te++){const ae=u[te],K=e.getTile(ae).getBucket(a);if(!K)continue;const de=h?K.textCollisionBox:K.iconCollisionBox,ge=K.collisionCircleArray;if(ge.length>0){const _e=c.H();c.aQ(_e,K.placementInvProjMatrix,m.transform.glCoordMatrix),c.aQ(_e,_e,K.placementViewportMatrix),E.push({circleArray:ge,circleOffset:z,transform:ae.posMatrix,invTransform:_e,coord:ae}),k+=ge.length/4,z=k}de&&T.draw(g,b.LINES,Rt.disabled,hn.disabled,m.colorModeForRenderPass(),en.disabled,{u_matrix:ae.posMatrix,u_pixel_extrude_scale:[1/(M=m.transform).width,1/M.height]},m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae),a.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,m.transform.zoom,null,null,de.collisionVertexBuffer)}var M;if(!h||!E.length)return;const B=m.useProgram("collisionCircle"),Z=new c.aR;Z.resize(4*k),Z._trim();let q=0;for(const te of E)for(let ae=0;ae<te.circleArray.length/4;ae++){const K=4*ae,de=te.circleArray[K+0],ge=te.circleArray[K+1],_e=te.circleArray[K+2],Me=te.circleArray[K+3];Z.emplace(q++,de,ge,_e,Me,0),Z.emplace(q++,de,ge,_e,Me,1),Z.emplace(q++,de,ge,_e,Me,2),Z.emplace(q++,de,ge,_e,Me,3)}(!cl||cl.length<2*k)&&(cl=function(te){const ae=2*te,K=new c.aT;K.resize(ae),K._trim();for(let de=0;de<ae;de++){const ge=6*de;K.uint16[ge+0]=4*de+0,K.uint16[ge+1]=4*de+1,K.uint16[ge+2]=4*de+2,K.uint16[ge+3]=4*de+2,K.uint16[ge+4]=4*de+3,K.uint16[ge+5]=4*de+0}return K}(k));const Y=g.createIndexBuffer(cl,!0),G=g.createVertexBuffer(Z,c.aS.members,!0);for(const te of E){const ae=af(te.transform,te.invTransform,m.transform);B.draw(g,b.TRIANGLES,Rt.disabled,hn.disabled,m.colorModeForRenderPass(),en.disabled,ae,m.style.map.terrain&&m.style.map.terrain.getTerrainData(te.coord),a.id,G,Y,c.a0.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,m.transform.zoom,null,null,null)}G.destroy(),Y.destroy()}en.disabled=new en(!1,1029,2305),en.backCCW=new en(!0,1029,2305);const as=c.an(new Float32Array(16));function hl(m,e,a,u,h,g){const{horizontalAlign:b,verticalAlign:T}=c.au(m);return new c.P((-(b-.5)*e/h+u[0])*g,(-(T-.5)*a/h+u[1])*g)}function dl(m,e,a,u,h,g){const b=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let T=u.mult(g);return a||(T=T.rotate(-h)),Q(b.add(T),e.labelPlaneMatrix,e.getElevation).point}if(a){const T=Te(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(m),E=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return m.add(u.rotate(E))}return m.add(u)}function Bu(m,e,a,u,h,g,b,T,E,k,z,M,B,Z){const q=m.text.placedSymbolArray,Y=m.text.dynamicLayoutVertexArray,G=m.icon.dynamicLayoutVertexArray,te={};Y.clear();for(let ae=0;ae<q.length;ae++){const K=q.get(ae),de=K.hidden||!K.crossTileID||m.allowVerticalPlacement&&!K.placedOrientation?null:u[K.crossTileID];if(de){const ge=new c.P(K.anchorX,K.anchorY),_e={getElevation:Z,width:h.width,height:h.height,labelPlaneMatrix:g,lineVertexArray:null,pitchWithMap:a,projection:z,projectionCache:null,tileAnchorPoint:ge,translation:M,unwrappedTileID:B},Me=a?Q(ge,b,Z):Te(ge.x,ge.y,_e),Be=L(h.cameraToCenterDistance,Me.signedDistanceFromCamera);let Je=c.ai(m.textSizeData,E,K)*Be/c.ap;a&&(Je*=m.tilePixelRatio/T);const{width:Ye,height:Oe,anchor:je,textOffset:st,textBoxScale:Ct}=de,qe=hl(je,Ye,Oe,st,Ct,Je),Ge=z.getPitchedTextCorrection(h,ge.add(new c.P(M[0],M[1])),B),bt=dl(Me.point,_e,e,qe,h.angle,Ge),tn=m.allowVerticalPlacement&&K.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let zt=0;zt<K.numGlyphs;zt++)c.aj(Y,bt,tn);k&&K.associatedIconIndex>=0&&(te[K.associatedIconIndex]={shiftedAnchor:bt,angle:tn})}else ce(K.numGlyphs,Y)}if(k){G.clear();const ae=m.icon.placedSymbolArray;for(let K=0;K<ae.length;K++){const de=ae.get(K);if(de.hidden)ce(de.numGlyphs,G);else{const ge=te[K];if(ge)for(let _e=0;_e<de.numGlyphs;_e++)c.aj(G,ge.shiftedAnchor,ge.angle);else ce(de.numGlyphs,G)}}m.icon.dynamicLayoutVertexBuffer.updateData(G)}m.text.dynamicLayoutVertexBuffer.updateData(Y)}function Oo(m,e,a){return a.iconsInText&&e?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function No(m,e,a,u,h,g,b,T,E,k,z,M){const B=m.context,Z=B.gl,q=m.transform,Y=Yi(),G=T==="map",te=E==="map",ae=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",K=G&&!te&&!ae,de=!te&&ae,ge=!a.layout.get("symbol-sort-key").isConstant();let _e=!1;const Me=m.depthModeForSublayer(0,Rt.ReadOnly),Be=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Je=[],Ye=Y.getCircleRadiusCorrection(q);for(const Oe of u){const je=e.getTile(Oe),st=je.getBucket(a);if(!st)continue;const Ct=h?st.text:st.icon;if(!Ct||!Ct.segments.get().length||!Ct.hasVisibleVertices)continue;const qe=Ct.programConfigurations.get(a.id),Ge=h||st.sdfIcons,bt=h?st.textSizeData:st.iconSizeData,tn=te||q.pitch!==0,zt=m.useProgram(Oo(Ge,h,st),qe),Lt=c.ag(bt,q.zoom),an=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Oe);let rr,_i,sn,Er,fr=[0,0],ir=null;if(h)_i=je.glyphAtlasTexture,sn=Z.LINEAR,rr=je.glyphAtlasTexture.size,st.iconsInText&&(fr=je.imageAtlasTexture.size,ir=je.imageAtlasTexture,Er=tn||m.options.rotating||m.options.zooming||bt.kind==="composite"||bt.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const xn=a.layout.get("icon-size").constantOr(0)!==1||st.iconsNeedLinear;_i=je.imageAtlasTexture,sn=Ge||m.options.rotating||m.options.zooming||xn||tn?Z.LINEAR:Z.NEAREST,rr=je.imageAtlasTexture.size}const or=Ae(je,1,m.transform.zoom),vi=de?Oe.posMatrix:as,Zo=Br(vi,te,G,m.transform,or),ws=Or(vi,te,G,m.transform,or),qo=Or(Oe.posMatrix,te,G,m.transform,or),xo=Y.translatePosition(m.transform,je,g,b),Ml=Be&&st.hasTextData(),uc=a.layout.get("icon-text-fit")!=="none"&&Ml&&st.hasIconData();if(ae){const xn=m.style.map.terrain?(bo,bs)=>m.style.map.terrain.getElevation(Oe,bo,bs):null,ba=a.layout.get("text-rotation-alignment")==="map";$(st,Oe.posMatrix,m,h,Zo,qo,te,k,ba,Y,Oe.toUnwrapped(),q.width,q.height,xo,xn)}const ti=Oe.posMatrix,xi=h&&Be||uc,wo=ae||xi?as:Zo,wi=ws,mr=Ge&&a.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ar;ar=Ge?st.iconsInText?uf(bt.kind,Lt,K,te,ae,xi,m,ti,wo,wi,xo,rr,fr,Ye):Fh(bt.kind,Lt,K,te,ae,xi,m,ti,wo,wi,xo,h,rr,!0,Ye):Rh(bt.kind,Lt,K,te,ae,xi,m,ti,wo,wi,xo,h,rr,Ye);const $r={program:zt,buffers:Ct,uniformValues:ar,atlasTexture:_i,atlasTextureIcon:ir,atlasInterpolation:sn,atlasInterpolationIcon:Er,isSDF:Ge,hasHalo:mr};if(ge&&st.canOverlap){_e=!0;const xn=Ct.segments.get();for(const ba of xn)Je.push({segments:new c.a0([ba]),sortKey:ba.sortKey,state:$r,terrainData:an})}else Je.push({segments:Ct.segments,sortKey:0,state:$r,terrainData:an})}_e&&Je.sort((Oe,je)=>Oe.sortKey-je.sortKey);for(const Oe of Je){const je=Oe.state;if(B.activeTexture.set(Z.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,Z.CLAMP_TO_EDGE),je.atlasTextureIcon&&(B.activeTexture.set(Z.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),je.isSDF){const st=je.uniformValues;je.hasHalo&&(st.u_is_halo=1,Vr(je.buffers,Oe.segments,a,m,je.program,Me,z,M,st,Oe.terrainData)),st.u_is_halo=0}Vr(je.buffers,Oe.segments,a,m,je.program,Me,z,M,je.uniformValues,Oe.terrainData)}}function Vr(m,e,a,u,h,g,b,T,E,k){const z=u.context;h.draw(z,z.gl.TRIANGLES,g,b,T,en.disabled,E,k,a.id,m.layoutVertexBuffer,m.indexBuffer,e,a.paint,u.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Ou(m,e,a,u,h){if(!a||!u||!u.imageAtlas)return;const g=u.imageAtlas.patternPositions;let b=g[a.to.toString()],T=g[a.from.toString()];if(!b&&T&&(b=T),!T&&b&&(T=b),!b||!T){const E=h.getPaintProperty(e);b=g[E],T=g[E]}b&&T&&m.setConstantPatternPositions(b,T)}function Nu(m,e,a,u,h,g,b){const T=m.context.gl,E="fill-pattern",k=a.paint.get(E),z=k&&k.constantOr(1),M=a.getCrossfadeParameters();let B,Z,q,Y,G;b?(Z=z&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=T.LINES):(Z=z?"fillPattern":"fill",B=T.TRIANGLES);const te=k.constantOr(null);for(const ae of u){const K=e.getTile(ae);if(z&&!K.patternsLoaded())continue;const de=K.getBucket(a);if(!de)continue;const ge=de.programConfigurations.get(a.id),_e=m.useProgram(Z,ge),Me=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae);z&&(m.context.activeTexture.set(T.TEXTURE0),K.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ge.updatePaintBuffers(M)),Ou(ge,E,te,K,a);const Be=Me?ae:null,Je=m.translatePosMatrix(Be?Be.posMatrix:ae.posMatrix,K,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(b){Y=de.indexBuffer2,G=de.segments2;const Ye=[T.drawingBufferWidth,T.drawingBufferHeight];q=Z==="fillOutlinePattern"&&z?of(Je,m,M,K,Ye):rf(Je,Ye)}else Y=de.indexBuffer,G=de.segments,q=z?ua(Je,m,M,K):es(Je);_e.draw(m.context,B,h,m.stencilModeForClipping(ae),g,en.disabled,q,Me,a.id,de.layoutVertexBuffer,Y,G,a.paint,m.transform.zoom,ge)}}function ss(m,e,a,u,h,g,b){const T=m.context,E=T.gl,k="fill-extrusion-pattern",z=a.paint.get(k),M=z.constantOr(1),B=a.getCrossfadeParameters(),Z=a.paint.get("fill-extrusion-opacity"),q=z.constantOr(null);for(const Y of u){const G=e.getTile(Y),te=G.getBucket(a);if(!te)continue;const ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Y),K=te.programConfigurations.get(a.id),de=m.useProgram(M?"fillExtrusionPattern":"fillExtrusion",K);M&&(m.context.activeTexture.set(E.TEXTURE0),G.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),K.updatePaintBuffers(B)),Ou(K,k,q,G,a);const ge=m.translatePosMatrix(Y.posMatrix,G,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),_e=a.paint.get("fill-extrusion-vertical-gradient"),Me=M?rl(ge,m,_e,Z,Y,B,G):nl(ge,m,_e,Z);de.draw(T,T.gl.TRIANGLES,h,g,b,en.backCCW,Me,ae,a.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,a.paint,m.transform.zoom,K,m.style.map.terrain&&te.centroidVertexBuffer)}}function jo(m,e,a,u,h,g,b){const T=m.context,E=T.gl,k=a.fbo;if(!k)return;const z=m.useProgram("hillshade"),M=m.style.map.terrain&&m.style.map.terrain.getTerrainData(e);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,k.colorAttachment.get()),z.draw(T,E.TRIANGLES,h,g,b,en.disabled,((B,Z,q,Y)=>{const G=q.paint.get("hillshade-shadow-color"),te=q.paint.get("hillshade-highlight-color"),ae=q.paint.get("hillshade-accent-color");let K=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=B.transform.angle);const de=!B.options.moving;return{u_matrix:Y?Y.posMatrix:B.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),de),u_image:0,u_latrange:jr(0,Z.tileID),u_light:[q.paint.get("hillshade-exaggeration"),K],u_shadow:G,u_highlight:te,u_accent:ae}})(m,a,u,M?e:null),M,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function pl(m,e,a,u,h,g){const b=m.context,T=b.gl,E=e.dem;if(E&&E.data){const k=E.dim,z=E.stride,M=E.getPixels();if(b.activeTexture.set(T.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||m.getTileTexture(z),e.demTexture){const Z=e.demTexture;Z.update(M,{premultiply:!1}),Z.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else e.demTexture=new ot(b,M,T.RGBA,{premultiply:!1}),e.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);b.activeTexture.set(T.TEXTURE0);let B=e.fbo;if(!B){const Z=new ot(b,{width:k,height:k,data:null},T.RGBA);Z.bind(T.LINEAR,T.CLAMP_TO_EDGE),B=e.fbo=b.createFramebuffer(k,k,!0,!1),B.colorAttachment.set(Z.texture)}b.bindFramebuffer.set(B.framebuffer),b.viewport.set([0,0,k,k]),m.useProgram("hillshadePrepare").draw(b,T.TRIANGLES,u,h,g,en.disabled,((Z,q)=>{const Y=q.stride,G=c.H();return c.aP(G,0,c.X,-c.X,0,0,1),c.J(G,G,[0,-c.X,0]),{u_matrix:G,u_image:1,u_dimension:[Y,Y],u_zoom:Z.overscaledZ,u_unpack:q.getUnpackVector()}})(e.tileID,E),null,a.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function fl(m,e,a,u,h,g){const b=u.paint.get("raster-fade-duration");if(!g&&b>0){const T=j.now(),E=(T-m.timeAdded)/b,k=e?(T-e.timeAdded)/b:-1,z=a.getSource(),M=h.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),B=!e||Math.abs(e.tileID.overscaledZ-M)>Math.abs(m.tileID.overscaledZ-M),Z=B&&m.refreshedUponExpiration?1:c.ac(B?E:1-k,0,1);return m.refreshedUponExpiration&&E>=1&&(m.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const ls=new c.aM(1,0,0,1),ml=new c.aM(0,1,0,1),Kh=new c.aM(0,0,1,1),da=new c.aM(1,0,1,1),pa=new c.aM(0,1,1,1);function ju(m,e,a,u){jt(m,0,e+a/2,m.transform.width,a,u)}function gl(m,e,a,u){jt(m,e-a/2,0,a,m.transform.height,u)}function jt(m,e,a,u,h,g){const b=m.context,T=b.gl;T.enable(T.SCISSOR_TEST),T.scissor(e*m.pixelRatio,a*m.pixelRatio,u*m.pixelRatio,h*m.pixelRatio),b.clear({color:g}),T.disable(T.SCISSOR_TEST)}function yl(m,e,a){const u=m.context,h=u.gl,g=a.posMatrix,b=m.useProgram("debug"),T=Rt.disabled,E=hn.disabled,k=m.colorModeForRenderPass(),z="$debug",M=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);u.activeTexture.set(h.TEXTURE0);const B=e.getTileByID(a.key).latestRawTileData,Z=Math.floor((B&&B.byteLength||0)/1024),q=e.getTile(a).tileSize,Y=512/Math.min(q,512)*(a.overscaledZ/m.transform.zoom)*.5;let G=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(G+=` => ${a.overscaledZ}`),function(te,ae){te.initDebugOverlayCanvas();const K=te.debugOverlayCanvas,de=te.context.gl,ge=te.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,K.width,K.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(ae,5,5),ge.strokeText(ae,5,5),te.debugOverlayTexture.update(K),te.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(m,`${G} ${Z}kB`),b.draw(u,h.TRIANGLES,T,E,vn.alphaBlended,en.disabled,_o(g,c.aM.transparent,Y),null,z,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),b.draw(u,h.LINE_STRIP,T,E,k,en.disabled,_o(g,c.aM.red),M,z,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Jh(m,e,a){const u=m.context,h=u.gl,g=m.colorModeForRenderPass(),b=new Rt(h.LEQUAL,Rt.ReadWrite,m.depthRangeFor3D),T=m.useProgram("terrain"),E=e.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,m.width,m.height]);for(const k of a){const z=m.renderToTexture.getTexture(k),M=e.getTerrainData(k.tileID);u.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,z.texture);const B=m.transform.calculatePosMatrix(k.tileID.toUnwrapped()),Z=e.getMeshFrameDelta(m.transform.zoom),q=m.transform.calculateFogMatrix(k.tileID.toUnwrapped()),Y=Eu(B,Z,q,m.style.sky,m.transform.pitch);T.draw(u,h.TRIANGLES,b,hn.disabled,g,en.backCCW,Y,M,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class Vu{constructor(e,a,u){this.vertexBuffer=e,this.indexBuffer=a,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class us{constructor(e,a){this.context=new _f(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=gt.maxUnderzooming+gt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new pr}resize(e,a,u){if(this.width=Math.floor(e*u),this.height=Math.floor(a*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,a=new c.aW;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=e.createVertexBuffer(a,Ya.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const u=new c.aW;u.emplaceBack(0,0),u.emplaceBack(c.X,0),u.emplaceBack(0,c.X),u.emplaceBack(c.X,c.X),this.debugBuffer=e.createVertexBuffer(u,Ya.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const h=new c.$;h.emplaceBack(0,0,0,0),h.emplaceBack(c.X,0,c.X,0),h.emplaceBack(0,c.X,0,c.X),h.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=e.createVertexBuffer(h,Ri.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const g=new c.aW;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(g,Ya.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const b=new c.aY;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(b);const T=new c.aX;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const E=this.context.gl;this.stencilClearMode=new hn({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=c.H();c.aP(u,0,this.width,this.height,0,0,1),c.K(u,u,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,a.TRIANGLES,Rt.disabled,this.stencilClearMode,vn.disabled,en.disabled,ts(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source;const u=this.context,h=u.gl;this.nextStencilID+a.length>256&&this.clearStencil(),u.setColorMode(vn.disabled),u.setDepthMode(Rt.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of a){const T=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);g.draw(u,h.TRIANGLES,Rt.disabled,new hn({func:h.ALWAYS,mask:0},T,255,h.KEEP,h.KEEP,h.REPLACE),vn.disabled,en.disabled,ts(b.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new hn({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new hn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(e){const a=this.context.gl,u=e.sort((b,T)=>T.overscaledZ-b.overscaledZ),h=u[u.length-1].overscaledZ,g=u[0].overscaledZ-h+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const b={};for(let T=0;T<g;T++)b[T+h]=new hn({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[b,u]}return[{[h]:hn.disabled},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new vn([e.CONSTANT_COLOR,e.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?vn.unblended:vn.alphaBlended}depthModeForSublayer(e,a,u){if(!this.opaquePassEnabledForLayer())return Rt.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Rt(u||this.context.gl.LEQUAL,a,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(j.now()),this.imageManager.beginFrame();const u=this.style._order,h=this.style.sourceCaches,g={},b={},T={};for(const E in h){const k=h[E];k.used&&k.prepare(this.context),g[E]=k.getVisibleCoordinates(),b[E]=g[E].slice().reverse(),T[E]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<u.length;E++)if(this.style._layers[u[E]].is3D()){this.opaquePassCutoff=E;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const E of u){const k=this.style._layers[E];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const z=b[k.source];(k.type==="custom"||z.length)&&this.renderLayer(this,h[k.source],k,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(E,k){const z=E.context,M=z.gl,B=((te,ae,K)=>({u_sky_color:te.properties.get("sky-color"),u_horizon_color:te.properties.get("horizon-color"),u_horizon:(ae.height/2+ae.getHorizon())*K,u_sky_horizon_blend:te.properties.get("sky-horizon-blend")*ae.height/2*K}))(k,E.style.map.transform,E.pixelRatio),Z=new Rt(M.LEQUAL,Rt.ReadWrite,[0,1]),q=hn.disabled,Y=E.colorModeForRenderPass(),G=E.useProgram("sky");if(!k.mesh){const te=new c.aW;te.emplaceBack(-1,-1),te.emplaceBack(1,-1),te.emplaceBack(1,1),te.emplaceBack(-1,1);const ae=new c.aX;ae.emplaceBack(0,1,2),ae.emplaceBack(0,2,3),k.mesh=new Vu(z.createVertexBuffer(te,Ya.members),z.createIndexBuffer(ae),c.a0.simpleSegment(0,0,te.length,ae.length))}G.draw(z,M.TRIANGLES,Z,q,Y,en.disabled,B,void 0,"sky",k.mesh.vertexBuffer,k.mesh.indexBuffer,k.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[u[this.currentLayer]],k=h[E.source],z=g[E.source];this._renderTileClippingMasks(E,z),this.renderLayer(this,k,E,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const E=this.style._layers[u[this.currentLayer]],k=h[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const z=(E.type==="symbol"?T:b)[E.source];this._renderTileClippingMasks(E,g[E.source]),this.renderLayer(this,k,E,z)}if(this.options.showTileBoundaries){const E=function(k,z){let M=null;const B=Object.values(k._layers).flatMap(G=>G.source&&!G.isHidden(z)?[k.sourceCaches[G.source]]:[]),Z=B.filter(G=>G.getSource().type==="vector"),q=B.filter(G=>G.getSource().type!=="vector"),Y=G=>{(!M||M.getSource().maxzoom<G.getSource().maxzoom)&&(M=G)};return Z.forEach(G=>Y(G)),M||q.forEach(G=>Y(G)),M}(this.style,this.transform.zoom);E&&function(k,z,M){for(let B=0;B<M.length;B++)yl(k,z,M[B])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const k=E.transform.padding;ju(E,E.transform.height-(k.top||0),3,ls),ju(E,k.bottom||0,3,ml),gl(E,k.left||0,3,Kh),gl(E,E.transform.width-(k.right||0),3,da);const z=E.transform.centerPoint;(function(M,B,Z,q){jt(M,B-1,Z-10,2,20,q),jt(M,B-10,Z-1,20,2,q)})(E,z.x,E.transform.height-z.y,pa)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!c.aZ(a,u):!c.a_(a,u)),h||(h=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),h&&(c.a$(a,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,b){const T=g.context,E=T.gl,k=vn.unblended,z=new Rt(E.LEQUAL,Rt.ReadWrite,[0,1]),M=b.getTerrainMesh(),B=b.sourceCache.getRenderableTiles(),Z=g.useProgram("terrainDepth");T.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1});for(const q of B){const Y=b.getTerrainData(q.tileID),G={u_matrix:g.transform.calculatePosMatrix(q.tileID.toUnwrapped()),u_ele_delta:b.getMeshFrameDelta(g.transform.zoom)};Z.draw(T,E.TRIANGLES,z,hn.disabled,k,en.backCCW,G,Y,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,b){const T=g.context,E=T.gl,k=vn.unblended,z=new Rt(E.LEQUAL,Rt.ReadWrite,[0,1]),M=b.getTerrainMesh(),B=b.getCoordsTexture(),Z=b.sourceCache.getRenderableTiles(),q=g.useProgram("terrainCoords");T.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1}),b.coordsIndex=[];for(const Y of Z){const G=b.getTerrainData(Y.tileID);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,B.texture);const te={u_matrix:g.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(g.transform.zoom)};q.draw(T,E.TRIANGLES,z,hn.disabled,k,en.backCCW,te,G,"terrain",M.vertexBuffer,M.indexBuffer,M.segments),b.coordsIndex.push(Y.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(e,a,u,h){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(h||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(g,b,T,E,k){if(g.renderPass!=="translucent")return;const z=hn.disabled,M=g.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(B,Z,q,Y,G,te,ae,K,de){const ge=Z.transform,_e=Yi(),Me=G==="map",Be=te==="map";for(const Je of B){const Ye=Y.getTile(Je),Oe=Ye.getBucket(q);if(!Oe||!Oe.text||!Oe.text.segments.get().length)continue;const je=c.ag(Oe.textSizeData,ge.zoom),st=Ae(Ye,1,Z.transform.zoom),Ct=Br(Je.posMatrix,Be,Me,Z.transform,st),qe=q.layout.get("icon-text-fit")!=="none"&&Oe.hasIconData();if(je){const Ge=Math.pow(2,ge.zoom-Ye.tileID.overscaledZ),bt=Z.style.map.terrain?(zt,Lt)=>Z.style.map.terrain.getElevation(Je,zt,Lt):null,tn=_e.translatePosition(ge,Ye,ae,K);Bu(Oe,Me,Be,de,ge,Ct,Je.posMatrix,Ge,je,qe,_e,tn,Je.toUnwrapped(),bt)}}}(E,g,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),k),T.paint.get("icon-opacity").constantOr(1)!==0&&No(g,b,T,E,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),z,M),T.paint.get("text-opacity").constantOr(1)!==0&&No(g,b,T,E,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),z,M),b.map.showCollisionBoxes&&(Fu(g,b,T,E,!0),Fu(g,b,T,E,!1))})(e,a,u,h,this.style.placement.variableOffsets);break;case"circle":(function(g,b,T,E){if(g.renderPass!=="translucent")return;const k=T.paint.get("circle-opacity"),z=T.paint.get("circle-stroke-width"),M=T.paint.get("circle-stroke-opacity"),B=!T.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(z.constantOr(1)===0||M.constantOr(1)===0))return;const Z=g.context,q=Z.gl,Y=g.depthModeForSublayer(0,Rt.ReadOnly),G=hn.disabled,te=g.colorModeForRenderPass(),ae=[];for(let K=0;K<E.length;K++){const de=E[K],ge=b.getTile(de),_e=ge.getBucket(T);if(!_e)continue;const Me=_e.programConfigurations.get(T.id),Be=g.useProgram("circle",Me),Je=_e.layoutVertexBuffer,Ye=_e.indexBuffer,Oe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(de),je={programConfiguration:Me,program:Be,layoutVertexBuffer:Je,indexBuffer:Ye,uniformValues:zh(g,de,ge,T),terrainData:Oe};if(B){const st=_e.segments.get();for(const Ct of st)ae.push({segments:new c.a0([Ct]),sortKey:Ct.sortKey,state:je})}else ae.push({segments:_e.segments,sortKey:0,state:je})}B&&ae.sort((K,de)=>K.sortKey-de.sortKey);for(const K of ae){const{programConfiguration:de,program:ge,layoutVertexBuffer:_e,indexBuffer:Me,uniformValues:Be,terrainData:Je}=K.state;ge.draw(Z,q.TRIANGLES,Y,G,te,en.disabled,Be,Je,T.id,_e,Me,K.segments,T.paint,g.transform.zoom,de)}})(e,a,u,h);break;case"heatmap":(function(g,b,T,E){if(T.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const k=g.context,z=k.gl,M=hn.disabled,B=new vn([z.ONE,z.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(Z,q,Y){const G=Z.gl;Z.activeTexture.set(G.TEXTURE1),Z.viewport.set([0,0,q.width/4,q.height/4]);let te=Y.heatmapFbo;if(te)G.bindTexture(G.TEXTURE_2D,te.colorAttachment.get()),Z.bindFramebuffer.set(te.framebuffer);else{const ae=G.createTexture();G.bindTexture(G.TEXTURE_2D,ae),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR),te=Y.heatmapFbo=Z.createFramebuffer(q.width/4,q.height/4,!1,!1),function(K,de,ge,_e){var Me,Be;const Je=K.gl,Ye=(Me=K.HALF_FLOAT)!==null&&Me!==void 0?Me:Je.UNSIGNED_BYTE,Oe=(Be=K.RGBA16F)!==null&&Be!==void 0?Be:Je.RGBA;Je.texImage2D(Je.TEXTURE_2D,0,Oe,de.width/4,de.height/4,0,Je.RGBA,Ye,null),_e.colorAttachment.set(ge)}(Z,q,ae,te)}})(k,g,T),k.clear({color:c.aM.transparent});for(let Z=0;Z<E.length;Z++){const q=E[Z];if(b.hasRenderableParent(q))continue;const Y=b.getTile(q),G=Y.getBucket(T);if(!G)continue;const te=G.programConfigurations.get(T.id),ae=g.useProgram("heatmap",te),{zoom:K}=g.transform;ae.draw(k,z.TRIANGLES,Rt.disabled,M,B,en.disabled,Nr(q.posMatrix,Y,K,T.paint.get("heatmap-intensity")),null,T.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,T.paint,g.transform.zoom,te)}k.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(k,z){const M=k.context,B=M.gl,Z=z.heatmapFbo;if(!Z)return;M.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,Z.colorAttachment.get()),M.activeTexture.set(B.TEXTURE1);let q=z.colorRampTexture;q||(q=z.colorRampTexture=new ot(M,z.colorRamp,B.RGBA)),q.bind(B.LINEAR,B.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(M,B.TRIANGLES,Rt.disabled,hn.disabled,k.colorModeForRenderPass(),en.disabled,((Y,G,te,ae)=>{const K=c.H();c.aP(K,0,Y.width,Y.height,0,0,1);const de=Y.context.gl;return{u_matrix:K,u_world:[de.drawingBufferWidth,de.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:G.paint.get("heatmap-opacity")}})(k,z),null,z.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,z.paint,k.transform.zoom)}(g,T))})(e,a,u,h);break;case"line":(function(g,b,T,E){if(g.renderPass!=="translucent")return;const k=T.paint.get("line-opacity"),z=T.paint.get("line-width");if(k.constantOr(1)===0||z.constantOr(1)===0)return;const M=g.depthModeForSublayer(0,Rt.ReadOnly),B=g.colorModeForRenderPass(),Z=T.paint.get("line-dasharray"),q=T.paint.get("line-pattern"),Y=q.constantOr(1),G=T.paint.get("line-gradient"),te=T.getCrossfadeParameters(),ae=Y?"linePattern":Z?"lineSDF":G?"lineGradient":"line",K=g.context,de=K.gl;let ge=!0;for(const _e of E){const Me=b.getTile(_e);if(Y&&!Me.patternsLoaded())continue;const Be=Me.getBucket(T);if(!Be)continue;const Je=Be.programConfigurations.get(T.id),Ye=g.context.program.get(),Oe=g.useProgram(ae,Je),je=ge||Oe.program!==Ye,st=g.style.map.terrain&&g.style.map.terrain.getTerrainData(_e),Ct=q.constantOr(null);if(Ct&&Me.imageAtlas){const bt=Me.imageAtlas,tn=bt.patternPositions[Ct.to.toString()],zt=bt.patternPositions[Ct.from.toString()];tn&&zt&&Je.setConstantPatternPositions(tn,zt)}const qe=st?_e:null,Ge=Y?Ah(g,Me,T,te,qe):Z?Dh(g,Me,T,Z,te,qe):G?il(g,Me,T,Be.lineClipsArray.length,qe):ns(g,Me,T,qe);if(Y)K.activeTexture.set(de.TEXTURE0),Me.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Je.updatePaintBuffers(te);else if(Z&&(je||g.lineAtlas.dirty))K.activeTexture.set(de.TEXTURE0),g.lineAtlas.bind(K);else if(G){const bt=Be.gradients[T.id];let tn=bt.texture;if(T.gradientVersion!==bt.version){let zt=256;if(T.stepInterpolant){const Lt=b.getSource().maxzoom,an=_e.canonical.z===Lt?Math.ceil(1<<g.transform.maxZoom-_e.canonical.z):1;zt=c.ac(c.aU(Be.maxLineLength/c.X*1024*an),256,K.maxTextureSize)}bt.gradient=c.aV({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:zt,image:bt.gradient||void 0,clips:Be.lineClipsArray}),bt.texture?bt.texture.update(bt.gradient):bt.texture=new ot(K,bt.gradient,de.RGBA),bt.version=T.gradientVersion,tn=bt.texture}K.activeTexture.set(de.TEXTURE0),tn.bind(T.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}Oe.draw(K,de.TRIANGLES,M,g.stencilModeForClipping(_e),B,en.disabled,Ge,st,T.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,T.paint,g.transform.zoom,Je,Be.layoutVertexBuffer2),ge=!1}})(e,a,u,h);break;case"fill":(function(g,b,T,E){const k=T.paint.get("fill-color"),z=T.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const M=g.colorModeForRenderPass(),B=T.paint.get("fill-pattern"),Z=g.opaquePassEnabledForLayer()&&!B.constantOr(1)&&k.constantOr(c.aM.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===Z){const q=g.depthModeForSublayer(1,g.renderPass==="opaque"?Rt.ReadWrite:Rt.ReadOnly);Nu(g,b,T,E,q,M,!1)}if(g.renderPass==="translucent"&&T.paint.get("fill-antialias")){const q=g.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Rt.ReadOnly);Nu(g,b,T,E,q,M,!0)}})(e,a,u,h);break;case"fill-extrusion":(function(g,b,T,E){const k=T.paint.get("fill-extrusion-opacity");if(k!==0&&g.renderPass==="translucent"){const z=new Rt(g.context.gl.LEQUAL,Rt.ReadWrite,g.depthRangeFor3D);if(k!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))ss(g,b,T,E,z,hn.disabled,vn.disabled),ss(g,b,T,E,z,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const M=g.colorModeForRenderPass();ss(g,b,T,E,z,hn.disabled,M)}}})(e,a,u,h);break;case"hillshade":(function(g,b,T,E){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const k=g.context,z=g.depthModeForSublayer(0,Rt.ReadOnly),M=g.colorModeForRenderPass(),[B,Z]=g.renderPass==="translucent"?g.stencilConfigForOverlap(E):[{},E];for(const q of Z){const Y=b.getTile(q);Y.needsHillshadePrepare!==void 0&&Y.needsHillshadePrepare&&g.renderPass==="offscreen"?pl(g,Y,T,z,hn.disabled,M):g.renderPass==="translucent"&&jo(g,q,Y,T,z,B[q.overscaledZ],M)}k.viewport.set([0,0,g.width,g.height])})(e,a,u,h);break;case"raster":(function(g,b,T,E){if(g.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!E.length)return;const k=g.context,z=k.gl,M=b.getSource(),B=g.useProgram("raster"),Z=g.colorModeForRenderPass(),[q,Y]=M instanceof ci?[{},E]:g.stencilConfigForOverlap(E),G=Y[Y.length-1].overscaledZ,te=!g.options.moving;for(const ae of Y){const K=g.depthModeForSublayer(ae.overscaledZ-G,T.paint.get("raster-opacity")===1?Rt.ReadWrite:Rt.ReadOnly,z.LESS),de=b.getTile(ae);de.registerFadeDuration(T.paint.get("raster-fade-duration"));const ge=b.findLoadedParent(ae,0),_e=b.findLoadedSibling(ae),Me=fl(de,ge||_e||null,b,T,g.transform,g.style.map.terrain);let Be,Je;const Ye=T.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;k.activeTexture.set(z.TEXTURE0),de.texture.bind(Ye,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(z.TEXTURE1),ge?(ge.texture.bind(Ye,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),Be=Math.pow(2,ge.tileID.overscaledZ-de.tileID.overscaledZ),Je=[de.tileID.canonical.x*Be%1,de.tileID.canonical.y*Be%1]):de.texture.bind(Ye,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),de.texture.useMipmap&&k.extTextureFilterAnisotropic&&g.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax);const Oe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ae),je=Oe?ae:null,st=je?je.posMatrix:g.transform.calculatePosMatrix(ae.toUnwrapped(),te),Ct=sf(st,Je||[0,0],Be||1,Me,T);M instanceof ci?B.draw(k,z.TRIANGLES,K,hn.disabled,Z,en.disabled,Ct,Oe,T.id,M.boundsBuffer,g.quadTriangleIndexBuffer,M.boundsSegments):B.draw(k,z.TRIANGLES,K,q[ae.overscaledZ],Z,en.disabled,Ct,Oe,T.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}})(e,a,u,h);break;case"background":(function(g,b,T,E){const k=T.paint.get("background-color"),z=T.paint.get("background-opacity");if(z===0)return;const M=g.context,B=M.gl,Z=g.transform,q=Z.tileSize,Y=T.paint.get("background-pattern");if(g.isPatternMissing(Y))return;const G=!Y&&k.a===1&&z===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==G)return;const te=hn.disabled,ae=g.depthModeForSublayer(0,G==="opaque"?Rt.ReadWrite:Rt.ReadOnly),K=g.colorModeForRenderPass(),de=g.useProgram(Y?"backgroundPattern":"background"),ge=E||Z.coveringTiles({tileSize:q,terrain:g.style.map.terrain});Y&&(M.activeTexture.set(B.TEXTURE0),g.imageManager.bind(g.context));const _e=T.getCrossfadeParameters();for(const Me of ge){const Be=E?Me.posMatrix:g.transform.calculatePosMatrix(Me.toUnwrapped()),Je=Y?Cu(Be,z,g,Y,{tileID:Me,tileSize:q},_e):ol(Be,z,k),Ye=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Me);de.draw(M,B.TRIANGLES,ae,te,K,en.disabled,Je,Ye,T.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}})(e,0,u,h);break;case"custom":(function(g,b,T){const E=g.context,k=T.implementation;if(g.renderPass==="offscreen"){const z=k.prerender;z&&(g.setCustomLayerDefaults(),E.setColorMode(g.colorModeForRenderPass()),z.call(k,E.gl,g.transform.customLayerMatrix()),E.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),E.setColorMode(g.colorModeForRenderPass()),E.setStencilMode(hn.disabled);const z=k.renderingMode==="3d"?new Rt(g.context.gl.LEQUAL,Rt.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Rt.ReadOnly);E.setDepthMode(z),k.render(E.gl,g.transform.customLayerMatrix(),{farZ:g.transform.farZ,nearZ:g.transform.nearZ,fov:g.transform._fov,modelViewProjectionMatrix:g.transform.modelViewProjectionMatrix,projectionMatrix:g.transform.projectionMatrix}),E.setDirty(),g.setBaseState(),E.bindFramebuffer.set(null)}})(e,0,u)}}translatePosMatrix(e,a,u,h,g){if(!u[0]&&!u[1])return e;const b=g?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(b){const k=Math.sin(b),z=Math.cos(b);u=[u[0]*z-u[1]*k,u[0]*k+u[1]*z]}const T=[g?u[0]:Ae(a,u[0],this.transform.zoom),g?u[1]:Ae(a,u[1],this.transform.zoom),0],E=new Float32Array(16);return c.J(E,e,T),E}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!a||!u}useProgram(e,a){this.cache=this.cache||{};const u=e+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new el(this.context,yo[e],a,al[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}class Uu{constructor(e,a){this.points=e,this.planes=a}static fromInvProjectionMatrix(e,a,u){const h=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const E=1/(T=c.af([],T,e))[3]/a*h;return c.b0(T,T,[E,E,1/T[3],E])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const E=function(B,Z){var q=Z[0],Y=Z[1],G=Z[2],te=q*q+Y*Y+G*G;return te>0&&(te=1/Math.sqrt(te)),B[0]=Z[0]*te,B[1]=Z[1]*te,B[2]=Z[2]*te,B}([],function(B,Z,q){var Y=Z[0],G=Z[1],te=Z[2],ae=q[0],K=q[1],de=q[2];return B[0]=G*de-te*K,B[1]=te*ae-Y*de,B[2]=Y*K-G*ae,B}([],Qe([],g[T[0]],g[T[1]]),Qe([],g[T[2]],g[T[1]]))),k=-((z=E)[0]*(M=g[T[1]])[0]+z[1]*M[1]+z[2]*M[2]);var z,M;return E.concat(k)});return new Uu(g,b)}}class _l{constructor(e,a){this.min=e,this.max=a,this.center=function(u,h,g){return u[0]=.5*h[0],u[1]=.5*h[1],u[2]=.5*h[2],u}([],function(u,h,g){return u[0]=h[0]+g[0],u[1]=h[1]+g[1],u[2]=h[2]+g[2],u}([],this.min,this.max))}quadrant(e){const a=[e%2==0,e<2],u=Le(this.min),h=Le(this.max);for(let g=0;g<a.length;g++)u[g]=a[g]?this.min[g]:this.center[g],h[g]=a[g]?this.center[g]:this.max[g];return h[2]=this.max[2],new _l(u,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let h=0;h<e.planes.length;h++){const g=e.planes[h];let b=0;for(let T=0;T<a.length;T++)c.b1(g,a[T])>=0&&b++;if(b===0)return 0;b!==a.length&&(u=!1)}if(u)return 2;for(let h=0;h<3;h++){let g=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<e.points.length;T++){const E=e.points[T][h]-this.min[h];g=Math.min(g,E),b=Math.max(b,E)}if(b<0||g>this.max[h]-this.min[h])return 0}return 1}}class cs{constructor(e=0,a=0,u=0,h=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(u)||u<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=u,this.right=h}interpolate(e,a,u){return a.top!=null&&e.top!=null&&(this.top=c.y.number(e.top,a.top,u)),a.bottom!=null&&e.bottom!=null&&(this.bottom=c.y.number(e.bottom,a.bottom,u)),a.left!=null&&e.left!=null&&(this.left=c.y.number(e.left,a.left,u)),a.right!=null&&e.right!=null&&(this.right=c.y.number(e.right,a.right,u)),this}getCenter(e,a){const u=c.ac((this.left+e-this.right)/2,0,e),h=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(u,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new cs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Yh=85.051129;class hs{constructor(e,a,u,h,g){this.tileSize=512,this._renderWorldCopies=g===void 0||!!g,this._minZoom=e||0,this._maxZoom=a||22,this._minPitch=u??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cs,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new hs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const a=-c.b2(e,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var u=new c.A(4);return c.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,h,g){var b=h[0],T=h[1],E=h[2],k=h[3],z=Math.sin(g),M=Math.cos(g);u[0]=b*M+E*z,u[1]=T*M+k*z,u[2]=b*-z+E*M,u[3]=T*-z+k*M}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const a=c.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const a=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,u){this._unmodified=!1,this._edgeInsets.interpolate(e,a,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const a=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(e){const a=[new c.b3(0,e)];if(this._renderWorldCopies){const u=this.pointCoordinate(new c.P(0,0)),h=this.pointCoordinate(new c.P(this.width,0)),g=this.pointCoordinate(new c.P(this.width,this.height)),b=this.pointCoordinate(new c.P(0,this.height)),T=Math.floor(Math.min(u.x,h.x,g.x,b.x)),E=Math.floor(Math.max(u.x,h.x,g.x,b.x)),k=1;for(let z=T-k;z<=E+k;z++)z!==0&&a.push(new c.b3(z,e))}return a}coveringTiles(e){var a,u;let h=this.coveringZoomLevel(e);const g=h;if(e.minzoom!==void 0&&h<e.minzoom)return[];e.maxzoom!==void 0&&h>e.maxzoom&&(h=e.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),T=c.Z.fromLngLat(this.center),E=Math.pow(2,h),k=[E*b.x,E*b.y,0],z=[E*T.x,E*T.y,0],M=Uu.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,h);let B=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(B=h);const Z=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,q=K=>({aabb:new _l([K*E,0,0],[(K+1)*E,E,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),Y=[],G=[],te=h,ae=e.reparseOverscaled?g:h;if(this._renderWorldCopies)for(let K=1;K<=3;K++)Y.push(q(-K)),Y.push(q(K));for(Y.push(q(0));Y.length>0;){const K=Y.pop(),de=K.x,ge=K.y;let _e=K.fullyVisible;if(!_e){const Oe=K.aabb.intersects(M);if(Oe===0)continue;_e=Oe===2}const Me=e.terrain?k:z,Be=K.aabb.distanceX(Me),Je=K.aabb.distanceY(Me),Ye=Math.max(Math.abs(Be),Math.abs(Je));if(K.zoom===te||Ye>Z+(1<<te-K.zoom)-2&&K.zoom>=B){const Oe=te-K.zoom,je=k[0]-.5-(de<<Oe),st=k[1]-.5-(ge<<Oe);G.push({tileID:new c.S(K.zoom===te?ae:K.zoom,K.wrap,K.zoom,de,ge),distanceSq:pe([z[0]-.5-de,z[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(je*je+st*st)})}else for(let Oe=0;Oe<4;Oe++){const je=(de<<1)+Oe%2,st=(ge<<1)+(Oe>>1),Ct=K.zoom+1;let qe=K.aabb.quadrant(Oe);if(e.terrain){const Ge=new c.S(Ct,K.wrap,Ct,je,st),bt=e.terrain.getMinMaxElevation(Ge),tn=(a=bt.minElevation)!==null&&a!==void 0?a:this.elevation,zt=(u=bt.maxElevation)!==null&&u!==void 0?u:this.elevation;qe=new _l([qe.min[0],qe.min[1],tn],[qe.max[0],qe.max[1],zt])}Y.push({aabb:qe,zoom:Ct,x:je,y:st,wrap:K.wrap,fullyVisible:_e})}}return G.sort((K,de)=>K.distanceSq-de.distanceSq).map(K=>K.tileID)}resize(e,a){this.width=e,this.height=a,this.pixelsToGLUnits=[2/e,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const a=c.ac(e.lat,-85.051129,Yh);return new c.P(c.O(e.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(e){return new c.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const a=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,h=this.pointLocation(this.centerPoint,e),g=e.getElevationForLngLatZoom(h,this.tileZoom);if(!(this.elevation-g))return;const b=u+a-g,T=Math.cos(this._pitch)*this.cameraToCenterDistance/b/c.b4(1,h.lat),E=this.scaleZoom(T/this.tileSize);this._elevation=g,this._center=h,this.zoom=E}setLocationAtPoint(e,a){const u=this.pointCoordinate(a),h=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(e),b=new c.Z(g.x-(u.x-h.x),g.y-(u.y-h.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,a){return a?this.coordinatePoint(this.locationCoordinate(e),a.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,a){return this.coordinateLocation(this.pointCoordinate(e,a))}locationCoordinate(e){return c.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,a){if(a){const B=a.pointCoordinate(e);if(B!=null)return B}const u=[e.x,e.y,0,1],h=[e.x,e.y,1,1];c.af(u,u,this.pixelMatrixInverse),c.af(h,h,this.pixelMatrixInverse);const g=u[3],b=h[3],T=u[1]/g,E=h[1]/b,k=u[2]/g,z=h[2]/b,M=k===z?0:(0-k)/(z-k);return new c.Z(c.y.number(u[0]/g,h[0]/b,M)/this.worldSize,c.y.number(T,E,M)/this.worldSize)}coordinatePoint(e,a=0,u=this.pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,a,1];return c.af(h,h,u),new c.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new we().extend(this.pointLocation(new c.P(0,e))).extend(this.pointLocation(new c.P(this.width,e))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new we([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Yh])}calculateTileMatrix(e){const a=e.canonical,u=this.worldSize/this.zoomScale(a.z),h=a.x+Math.pow(2,a.z)*e.wrap,g=c.an(new Float64Array(16));return c.J(g,g,[h*u,a.y*u,0]),c.K(g,g,[u/c.X,u/c.X,1]),g}calculatePosMatrix(e,a=!1){const u=e.key,h=a?this._alignedPosMatrixCache:this._posMatrixCache;if(h[u])return h[u];const g=this.calculateTileMatrix(e);return c.L(g,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,g),h[u]=new Float32Array(g),h[u]}calculateFogMatrix(e){const a=e.key,u=this._fogMatrixCache;if(u[a])return u[a];const h=this.calculateTileMatrix(e);return c.L(h,this.fogMatrix,h),u[a]=new Float32Array(h),u[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,a){a=c.ac(+a,this.minZoom,this.maxZoom);const u={center:new c.N(e.lng,e.lat),zoom:a};let h=this.lngRange;if(!this._renderWorldCopies&&h===null){const K=179.9999999999;h=[-K,K]}const g=this.tileSize*this.zoomScale(u.zoom);let b=0,T=g,E=0,k=g,z=0,M=0;const{x:B,y:Z}=this.size;if(this.latRange){const K=this.latRange;b=c.Q(K[1])*g,T=c.Q(K[0])*g,T-b<Z&&(z=Z/(T-b))}h&&(E=c.b2(c.O(h[0])*g,0,g),k=c.b2(c.O(h[1])*g,0,g),k<E&&(k+=g),k-E<B&&(M=B/(k-E)));const{x:q,y:Y}=this.project.call({worldSize:g},e);let G,te;const ae=Math.max(M||0,z||0);if(ae){const K=new c.P(M?(k+E)/2:q,z?(T+b)/2:Y);return u.center=this.unproject.call({worldSize:g},K).wrap(),u.zoom+=this.scaleZoom(ae),u}if(this.latRange){const K=Z/2;Y-K<b&&(te=b+K),Y+K>T&&(te=T-K)}if(h){const K=(E+k)/2;let de=q;this._renderWorldCopies&&(de=c.b2(q,K-g/2,K+g/2));const ge=B/2;de-ge<E&&(G=E+ge),de+ge>k&&(G=k-ge)}if(G!==void 0||te!==void 0){const K=new c.P(G??q,te??Y);u.center=this.unproject.call({worldSize:g},K).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=u,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,a=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b4(1,this.center.lat)*this.worldSize;let h=c.an(new Float64Array(16));c.K(h,h,[this.width/2,-this.height/2,1]),c.J(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=c.an(new Float64Array(16)),c.K(h,h,[1,-1,1]),c.J(h,h,[-1,-1,0]),c.K(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h;const g=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this.minElevationForCurrentTile),T=g-b*this._pixelPerMeter/Math.cos(this._pitch),E=b<0?T:g,k=Math.PI/2+this._pitch,z=this._fov*(.5+e.y/this.height),M=Math.sin(z)*E/Math.sin(c.ac(Math.PI-k-z,.01,Math.PI-.01)),B=this.getHorizon(),Z=2*Math.atan(B/this.cameraToCenterDistance)*(.5+e.y/(2*B)),q=Math.sin(Z)*E/Math.sin(c.ac(Math.PI-k-Z,.01,Math.PI-.01)),Y=Math.min(M,q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Y+E),this.nearZ=this.height/50,h=new Float64Array(16),c.b5(h,this._fov,this.width/this.height,this.nearZ,this.farZ),h[8]=2*-e.x/this.width,h[9]=2*e.y/this.height,this.projectionMatrix=c.ae(h),c.K(h,h,[1,-1,1]),c.J(h,h,[0,0,-this.cameraToCenterDistance]),c.b6(h,h,this._pitch),c.ad(h,h,this.angle),c.J(h,h,[-a,-u,0]),this.mercatorMatrix=c.K([],h,[this.worldSize,this.worldSize,this.worldSize]),c.K(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,h),c.J(h,h,[0,0,-this.elevation]),this.modelViewProjectionMatrix=h,this.invModelViewProjectionMatrix=c.as([],h),this.fogMatrix=new Float64Array(16),c.b5(this.fogMatrix,this._fov,this.width/this.height,g,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-u,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,h);const G=this.width%2/2,te=this.height%2/2,ae=Math.cos(this.angle),K=Math.sin(this.angle),de=a-Math.round(a)+ae*G+K*te,ge=u-Math.round(u)+ae*te+K*G,_e=new Float64Array(h);if(c.J(_e,_e,[de>.5?de-1:de,ge>.5?ge-1:ge,0]),this.alignedModelViewProjectionMatrix=_e,h=c.as(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new c.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,e))}getCameraQueryGeometry(e){const a=this.getCameraPoint();if(e.length===1)return[e[0],a];{let u=a.x,h=a.y,g=a.x,b=a.y;for(const T of e)u=Math.min(u,T.x),h=Math.min(h,T.y),g=Math.max(g,T.x),b=Math.max(b,T.y);return[new c.P(u,h),new c.P(g,h),new c.P(g,b),new c.P(u,b),new c.P(u,h)]}}lngLatToCameraDepth(e,a){const u=this.locationCoordinate(e),h=[u.x*this.worldSize,u.y*this.worldSize,a,1];return c.af(h,h,this.modelViewProjectionMatrix),h[2]/h[3]}}function ds(m,e){let a,u=!1,h=null,g=null;const b=()=>{h=null,u&&(m.apply(g,a),h=setTimeout(b,e),u=!1)};return(...T)=>(u=!0,g=this,a=T,h||b(),h)}class ps{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let u;return a.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(u=h)}),(u&&u[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:u,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const u=a.join("/");let h=u;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${u}`);let g=window.location.hash.replace(h,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let b=window.location.href.replace(/(#.+)?$/,g);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=ds(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,h=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,h),b=Math.round(a.lng*g)/g,T=Math.round(a.lat*g)/g,E=this._map.getBearing(),k=this._map.getPitch();let z="";if(z+=e?`/${b}/${T}/${u}`:`${u}/${T}/${b}`,(E||k)&&(z+="/"+Math.round(10*E)/10),k&&(z+=`/${Math.round(k)}`),this._hashName){const M=this._hashName;let B=!1;const Z=window.location.hash.slice(1).split("&").map(q=>{const Y=q.split("=")[0];return Y===M?(B=!0,`${Y}=${z}`):q}).filter(q=>q);return B||Z.push(`${M}=${z}`),`#${Z.join("&")}`}return`#${z}`}}const fa={linearity:.3,easing:c.b7(0,0,.3,1)},$u=c.e({deceleration:2500,maxSpeed:1400},fa),Qh=c.e({deceleration:20,maxSpeed:1400},fa),vl=c.e({deceleration:1e3,maxSpeed:360},fa),xl=c.e({deceleration:1e3,maxSpeed:90},fa);class Zu{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:j.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=j.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(a.pan.mag()){const g=ma(a.pan.mag(),u,c.e({},$u,e||{}));h.offset=a.pan.mult(g.amount/a.pan.mag()),h.center=this._map.transform.center,wl(h,g)}if(a.zoom){const g=ma(a.zoom,u,Qh);h.zoom=this._map.transform.zoom+g.amount,wl(h,g)}if(a.bearing){const g=ma(a.bearing,u,vl);h.bearing=this._map.transform.bearing+c.ac(g.amount,-179,179),wl(h,g)}if(a.pitch){const g=ma(a.pitch,u,xl);h.pitch=this._map.transform.pitch+g.amount,wl(h,g)}if(h.zoom||h.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;h.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(h,{noMoveStart:!0})}}function wl(m,e){(!m.duration||m.duration<e.duration)&&(m.duration=e.duration,m.easing=e.easing)}function ma(m,e,a){const{maxSpeed:u,linearity:h,deceleration:g}=a,b=c.ac(m*h/(e/1e3),-u,u),T=Math.abs(b)/(g*h);return{easing:a.easing,duration:1e3*T,amount:b*(T/2)}}class Ur extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u,h={}){const g=N.mousePos(a.getCanvas(),u),b=a.unproject(g);super(e,c.e({point:g,lngLat:b,originalEvent:u},h)),this._defaultPrevented=!1,this.target=a}}class ga extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u){const h=e==="touchend"?u.changedTouches:u.touches,g=N.touchPos(a.getCanvasContainer(),h),b=g.map(E=>a.unproject(E)),T=g.reduce((E,k,z,M)=>E.add(k.div(M.length)),new c.P(0,0));super(e,{points:g,point:T,lngLats:b,lngLat:a.unproject(T),originalEvent:u}),this._defaultPrevented=!1}}class fs extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class qu{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new fs(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new Ur(e.type,this._map,e))}mouseup(e){this._map.fire(new Ur(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ur(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ur(e.type,this._map,e))}mouseover(e){this._map.fire(new Ur(e.type,this._map,e))}mouseout(e){this._map.fire(new Ur(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ga(e.type,this._map,e))}touchmove(e){this._map.fire(new ga(e.type,this._map,e))}touchend(e){this._map.fire(new ga(e.type,this._map,e))}touchcancel(e){this._map.fire(new ga(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ed{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ur(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ur("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ur(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ya{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(c.P.convert(e),this._map.terrain)}}class ms{constructor(e,a){this._map=e,this._tr=new ya(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(N.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const u=a;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=u,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const g=Math.min(h.x,u.x),b=Math.max(h.x,u.x),T=Math.min(h.y,u.y),E=Math.max(h.y,u.y);N.setTransform(this._box,`translate(${g}px,${T}px)`),this._box.style.width=b-g+"px",this._box.style.height=E-T+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const u=this._startPos,h=a;if(this.reset(),N.suppressClick(),u.x!==h.x||u.y!==h.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(u,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new c.k(e,{originalEvent:a}))}}function gs(m,e){if(m.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${e.length}`);const a={};for(let u=0;u<m.length;u++)a[m[u].identifier]=e[u];return a}class vf{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(h){const g=new c.P(0,0);for(const b of h)g._add(b);return g.div(h.length)}(a),this.touches=gs(u,a)))}touchmove(e,a,u){if(this.aborted||!this.centroid)return;const h=gs(u,a);for(const g in this.touches){const b=h[g];(!b||b.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,a,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class bl{constructor(e){this.singleTap=new vf(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,u){this.singleTap.touchstart(e,a,u)}touchmove(e,a,u){this.singleTap.touchmove(e,a,u)}touchend(e,a,u){const h=this.singleTap.touchend(e,a,u);if(h){const g=e.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(h)<30;if(g&&b||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Tn{constructor(e){this._tr=new ya(e),this._zoomIn=new bl({numTouches:1,numTaps:2}),this._zoomOut=new bl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,u){this._zoomIn.touchstart(e,a,u),this._zoomOut.touchstart(e,a,u)}touchmove(e,a,u){this._zoomIn.touchmove(e,a,u),this._zoomOut.touchmove(e,a,u)}touchend(e,a,u){const h=this._zoomIn.touchend(e,a,u),g=this._zoomOut.touchend(e,a,u),b=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(h)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fi{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=a.length?a[0]:a;return!this._moved&&h.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(u,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&N.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ei={0:1,2:2};class ys{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=N.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(a,u){const h=ei[u];return a.buttons===void 0||(a.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return N.mouseButton(e)===this._eventButton}}class Sl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Tl=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=e=>{e.preventDefault()}},Vo=({enable:m,clickTolerance:e,bearingDegreesPerPixelMoved:a=.8})=>{const u=new ys({checkCorrectEvent:h=>N.mouseButton(h)===0&&h.ctrlKey||N.mouseButton(h)===2});return new fi({clickTolerance:e,move:(h,g)=>({bearingDelta:(g.x-h.x)*a}),moveStateManager:u,enable:m,assignEvents:Tl})},_a=({enable:m,clickTolerance:e,pitchDegreesPerPixelMoved:a=-.5})=>{const u=new ys({checkCorrectEvent:h=>N.mouseButton(h)===0&&h.ctrlKey||N.mouseButton(h)===2});return new fi({clickTolerance:e,move:(h,g)=>({pitchDelta:(g.y-h.y)*a}),moveStateManager:u,enable:m,assignEvents:Tl})};class Hu{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,u){return this._calculateTransform(e,a,u)}touchmove(e,a,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,a,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,u){this._calculateTransform(e,a,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,u){u.length>0&&(this._active=!0);const h=gs(u,a),g=new c.P(0,0),b=new c.P(0,0);let T=0;for(const k in h){const z=h[k],M=this._touches[k];M&&(g._add(z),b._add(z.sub(M)),T++,h[k]=z)}if(this._touches=h,this._shouldBePrevented(T)||!b.mag())return;const E=b.div(T);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(T),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class El{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,u){if(!this._firstTwoTouches)return;e.preventDefault();const[h,g]=this._firstTwoTouches,b=_s(u,a,h),T=_s(u,a,g);if(!b||!T)return;const E=this._aroundCenter?null:b.add(T).div(2);return this._move([b,T],E,e)}touchend(e,a,u){if(!this._firstTwoTouches)return;const[h,g]=this._firstTwoTouches,b=_s(u,a,h),T=_s(u,a,g);b&&T||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function _s(m,e,a){for(let u=0;u<m.length;u++)if(m[u].identifier===a)return e[u]}function Gu(m,e){return Math.log(m/e)/Math.LN2}class Wu extends El{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Gu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gu(this._distance,u),pinchAround:a}}}function Xu(m,e){return 180*m.angleWith(e)/Math.PI}class vo extends El{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,u){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Xu(this._vector,h),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,u=Xu(e,this._startVector);return Math.abs(u)<a}}function Cl(m){return Math.abs(m.y)>Math.abs(m.x)}class Ku extends El{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,u){super.touchstart(e,a,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Cl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,g,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,u){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,g=a.mag()>=2;if(!h&&!g)return;if(!h||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const b=e.y>0==a.y>0;return Cl(e)&&Cl(a)&&b}}const td={panStep:100,bearingStep:15,pitchStep:10};class Ju{constructor(e){this._tr=new ya(e);const a=td;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,u=0,h=0,g=0,b=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),b=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(u=0,h=0),{cameraAnimation:T=>{const E=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:nd,zoom:a?Math.round(E.zoom)+a*(e.shiftKey?2:1):E.zoom,bearing:E.bearing+u*this._bearingStep,pitch:E.pitch+h*this._pitchStep,offset:[-g*this._panStep,-b*this._panStep],center:E.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function nd(m){return m*(2-m)}const Yu=4.000244140625;class Qu{constructor(e,a){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new ya(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=j.now(),h=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,a!==0&&a%Yu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=N.mousePos(this._map.getCanvas(),e),u=this._tr;this._around=a.y>u.transform.height/2-u.transform.getHorizon()?c.N.convert(this._aroundCenter?u.center:u.unproject(a)):c.N.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Yu?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&k!==0&&(k=1/k);const z=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(z*k))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,u=this._startZoom,h=this._easing;let g,b=!1;const T=j.now()-this._lastWheelEventTime;if(this._type==="wheel"&&u&&h&&T){const E=Math.min(T/200,1),k=h(E);g=c.y.number(u,a,k),E<1?this._frameId||(this._frameId=!0):b=!0}else g=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=c.b8;if(this._prevEase){const u=this._prevEase,h=(j.now()-u.start)/u.duration,g=u.easing(h+.01)-u.easing(h),b=.27/Math.sqrt(g*g+1e-4)*.01,T=Math.sqrt(.0729-b*b);a=c.b7(b,T,.25,1)}return this._prevEase={start:j.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class va{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rd{constructor(e){this._tr=new ya(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mi{constructor(){this._tap=new bl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,u){if(!this._swipePoint)if(this._tapTime){const h=a[0],g=e.timeStamp-this._tapTime<500,b=this._tapPoint.dist(h)<30;g&&b?u.length>0&&(this._swipePoint=h,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,a,u)}touchmove(e,a,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const h=a[0],g=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,a,u)}touchend(e,a,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const h=this._tap.touchend(e,a,u);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gi{constructor(e,a,u){this._el=e,this._mousePan=a,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ec{constructor(e,a,u){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=a,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class yi{constructor(e,a,u,h){this._el=e,this._touchZoom=a,this._touchRotate=u,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Uo{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=a,this._container.appendChild(h);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=u,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const kl=m=>m.zoom||m.drag||m.pitch||m.rotate;class xf extends c.k{}function tc(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class wf{constructor(e,a){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,g)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=h.type==="renderFrame"?void 0:h,T={needsRenderFrame:!1},E={},k={},z=h.touches,M=z?this._getMapTouches(z):void 0,B=M?N.touchPos(this._map.getCanvas(),M):N.mousePos(this._map.getCanvas(),h);for(const{handlerName:Y,handler:G,allowed:te}of this._handlers){if(!G.isEnabled())continue;let ae;this._blockedByActive(k,te,Y)?G.reset():G[g||h.type]&&(ae=G[g||h.type](h,B,M),this.mergeHandlerResult(T,E,ae,Y,b),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()),(ae||G.isActive())&&(k[Y]=G)}const Z={};for(const Y in this._previousActiveHandlers)k[Y]||(Z[Y]=b);this._previousActiveHandlers=k,(Object.keys(Z).length||tc(T))&&(this._changes.push([T,E,Z]),this._triggerRenderFrame()),(Object.keys(k).length||tc(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=T;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zu(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,g,b]of this._listeners)N.addEventListener(h,g,h===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[e,a,u]of this._listeners)N.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const a=this._map,u=a.getCanvasContainer();this._add("mapEvent",new qu(a,e));const h=a.boxZoom=new ms(a,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const g=a.cooperativeGestures=new Uo(a,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();const b=new Tn(a),T=new rd(a);a.doubleClickZoom=new va(T,b),this._add("tapZoom",b),this._add("clickZoom",T),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const E=new mi;this._add("tapDragZoom",E);const k=a.touchPitch=new Ku(a);this._add("touchPitch",k),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const z=Vo(e),M=_a(e);a.dragRotate=new ec(e,z,M),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const B=(({enable:ae,clickTolerance:K})=>{const de=new ys({checkCorrectEvent:ge=>N.mouseButton(ge)===0&&!ge.ctrlKey});return new fi({clickTolerance:K,move:(ge,_e)=>({around:_e,panDelta:_e.sub(ge)}),activateOnStart:!0,moveStateManager:de,enable:ae,assignEvents:Tl})})(e),Z=new Hu(e,a);a.dragPan=new gi(u,B,Z),this._add("mousePan",B),this._add("touchPan",Z,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const q=new vo,Y=new Wu;a.touchZoomRotate=new yi(u,Y,q,E),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",Y,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);const G=a.scrollZoom=new Qu(a,()=>this._triggerRenderFrame());this._add("scrollZoom",G,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const te=a.keyboard=new Ju(a);this._add("keyboard",te),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new ed(a))}_add(e,a,u){this._handlers.push({handlerName:e,handler:a,allowed:u}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!kl(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,u){for(const h in e)if(h!==u&&(!a||a.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const u of e)this._el.contains(u.target)&&a.push(u);return a}mergeHandlerResult(e,a,u,h,g){if(!u)return;c.e(e,u);const b={handlerName:h,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(a.zoom=b),u.panDelta!==void 0&&(a.drag=b),u.pitchDelta!==void 0&&(a.pitch=b),u.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const e={},a={},u={};for(const[h,g,b]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),c.e(a,g),c.e(u,b);this._updateMapTransform(e,a,u),this._changes=[]}_updateMapTransform(e,a,u){const h=this._map,g=h._getTransformForUpdate(),b=h.terrain;if(!(tc(e)||b&&this._terrainMovement))return this._fireEvents(a,u,!0);let{panDelta:T,zoomDelta:E,bearingDelta:k,pitchDelta:z,around:M,pinchAround:B}=e;B!==void 0&&(M=B),h._stop(!0),M=M||h.transform.centerPoint;const Z=g.pointLocation(T?M.sub(T):M);k&&(g.bearing+=k),z&&(g.pitch+=z),E&&(g.zoom+=E),b?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?g.center=g.pointLocation(g.centerPoint.sub(T)):g.setLocationAtPoint(Z,M):(this._terrainMovement=!0,this._map._elevationFreeze=!0,g.setLocationAtPoint(Z,M)):g.setLocationAtPoint(Z,M),h._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,u,!0)}_fireEvents(e,a,u){const h=kl(this._eventsInProgress),g=kl(e),b={};for(const M in e){const{originalEvent:B}=e[M];this._eventsInProgress[M]||(b[`${M}start`]=B),this._eventsInProgress[M]=e[M]}!h&&g&&this._fireEvent("movestart",g.originalEvent);for(const M in b)this._fireEvent(M,b[M]);g&&this._fireEvent("move",g.originalEvent);for(const M in e){const{originalEvent:B}=e[M];this._fireEvent(M,B)}const T={};let E;for(const M in this._eventsInProgress){const{handlerName:B,originalEvent:Z}=this._eventsInProgress[M];this._handlersById[B].isActive()||(delete this._eventsInProgress[M],E=a[B]||Z,T[`${M}end`]=E)}for(const M in T)this._fireEvent(M,T[M]);const k=kl(this._eventsInProgress),z=(h||g)&&!k;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const M=this._map._getTransformForUpdate();M.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(M)}if(u&&z){this._updatingCamera=!0;const M=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;!M||!M.essential&&j.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),B(this._map.getBearing())&&this._map.resetNorth()):(B(M.bearing||this._map.getBearing())&&(M.bearing=0),M.freezeElevation=!0,this._map.easeTo(M,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new c.k(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new xf("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class id extends c.E{constructor(e,a){super(),this._renderFrameCallback=()=>{const u=Math.min((j.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}panBy(e,a,u){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},a),u)}panTo(e,a,u){return this.easeTo(c.e({center:e},a),u)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,u){return this.easeTo(c.e({zoom:e},a),u)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,u){return this.easeTo(c.e({bearing:e},a),u)}resetNorth(e,a){return this.rotateTo(0,c.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}cameraForBounds(e,a){e=we.convert(e);const u=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,a)}_cameraForBoxAndBearing(e,a,u,h){const g={top:0,bottom:0,right:0,left:0};if(typeof(h=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Oe=h.padding;h.padding={top:Oe,bottom:Oe,right:Oe,left:Oe}}h.padding=c.e(g,h.padding);const b=this.transform,T=b.padding,E=new we(e,a),k=b.project(E.getNorthWest()),z=b.project(E.getNorthEast()),M=b.project(E.getSouthEast()),B=b.project(E.getSouthWest()),Z=c.b9(-u),q=k.rotate(Z),Y=z.rotate(Z),G=M.rotate(Z),te=B.rotate(Z),ae=new c.P(Math.max(q.x,Y.x,te.x,G.x),Math.max(q.y,Y.y,te.y,G.y)),K=new c.P(Math.min(q.x,Y.x,te.x,G.x),Math.min(q.y,Y.y,te.y,G.y)),de=ae.sub(K),ge=(b.width-(T.left+T.right+h.padding.left+h.padding.right))/de.x,_e=(b.height-(T.top+T.bottom+h.padding.top+h.padding.bottom))/de.y;if(_e<0||ge<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Me=Math.min(b.scaleZoom(b.scale*Math.min(ge,_e)),h.maxZoom),Be=c.P.convert(h.offset),Je=new c.P((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(c.b9(u)),Ye=Be.add(Je).mult(b.scale/b.zoomScale(Me));return{center:b.unproject(k.add(M).div(2).sub(Ye)),zoom:Me,bearing:u}}fitBounds(e,a,u){return this._fitInternal(this.cameraForBounds(e,a),a,u)}fitScreenCoordinates(e,a,u,h,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(e)),this.transform.pointLocation(c.P.convert(a)),u,h),h,g)}_fitInternal(e,a,u){return e?(delete(a=c.e(e,a)).padding,a.linear?this.easeTo(a,u):this.flyTo(a,u)):this}jumpTo(e,a){this.stop();const u=this._getTransformForUpdate();let h=!1,g=!1,b=!1;return"zoom"in e&&u.zoom!==+e.zoom&&(h=!0,u.zoom=+e.zoom),e.center!==void 0&&(u.center=c.N.convert(e.center)),"bearing"in e&&u.bearing!==+e.bearing&&(g=!0,u.bearing=+e.bearing),"pitch"in e&&u.pitch!==+e.pitch&&(b=!0,u.pitch=+e.pitch),e.padding==null||u.isPaddingEqual(e.padding)||(u.padding=e.padding),this._applyUpdatedTransform(u),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),h&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),g&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),b&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(e,a,u,h=0){const g=c.Z.fromLngLat(e,a),b=c.Z.fromLngLat(u,h),T=b.x-g.x,E=b.y-g.y,k=b.z-g.z,z=Math.hypot(T,E,k);if(z===0)throw new Error("Can't calculate camera options with same From and To");const M=Math.hypot(T,E),B=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),Z=180*Math.atan2(T,-E)/Math.PI;let q=180*Math.acos(M/z)/Math.PI;return q=k<0?90-q:90+q,{center:b.toLngLat(),zoom:B,pitch:q,bearing:Z}}easeTo(e,a){var u;this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.b8},e)).animate===!1||!e.essential&&j.prefersReducedMotion)&&(e.duration=0);const h=this._getTransformForUpdate(),g=h.zoom,b=h.bearing,T=h.pitch,E=h.padding,k="bearing"in e?this._normalizeBearing(e.bearing,b):b,z="pitch"in e?+e.pitch:T,M="padding"in e?e.padding:h.padding,B=c.P.convert(e.offset);let Z=h.centerPoint.add(B);const q=h.pointLocation(Z),{center:Y,zoom:G}=h.getConstrained(c.N.convert(e.center||q),(u=e.zoom)!==null&&u!==void 0?u:g);this._normalizeCenter(Y,h);const te=h.project(q),ae=h.project(Y).sub(te),K=h.zoomScale(G-g);let de,ge;e.around&&(de=c.N.convert(e.around),ge=h.locationPoint(de));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==g,this._rotating=this._rotating||b!==k,this._pitching=this._pitching||z!==T,this._padding=!h.isPaddingEqual(M),this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,_e),this.terrain&&this._prepareElevation(Y),this._ease(Me=>{if(this._zooming&&(h.zoom=c.y.number(g,G,Me)),this._rotating&&(h.bearing=c.y.number(b,k,Me)),this._pitching&&(h.pitch=c.y.number(T,z,Me)),this._padding&&(h.interpolatePadding(E,M,Me),Z=h.centerPoint.add(B)),this.terrain&&!e.freezeElevation&&this._updateElevation(Me),de)h.setLocationAtPoint(de,ge);else{const Be=h.zoomScale(h.zoom-g),Je=G>g?Math.min(2,K):Math.max(.5,K),Ye=Math.pow(Je,1-Me),Oe=h.unproject(te.add(ae.mult(Me*Ye)).mult(Be));h.setLocationAtPoint(h.renderWorldCopies?Oe.wrap():Oe,Z)}this._applyUpdatedTransform(h),this._fireMoveEvents(a)},Me=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Me)},e),this}_prepareEase(e,a,u={}){this._moving=!0,a||u.moving||this.fire(new c.k("movestart",e)),this._zooming&&!u.zooming&&this.fire(new c.k("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new c.k("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new c.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(a-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const a=e.getCameraPosition(),u=this.terrain.getElevationForLngLatZoom(a.lngLat,e.zoom);if(a.altitude<u){const h=this.calculateCameraOptionsFromTo(a.lngLat,u,e.center,e.elevation);return{pitch:h.pitch,zoom:h.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(this.terrain&&a.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&a.push(h=>this.transformCameraUpdate(h)),!a.length)return;const u=e.clone();for(const h of a){const g=u.clone(),{center:b,zoom:T,pitch:E,bearing:k,elevation:z}=h(g);b&&(g.center=b),T!==void 0&&(g.zoom=T),E!==void 0&&(g.pitch=E),k!==void 0&&(g.bearing=k),z!==void 0&&(g.elevation=z),u.apply(g)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new c.k("move",e)),this._zooming&&this.fire(new c.k("zoom",e)),this._rotating&&this.fire(new c.k("rotate",e)),this._pitching&&this.fire(new c.k("pitch",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const u=this._zooming,h=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new c.k("zoomend",e)),h&&this.fire(new c.k("rotateend",e)),g&&this.fire(new c.k("pitchend",e)),this.fire(new c.k("moveend",e))}flyTo(e,a){var u;if(!e.essential&&j.prefersReducedMotion){const Ge=c.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ge,a)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b8},e);const h=this._getTransformForUpdate(),g=h.zoom,b=h.bearing,T=h.pitch,E=h.padding,k="bearing"in e?this._normalizeBearing(e.bearing,b):b,z="pitch"in e?+e.pitch:T,M="padding"in e?e.padding:h.padding,B=c.P.convert(e.offset);let Z=h.centerPoint.add(B);const q=h.pointLocation(Z),{center:Y,zoom:G}=h.getConstrained(c.N.convert(e.center||q),(u=e.zoom)!==null&&u!==void 0?u:g);this._normalizeCenter(Y,h);const te=h.zoomScale(G-g),ae=h.project(q),K=h.project(Y).sub(ae);let de=e.curve;const ge=Math.max(h.width,h.height),_e=ge/te,Me=K.mag();if("minZoom"in e){const Ge=c.ac(Math.min(e.minZoom,g,G),h.minZoom,h.maxZoom),bt=ge/h.zoomScale(Ge-g);de=Math.sqrt(bt/Me*2)}const Be=de*de;function Je(Ge){const bt=(_e*_e-ge*ge+(Ge?-1:1)*Be*Be*Me*Me)/(2*(Ge?_e:ge)*Be*Me);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Ye(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function Oe(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const je=Je(!1);let st=function(Ge){return Oe(je)/Oe(je+de*Ge)},Ct=function(Ge){return ge*((Oe(je)*(Ye(bt=je+de*Ge)/Oe(bt))-Ye(je))/Be)/Me;var bt},qe=(Je(!0)-je)/de;if(Math.abs(Me)<1e-6||!isFinite(qe)){if(Math.abs(ge-_e)<1e-6)return this.easeTo(e,a);const Ge=_e<ge?-1:1;qe=Math.abs(Math.log(_e/ge))/de,Ct=()=>0,st=bt=>Math.exp(Ge*de*bt)}return e.duration="duration"in e?+e.duration:1e3*qe/("screenSpeed"in e?+e.screenSpeed/de:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=b!==k,this._pitching=z!==T,this._padding=!h.isPaddingEqual(M),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(Y),this._ease(Ge=>{const bt=Ge*qe,tn=1/st(bt);h.zoom=Ge===1?G:g+h.scaleZoom(tn),this._rotating&&(h.bearing=c.y.number(b,k,Ge)),this._pitching&&(h.pitch=c.y.number(T,z,Ge)),this._padding&&(h.interpolatePadding(E,M,Ge),Z=h.centerPoint.add(B)),this.terrain&&!e.freezeElevation&&this._updateElevation(Ge);const zt=Ge===1?Y:h.unproject(ae.add(K.mult(Ct(bt))).mult(tn));h.setLocationAtPoint(h.renderWorldCopies?zt.wrap():zt,Z),this._applyUpdatedTransform(h),this._fireMoveEvents(a)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,a)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,a,u){u.animate===!1||u.duration===0?(e(1),a()):(this._easeStart=j.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=c.b2(e,-180,180);const u=Math.abs(e-a);return Math.abs(e-360-a)<u&&(e-=360),Math.abs(e+360-a)<u&&(e+=360),e}_normalizeCenter(e,a){if(!a.renderWorldCopies||a.lngRange)return;const u=e.lng-a.center.lng;e.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const xa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Oi{constructor(e=xa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const u=this._map._getUIString(`AttributionControl.${a}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const a=this._map.style.sourceCaches;for(const h in a){const g=a[h];if(g.used||g.usedForTerrain){const b=g.getSource();b.attribution&&e.indexOf(b.attribution)<0&&e.push(b.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,g)=>h.length-g.length),e=e.filter((h,g)=>{for(let b=g+1;b<e.length;b++)if(e[b].indexOf(h)>=0)return!1;return!0});const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class et{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const u=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const a=N.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class od{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,u=a?this._queue.concat(a):this._queue;for(const h of u)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const u of a)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var nc=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class ad extends c.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];const u={};for(const h of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))u[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.posMatrix=new Float64Array(16),c.aP(h.posMatrix,0,c.X,0,c.X,0,1),this._tiles[h.key]=new pi(h,this.tileSize));for(const h in this._tiles)u[h]||delete this._tiles[h]}freeRtt(e){for(const a in this._tiles){const u=this._tiles[a];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const a={};for(const u of this._renderableTilesKeys){const h=this._tiles[u].tileID;if(h.canonical.equals(e.canonical)){const g=e.clone();g.posMatrix=new Float64Array(16),c.aP(g.posMatrix,0,c.X,0,c.X,0,1),a[u]=g}else if(h.canonical.isChildOf(e.canonical)){const g=e.clone();g.posMatrix=new Float64Array(16);const b=h.canonical.z-e.canonical.z,T=h.canonical.x-(h.canonical.x>>b<<b),E=h.canonical.y-(h.canonical.y>>b<<b),k=c.X>>b;c.aP(g.posMatrix,0,k,0,k,0,1),c.J(g.posMatrix,g.posMatrix,[-T*k,-E*k,0]),a[u]=g}else if(e.canonical.isChildOf(h.canonical)){const g=e.clone();g.posMatrix=new Float64Array(16);const b=e.canonical.z-h.canonical.z,T=e.canonical.x-(e.canonical.x>>b<<b),E=e.canonical.y-(e.canonical.y>>b<<b),k=c.X>>b;c.aP(g.posMatrix,0,c.X,0,c.X,0,1),c.J(g.posMatrix,g.posMatrix,[T*k,E*k,0]),c.K(g.posMatrix,g.posMatrix,[1/2**b,1/2**b,0]),a[u]=g}}return a}getSourceTile(e,a){const u=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>u.maxzoom&&(h=u.maxzoom),h<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&a)for(;h>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(h--).key);return g}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=e)}}class vs{constructor(e,a,u){this.painter=e,this.sourceCache=new ad(a),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,u,h=c.X){var g;if(!(a>=0&&a<h&&u>=0&&u<h))return 0;const b=this.getTerrainData(e),T=(g=b.tile)===null||g===void 0?void 0:g.dem;if(!T)return 0;const E=function(q,Y,G){var te=Y[0],ae=Y[1];return q[0]=G[0]*te+G[4]*ae+G[12],q[1]=G[1]*te+G[5]*ae+G[13],q}([],[a/h*c.X,u/h*c.X],b.u_terrain_matrix),k=[E[0]*T.dim,E[1]*T.dim],z=Math.floor(k[0]),M=Math.floor(k[1]),B=k[0]-z,Z=k[1]-M;return T.get(z,M)*(1-B)*(1-Z)+T.get(z+1,M)*B*(1-Z)+T.get(z,M+1)*(1-B)*Z+T.get(z+1,M+1)*B*Z}getElevationForLngLatZoom(e,a){if(!c.ba(a,e.wrap()))return 0;const{tileID:u,mercatorX:h,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(u,h%c.X,g%c.X,c.X)}getElevation(e,a,u,h=c.X){return this.getDEMElevation(e,a,u,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(h,g,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(h,new c.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const h=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new ot(h,a.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),a.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const u=a&&a+a.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const h=this.sourceCache.sourceCache._source.maxzoom;let g=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?g=e.canonical.z-h:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=e.canonical.x-(e.canonical.x>>g<<g),T=e.canonical.y-(e.canonical.y>>g<<g),E=c.bb(new Float64Array(16),[1/(c.X<<g),1/(c.X<<g),0]);c.J(E,E,[b*c.X,T*c.X,0]),this._demMatrixCache[e.key]={matrix:E,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,u=a.width/devicePixelRatio,h=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(a.context,{width:u,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(a.context,{width:u,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(u,h,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,u,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,b=0;g<this._coordsTextureSize;g++)for(let T=0;T<this._coordsTextureSize;T++,b+=4)a[b+0]=255&T,a[b+1]=255&g,a[b+2]=T>>8<<4|g>>8,a[b+3]=0;const u=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),h=new ot(e,u,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),u=this.painter.context,h=u.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(g,T-b-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null);const E=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),z=this.coordsIndex[255-a[3]],M=z&&this.sourceCache.getTileByID(z);if(!M)return null;const B=this._coordsTextureSize,Z=(1<<M.tileID.canonical.z)*B;return new c.Z((M.tileID.canonical.x*B+E)/Z+M.tileID.wrap,(M.tileID.canonical.y*B+k)/Z,this.getElevation(M.tileID,E,k,B))}depthAtPoint(e){const a=new Uint8Array(4),u=this.painter.context,h=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,a=new c.bc,u=new c.aX,h=this.meshSize,g=c.X/h,b=h*h;for(let M=0;M<=h;M++)for(let B=0;B<=h;B++)a.emplaceBack(B*g,M*g,0);for(let M=0;M<b;M+=h+1)for(let B=0;B<h;B++)u.emplaceBack(B+M,h+B+M+1,h+B+M+2),u.emplaceBack(B+M,h+B+M+2,B+M+1);const T=a.length,E=T+2*(h+1);for(const M of[0,1])for(let B=0;B<=h;B++)for(const Z of[0,1])a.emplaceBack(B*g,M*c.X,Z);for(let M=0;M<2*h;M+=2)u.emplaceBack(E+M,E+M+1,E+M+3),u.emplaceBack(E+M,E+M+3,E+M+2),u.emplaceBack(T+M,T+M+3,T+M+1),u.emplaceBack(T+M,T+M+2,T+M+3);const k=a.length,z=k+2*(h+1);for(const M of[0,1])for(let B=0;B<=h;B++)for(const Z of[0,1])a.emplaceBack(M*c.X,B*g,Z);for(let M=0;M<2*h;M+=2)u.emplaceBack(k+M,k+M+1,k+M+3),u.emplaceBack(k+M,k+M+3,k+M+2),u.emplaceBack(z+M,z+M+3,z+M+1),u.emplaceBack(z+M,z+M+2,z+M+3);return this._mesh=new Vu(e.createVertexBuffer(a,nc.members),e.createIndexBuffer(u),c.a0.simpleSegment(0,0,a.length,u.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*c.bd/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,a){var u;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(u=this.getMinMaxElevation(h).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return a&&a.dem&&(u.minElevation=a.dem.min*this.exaggeration,u.maxElevation=a.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,a){const u=c.Z.fromLngLat(e.wrap()),h=(1<<a)*c.X,g=u.x*h,b=u.y*h,T=Math.floor(g/c.X),E=Math.floor(b/c.X);return{tileID:new c.S(a,0,a,T,E),mercatorX:g,mercatorY:b}}}class xs{constructor(e,a,u){this._context=e,this._size=a,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(u.texture),{id:e,fbo:a,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>e.id!==a),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const $o={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Bt{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new xs(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(a)),this._coordsDescendingInv={};for(const u in e.sourceCaches){this._coordsDescendingInv[u]={};const h=e.sourceCaches[u].getVisibleCoordinates();for(const g of h){const b=this.terrain.sourceCache.getTerrainCoords(g);for(const T in b)this._coordsDescendingInv[u][T]||(this._coordsDescendingInv[u][T]=[]),this._coordsDescendingInv[u][T].push(b[T])}}this._coordsDescendingInvStr={};for(const u of e._order){const h=e._layers[u],g=h.source;if($o[h.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const b in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][b]=this._coordsDescendingInv[g][b].map(T=>T.key).sort().join()}}for(const u of this._renderableTiles)for(const h in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[h][u.tileID.key];g&&g!==u.rttCoords[h]&&(u.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const a=e.type,u=this.painter,h=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if($o[a]&&(this._prevType&&$o[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(e.id),!h))return!0;if($o[this._prevType]||$o[a]&&h){this._prevType=a;const g=this._stacks.length-1,b=this._stacks[g]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Jh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[g]){const k=this.pool.getObjectForId(T.rtt[g].id);if(k.stamp===T.rtt[g].stamp){this.pool.useObject(k);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),T.rtt[g]={id:E.id,stamp:E.stamp},u.context.bindFramebuffer.set(E.fbo.framebuffer),u.context.clear({color:c.aM.transparent,stencil:0}),u.currentStencilSource=void 0;for(let k=0;k<b.length;k++){const z=u.style._layers[b[k]],M=z.source?this._coordsDescendingInv[z.source][T.tileID.key]:[T.tileID];u.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),u._renderTileClippingMasks(z,M),u.renderLayer(u,u.style.sourceCaches[z.source],z,M),z.source&&(T.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][T.tileID.key])}}return Jh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),$o[a]}return!1}}const rc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},bf=A,ic={hash:!1,interactive:!0,bearingSnap:7,attributionControl:xa,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},sd=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},Sf={showCompass:!0,showZoom:!0,visualizePitch:!1};class ld{constructor(e,a,u=!1){this.mousedown=b=>{this.startMouse(c.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),N.mousePos(this.element,b)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,N.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const h=e.dragRotate._mouseRotate.getClickTolerance(),g=e.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=Vo({clickTolerance:h,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:T,bearingDegreesPerPixelMoved:E=.8})=>{const k=new Sl;return new fi({clickTolerance:T,move:(z,M)=>({bearingDelta:(M.x-z.x)*E}),moveStateManager:k,enable:b,assignEvents:sd})})({clickTolerance:h,enable:!0}),this.map=e,u&&(this.mousePitch=_a({clickTolerance:g,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:T,pitchDegreesPerPixelMoved:E=-.5})=>{const k=new Sl;return new fi({clickTolerance:T,move:(z,M)=>({pitchDelta:(M.y-z.y)*E}),moveStateManager:k,enable:b,assignEvents:sd})})({clickTolerance:g,enable:!0})),N.addEventListener(a,"mousedown",this.mousedown),N.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(a,"touchcancel",this.reset)}startMouse(e,a){this.mouseRotate.dragStart(e,a),this.mousePitch&&this.mousePitch.dragStart(e,a),N.disableDrag()}startTouch(e,a){this.touchRotate.dragStart(e,a),this.touchPitch&&this.touchPitch.dragStart(e,a),N.disableDrag()}moveMouse(e,a){const u=this.map,{bearingDelta:h}=this.mouseRotate.dragMove(e,a)||{};if(h&&u.setBearing(u.getBearing()+h),this.mousePitch){const{pitchDelta:g}=this.mousePitch.dragMove(e,a)||{};g&&u.setPitch(u.getPitch()+g)}}moveTouch(e,a){const u=this.map,{bearingDelta:h}=this.touchRotate.dragMove(e,a)||{};if(h&&u.setBearing(u.getBearing()+h),this.touchPitch){const{pitchDelta:g}=this.touchPitch.dragMove(e,a)||{};g&&u.setPitch(u.getPitch()+g)}}off(){const e=this.element;N.removeEventListener(e,"mousedown",this.mousedown),N.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let eo;function oc(m,e,a){const u=new c.N(m.lng,m.lat);if(m=new c.N(m.lng,m.lat),e){const h=new c.N(m.lng-360,m.lat),g=new c.N(m.lng+360,m.lat),b=a.locationPoint(m).distSqr(e);a.locationPoint(h).distSqr(e)<b?m=h:a.locationPoint(g).distSqr(e)<b&&(m=g)}for(;Math.abs(m.lng-a.center.lng)>180;){const h=a.locationPoint(m);if(h.x>=0&&h.y>=0&&h.x<=a.width&&h.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m.lng!==u.lng&&a.locationPoint(m).y>a.height/2-a.getHorizon()?m:u}const ac={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sc(m,e,a){const u=m.classList;for(const h in ac)u.remove(`maplibregl-${a}-anchor-${h}`);u.add(`maplibregl-${a}-anchor-${e}`)}class lc extends c.E{constructor(e){if(super(),this._onKeyPress=a=>{const u=a.code,h=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=a=>{const u=a.originalEvent.target,h=this._element;this._popup&&(u===h||h.contains(u))&&this.togglePopup()},this._update=a=>{var u;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?oc(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${ac[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${g}`),j.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const a=N.createNS("http://www.w3.org/2000/svg","svg"),u=41,h=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${u}px`),a.setAttributeNS(null,"width",`${h}px`),a.setAttributeNS(null,"viewBox",`0 0 ${h} ${u}`);const g=N.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const b=N.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const T=N.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of E){const ae=N.createNS("http://www.w3.org/2000/svg","ellipse");ae.setAttributeNS(null,"opacity","0.04"),ae.setAttributeNS(null,"cx","10.5"),ae.setAttributeNS(null,"cy","5.80029008"),ae.setAttributeNS(null,"rx",te.rx),ae.setAttributeNS(null,"ry",te.ry),T.appendChild(ae)}const k=N.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const z=N.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(z);const M=N.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"opacity","0.25"),M.setAttributeNS(null,"fill","#000000");const B=N.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),M.appendChild(B);const Z=N.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const q=N.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Y=N.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#000000"),Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962");const G=N.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#FFFFFF"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962"),q.appendChild(Y),q.appendChild(G),b.appendChild(T),b.appendChild(k),b.appendChild(M),b.appendChild(Z),b.appendChild(q),a.appendChild(b),a.setAttributeNS(null,"height",u*this._scale+"px"),a.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),sc(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,u;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,g=h.terrain.depthAtPoint(this._pos),b=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,b)-g<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/h.transform._pixelPerMeter,E=Math.sin(h.getPitch()*Math.PI/180)*T,k=h.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),z=h.transform.lngLatToCameraDepth(this._lngLat,b+E)-k>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return e===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Tf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ni=0,Kt=!1;const Il={maxWidth:100,unit:"metric"};function Pl(m,e,a){const u=a&&a.maxWidth||100,h=m._container.clientHeight/2,g=m.unproject([0,h]),b=m.unproject([u,h]),T=g.distanceTo(b);if(a&&a.unit==="imperial"){const E=3.2808*T;E>5280?wa(e,u,E/5280,m._getUIString("ScaleControl.Miles")):wa(e,u,E,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?wa(e,u,T/1852,m._getUIString("ScaleControl.NauticalMiles")):T>=1e3?wa(e,u,T/1e3,m._getUIString("ScaleControl.Kilometers")):wa(e,u,T,m._getUIString("ScaleControl.Meters"))}function wa(m,e,a,u){const h=function(g){const b=Math.pow(10,`${Math.floor(g)}`.length-1);let T=g/b;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(E){const k=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*k)/k}(T),b*T}(a);m.style.width=e*(h/a)+"px",m.innerHTML=`${h}&nbsp;${u}`}const ud={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},cd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hd(m){if(m){if(typeof m=="number"){const e=Math.round(Math.abs(m)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,m),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-m),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(m,0),right:new c.P(-m,0)}}if(m instanceof c.P||Array.isArray(m)){const e=c.P.convert(m);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(m.center||[0,0]),top:c.P.convert(m.top||[0,0]),"top-left":c.P.convert(m["top-left"]||[0,0]),"top-right":c.P.convert(m["top-right"]||[0,0]),bottom:c.P.convert(m.bottom||[0,0]),"bottom-left":c.P.convert(m["bottom-left"]||[0,0]),"bottom-right":c.P.convert(m["bottom-right"]||[0,0]),left:c.P.convert(m.left||[0,0]),right:c.P.convert(m.right||[0,0])}}return hd(new c.P(0,0))}const ji=A;v.AJAXError=c.bg,v.Evented=c.E,v.LngLat=c.N,v.MercatorCoordinate=c.Z,v.Point=c.P,v.addProtocol=c.bh,v.config=c.a,v.removeProtocol=c.bi,v.AttributionControl=Oi,v.BoxZoomHandler=ms,v.CanvasSource=wr,v.CooperativeGesturesHandler=Uo,v.DoubleClickZoomHandler=va,v.DragPanHandler=gi,v.DragRotateHandler=ec,v.EdgeInsets=cs,v.FullscreenControl=class extends c.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a==null?void 0:a.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=po,v.GeolocateControl=class extends c.E{constructor(m){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new c.N(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,h=this._map.getBearing(),g=c.e({bearing:h},this.options.fitBoundsOptions),b=we.fromLngLat(a,u);this._map.fitBounds(b,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new c.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Kt)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lc({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Tf,m)}onAdd(m){return this._map=m,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(eo!==void 0&&!e)return eo;if(window.navigator.permissions===void 0)return eo=!!window.navigator.geolocation,eo;try{eo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{eo=!!window.navigator.geolocation}return eo})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ni=0,Kt=!1}_isOutOfMapMaxBounds(m){const e=this._map.getMaxBounds(),a=m.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),e=m.getSouthEast(),a=m.getNorthEast(),u=e.distanceTo(a),h=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ni--,Kt=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ni++,Ni>1?(m={maximumAge:6e5,timeout:0},Kt=!0):(m=this.options.positionOptions,Kt=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.Hash=ps,v.ImageSource=ci,v.KeyboardHandler=Ju,v.LngLatBounds=we,v.LogoControl=et,v.Map=class extends id{constructor(m){c.be.mark(c.bf.create);const e=Object.assign(Object.assign({},ic),m);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new hs(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new od,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},rc),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ue.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ce(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const u=ds(h=>{this._trackResize&&!this._removed&&this.resize(h)._update()},50);this._resizeObserver=new ResizeObserver(h=>{a?u(h):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new wf(this,e),this._hash=e.hash&&new ps(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,c.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Oi(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new et,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(m,e){if(e===void 0&&(e=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(a,u.firstChild):u.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(m);return e>-1&&this._controls.splice(e,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,e,a,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,e,a,u)}resize(m){var e;const a=this._containerDimensions(),u=a[0],h=a[1],g=this._getClampedPixelRatio(u,h);if(this._resizeCanvas(u,h,g),this.painter.resize(u,h,g),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const E=this._getClampedPixelRatio(u,h);this._resizeCanvas(u,h,E),this.painter.resize(u,h,E)}this.transform.resize(u,h),(e=this._requestedCameraState)===null||e===void 0||e.resize(u,h);const b=!this._moving;return b&&(this.stop(),this.fire(new c.k("movestart",m)).fire(new c.k("move",m))),this.fire(new c.k("resize",m)),b&&this.fire(new c.k("moveend",m)),this}_getClampedPixelRatio(m,e){const{0:a,1:u}=this._maxCanvasSize,h=this.getPixelRatio(),g=m*h,b=e*h;return Math.min(g>a?a/g:1,b>u?u/b:1)*h}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(we.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(c.N.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(c.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,e,a){if(m==="mouseenter"||m==="mouseover"){let u=!1;return{layer:e,listener:a,delegates:{mousemove:g=>{const b=this.getLayer(e)?this.queryRenderedFeatures(g.point,{layers:[e]}):[];b.length?u||(u=!0,a.call(this,new Ur(m,this,g.originalEvent,{features:b}))):u=!1},mouseout:()=>{u=!1}}}}if(m==="mouseleave"||m==="mouseout"){let u=!1;return{layer:e,listener:a,delegates:{mousemove:b=>{(this.getLayer(e)?this.queryRenderedFeatures(b.point,{layers:[e]}):[]).length?u=!0:u&&(u=!1,a.call(this,new Ur(m,this,b.originalEvent)))},mouseout:b=>{u&&(u=!1,a.call(this,new Ur(m,this,b.originalEvent)))}}}}{const u=h=>{const g=this.getLayer(e)?this.queryRenderedFeatures(h.point,{layers:[e]}):[];g.length&&(h.features=g,a.call(this,h),delete h.features)};return{layer:e,listener:a,delegates:{[m]:u}}}}on(m,e,a){if(a===void 0)return super.on(m,e);const u=this._createDelegatedListener(m,e,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(u);for(const h in u.delegates)this.on(h,u.delegates[h]);return this}once(m,e,a){if(a===void 0)return super.once(m,e);const u=this._createDelegatedListener(m,e,a);for(const h in u.delegates)this.once(h,u.delegates[h]);return this}off(m,e,a){return a===void 0?super.off(m,e):(this._delegatedListeners&&this._delegatedListeners[m]&&(u=>{const h=this._delegatedListeners[m];for(let g=0;g<h.length;g++){const b=h[g];if(b.layer===e&&b.listener===a){for(const T in b.delegates)this.off(T,b.delegates[T]);return h.splice(g,1),this}}})(),this)}queryRenderedFeatures(m,e){if(!this.style)return[];let a;const u=m instanceof c.P||Array.isArray(m),h=u?m:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:m)||{},h instanceof c.P||typeof h[0]=="number")a=[c.P.convert(h)];else{const g=c.P.convert(h[0]),b=c.P.convert(h[1]);a=[g,new c.P(b.x,g.y),b,new c.P(g.x,b.y),g]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(m,e){return this.style.querySourceFeatures(m,e)}setStyle(m,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(m,e))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const e=this._locale[m];if(e==null)throw new Error(`Missing UI string '${m}'`);return e}_updateStyle(m,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,e));const a=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Tu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,e,a):this.style.loadJSON(m,e,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Tu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,e){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,"Style");c.h(a,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new c.j(u))})}else typeof m=="object"&&this._updateDiff(m,e)}_updateDiff(m,e){try{this.style.setState(m,e)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(m,e){return this._lazyInitEmptyStyle(),this.style.addSource(m,e),this._update(!0)}isSourceLoaded(m){const e=this.style&&this.style.sourceCaches[m];if(e!==void 0)return e.loaded();this.fire(new c.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const e=this.style.sourceCaches[m.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const u=this.style._layers[a];u.type==="hillshade"&&u.source===m.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new vs(this.painter,e,m),this.painter.renderToTexture=new Bt(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:m})),this}getTerrain(){var m,e;return(e=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const e in m){const a=m[e]._tiles;for(const u in a){const h=a[u];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,e,a={}){const{pixelRatio:u=1,sdf:h=!1,stretchX:g,stretchY:b,content:T,textFitWidth:E,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:M,data:B}=e,Z=e;return this.style.addImage(m,{data:new c.R({width:z,height:M},new Uint8Array(B)),pixelRatio:u,stretchX:g,stretchY:b,content:T,textFitWidth:E,textFitHeight:k,sdf:h,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,m),this}}{const{width:z,height:M,data:B}=j.getImageData(e);this.style.addImage(m,{data:new c.R({width:z,height:M},B),pixelRatio:u,stretchX:g,stretchY:b,content:T,textFitWidth:E,textFitHeight:k,sdf:h,version:0})}}updateImage(m,e){const a=this.style.getImage(m);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||c.b(e)?j.getImageData(e):e,{width:h,height:g,data:b}=u;if(h===void 0||g===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==a.data.width||g!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(e instanceof HTMLImageElement||c.b(e));return a.data.replace(b,T),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return ue.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,e){return this._lazyInitEmptyStyle(),this.style.addLayer(m,e),this._update(!0)}moveLayer(m,e){return this.style.moveLayer(m,e),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,e,a){return this.style.setLayerZoomRange(m,e,a),this._update(!0)}setFilter(m,e,a={}){return this.style.setFilter(m,e,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,e,a,u={}){return this.style.setPaintProperty(m,e,a,u),this._update(!0)}getPaintProperty(m,e){return this.style.getPaintProperty(m,e)}setLayoutProperty(m,e,a,u={}){return this.style.setLayoutProperty(m,e,a,u),this._update(!0)}getLayoutProperty(m,e){return this.style.getLayoutProperty(m,e)}setGlyphs(m,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,e,a,u=>{u||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,e,a=>{a||this._update(!0)}),this}setLight(m,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(m){return this._lazyInitEmptyStyle(),this.style.setSky(m),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,e){return this.style.setFeatureState(m,e),this._update()}removeFeatureState(m,e){return this.style.removeFeatureState(m,e),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,e=0;return this._container&&(m=this._container.clientWidth||400,e=this._container.clientHeight||300),[m,e]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const e=this._canvasContainer=N.create("div","maplibregl-canvas-container",m);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),u=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],u);const h=this._controlContainer=N.create("div","maplibregl-control-container",m),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{g[b]=N.create("div",`maplibregl-ctrl-${b} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,e,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:m},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});const a=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!a){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new us(a,this.transform),ke.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const h=this.transform.zoom,g=j.now();this.style.zoomHistory.update(h,g);const b=new c.z(h,{now:g,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=b.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.be.mark(c.bf.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,c.be.mark(c.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ue.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.be.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(m=>{c.be.frame(m),this._frameRequest=null,this._render(m)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return bf}getCameraTargetElevation(){return this.transform.elevation}},v.MapMouseEvent=Ur,v.MapTouchEvent=ga,v.MapWheelEvent=fs,v.Marker=lc,v.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,a)=>{const u=this._map._getUIString(`NavigationControl.${a}`);e.title=u,e.setAttribute("aria-label",u)},this.options=c.e({},Sf,m),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ld(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,e){const a=N.create("button",m,this._container);return a.type="button",a.addEventListener("click",e),a}},v.Popup=class extends c.E{constructor(m){super(),this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?oc(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let h=this.options.anchor;const g=hd(this.options.offset);if(!h){const T=this._container.offsetWidth,E=this._container.offsetHeight;let k;k=u.y+g.bottom.y<E?["top"]:u.y>this._map.transform.height-E?["bottom"]:[],u.x<T/2?k.push("left"):u.x>this._map.transform.width-T/2&&k.push("right"),h=k.length===0?"bottom":k.join("-")}let b=u.add(g[h]);this.options.subpixelPositioning||(b=b.round()),N.setTransform(this._container,`${ac[h]} translate(${b.x}px,${b.y}px)`),sc(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(ud),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.N.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const e=document.createDocumentFragment(),a=document.createElement("body");let u;for(a.innerHTML=m;u=a.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(cd);m&&m.focus()}},v.RasterDEMTileSource=cn,v.RasterTileSource=$t,v.ScaleControl=class{constructor(m){this._onMove=()=>{Pl(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Pl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Il),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Qu,v.Style=Tu,v.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Ku,v.TwoFingersTouchRotateHandler=vo,v.TwoFingersTouchZoomHandler=Wu,v.TwoFingersTouchZoomRotateHandler=yi,v.VectorTileSource=Fr,v.VideoSource=fo,v.addSourceType=(m,e)=>c._(void 0,void 0,void 0,function*(){if(di(m))throw new Error(`A source type called "${m}" already exists.`);((a,u)=>{hi[a]=u})(m,e)}),v.clearPrewarmedResources=function(){const m=on;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(yn),on=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Bn().getRTLTextPluginStatus()},v.getVersion=function(){return ji},v.getWorkerCount=function(){return Fn.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(m){return Do().broadcast("IS",m)},v.prewarm=function(){Xi().acquire(yn)},v.setMaxParallelImageRequests=function(m){c.a.MAX_PARALLEL_IMAGE_REQUESTS=m},v.setRTLTextPlugin=function(m,e){return Bn().setRTLTextPlugin(m,e)},v.setWorkerCount=function(m){Fn.workerCount=m},v.setWorkerUrl=function(m){c.a.WORKER_URL=m}});var w=l;return w})})(qw);var Gw=qw.exports;const Ww=$g(Gw),Rk=Ug({__proto__:null,default:Ww},[Gw]),Fk="_mapa_4mpsx_1",Bk="_marker_4mpsx_13",Ok="_infoBox_4mpsx_31",Nk={mapa:Fk,marker:Bk,infoBox:Ok},jk=[{"Comedor (nombre)":"CAC Once -BARRIAL ONCE","Organización a la que pertenece":"FACYR","Enlace punto gps":"",Coordenadas:"-34.60922223655508, -58.41404418939811",Barrio:"Balvanera","Dirección exacta":"Bartolome Mitre 3366",Responsable:"Mariana González","Contacto del/la responsable":1134192321,"Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Lunes a viernes","Horarios de funcionamiento":"10 a 16","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"Desayuno y almuerzo",Modalidad:""},{"Comedor (nombre)":"Cooperativa Amanecer de los Cartoneros","Organización a la que pertenece":"ACAC","Enlace punto gps":"",Coordenadas:"-34.64314862262282, -58.40668759077134",Barrio:"CABA","Dirección exacta":"Cortajarena 3151",Responsable:"VICTORIA BRINGAS","Contacto del/la responsable":1154906709,"Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Lunes a viernes","Horarios de funcionamiento":"8 a 12 y de 16 a 20","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"Almuerzo y cena",Modalidad:""},{"Comedor (nombre)":"Cooperativa Anuillan","Organización a la que pertenece":"FACYR","Enlace punto gps":"",Coordenadas:"-34.59508057304257, -58.46595218983126",Barrio:"La Paternal","Dirección exacta":"Osorio 4941",Responsable:"Jaqueline Flores","Contacto del/la responsable":"11 5505-2090","Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Lunes a viernes","Horarios de funcionamiento":"","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"Almuerzo, merienda, desayuno y cena",Modalidad:""},{"Comedor (nombre)":'Comedor "La Patria Grande',"Organización a la que pertenece":"ACEYTIS","Enlace punto gps":"",Coordenadas:"-34.59966043560515, -58.4733935065555",Barrio:"La Paternal","Dirección exacta":"Espinosa 2899 sector 3 casa 111, La Carbonilla",Responsable:"María Flores","Contacto del/la responsable":1166936661,"Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Sábado","Horarios de funcionamiento":"8 a 13h","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"Almuerzo",Modalidad:""},{"Comedor (nombre)":"Olla  CTEP Comedor Constitución","Organización a la que pertenece":"ACAC","Enlace punto gps":"",Coordenadas:"-34.62940096904388, -58.383476918232766",Barrio:"Constitucion","Dirección exacta":"Pedro Echague 1265",Responsable:"Sergio Sanchez","Contacto del/la responsable":1127453198,"Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Lunes a Viernes","Horarios de funcionamiento":"8 a 17hs","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"Almuerzo",Modalidad:""},{"Comedor (nombre)":'Comedor "Somos',"Organización a la que pertenece":"ACAC","Enlace punto gps":"",Coordenadas:"-34.5804069722307, -58.38807057405722",Barrio:"Retiro","Dirección exacta":"Aguara Guazú 2051, barrio padre Mújica",Responsable:"","Contacto del/la responsable":"","Redes institucionales (IG, FB, web)":"","Frecuencia de funcionamiento":"Todas las semanas","Días de funcionamiento":"Lunes a Viernes","Horarios de funcionamiento":"","Cuantas raciones diarias entrega?":"","Prestacion alimentaria":"",Modalidad:""}],Vk="_marker_l17or_2",Uk={marker:Vk};function $k({comedores:n,onSelect:i}){return vt.jsx(vt.Fragment,{children:n.map((l,p)=>{const[_,w]=l.Coordenadas.split(",").map(Number);return vt.jsx(Dk,{longitude:w,latitude:_,onClick:()=>i(l),children:vt.jsx("div",{className:Uk.marker})},p)})})}const Zk="_screen_ubis5_1",qk="_dataSection_ubis5_15",Hk="_timeSection_ubis5_15",Gk="_titleBox_ubis5_26",Wk="_contactBox_ubis5_48",Xk="_socialIcons_ubis5_64",Hl={screen:Zk,dataSection:qk,timeSection:Hk,titleBox:Gk,contactBox:Wk,socialIcons:Xk};function Kk({comedor:n}){return n?vt.jsxs("div",{className:Hl.screen,children:[vt.jsxs("div",{className:Hl.dataSection,children:[vt.jsxs("div",{className:Hl.titleBox,children:[vt.jsx("h3",{children:n["Comedor (nombre)"]||"Nombre no disponible"}),n["Organización a la que pertenece"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Organización:"})," ",n["Organización a la que pertenece"]]})]}),vt.jsxs("div",{className:Hl.contactBox,children:[n["Dirección exacta"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Dirección:"})," ",n["Dirección exacta"],", ",n.Barrio&&vt.jsx("strong",{children:n.Barrio})]}),n.Responsable&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Responsable:"})," ",n.Responsable]}),n["Contacto del/la responsable"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Contacto:"})," ",n["Contacto del/la responsable"]]}),vt.jsx("div",{className:Hl.socialIcons,children:n["Redes Sociales"]&&n["Redes Sociales"].map((i,l)=>vt.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer"},l))})]})]}),vt.jsxs("div",{className:Hl.timeSection,children:[n["Frecuencia de funcionamiento"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Frecuencia:"})," ",n["Frecuencia de funcionamiento"]]}),n["Días de funcionamiento"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Días:"})," ",n["Días de funcionamiento"]]}),n["Horarios de funcionamiento"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Horarios:"})," ",n["Horarios de funcionamiento"]]}),n["Prestacion alimentaria"]&&vt.jsxs("p",{children:[vt.jsx("strong",{children:"Prestación:"})," ",n["Prestacion alimentaria"]]})]})]}):null}function Jk(){const n={initialViewState:{longitude:58.3816,latitude:-34.6037,zoom:1.5,minZoom:1,maxZoom:25,maxBounds:[[-58.59,-34.8],[-58.31,-34.478]]},style:{width:"100vw",height:"100vh"}},[i,l]=Ie.useState(null),p=_=>{l(_)};return vt.jsxs("div",{className:Nk.mapa,children:[vt.jsxs(Ak,{...n,style:{width:"100vw",height:"100vh"},mapStyle:"https://tiles.stadiamaps.com/styles/alidade_smooth.json",mapLib:Ww,mapOptions:{},children:[vt.jsx(Lk,{position:"top-right"}),vt.jsx($k,{comedores:jk,onSelect:p})]}),i&&vt.jsx(Kk,{comedor:i})]})}function Yk(){return vt.jsx(vt.Fragment,{children:vt.jsx("h3",{children:"V 0.1"})})}function Qk(){return vt.jsxs(vt.Fragment,{children:[vt.jsx(rk,{}),vt.jsx(Jk,{}),vt.jsx(Yk,{})]})}const eI="_container_1ts3g_1",tI="_image_1ts3g_6",nI="_title_1ts3g_13",rI="_subtitle_1ts3g_18",iI="_description_1ts3g_24",Uc={container:eI,image:tI,title:nI,subtitle:rI,description:iI},oI="/MapaDeLosComedores/assets/comedores-DjyFd6P9.jpg";function aI(){return vt.jsxs("div",{className:Uc.container,children:[vt.jsx("img",{src:oI,alt:"Imagen de comedores",className:Uc.image}),vt.jsx("h1",{className:Uc.title,children:"MAPA DE LOS COMEDORES"}),vt.jsx("h2",{className:Uc.subtitle,children:"La ciudad solidaria"}),vt.jsx("p",{className:Uc.description,children:"Somos un conjunto de organizaciones de la sociedad civil de la Ciudad de Buenos Aires que todos los días sostenemos comedores y merenderos comunitarios. Esperamos que este Mapa de los Comedores sea un aporte a la visibilización y valoración de cada persona que dedica su tiempo y su trabajo para tenderle una mano a miles de otras en estos momentos difíciles. Buenos Aires es una Ciudad solidaria.."})]})}const sI=OC([{path:"/",element:vt.jsx(QC,{}),children:[{path:"/",element:vt.jsx(Qk,{})},{path:"/us",element:vt.jsx(aI,{})}]}]);Gm.createRoot(document.getElementById("root")).render(vt.jsx(Cx.StrictMode,{children:vt.jsx(GC,{router:sI})}));
